define(["jimu-core"],function(e){return function(e){var t={};function r(a){if(t[a])return t[a].exports;var n=t[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=452)}({2:function(t,r){t.exports=e},312:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(2);function n(e,t,r){return new Promise(function(n,i){return a.loadArcGISJSAPIModules(["esri/layers/FeatureLayer"]).then(function(a){if(t.features.length<1)return n();var i=void 0;i=a[0];for(var s=t.features[0].layer,l=[],u={},c=0;c<s.fields.length;c++){var p=o(s.fields[c]);u[s.fields[c].name]=p.name,l.push(p)}var d=[];for(var f in t.features[0].attributes)if(u[f]){p={fieldName:u[f],label:f};d.push(p)}var m=[];t.features.forEach(function(e,t){var r=e;if(r.attributes){for(var a in r.attributes)r.attributes[u[a]]=r.attributes[a];r.attributes.exbfid=t}else r.attributes={exbfid:t};m.push(r)});var g=new i({id:r,title:s.title,source:m,fields:l,outFields:["*"],objectIdField:"exbfid",renderer:s.renderer,popupEnabled:!0,popupTemplate:{title:"information",content:[{type:"fields",fieldInfos:d}]}});e.map.add(g),g.on("layerview-create",function(e){return n()})})})}function o(e){return{name:e.name.replace(/\./g,"_").replace(/\(/g,"_").replace(/\)/g,"_"),alias:e.alias,type:e.type}}function i(e){return a.loadArcGISJSAPIModules(["esri/geometry/Extent"]).then(function(t){var r;if(r=t[0],!e||!e.length)return Promise.resolve(null);var a,n=null,o=e.length;for(a=0;a<o;a++){var i=e[a];if(i){var s=i.extent;if(!s&&"point"===i.type){var l=i;l.x&&l.y&&(s=new r({xmax:l.x,xmin:l.x,ymax:l.y,ymin:l.y,zmax:l.z,zmin:l.z,spatialReference:l.spatialReference}))}s&&(n=n?n.union(s):s)}}return n.width<0&&n.height<0?Promise.resolve(null):Promise.resolve(n)})}function s(e){switch(e.type){case"point":return e;case"extent":return e.center;case"polygon":return e.centroid;case"polyline":return e.extent.center;default:return e&&e.extent?e.extent.center:void 0}}t.controlUIWidget=function(e,t,r,a,n){var o=e.ui;r&&(t?(o.add(r,a),n&&-1===o.specialComponents.indexOf(n)&&o.specialComponents.push(n)):o.remove(r))},t.createNewFeaturelayer=function(e,t){var r=[];return t&&Object.keys(t).forEach(function(a){e.map.layers.find(function(e){return e.id===a})?console.warn("the feature layer is already created"):r.push(n(e,t[a],a))}),0===r.length?null:Promise.all(r)},t.updateFeaturelayer=function(e,t){var r=[];return t&&Object.keys(t).forEach(function(a){var o=e.map.layers.find(function(e){return e.id===a});o&&(e.map.remove(o),r.push(n(e,t[a],a)))}),0===r.length?null:Promise.all(r)},t.selectFeature=function(e,t,r){var a=r,n=null,o=null;if(a||(o=t instanceof Array?t[0]:t)&&(a=o.layer&&o.layer.id),a){for(var i=e.allLayerViews,s=0;s<i.length;s++)i.getItemAt(s).layer.id===a&&(n=i.getItemAt(s));return n?{layerId:a,handle:n.highlight(t)}:null}},t.mapPanto=function(e,t){var r=t,a=e;if(r instanceof Array){if(0===r.length)return Promise.resolve();if(r[0].geometry){for(var n=[],o=0;o<r.length;o++)n.push(r[o].geometry);return i(n).then(function(e){return a.goTo(e.center)})}return r[0].extent?i(r).then(function(e){return a.goTo(e.center)}):Promise.resolve()}if(r.geometry){var l=r.geometry;return a.goTo(s(l))}if(r.extent)return l=r,a.goTo(s(l));return Promise.resolve()},t.flashFeaturesByQuery=function(e,t,r){if(t){for(var n=e.allLayerViews,o=null,i=0;i<n.length;i++)n.getItemAt(i).layer.id===t&&(o=n.getItemAt(i));if(!o)return null;a.loadArcGISJSAPIModules(["esri/tasks/support/Query","esri/Graphic"]).then(function(t){var a,n;a=t[0],n=t[1];var i=new a;i.where=r,i.outFields=["*"],i.returnGeometry=!0,o.layer.queryFeatures(i).then(function(t){if(t&&t.features&&t.features.length>0){var r=function(e){return["point","multipoint"].indexOf(e)>-1?{type:"simple-marker",style:"circle",color:[255,255,0,.8],size:"16px",outline:{color:[255,255,0,.8],width:3}}:["polyline"].indexOf(e)>-1?{type:"simple-line",color:[255,255,0,.8],width:3,style:"solid"}:["polygon","extent"].indexOf(e)>-1?{type:"simple-fill",color:[255,255,0,.5],style:"solid",outline:{color:[255,255,0,.8],width:3}}:["mesh"].indexOf(e)>-1?{type:"mesh-3d",symbolLayers:[{type:"fill",material:{color:[255,255,0,.8]}}]}:null}(o.layer.geometryType);!function(t,a){for(var o=[],i=0,s=0;s<t.length;s++){var l=new n({geometry:t[s].geometry,symbol:r,attributes:t[s].attributes});o.push(l)}var u=function(){e.graphics.addMany(o),setTimeout(function(){e.graphics.removeMany(o),(i+=1)<a&&setTimeout(function(){u()},500)},500)};u()}(t.features,3)}})})}},t.handleFeature=function(e,t){var r=null;return e.clone?r=e.clone():(r=t.fromJSON(Object.assign({},e))).attributes=Object.assign({},e.attributes),r},t.getMapBaseRestoreData=function(e){return{mapContainer:e.mapContainer,state:e.state,MapView:e.MapView,SceneView:e.SceneView,Extent:e.Extent,Zoom:e.Zoom,ScaleBar:e.ScaleBar,Home:e.Home,Locate:e.Locate,Search:e.Search,Compass:e.Compass,Navigate:e.Navigate,Viewpoint:e.Viewpoint,mapView:e.mapView,sceneView:e.sceneView,mapViewDS:e.mapViewDS,sceneViewDS:e.sceneViewDS,overview:e.overview,zoomBtn:e.zoomBtn,scaleBar:e.scaleBar,homeBtn:e.homeBtn,locateBtn:e.locateBtn,earchBtn:e.searchBtn,compassBtn:e.compassBtn,navigateBtn:e.navigateBtn,extentWatch:e.extentWatch,dsManager:e.dsManager,highLightHandles:e.highLightHandles,mapBaseViewEventHandles:e.mapBaseViewEventHandles,initialViewPoint:e.initialViewPoint}},t.restoreMapBase=function(e,t){e.mapContainer=t.mapContainer,e.state=t.state,e.MapView=t.MapView,e.SceneView=t.SceneView,e.Extent=t.Extent,e.Zoom=t.Zoom,e.ScaleBar=t.ScaleBar,e.Home=t.Home,e.Locate=t.Locate,e.Search=t.Search,e.Compass=t.Compass,e.Navigate=t.Navigate,e.Viewpoint=t.Viewpoint,e.mapView=t.mapView,e.sceneView=t.sceneView,e.mapViewDS=t.mapViewDS,e.sceneViewDS=t.sceneViewDS,e.overview=t.overview,e.zoomBtn=t.zoomBtn,e.scaleBar=t.scaleBar,e.homeBtn=t.homeBtn,e.locateBtn=t.locateBtn,e.searchBtn=t.searchBtn,e.compassBtn=t.compassBtn,e.navigateBtn=t.navigateBtn,e.extentWatch=t.extentWatch,e.dsManager=t.dsManager,e.highLightHandles=t.highLightHandles,e.mapBaseViewEventHandles=t.mapBaseViewEventHandles,e.initialViewPoint=t.initialViewPoint}},452:function(e,t,r){"use strict";var a=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function a(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}();Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(312),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.filterMessageType=function(e){return e===n.MessageType.SpatialDataRecordSetCreate||e===n.MessageType.SpatialDataRecordSetUpdate||e===n.MessageType.SpatialDataRecordsSelectionChange||e===n.MessageType.ExtentChange},t.prototype.filterMessage=function(e){return!0},t.prototype.onExecute=function(e,t){var r=this;return n.loadArcGISJSAPIModules(["esri/Graphic"]).then(function(t){var a;switch(a=t[0],e.type){case n.MessageType.SpatialDataRecordSetCreate:var i=e,s={};if(i.dataRecordSet&&i.dataRecordSet.records){for(var l=[],u=0;u<i.dataRecordSet.records.length;u++)i.dataRecordSet.records[u].feature&&l.push(o.handleFeature(i.dataRecordSet.records[u].feature,a).geometry);s={features:l}}n.getAppStore().dispatch(n.appActions.widgetMutableStatePropChange(r.widgetId,"zoomToFeatureActionValue.value",s));break;case n.MessageType.SpatialDataRecordSetUpdate:var c=e,p={};if(c.dataRecordSet&&c.dataRecordSet.records){for(l=[],u=0;u<c.dataRecordSet.records.length;u++)c.dataRecordSet.records[u].feature&&l.push(o.handleFeature(c.dataRecordSet.records[u].feature,a).geometry);p={features:l}}n.getAppStore().dispatch(n.appActions.widgetMutableStatePropChange(r.widgetId,"zoomToFeatureActionValue.value",p));break;case n.MessageType.SpatialDataRecordsSelectionChange:var d=e,f=[];if(d.records)for(u=0;u<d.records.length;u++)d.records[u].feature&&f.push(o.handleFeature(d.records[u].feature,a).geometry);n.getAppStore().dispatch(n.appActions.widgetMutableStatePropChange(r.widgetId,"zoomToFeatureActionValue.value",f));break;case n.MessageType.ExtentChange:var m=e;if(m.getRelatedWidgetIds().indexOf(r.widgetId)>-1)break;var g={value:m.extent,relatedWidgets:m.getRelatedWidgetIds()};n.getAppStore().dispatch(n.appActions.widgetMutableStatePropChange(r.widgetId,"zoomToFeatureActionValue",g))}return!0})},t}(n.AbstractMessageAction);t.default=i}})});
//# sourceMappingURL=zoom-to-feature-action.js.map