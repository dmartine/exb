define(["jimu-core","jimu-arcgis/arcgis-data-source","esri/views/MapView","esri/geometry/Extent"],function(t,e,r,n){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=708)}({2:function(e,r){e.exports=t},32:function(t,r){t.exports=e},398:function(t,e){t.exports=r},708:function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(2),a=r(2),u=r(32),i=r(398),c=r(709);u.MapViewDataSource;var s=function(t){function e(e){var r=t.call(this,e)||this;return r.mapContainer=o.React.createRef(),r.dsManager=a.DataSourceManager.getInstance(),r.onDsInject=function(t){r.update(t)},r.mapNode=o.React.createElement("div",{className:"widget-map",style:{width:"500px",height:"500px"},ref:r.mapContainer}),r}return n(e,t),e.prototype.update=function(t){var e=this;if(t&&!this.mapView){var r={map:t.map,container:this.mapContainer.current};if(this.props.queryObject[this.props.id]){var n=this.props.queryObject[this.props.id].substr("extent=".length),u=void 0;try{u=new c(JSON.parse(n))}catch(t){console.error("Bad extent URL parameter.")}u&&(r.extent=u)}this.mapView=new i(r),this.mapView.when(function(){if(e.props.outputDataSources){var t=a.DataSourceManager.getInstance(),r=e.props.outputDataSources[0],n=t.getDataSource(r);if(!n){var o={dataSourceJson:e.props.outputDataSourceJson,view:e.mapView};t.createDataSource(o).then(function(t){return n=t})}}}),this.extentWatch||(this.extentWatch=this.mapView.watch("extent",function(t){var r;o.jimuHistory.changeQueryObject(((r={})[e.props.id]="extent="+JSON.stringify(t.toJSON()),r))}))}},e.prototype.render=function(){return this.props.useDataSources&&0!==this.props.useDataSources.length?o.React.createElement(o.DataSourceComponent,{useDataSource:this.props.useDataSources[0],onDataSourceCreated:this.onDsInject},this.mapNode):"Please choose webmap in setting"},e.mapExtraStateProps=function(t,e){return{outputDataSourceJson:t.appConfig.dataSources[e.outputDataSources[0]]}},e}(a.BaseWidget);e.default=s},709:function(t,e){t.exports=n}})});
//# sourceMappingURL=widget.js.map