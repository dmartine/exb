define(["jimu-core/react","jimu-core","jimu-ui","jimu-for-builder"],function(e,t,n,o){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=544)}({0:function(t,n){t.exports=e},2:function(e,n){e.exports=t},28:function(e,t,n){function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var i=n(0),s=i.createElement("path",{d:"M7.42 8.84a.502.502 0 0 1 0 .71L6 10.97A3.515 3.515 0 1 1 1.03 6l1.42-1.42a.502.502 0 1 1 .71.71L1.74 6.71a2.51 2.51 0 1 0 3.55 3.55l1.42-1.42a.502.502 0 0 1 .71 0zm1.42-2.13l1.42-1.42a2.51 2.51 0 1 0-3.55-3.55L5.29 3.16a.502.502 0 1 1-.71-.71L6 1.03A3.515 3.515 0 1 1 10.97 6L9.55 7.42a.502.502 0 1 1-.71-.71zm-4.97.71l3.55-3.55a.502.502 0 0 1 .71.71L4.58 8.13a.502.502 0 0 1-.71-.71z",fill:"currentColor",fillRule:"nonzero"});function r(e){return i.createElement("svg",o({width:12,height:12,viewBox:"0 0 12 12"},e),s)}e.exports=r,r.default=r},4:function(e,t){e.exports=n},544:function(e,t,n){"use strict";var o=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0});var i,s,r=n(2),a=n(6),l=n(4),p=n(545),u=n(546),g=n(28);!function(e){e.Default="DEFAULT",e.Outline="OUTLINE",e.DefaultRround="DEFAULTROUND",e.OutlineRound="OUTLINEROUND",e.Link="LINK"}(i||(i={})),function(e){e.Default="DEFAULT",e.Large="LARGE",e.Small="SMALL"}(s||(s={}));var f=[l.ThemeColors.PRIMARY,l.ThemeColors.SECONDARY,l.ThemeColors.SUCCESS,l.ThemeColors.INFO,l.ThemeColors.WARNING,l.ThemeColors.DANGER,l.ThemeColors.LIGHT,l.ThemeColors.DARK],c=function(e){function t(t){var n,o,p,g=e.call(this,t)||this;return g.width70Style={width:"75%",minHeight:"20px"},g.supportedDsTypes=r.Immutable([a.AllDataSourceTypes.FeatureLayer,a.AllDataSourceTypes.FeatureQuery]),g.themeGenerals=((n={})[i.Default]={label:g.props.intl.formatMessage({id:"default",defaultMessage:u.default.default}),themeStyle:"default"},n[i.Outline]={label:g.props.intl.formatMessage({id:"outline",defaultMessage:u.default.outline}),themeStyle:"outline"},n[i.DefaultRround]={label:g.props.intl.formatMessage({id:"defaultRound",defaultMessage:u.default.defaultRound}),themeStyle:"default-round"},n[i.OutlineRound]={label:g.props.intl.formatMessage({id:"outlineRound",defaultMessage:u.default.outlineRound}),themeStyle:"outline-round"},n[i.Link]={label:g.props.intl.formatMessage({id:"link",defaultMessage:u.default.link}),themeStyle:"link"},n),g.themeSizes=((o={})[s.Default]={label:g.props.intl.formatMessage({id:"default",defaultMessage:u.default.default}),themeStyle:""},o[s.Large]={label:g.props.intl.formatMessage({id:"large",defaultMessage:u.default.large}),themeStyle:"lg"},o[s.Small]={label:g.props.intl.formatMessage({id:"small",defaultMessage:u.default.small}),themeStyle:"sm"},o),g.themeColors=((p={})[l.ThemeColors.PRIMARY]={label:g.props.intl.formatMessage({id:"primary",defaultMessage:u.default.primary}),themeStyle:"primary"},p[l.ThemeColors.SECONDARY]={label:g.props.intl.formatMessage({id:"secondary",defaultMessage:u.default.secondary}),themeStyle:"secondary"},p[l.ThemeColors.SUCCESS]={label:g.props.intl.formatMessage({id:"success",defaultMessage:u.default.success}),themeStyle:"success"},p[l.ThemeColors.INFO]={label:g.props.intl.formatMessage({id:"info",defaultMessage:u.default.info}),themeStyle:"info"},p[l.ThemeColors.WARNING]={label:g.props.intl.formatMessage({id:"warning",defaultMessage:u.default.warning}),themeStyle:"warning"},p[l.ThemeColors.DANGER]={label:g.props.intl.formatMessage({id:"danger",defaultMessage:u.default.danger}),themeStyle:"danger"},p[l.ThemeColors.LIGHT]={label:g.props.intl.formatMessage({id:"light",defaultMessage:u.default.light}),themeStyle:"light"},p[l.ThemeColors.DARK]={label:g.props.intl.formatMessage({id:"dark",defaultMessage:u.default.dark}),themeStyle:"dark"},p),g.outlineStyleReg=/outline/i,g.roundStyleReg=/round/i,g.linkStyleReg=/link/i,g.linkNameReg=/link/i,g.getGeneralThemeName=function(e){if(!e)return i.Default;if(g.linkStyleReg.test(e.color))return i.Link;var t="default",n="";e.outline&&(t="outline"),e.rounded&&(n="round");var o=n?t+"-"+n:t;return Object.keys(g.themeGenerals).find(function(e){return g.themeGenerals[e].themeStyle===o})||i.Default},g.getSizeThemeName=function(e){return e&&Object.keys(g.themeSizes).find(function(t){return g.themeSizes[t].themeStyle===e.size})||s.Default},g.getColorThemeName=function(e){return e?g.linkStyleReg.test(e.color)?l.ThemeColors.PRIMARY:Object.keys(g.themeColors).find(function(t){return g.themeColors[t].themeStyle===e.color})||l.ThemeColors.PRIMARY:l.ThemeColors.PRIMARY},g.getThemeStyle=function(e,t,n){var o={outline:g.outlineStyleReg.test(g.themeGenerals[e].themeStyle),rounded:g.roundStyleReg.test(g.themeGenerals[e].themeStyle),color:g.linkStyleReg.test(g.themeGenerals[e].themeStyle)?"link":g.themeColors[n].themeStyle,size:g.themeSizes[t].themeStyle};return g.props.config.styleConfig.themeStyle.merge(o)},g.changeGeneral=function(e){g.props.onSettingChange({widgetId:g.props.id,config:g.props.config.setIn(["styleConfig","themeStyle"],g.getThemeStyle(e,g.getSizeThemeName(g.props.config.styleConfig.themeStyle),g.getColorThemeName(g.props.config.styleConfig.themeStyle)))})},g.changeSize=function(e){g.props.onSettingChange({widgetId:g.props.id,config:g.props.config.setIn(["styleConfig","themeStyle"],g.getThemeStyle(g.getGeneralThemeName(g.props.config.styleConfig.themeStyle),e,g.getColorThemeName(g.props.config.styleConfig.themeStyle)))})},g.changeColor=function(e){g.props.onSettingChange({widgetId:g.props.id,config:g.props.config.setIn(["styleConfig","themeStyle"],g.getThemeStyle(g.getGeneralThemeName(g.props.config.styleConfig.themeStyle),g.getSizeThemeName(g.props.config.styleConfig.themeStyle),e))})},g.toggleLinkSetting=function(){g.setState({isLinkSettingShown:!g.state.isLinkSettingShown})},g.onSettingLinkConfirm=function(e){var t;if(e){if(e.expression){i=g.getTextExpression(),s=g.getTipExpression();var n=e.expression;o=g.mergeUseDataSources(i,s,n);t={widgetId:g.props.id,config:g.props.config.setIn(["functionConfig","linkParam"],e),useDataSources:o}}else{var o=void 0;if(g.getIsDataSourceUsed()){var i=g.getTextExpression(),s=g.getTipExpression();o=g.mergeUseDataSources(i,s,null)}else o=g.getUseDataSourcesWithoutFields();t={widgetId:g.props.id,config:g.props.config.setIn(["functionConfig","linkParam"],e),useDataSources:o}}g.props.onSettingChange(t),g.setState({isLinkSettingShown:!1})}},g.onTextInputConfigChange=function(e){var t={widgetId:g.props.id,config:g.props.config.setIn(["functionConfig","text"],g.state.currentTextInput).setIn(["functionConfig","textExpression"],null),useDataSources:g.getUseDataSourcesWithoutFields()};g.props.onSettingChange(t)},g.onToolTipConfigChange=function(e){var t={widgetId:g.props.id,config:g.props.config.setIn(["functionConfig","toolTip"],g.state.currentTipInput).setIn(["functionConfig","toolTipExpression"],null),useDataSources:g.getUseDataSourcesWithoutFields()};g.props.onSettingChange(t)},g.onTextExpChange=function(e){if(e){var t=g.getTipExpression(),n=g.getLinkSettingExpression(),o=g.mergeUseDataSources(e,t,n);g.props.onSettingChange({widgetId:g.props.id,config:g.props.config.setIn(["functionConfig","textExpression"],e),useDataSources:o}),g.setState({isTextExpOpen:!1})}},g.onTipExpChange=function(e){if(e){var t=g.getTextExpression(),n=g.getLinkSettingExpression(),o=g.mergeUseDataSources(t,e,n);g.props.onSettingChange({widgetId:g.props.id,config:g.props.config.setIn(["functionConfig","toolTipExpression"],e),useDataSources:o}),g.setState({isTipExpOpen:!1})}},g.mergeUseDataSources=function(e,t,n){var o=a.expressionUtils.getUseDataSourceFromExpParts(e&&e.parts),i=a.expressionUtils.getUseDataSourceFromExpParts(t&&t.parts),s=a.expressionUtils.getUseDataSourceFromExpParts(n&&n.parts);return g.mergeUseDataSourcesByDss(o,i,s)},g.mergeUseDataSourcesByDss=function(e,t,n){var o=g.getUseDataSourcesWithoutFields(),i=a.expressionUtils.mergeUseDataSources(o,e);return i=a.expressionUtils.mergeUseDataSources(i,t),i=a.expressionUtils.mergeUseDataSources(i,n)},g.generateColors=function(){var e=g.props.appTheme&&g.props.appTheme.colors||{};return f.map(function(t){return{name:t,value:e[t],background:e[t]}})},g.getUseDataSourcesWithoutFields=function(){return g.props.useDataSources&&g.props.useDataSources[0]&&g.props.useDataSources[0].dataSourceId?r.Immutable([g.props.useDataSources[0].without("fields")]):r.Immutable([])},g.getIsDataSourceUsed=function(){return g.props.useDataSourcesEnabled},g.getTipExpression=function(){var e=g.props.config&&g.props.config.functionConfig&&g.props.config.functionConfig.toolTipExpression&&g.props.config.functionConfig.toolTipExpression;return e&&e.asMutable({deep:!0})||{name:"default expression",parts:[{type:r.ExpressionPartType.String,exp:'"'+(g.props.config&&g.props.config.functionConfig&&g.props.config.functionConfig.toolTip)+'"'}]}},g.getTextExpression=function(){var e=g.props.config&&g.props.config.functionConfig&&g.props.config.functionConfig.textExpression&&g.props.config.functionConfig.textExpression;return e&&e.asMutable({deep:!0})||{name:"default expression",parts:[{type:r.ExpressionPartType.String,exp:'"'+(g.props.config&&g.props.config.functionConfig&&g.props.config.functionConfig.text)+'"'}]}},g.getLinkSettingExpression=function(){var e=g.props.config&&g.props.config.functionConfig&&g.props.config.functionConfig.linkParam&&g.props.config.functionConfig.linkParam&&g.props.config.functionConfig.linkParam.expression;return e&&e.asMutable({deep:!0})||null},g.openTextExpPopup=function(){g.setState({isTextExpOpen:!0,isTipExpOpen:!1})},g.openTipExpPopup=function(){g.setState({isTextExpOpen:!1,isTipExpOpen:!0})},g.closeTextExpPopup=function(){g.setState({isTextExpOpen:!1,isTipExpOpen:!1})},g.closeTipExpPopup=function(){g.setState({isTextExpOpen:!1,isTipExpOpen:!1})},g.state={isLinkSettingShown:!1,isTextExpOpen:!1,isTipExpOpen:!1,currentTextInput:g.props.config?g.props.config.functionConfig.text:null,currentTipInput:g.props.config?g.props.config.functionConfig.toolTip:null},g}return o(t,e),t.prototype.render=function(){var e=this,t=Object.keys(this.themeGenerals),n=this.props.useDataSources||[],o=n[0]?r.Immutable([n[0].dataSourceId]):r.Immutable([]);return r.jsx("div",{css:p.getStyle(this.props.theme)},r.jsx("div",{className:"widget-setting-link jimu-widget"},r.jsx("div",null,r.jsx(a.SettingSection,null,r.jsx(a.SettingRow,null,r.jsx("div",{className:"choose-ds w-100"},r.jsx(a.DataSourceChooser,{types:this.supportedDsTypes,selectedDataSourceIds:o,widgetId:this.props.id})))),r.jsx(a.SettingSection,null,r.jsx(a.SettingRow,null,r.jsx(l.Button,{className:"w-100 text-dark set-link-btn",color:"primary",onClick:this.toggleLinkSetting},r.jsx(l.Icon,{className:"mr-3",icon:g}),this.props.intl.formatMessage({id:"setLink",defaultMessage:u.default.setLink}))),r.jsx(a.SettingRow,{label:this.props.intl.formatMessage({id:"text",defaultMessage:u.default.text})},this.getIsDataSourceUsed()?r.jsx("div",{style:this.width70Style},r.jsx(a.ExpressionInput,{dataSourceIds:o,onChange:this.onTextExpChange,openExpPopup:this.openTextExpPopup,expression:this.getTextExpression(),isExpPopupOpen:this.state.isTextExpOpen,closeExpPopup:this.closeTextExpPopup,from:[a.ExpressionInputFrom.Static,a.ExpressionInputFrom.Attribute,a.ExpressionInputFrom.Statistics,a.ExpressionInputFrom.Expression]})):r.jsx(l.Input,{className:"float-right",style:this.width70Style,value:this.state.currentTextInput,onChange:function(t){e.setState({currentTextInput:t.target.value})},onBlur:function(){e.onTextInputConfigChange()},onKeyUp:function(){e.onTextInputConfigChange()}})),r.jsx(a.SettingRow,{label:this.props.intl.formatMessage({id:"tooltip",defaultMessage:u.default.tooltip})},this.getIsDataSourceUsed()?r.jsx("div",{style:this.width70Style},r.jsx(a.ExpressionInput,{dataSourceIds:o,onChange:this.onTipExpChange,openExpPopup:this.openTipExpPopup,expression:this.getTipExpression(),isExpPopupOpen:this.state.isTipExpOpen,closeExpPopup:this.closeTipExpPopup,from:[a.ExpressionInputFrom.Static,a.ExpressionInputFrom.Attribute,a.ExpressionInputFrom.Statistics,a.ExpressionInputFrom.Expression]})):r.jsx(l.Input,{className:"float-right",style:this.width70Style,value:this.state.currentTipInput,onChange:function(t){e.setState({currentTipInput:t.target.value})},onBlur:function(){e.onToolTipConfigChange()},onKeyUp:function(){e.onToolTipConfigChange()}}))),r.jsx(a.SettingSection,null,r.jsx(a.SettingRow,null,r.jsx("div",{className:"d-flex justify-content-between w-100"},r.jsx("label",null,this.props.intl.formatMessage({id:"style",defaultMessage:u.default.style})))),t.map(function(t,n){return r.jsx(a.SettingRow,{key:t},r.jsx(l.Input,{onChange:function(){return e.changeGeneral(t)},id:"link-style"+n,type:"radio",checked:e.getGeneralThemeName(e.props.config.styleConfig.themeStyle)===t}),r.jsx(l.Label,{for:"link-style"+n,className:"ml-2 link-cursor-pointer"},e.themeGenerals[t].label))})),this.linkNameReg.test(this.getGeneralThemeName(this.props.config.styleConfig.themeStyle))?null:r.jsx(a.SettingSection,null,r.jsx(a.SettingRow,null,r.jsx("div",{className:"d-flex justify-content-between w-100"},r.jsx("label",null,this.props.intl.formatMessage({id:"color",defaultMessage:u.default.color})))),r.jsx(a.SingleColorChooser,{color:this.getColorThemeName(this.props.config.styleConfig.themeStyle),colors:this.generateColors(),onChange:function(t){return e.changeColor(t)}}))),this.state.isLinkSettingShown&&!r.urlUtils.getAppIdPageIdFromUrl().pageId&&r.jsx(a.LinkSettingPopup,{showDialog:this.state.isLinkSettingShown,onSettingCancel:function(){e.setState({isLinkSettingShown:!1})},onSettingConfirm:this.onSettingLinkConfirm,linkParam:this.props.config.functionConfig.linkParam,dataSourceIds:this.getIsDataSourceUsed()&&o})))},t.mapExtraStateProps=function(e,t){return{appTheme:e&&e.appStateInBuilder&&e.appStateInBuilder.theme}},t}(a.BaseWidgetSetting);t.default=c},545:function(e,t,n){"use strict";var o=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var i,s=n(2);t.getStyle=function(e){return s.css(i||(i=o(["\n    .widget-setting-link {\n      overflow-y: auto;\n      font-size: 13px;\n      font-weight: lighter;\n\n      .link-setting-selected {\n        border: "," solid;\n      }\n\n      .choose-ds {\n        width: ",";\n      }\n\n      .setting-function {\n\n        .setting-function-item {\n          overflow: hidden;\n\n          .setting-function-item-input {\n            width: ",";\n          }\n        }\n      }\n\n      .setting-exterior {\n\n        .exterior-shape-item {\n          padding-bottom: 100%;\n          cursor: pointer;\n        }\n      }\n\n      .setting-collapse {\n        overflow: hidden;\n        cursor: pointer;\n      }\n\n      .setting-stylepicker {\n        display: grid;\n        grid-template-columns: repeat(3, 1fr);\n        grid-gap: ",";\n      }\n\n      .setting-stylepicker-item {\n        height: ",";\n      }\n\n      .setting-stylepicker-selected {\n        border-width: "," !important;\n      }\n\n      .link-cursor-pointer{\n        cursor: pointer;\n      }\n    }\n\n  "],["\n    .widget-setting-link {\n      overflow-y: auto;\n      font-size: 13px;\n      font-weight: lighter;\n\n      .link-setting-selected {\n        border: "," solid;\n      }\n\n      .choose-ds {\n        width: ",";\n      }\n\n      .setting-function {\n\n        .setting-function-item {\n          overflow: hidden;\n\n          .setting-function-item-input {\n            width: ",";\n          }\n        }\n      }\n\n      .setting-exterior {\n\n        .exterior-shape-item {\n          padding-bottom: 100%;\n          cursor: pointer;\n        }\n      }\n\n      .setting-collapse {\n        overflow: hidden;\n        cursor: pointer;\n      }\n\n      .setting-stylepicker {\n        display: grid;\n        grid-template-columns: repeat(3, 1fr);\n        grid-gap: ",";\n      }\n\n      .setting-stylepicker-item {\n        height: ",";\n      }\n\n      .setting-stylepicker-selected {\n        border-width: "," !important;\n      }\n\n      .link-cursor-pointer{\n        cursor: pointer;\n      }\n    }\n\n  "])),s.polished.rem(2),s.polished.rem(160),s.polished.rem(200),s.polished.rem(10),s.polished.rem(30),s.polished.rem(2))}},546:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={default:"Default",outline:"Outline",link:"Link",large:"Large",small:"Small",primary:"Primary",secondary:"Secondary",success:"Success",info:"Info",warning:"Warning",danger:"Danger",light:"Light",dark:"Dark",connectToData:"Connect to data",setLink:"Set link",style:"Style",size:"Size",color:"Color",text:"Text",tooltip:"Tooltip",defaultRound:"Default round",outlineRound:"Outline round"}},6:function(e,t){e.exports=o}})});
//# sourceMappingURL=setting.js.map