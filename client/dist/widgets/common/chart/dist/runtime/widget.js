define(["jimu-core","jimu-ui"],function(e,t){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=457)}({2:function(t,r){t.exports=e},296:function(e,t,r){"use strict";function n(e){return"/"===(e=e.trim())[e.length-1]&&(e=e.slice(0,-1)),e}r.d(t,"a",function(){return n})},297:function(e,t,r){"use strict";var n=r(5);function o(e){return Object.keys(e).some(function(t){var r=e[t];if(!r)return!1;switch(r&&r.toParam&&(r=r.toParam()),r.constructor.name){case"Array":case"Object":case"Date":case"Function":case"Boolean":case"String":case"Number":return!1;default:return!0}})}function a(e){var t={};return Object.keys(e).forEach(function(r){var n=e[r];if(n&&n.toParam&&(n=n.toParam()),n||0===n||"boolean"==typeof n||"string"==typeof n){var o;switch(n.constructor.name){case"Array":o=n[0]&&n[0].constructor&&"Object"===n[0].constructor.name?JSON.stringify(n):n.join(",");break;case"Object":o=JSON.stringify(n);break;case"Date":o=n.valueOf();break;case"Function":o=null;break;case"Boolean":o=n+"";break;default:o=n}(o||0===o||"string"==typeof o)&&(t[r]=o)}}),t}function i(e){var t=a(e);return Object.keys(t).map(function(e){return function(e,t){return encodeURIComponent(e)+"="+encodeURIComponent(t)}(e,t[e])}).join("&")}var s=function(){return function(e,t,r,n,o){e=e||"UNKNOWN_ERROR",t=t||"UNKNOWN_ERROR_CODE",this.name="ArcGISRequestError",this.message="UNKNOWN_ERROR_CODE"===t?e:t+": "+e,this.originalMessage=e,this.code=t,this.response=r,this.url=n,this.options=o}}();s.prototype=Object.create(Error.prototype),s.prototype.constructor=s;r(310);r.d(t,"a",function(){return d});var u="@esri/arcgis-rest-js",l={httpMethod:"POST",params:{f:"json"}};var c=function(e){function t(t,r,n,o,a){void 0===t&&(t="AUTHENTICATION_ERROR"),void 0===r&&(r="AUTHENTICATION_ERROR_CODE");var i=e.call(this,t,r,n,o,a)||this;return i.name="ArcGISAuthError",i.message="AUTHENTICATION_ERROR_CODE"===r?t:r+": "+t,i}return n.b(t,e),t.prototype.retry=function(e,t){var r=this;void 0===t&&(t=3);var o=0,a=function(i,s){e(r.url,r.options).then(function(e){var t=n.a({},r.options,{authentication:e});return o+=1,d(r.url,t)}).then(function(e){i(e)}).catch(function(e){"ArcGISAuthError"===e.name&&o<t?a(i,s):"ArcGISAuthError"===e.name&&o>=t?s(r):s(e)})};return new Promise(function(e,t){a(e,t)})},t}(s);function d(e,t){void 0===t&&(t={params:{f:"json"}});var r=n.a({httpMethod:"POST"},l,t,{params:n.a({},l.params,t.params),headers:n.a({},l.headers,t.headers)}),d=[],f=[];if(r.fetch||"undefined"==typeof fetch?(d.push("`fetch`"),f.push("`node-fetch`")):r.fetch=fetch.bind(Function("return this")()),"undefined"==typeof Promise&&(d.push("`Promise`"),f.push("`es6-promise`")),"undefined"==typeof FormData&&(d.push("`FormData`"),f.push("`isomorphic-form-data`")),!r.fetch||"undefined"==typeof Promise||"undefined"==typeof FormData)throw new Error("`arcgis-rest-request` requires a `fetch` implementation and global variables for `Promise` and `FormData` to be present in the global scope. You are missing "+d.join(", ")+". We recommend installing the "+f.join(", ")+" modules at the root of your application to add these to the global scope. See https://bit.ly/2KNwWaJ for more info.");var p=r.httpMethod,h=r.authentication,b=r.rawResponse,y=n.a({f:"json"},r.params),g=null,m={method:p,credentials:"same-origin"};return(h?h.getToken(e,{fetch:r.fetch}).catch(function(t){return t.url=e,t.options=r,g=t,Promise.resolve("")}):Promise.resolve("")).then(function(t){if(t.length&&(y.token=t),"GET"===m.method){var s=""===i(y)?e:e+"?"+i(y);r.maxUrlLength&&s.length>r.maxUrlLength?m.method="POST":e=s}var l=new RegExp("/items/.+/updateResources").test(e);return"POST"===m.method&&(m.body=function(e,t){var r=o(e)||t,n=a(e);if(r){var s=new FormData;return Object.keys(n).forEach(function(e){if("undefined"!=typeof Blob&&n[e]instanceof Blob){var t=n.fileName||n[e].name||e;s.append(e,n[e],t)}else s.append(e,n[e])}),s}return i(e)}(y,l)),m.headers=n.a({},r.headers),"undefined"!=typeof window||m.headers.referer||(m.headers.referer=u),o(y)||l||(m.headers["Content-Type"]="application/x-www-form-urlencoded"),r.fetch(e,m)}).then(function(t){if(!t.ok){var n=t.status,o=t.statusText;throw new s(o,"HTTP "+n,t,e,r)}if(b)return t;switch(y.f){case"json":case"geojson":return t.json();case"html":case"text":return t.text();default:return t.blob()}}).then(function(t){if("json"!==y.f&&"geojson"!==y.f||b)return t;var n=function(e,t,r,n,o){if(e.code>=400){var a=e.message,i=e.code;throw new s(a,i,e,t,n)}if(e.error){var u=e.error,l=(a=u.message,i=u.code,u.messageCode),d=l||i||"UNKNOWN_ERROR_CODE";if(498===i||499===i||"GWM_0003"===l||400===i&&"Unable to generate token."===a)throw o||new c(a,d,e,t,n);throw new s(a,d,e,t,n)}if("failed"===e.status||"failure"===e.status){a=void 0,i="UNKNOWN_ERROR_CODE";try{a=JSON.parse(e.statusMessage).message,i=JSON.parse(e.statusMessage).code}catch(t){a=e.statusMessage||e.message}throw new s(a,i,e,t,n)}return e}(t,e,0,r,g);if(g){var o=e.toLowerCase().split(/\/rest(\/admin)?\/services\//)[0];r.authentication.trustedServers[o]={token:[],expires:new Date(Date.now()+864e5)},g=null}return n})}},310:function(e,t,r){"use strict";function n(e){console&&console.warn&&console.warn.apply(console,[e])}r.d(t,"a",function(){return n})},328:function(e,t,r){"use strict";r.d(t,"a",function(){return s}),r.d(t,"b",function(){return u});var n=r(5),o=r(296),a=r(297),i=r(347);function s(e){var t=Object(o.a)(e.url)+"/"+e.id,r=n.a({httpMethod:"GET"},e);return Object(a.a)(t,r).then(function(e){return r.rawResponse?e:e.feature})}function u(e){var t=Object(i.a)(e,["where","objectIds","relationParam","time","distance","units","outFields","geometry","geometryType","spatialRel","returnGeometry","maxAllowableOffset","geometryPrecision","outSR","gdbVersion","returnDistinctValues","returnIdsOnly","returnCountOnly","returnExtentOnly","orderByFields","groupByFieldsForStatistics","outStatistics","returnZ","returnM","multipatchOption","resultOffset","resultRecordCount","quantizationParameters","returnCentroid","resultType","historicMoment","returnTrueCurves","sqlFormat","returnExceededLimitFeatures","f"],{httpMethod:"GET",params:n.a({where:"1=1",outFields:"*"},e.params)});return Object(a.a)(Object(o.a)(e.url)+"/query",t)}},329:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r(5),o=r(76);function a(e){return new Promise(function(t){if(!e.fields)return Object(o.a)({url:e.url}).then(function(r){t(e.fields=r.fields)});t(e.fields)}).then(function(t){var r=function(e){return e.reduce(function(e,t){var r=t.domain;return r&&"codedValue"===r.type&&(e[t.name]=r),e},{})}(t);if(Object.keys(r).length<1)return e.queryResponse;var o=e.queryResponse.features.map(function(e){var t={};for(var o in e.attributes)if(e.attributes.hasOwnProperty(o)){var a=e.attributes[o],s=r[o];t[o]=null!==a&&s?i(a,s):a}return n.a({},e,{attributes:t})});return n.a({},e.queryResponse,{features:o})})}function i(e,t){var r=t.codedValues.find(function(t){return e===t.code});return r?r.name:e}},347:function(e,t,r){"use strict";r.d(t,"a",function(){return o});var n=r(5);function o(e,t,r){var o=n.a({params:{}},r,e);return o.params=t.reduce(function(t,r){return(e[r]||"boolean"==typeof e[r])&&(t[r]=e[r]),t},o.params),["params","httpMethod","rawResponse","authentication","portal","fetch","maxUrlLength","headers"].reduce(function(e,t){return o[t]&&(e[t]=o[t]),e},{})}},4:function(e,r){e.exports=t},457:function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),a=r(2),i=r(4),s=r(458),u=r(459),l=r(460);function c(){return a.moduleLoader.loadModule("amcharts/amcharts.js").then(function(){r(461);return a.moduleLoader.loadModules(["amcharts/pie.js","amcharts/serial.js"])})}function d(e,t){var r;if(t.height)if(t.title){r=Math.max(t.height-28,28)}else r=t.height;return o.React.createElement(u.CedarChart,{height:r,definition:o.Immutable(e),loadDependencies:c})}var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var e=this.props.config.title;return o.React.createElement("div",{className:"widget-chart"},!!e&&o.React.createElement("div",{className:"jimu-chart-title"},e),function(e){var t=e.useDataSources,r=e.config,n=e.stateProps;if(r.definition)return d(l.applyOverrides(r.definition),r);if(!function(e,t){return void 0===t&&(t=0),e&&e.length>0&&e[t].dataSourceId}(t))return o.React.createElement(i.Alert,{color:"danger"},o.React.createElement(o.FormattedMessage,{id:"pleaseConfigureADataSource",defaultMessage:s.default.pleaseConfigureADataSource}));var a=l.buildQuery(r);return a.geometry=n&&n.queryExtent,o.React.createElement(o.DataSourceComponent,{query:a,useDataSource:t[0]},function(e){return d(l.createDefinition(r,e.getRecords()),r)})}(this.props))},t}(o.BaseWidget);t.default=f},458:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={pleaseConfigureADataSource:"Please either configure a data source or a custom chart definition (JSON)"}},459:function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),a=r(759),i=function(e){function t(t){var r=e.call(this,t)||this;r.setChartRootRef=function(e){r.chartRoot=e};var n=window.AmCharts,o=!!n&&!!n.AmSerialChart;return r.state={dependenciesLoaded:o},r}return n(t,e),t.prototype._renderChart=function(){var e=this.props.definition;this.chartRoot&&this.state.dependenciesLoaded&&e&&new a.Chart(this.chartRoot,e).show()},t.prototype.componentDidMount=function(){var e=this;if(this.state.dependenciesLoaded)this._renderChart();else{var t=this.props.loadDependencies;t&&t().then(function(){e.setState({dependenciesLoaded:!0})})}},t.prototype.componentDidUpdate=function(){this._renderChart()},t.prototype.render=function(){return o.React.createElement("div",{style:{height:this.props.height},className:"cedar-chart-root",ref:this.setChartRootRef})},t.defaultProps={height:400},t}(o.React.PureComponent);t.CedarChart=i},460:function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o={hideCredits:!0};function a(e,t){return t?e+"_"+t.toUpperCase():e}t.buildQuery=function(e){var t,r=e.valueFields,n=e.categoryField,o=e.statType,i=e.sortField,s=e.sortDirection,u={};if(o)u.groupByFieldsForStatistics=n,u.outStatistics=r.map(function(e){return t=a(e,o),{statisticType:o,onStatisticField:e,outStatisticFieldName:t}}),u.orderByFields=t&&t+" DESC";else if(i){var l="value"===i?r[0]:n;s&&(l=l+" "+s),u.orderByFields=l}return u},t.applyOverrides=function(e){var t=JSON.parse(JSON.stringify(e));return n({},t,{overrides:o})},t.createDefinition=function(e,t){var r=t.map(function(e){return e.getData()});return{type:e.chartType,datasets:[{name:"dataset0",data:r,domains:e.domains}],series:function(e,t){var r=e.valueFields,n=e.categoryField,o=e.statType,i=e.categoryLabel,s=e.valueLabels;return r.map(function(e,r){var u=a(e,o),l=s?s[r]:u;return{category:{field:n,label:i},value:{field:u,label:l},source:t}})}(e,"dataset0"),overrides:o}}},461:function(e,t){AmCharts.themes.calcite={themeName:"calcite",AmChart:{color:"#706f72",backgroundColor:"#FFFFFF"},AmCoordinateChart:{colors:["#0079c1","#e4d154","#5a9359","#de2900","#9081bc","#005e95","#338033","#d9bf2b","#a57946","#ab3c16","#7461a8"],startDuration:0,startEffect:"easeInSine"},AmStockChart:{colors:["#0079c1","#e4d154","#5a9359","#de2900","#9081bc","#005e95","#338033","#d9bf2b","#a57946","#ab3c16","#7461a8"]},AmSlicedChart:{colors:["#0079c1","#e4d154","#5a9359","#de2900","#9081bc","#005e95","#338033","#d9bf2b","#a57946","#ab3c16","#7461a8"],outlineAlpha:1,outlineThickness:2,labelTickColor:"#000000",labelTickAlpha:.3},AmRectangularChart:{zoomOutButtonColor:"#000000",zoomOutButtonRollOverAlpha:.15,zoomOutButtonImage:"lens"},AxisBase:{autoWrap:!0,autoRotateAngle:45,autoRotateCount:5,axisColor:"#000000",axisAlpha:.3,gridAlpha:0,gridColor:"#000000",tickLength:0,labelOffset:5},ChartScrollbar:{backgroundColor:"#000000",backgroundAlpha:.12,graphFillAlpha:.5,graphLineAlpha:0,selectedBackgroundColor:"#FFFFFF",selectedBackgroundAlpha:.4,gridAlpha:.15},ChartCursor:{cursorColor:"#000000",color:"#FFFFFF",cursorAlpha:0},AmLegend:{color:"#706f72"},AmGraph:{fillAlphas:.9,lineAlpha:.9},GaugeArrow:{color:"#000000",alpha:.8,nailAlpha:0,innerRadius:"40%",nailRadius:15,startWidth:15,borderAlpha:.8,nailBorderAlpha:0},GaugeAxis:{tickColor:"#000000",tickAlpha:1,tickLength:15,minorTickLength:8,axisThickness:3,axisColor:"#000000",axisAlpha:1,bandAlpha:.8},TrendLine:{lineColor:"#c03246",lineAlpha:.8},AreasSettings:{alpha:.8,color:"#67b7dc",colorSolid:"#003767",unlistedAreasAlpha:.4,unlistedAreasColor:"#000000",outlineColor:"#FFFFFF",outlineAlpha:.5,outlineThickness:.5,rollOverColor:"#3c5bdc",rollOverOutlineColor:"#FFFFFF",selectedOutlineColor:"#FFFFFF",selectedColor:"#f15135",unlistedAreasOutlineColor:"#FFFFFF",unlistedAreasOutlineAlpha:.5},LinesSettings:{color:"#000000",alpha:.8},ImagesSettings:{alpha:.8,labelColor:"#000000",color:"#000000",labelRollOverColor:"#3c5bdc"},ZoomControl:{buttonFillAlpha:.7,buttonIconColor:"#a7a7a7"},SmallMap:{mapColor:"#000000",rectangleColor:"#f15135",backgroundColor:"#FFFFFF",backgroundAlpha:.7,borderThickness:1,borderAlpha:.8},PeriodSelector:{color:"#000000"},PeriodButton:{color:"#000000",background:"transparent",opacity:.7,border:"1px solid rgba(0, 0, 0, .3)",MozBorderRadius:"5px",borderRadius:"5px",margin:"1px",outline:"none",boxSizing:"border-box"},PeriodButtonSelected:{color:"#000000",backgroundColor:"#b9cdf5",border:"1px solid rgba(0, 0, 0, .3)",MozBorderRadius:"5px",borderRadius:"5px",margin:"1px",outline:"none",opacity:1,boxSizing:"border-box"},PeriodInputField:{color:"#000000",background:"transparent",border:"1px solid rgba(0, 0, 0, .3)",outline:"none"},DataSetSelector:{color:"#000000",selectedBackgroundColor:"#b9cdf5",rollOverBackgroundColor:"#a8b0e4"},DataSetCompareList:{color:"#000000",lineHeight:"100%",boxSizing:"initial",webkitBoxSizing:"initial",border:"1px solid rgba(0, 0, 0, .3)"},DataSetSelect:{border:"1px solid rgba(0, 0, 0, .3)",outline:"none"}}},5:function(e,t,r){"use strict";r.d(t,"b",function(){return o}),r.d(t,"a",function(){return a});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return(a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)}},759:function(e,t,r){"use strict";r.r(t);var n=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===o}(e)}(e)};var o="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function a(e,t){return t&&!0===t.clone&&n(e)?s(function(e){return Array.isArray(e)?[]:{}}(e),e,t):e}function i(e,t,r){var o=e.slice();return t.forEach(function(t,i){void 0===o[i]?o[i]=a(t,r):n(t)?o[i]=s(e[i],t,r):-1===e.indexOf(t)&&o.push(a(t,r))}),o}function s(e,t,r){var o=Array.isArray(t);return o===Array.isArray(e)?o?((r||{arrayMerge:i}).arrayMerge||i)(e,t,r):function(e,t,r){var o={};return n(e)&&Object.keys(e).forEach(function(t){o[t]=a(e[t],r)}),Object.keys(t).forEach(function(i){n(t[i])&&e[i]?o[i]=s(e[i],t[i],r):o[i]=a(t[i],r)}),o}(e,t,r):a(t,r)}s.all=function(e,t){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce(function(e,r){return s(e,r,t)})};var u=s,l={bar:{type:"serial",rotate:!1,theme:"calcite",chartCursor:{categoryBalloonEnabled:!1},graphs:[{type:"column",newStack:!0}],legend:{valueAlign:"left",spacing:25},valueAxes:[{stackType:"regular"}],export:{enabled:!0}},"bar-horizontal":{type:"serial",theme:"calcite",rotate:!0,chartCursor:{leaveCursor:!0,valueLineEnabled:!0,categoryBalloonEnabled:!1},graphs:[{type:"column"}],legend:{},valueAxes:[{gridAlpha:.2,stackType:"regular"}],export:{enabled:!0}},line:{type:"serial",theme:"calcite",chartCursor:{categoryBalloonEnabled:!1,valueLineBalloonEnabled:!0},graphs:[{bullet:"circle",bulletAlpha:1,bulletBorderAlpha:.8,bulletBorderThickness:0,dashLengthField:"dashLengthLine",fillAlphas:0,useLineColorForBulletBorder:!0}],legend:{position:"bottom",useGraphSettings:!0},export:{enabled:!0}},area:{type:"serial",theme:"calcite",chartCursor:{categoryBalloonEnabled:!1,valueLineBalloonEnabled:!0},graphs:[{bullet:"circle",bulletAlpha:1,bulletBorderAlpha:.8,bulletBorderThickness:0,dashLengthField:"dashLengthLine",fillAlphas:.5,useLineColorForBulletBorder:!0}],legend:{horizontalGap:10,position:"bottom",useGraphSettings:!0,markerSize:10},valueAxes:[{stackType:"regular"}],export:{enabled:!0}},pie:{type:"pie",theme:"calcite",innerRadius:"0%",startDuration:0,graphs:[{}],groupPercent:5,balloon:{fixedPosition:!0},legend:{enabled:!1},export:{enabled:!0}},radar:{type:"radar",valueAxes:[{gridType:"circles",minimum:0}],polarScatter:{minimum:0,maximum:400,step:1},startDuration:0,graphs:[{graphFillAlpha:0}],groupPercent:5,balloon:{fixedPosition:!0},legend:{position:"right",marginRight:100,autoMargins:!1}},scatter:{type:"xy",theme:"calcite",valueAxes:[{axisAlpha:.8,gridAlpha:.2,position:"bottom"},{axisAlpha:.8,gridAlpha:.2,position:"left"}],chartScrollbar:{scrollbarHeight:5,offset:-1,backgroundAlpha:.1,backgroundColor:"#888888",selectedBackgroundColor:"#67b7dc",selectedBackgroundAlpha:1,dragIconWidth:15,dragIconHeight:15},chartCursor:{categoryBalloonEnabled:!0,cursorAlpha:.3,valueLineAlpha:.3,valueLineBalloonEnabled:!0},graphs:[{fillAlphas:0,lineAlpha:0,bullet:"circle",bulletBorderAlpha:.2,bulletAlpha:.8,valueField:null,xField:null,yField:null}],export:{enabled:!0}},timeline:{type:"serial",theme:"calcite",chartCursor:{categoryBalloonEnabled:!1,valueLineBalloonEnabled:!0},graphs:[{bullet:"circle",bulletAlpha:1,bulletBorderAlpha:.8,bulletBorderThickness:0,dashLengthField:"dashLengthLine",fillAlphas:0,useLineColorForBulletBorder:!0}],legend:{position:"bottom",useGraphSettings:!0},categoryAxis:{parseDates:!0},export:{enabled:!0}}};function c(e,t){var r=e.graphs.pop(),n=t.datasets.length>1;if(e.categoryField=n?"categoryField":t.series[0].category.field,e.tabIndex=0,e.legend||(e.legend={}),t.legend&&t.legend.hasOwnProperty("enable")&&(t.legend.visible=t.legend.enable),1===t.series.length&&"pie"!==t.type&&"radar"!==t.type){e.legend.enabled=!1;var o=t.series[0].category.label,a=t.series[0].value.label;"xy"===e.type&&Array.isArray(e.valueAxes)?e.valueAxes.forEach(function(e){"bottom"===e.position?e.title=o:"left"===e.position&&(e.title=a)}):(e.valueAxes||(e.valueAxes=[{}]),e.valueAxes[0].title=t.series[0].value.label,e.valueAxes[0].position="left",e.categoryAxis||(e.categoryAxis={}),e.categoryAxis.title=o)}if(t.legend){var i=t.legend;i.hasOwnProperty("visible")&&(e.legend.enabled=i.visible,e.legend.tabIndex=0),i.position&&["top","bottom","left","right"].indexOf(i.position)>-1&&(e.legend.position=i.position)}if(t.style){var s=t.style;if(s.padding){var u=s.padding;e.autoMargins=!1,u.hasOwnProperty("top")&&(e.marginTop=u.top),u.hasOwnProperty("bottom")&&(e.marginBottom=u.bottom),u.hasOwnProperty("left")&&(e.marginLeft=u.left),u.hasOwnProperty("right")&&(e.marginRight=u.right)}if(s.pie){var l=s.pie;l.hasOwnProperty("innerRadius")&&(e.innerRadius=l.innerRadius),l.hasOwnProperty("expand")&&(e.pullOutRadius=l.expand)}s.colors&&Array.isArray(s.colors)&&(e.colors=s.colors)}return t.datasets.forEach(function(o,a){var i=o.name;t.series.forEach(function(a,s){if(o.name===a.source){var u=f(r);u.title=a.value.label,u.valueField=n?i+"_"+a.value.field:a.value.field,u.balloonText="<div>"+a.category.label+": [["+e.categoryField+"]]</div><div>"+u.title+": [["+u.valueField+"]]</div>",a.stack&&u.newStack&&(u.newStack=!1),"pie"===t.type&&(e.titleField=e.categoryField,e.valueField=u.valueField),"xy"===e.type&&a.category&&a.value&&(u.xField=a.category.field,u.yField=a.value.field,u.balloonText="<div>"+a.category.label+": [["+a.category.field+"]]</div><div>"+a.value.label+": [["+a.value.field+"]]</div>","xy"===e.type&&a.size?(u.valueField=a.size.field,u.balloonText=u.balloonText+"<div>"+a.size.label+": [["+u.valueField+"]]</div>"):delete u.valueField),e.graphs.push(u)}})}),e}function d(e){var t=e;return"time"===t?(console.warn("'time' is no longer a supported type. Please use 'timeline' instead"),t="timeline"):"bubble"===t?(console.warn("'bubble' is no longer a supported type. Please use 'scatter' instead"),t="scatter"):"grouped"===t&&(console.warn("'grouped' is no longer a supported type. Please use 'bar' instead"),t="bar"),f(l[t])}function f(e){return JSON.parse(JSON.stringify(e))}var p={renderChart:function(e,t,r){if("custom"===t.type)return AmCharts.makeChart(e,t.specification);var n=t.specification&&"string"!=typeof t.specification?f(t.specification):d(t.type),o=f(r);n.dataProvider=o,t.datasets&&(n=c(n,t)),t.overrides&&(n=u(n,t.overrides,{clone:!0}));var a=AmCharts.makeChart(e,n);return"pie"===t.type&&(a.balloonText=function(e){var t=e.series[0].category.label?e.series[0].category.label+": ":"",r=e.series[0].value.label?e.series[0].value.label+": ":"";return"<div>"+t+"[[title]]</div><div>"+r+"[[percents]]% ([[value]])</div>"}(t)),a},fillInSpec:c,fetchSpec:d};function h(e,t,r){if((!e||!t||!r)&&t.type&&"custom"!==t.type)throw new Error("Element Id, definition, and data are all required.");return t.type&&"custom"===t.type?p.renderChart(e,t):p.renderChart(e,t,r)}function b(e){return e.features?e.features:e}function y(e){return e.attributes?e.attributes:e}function g(e,t,r){var n=e.name||r;return e.data||t[n]}function m(e,t){if(e){if(e.length<1)return[];var r=t&&t.datasetsData;return e.length>1?function(e,t,r){var n=e.reduce(function(e,n,o){var a=n.join,i=g(n,r),s=n.name,u=function(e,t){return t.reduce(function(t,r){return r.source===e&&r.value&&t.push(r.value.field),t},[])}(s,t);return b(i).forEach(function(t){var r=y(t),n=r[a];void 0===e[n]&&(e[n]={categoryField:n}),u.reduce(function(e,t){return e[function(e,t){return e+"_"+t}(s,t)]=r[t],e},e[n])}),e},{});return Object.keys(n).map(function(e){return n[e]})}(e,t&&t.series,r):function(e){var t=b(e);return t.length>0&&t[0].attributes?t.map(y):t}(g(e[0],r,"dataset0"))}}var v=r(328),A=r(329),O={fetch:void 0};function F(e){var t=[],r=[];return e&&e.forEach(function(e,n){if(e.url){t.push(e.name||"dataset"+n);var o=function(e){void 0===e&&(e={});var t={where:"1=1",returnGeometry:!1,returnDistinctValues:!1,returnIdsOnly:!1,returnCountOnly:!1,outFields:"*",sqlFormat:"standard",f:"json"};if(e.bbox){if(e.geometry)throw new Error("Dataset.query can not have both a geometry and a bbox specified");var r=e.bbox.split(",");delete e.bbox,e.geometry=JSON.stringify({xmin:Number(r[0]),ymin:Number(r[1]),xmax:Number(r[2]),ymax:Number(r[3])}),e.inSR="4326"}return Object.keys(e).reduce(function(r,n){var o=e[n];return t[n]="object"==typeof o?JSON.stringify(o):o,r},t),t}(e.query),a={url:e.url,params:o};O.fetch&&"function"==typeof O.fetch&&(a.fetch=O.fetch),r.push(Object(v.b)(a).then(function(t){var r=e.domains,n=r&&Object.keys(r).map(function(e){return{name:e,domain:r[e]}});if(n&&n.length>0){var o={url:a.url,queryResponse:t,fields:n,fetch:O.fetch};return Object(A.a)(o)}return t}))}}),Promise.all(r).then(function(e){var r=e.reduce(function(e,r,n){return e[t[n]]=r,e},{});return Promise.resolve(r)})}var x=function(){function e(e,t){if(!e)throw new Error("A container is required");this._container=e,t&&this.definition(function(e){return JSON.parse(JSON.stringify(e))}(t))}return e.prototype.definition=function(e){return void 0===e?this._definition:(this._definition=e,this)},e.prototype.datasets=function(e){return this._definitionAccessor("datasets",e)},e.prototype.series=function(e){return this._definitionAccessor("series",e)},e.prototype.type=function(e){return this._definitionAccessor("type",e)},e.prototype.specification=function(e){return this._definitionAccessor("specification",e)},e.prototype.overrides=function(e){return this._definitionAccessor("overrides",e)},e.prototype.legend=function(e){return this._definitionAccessor("legend",e)},e.prototype.style=function(e){return this._definitionAccessor("style",e)},e.prototype.data=function(){return this._data},e.prototype.dataset=function(e){var t,r=this.datasets();return r&&r.some(function(r){if(r.name===e)return t=r,!0}),t},e.prototype.query=function(){return F(this.datasets())},e.prototype.updateData=function(e){var t=this.datasets(),r={datasetsData:e,series:this.series()};return this._data=m(t,r),this},e.prototype.render=function(){return h(this._container,this.definition(),this.data()),this},e.prototype.show=function(){var e=this;return this.query().then(function(t){return e.updateData(t).render()})},e.prototype._definitionAccessor=function(e,t){var r=this._definition;if(void 0===t)return r?r[e]:void 0;if(r)return r[e]=t,this;var n={};return n[e]=t,this.definition(n)},e}();r.d(t,"Chart",function(){return x})},76:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r(297),o=r(296);function a(e){return Object(n.a)(Object(o.a)(e.url),e)}}})});
//# sourceMappingURL=widget.js.map