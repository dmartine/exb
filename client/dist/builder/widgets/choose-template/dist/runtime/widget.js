define(["jimu-core","jimu-core/react","jimu-ui","jimu-for-builder","builder/common"],function(e,n,t,i,r){return function(e){var n={};function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(i,r,function(n){return e[n]}.bind(null,r));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=80)}({0:function(n,t){n.exports=e},1:function(e,t){e.exports=n},10:function(e,n){e.exports=r},2:function(e,n){e.exports=t},26:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={_widgetLabel:"Create New",untitledExperience:"Untitled experience",telplateListTitle:"Templates",searchPlaceholder:"Search",create:"Create"}},3:function(e,n){e.exports=i},7:function(e,n,t){function i(){return(i=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)}var r=t(1),o=r.createElement("path",{d:"M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16zm0 2C4.477 20 0 15.523 0 10S4.477 0 10 0s10 4.477 10 10-4.477 10-10 10zm8.282-1.718a.961.961 0 0 1 1.359 0l4.077 4.077a.961.961 0 0 1-1.359 1.36l-4.077-4.078a.961.961 0 0 1 0-1.36z",fill:"currentColor",fillRule:"nonzero"});function s(e){return r.createElement("svg",i({width:24,height:24,viewBox:"0 0 24 24"},e),o)}e.exports=s,s.default=s},80:function(e,n,t){"use strict";var i=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function i(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),r=this&&this.__makeTemplateObject||function(e,n){return Object.defineProperty?Object.defineProperty(e,"raw",{value:n}):e.raw=n,e};Object.defineProperty(n,"__esModule",{value:!0});var o,s=t(0),a=t(3),l=t(10),c=t(81),p=t(2),u=t(26),d=t(7),h=t(83),f=function(e){function n(n){var t=e.call(this,n)||this;return t.nls=function(e){return t.props.intl?t.props.intl.formatMessage({id:e,defaultMessage:u.default[e]}):e},t.createApp=function(e){t.setState({loading:!0});var n=t.nls("untitledExperience");t.getNewAppTitleWithIndex(n).then(function(n){l.appServices.createApp({template:e,name:n,description:""}).then(function(e){t.setState({loading:!1}),t.props.dispatch(a.builderActions.refreshAppListAction(!0)),s.jimuHistory.browserHistory.push(s.urlUtils.getFixedRootPath()+"builder?id="+e.id)},function(e){t.setState({loading:!1}),console.error(e)})}).catch(function(e){t.setState({loading:!1}),console.error(e)})},t.getNewAppTitleWithIndex=function(e){var n=s.SessionManager.getInstance().getSession(),t=null;return l.appServices.searchApp({q:'type: "Web Experience" AND owner:'+n.username+' AND  title:"'+e+'"',sortField:"title",sortOrder:"desc"}).then(function(n){if(n&&n.length>0){for(var i=[],r=0;r<n.length;r++){if(n[r].title===e){t=e+"-1";break}var o=n[r].title.split("-");if(2===o.length){var s=Number(o[o.length-1]);isNaN(s)||i.push(s)}}return i.length>0&&(i.sort(function(e,n){return e<n?1:-1}),t=e+"-"+(i[0]+1)),t||(t=e),Promise.resolve(t)}return t=e,Promise.resolve(t)}).catch(function(e){return console.error(e),Promise.reject(e)})},t.onCreateClick=function(e){t.selectTemplate(e),t.createApp(e)},t.selectTemplate=function(e){t.props.dispatch(a.builderActions.selectTemplate(e))},t._matchearchText=function(e){var n=t.state.searchText;return!n||!e||e.toLowerCase().indexOf(n.toLowerCase())>-1},t.getStyle=function(){var e=t.props.theme,n=e?e.colors.grays.gray500:"",i=e?e.colors.secondary:"";return s.css(o||(o=r(["\n      height: 100%;\n      .header-bar {\n        width: 100%;\n        height: ",";\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        padding: 0 ",";\n        font-size: 24px;\n        border-bottom: 1px solid ",";\n        .jimu-icon {\n          cursor: pointer;\n        }\n      }\n      .homescreen {\n        height: calc(100% - 80px);\n        width:810px;\n        margin: 0 auto;\n      }\n      @media only screen and (min-width: 1280px) {\n        .homescreen {\n          width:1090px;\n        }\n      }\n      @media only screen and (min-width: 1400px) {\n        .homescreen {\n            width:1360px;\n        }\n      }\n      @media only screen and (min-width: 1680px) {\n        .homescreen {\n            width:1630px;\n        }\n      }\n\n      .header {\n        width: 100%;\n        padding: "," "," "," ",";\n\n        > .banner {\n          position: relative;\n  \n          .jimu-icon {\n              color: ",";\n              position: absolute;\n              left:",";\n              top: ",";\n              cursor: pointer;\n          }\n  \n          .searchbox {\n              padding-left:",";\n              font-size:",";\n              height: 3.8rem;\n              cursor: text;\n          }\n        }\n\n        .template-title {\n          margin-top: ",";\n          font-size: ",";\n        }\n      }\n      .section {\n        display: flex;\n        flex-wrap: wrap;\n        height: calc(100% - 200px);\n        overflow-x: hidden;\n        overflow-y: auto;\n        align-content: flex-start;\n      }\n    "],["\n      height: 100%;\n      .header-bar {\n        width: 100%;\n        height: ",";\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        padding: 0 ",";\n        font-size: 24px;\n        border-bottom: 1px solid ",";\n        .jimu-icon {\n          cursor: pointer;\n        }\n      }\n      .homescreen {\n        height: calc(100% - 80px);\n        width:810px;\n        margin: 0 auto;\n      }\n      @media only screen and (min-width: 1280px) {\n        .homescreen {\n          width:1090px;\n        }\n      }\n      @media only screen and (min-width: 1400px) {\n        .homescreen {\n            width:1360px;\n        }\n      }\n      @media only screen and (min-width: 1680px) {\n        .homescreen {\n            width:1630px;\n        }\n      }\n\n      .header {\n        width: 100%;\n        padding: "," "," "," ",";\n\n        > .banner {\n          position: relative;\n  \n          .jimu-icon {\n              color: ",";\n              position: absolute;\n              left:",";\n              top: ",";\n              cursor: pointer;\n          }\n  \n          .searchbox {\n              padding-left:",";\n              font-size:",";\n              height: 3.8rem;\n              cursor: text;\n          }\n        }\n\n        .template-title {\n          margin-top: ",";\n          font-size: ",";\n        }\n      }\n      .section {\n        display: flex;\n        flex-wrap: wrap;\n        height: calc(100% - 200px);\n        overflow-x: hidden;\n        overflow-y: auto;\n        align-content: flex-start;\n      }\n    "])),s.polished.rem(80),s.polished.rem(30),i,s.polished.rem(40),s.polished.rem(16),s.polished.rem(20),s.polished.rem(16),n,s.polished.rem(20),s.polished.rem(18),s.polished.rem(64),s.polished.rem(24),s.polished.rem(40),s.polished.rem(16))},t.close=function(){s.jimuHistory.browserHistory.length>2?s.jimuHistory.browserHistory.goBack():window.location.href=s.urlUtils.getFixedRootPath()},t.isTemplateDisabled=function(e){return!1},t.state={loading:!1,searchText:""},t}return i(n,e),n.getListInfo=function(){return fetch(s.urlUtils.getAbsoluteRootUrl()+"templates/templates-info.json").then(function(e){return e.json()}).then(function(e){return{templates:e=e.map(function(e){return{name:e.name,title:e.label,image:{src:"../"+e.thumbnail},description:e.description}})}})},n.prototype.render=function(){var e=this,n=this.state.searchText,t=this.props,i=t.templates,r=t.theme,o=t.intl;return s.jsx("div",{css:this.getStyle(),className:"widget-choose-template bg-gray-100"},s.jsx("div",{className:"header-bar"},this.nls("_widgetLabel"),s.jsx("div",{onClick:this.close},s.jsx(p.Icon,{size:24,icon:h}))),s.jsx("div",{className:"homescreen"},s.jsx("div",{className:"header"},s.jsx("div",{className:"banner d-flex"},s.jsx(p.Icon,{size:24,icon:d}),s.jsx(p.Input,{className:"pt-2 pb-2 searchbox",placeholder:this.nls("searchPlaceholder"),value:n,onChange:function(n){e.setState({searchText:n.target.value})}})),s.jsx("div",{className:"template-title"},this.nls("telplateListTitle"))),s.jsx("div",{className:"section"},i&&i.map(function(n,t){return s.jsx(c.default,{key:t,theme:r,show:e._matchearchText(n.title),info:n,intl:o,disabled:e.isTemplateDisabled(n),onCreateClick:e.onCreateClick})})),this.state.loading&&s.jsx("div",{style:{position:"absolute",left:"50%",top:"50%"},className:"jimu-primary-loading"})))},n.preloadData=function(e,t){return n.getListInfo()},n}(s.BaseWidget);n.default=f},81:function(e,n,t){"use strict";var i=this&&this.__extends||function(){var e=function(n,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(n,t)};return function(n,t){function i(){this.constructor=n}e(n,t),n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),r=this&&this.__makeTemplateObject||function(e,n){return Object.defineProperty?Object.defineProperty(e,"raw",{value:n}):e.raw=n,e},o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var n,t=1,i=arguments.length;t<i;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0});var s,a=t(0),l=t(2),c=t(26),p=t(82),u=function(e){function n(n){var t=e.call(this,n)||this;return t.onCreateClick=function(){var e=t.props.info.name;t.props.onCreateClick(e)},t.nls=function(e){return t.props.intl?t.props.intl.formatMessage({id:e,defaultMessage:c.default[e]}):e},t.getStyle=function(){var e=t.props.theme,n=e?e.colors.grays.gray600:"",i=e?e.colors.grays.gray800:"",l=e?e.colors.white:"";return a.css(s||(s=r(["\n      width: ",";\n      height: ",";\n      margin: 0 ","  ","  ",";\n      display: flex;\n      flex-direction: column;\n      .image-container {\n        position: relative;\n        height: ",";\n        width: ",";\n        > img {\n          width: 100%;\n          max-width: 100%;\n          max-height: 100%;\n        }\n        flex-shrink: 0;\n        flex-grow: 0;\n        .description {\n          user-select: text;\n          cursor: text;\n          position: absolute;\n          padding: ",";\n          left: 0;\n          top: 0;\n          width: 100%;\n          height: 100%;\n          background: ",";\n          opacity: 0.8;\n          color: ",";\n          font-size: 13px;\n          .content {\n            overflow: hidden;\n            width: 100%;\n            height: 100%;\n          }\n        }\n      }\n      .info{\n        padding: ",";\n        flex-shrink: 1;\n        flex-grow: 1;\n        display: flex;\n        flex-direction: column;\n        justify-content: space-between;\n        .title {\n          ","\n          font-size: ",";\n        }\n      }\n      .buttons {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        .icon-btn:first-of-type {\n          margin-left: -4px;\n        }\n      }\n      &.disabled {\n        > img {\n          opacity: 0.6;\n        }\n        .jimu-icon {\n          color: ",";\n          cursor: default;\n        }\n        .info{\n          .title {\n            color: ",";\n          }\n        }\n      }\n    "],["\n      width: ",";\n      height: ",";\n      margin: 0 ","  ","  ",";\n      display: flex;\n      flex-direction: column;\n      .image-container {\n        position: relative;\n        height: ",";\n        width: ",";\n        > img {\n          width: 100%;\n          max-width: 100%;\n          max-height: 100%;\n        }\n        flex-shrink: 0;\n        flex-grow: 0;\n        .description {\n          user-select: text;\n          cursor: text;\n          position: absolute;\n          padding: ",";\n          left: 0;\n          top: 0;\n          width: 100%;\n          height: 100%;\n          background: ",";\n          opacity: 0.8;\n          color: ",";\n          font-size: 13px;\n          .content {\n            overflow: hidden;\n            width: 100%;\n            height: 100%;\n          }\n        }\n      }\n      .info{\n        padding: ",";\n        flex-shrink: 1;\n        flex-grow: 1;\n        display: flex;\n        flex-direction: column;\n        justify-content: space-between;\n        .title {\n          ","\n          font-size: ",";\n        }\n      }\n      .buttons {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        .icon-btn:first-of-type {\n          margin-left: -4px;\n        }\n      }\n      &.disabled {\n        > img {\n          opacity: 0.6;\n        }\n        .jimu-icon {\n          color: ",";\n          cursor: default;\n        }\n        .info{\n          .title {\n            color: ",";\n          }\n        }\n      }\n    "])),a.polished.rem(238),a.polished.rem(260),a.polished.rem(16),a.polished.rem(30),a.polished.rem(16),a.polished.rem(160),a.polished.rem(238),a.polished.rem(16),l,i,a.polished.rem(16),o({},a.polished.ellipsis()),a.polished.rem(16),n,e.colors.grays.gray700)},t.showDesc=function(){t.setState({showDesc:!0})},t.hideDesc=function(){t.setState({showDesc:!1})},t.state={showDesc:!1},t}return i(n,e),n.prototype.render=function(){var e=this.props,n=e.show,t=e.disabled,i=e.style;if(!n)return null;var r=this.props.info,o=r.title,s=r.image,c=r.description,u=r.name,d=this.state.showDesc,h=window.location.origin+"/stemapp/?config=/templates/"+u+"/config.json";return a.jsx("div",{css:this.getStyle(),className:a.classNames("template bg-secondary",{disabled:t}),style:i},a.jsx("div",{className:"image-container",onMouseEnter:this.showDesc,onMouseLeave:this.hideDesc},a.jsx(l.Image,{src:s.src,alt:o}),d&&a.jsx("div",{className:"description"},a.jsx("div",{className:"content"},c))),a.jsx("div",{className:"info"},a.jsx("div",{className:"title"},o),a.jsx("div",{className:"buttons"},a.jsx(l.Button,{size:"sm",text:!0,icon:!0,color:"dark",href:h,target:"_blank"},a.jsx(l.Icon,{size:"16",icon:p})," "),a.jsx(l.Button,{disabled:t,className:"action-button",color:"primary",onClick:this.onCreateClick},this.nls("create")," "))))},n.defaultProps={disabled:!1},n}(a.React.PureComponent);n.default=u},82:function(e,n,t){function i(){return(i=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)}var r=t(1),o=r.createElement("path",{d:"M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H2zm0-1h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm4.5 5.05v5.9L10.503 8 6.5 5.05zm4.6 3.752l-4.09 3.014a.937.937 0 0 1-1.332-.229 1.008 1.008 0 0 1-.178-.573V4.986c0-.545.428-.986.955-.986.2 0 .394.064.556.184L11.1 7.198a1.006 1.006 0 0 1 0 1.604z",fill:"currentColor",fillRule:"nonzero"});function s(e){return r.createElement("svg",i({width:16,height:16,viewBox:"0 0 16 16"},e),o)}e.exports=s,s.default=s},83:function(e,n,t){function i(){return(i=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)}var r=t(1),o=r.createElement("path",{d:"M13.462 12l10.235 10.235a1.034 1.034 0 1 1-1.462 1.462L12 13.462 1.765 23.697a1.034 1.034 0 1 1-1.462-1.462L10.538 12 .303 1.765A1.034 1.034 0 1 1 1.765.303L12 10.538 22.235.303a1.034 1.034 0 1 1 1.462 1.462L13.462 12z",fill:"currentColor",fillRule:"nonzero"});function s(e){return r.createElement("svg",i({width:24,height:24,viewBox:"0 0 24 24"},e),o)}e.exports=s,s.default=s}})});
//# sourceMappingURL=widget.js.map