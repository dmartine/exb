System.register(["jimu-core"], function(__WEBPACK_DYNAMIC_EXPORT__) {
	var __WEBPACK_EXTERNAL_MODULE_jimu_core__;
	return {
		setters: [
			function(module) {
				__WEBPACK_EXTERNAL_MODULE_jimu_core__ = module;
			}
		],
		execute: function() {
			__WEBPACK_DYNAMIC_EXPORT__(
/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./jimu-arcgis/index.tsx");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./jimu-arcgis/index.tsx":
/*!*******************************!*\
  !*** ./jimu-arcgis/index.tsx ***!
  \*******************************/
/*! exports provided: JimuLayerView, JimuFeatureLayerView, JimuMapView, JimuMapViewGroup, MapViewManager, DataSourceTypes, LayerTypes, FeatureLayerDataSource, FeatureDataRecord, ArcGISDataSourceTypes, ArcGISDependencyDefineExtension, ArcGISDataSourceFactoryUriExtension, loadArcGISJSAPIModules, JimuMapViewComponent, JimuLayerViewComponent, init, geometryUtils, zoomToUtils, portalUtils, defaultMessages */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _lib_utils_geometry_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./lib/utils/geometry-utils */ \"./jimu-arcgis/lib/utils/geometry-utils.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"geometryUtils\", function() { return _lib_utils_geometry_utils__WEBPACK_IMPORTED_MODULE_0__; });\n/* harmony import */ var _lib_utils_zoomto_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./lib/utils/zoomto-utils */ \"./jimu-arcgis/lib/utils/zoomto-utils.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"zoomToUtils\", function() { return _lib_utils_zoomto_utils__WEBPACK_IMPORTED_MODULE_1__; });\n/* harmony import */ var _lib_utils_portal_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./lib/utils/portal-utils */ \"./jimu-arcgis/lib/utils/portal-utils.ts\");\n/* harmony reexport (module object) */ __webpack_require__.d(__webpack_exports__, \"portalUtils\", function() { return _lib_utils_portal_utils__WEBPACK_IMPORTED_MODULE_2__; });\n/* harmony import */ var _lib_translations_default__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./lib/translations/default */ \"./jimu-arcgis/lib/translations/default.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"defaultMessages\", function() { return _lib_translations_default__WEBPACK_IMPORTED_MODULE_3__[\"default\"]; });\n\n/* harmony import */ var _lib_views__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./lib/views */ \"./jimu-arcgis/lib/views/index.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"JimuLayerView\", function() { return _lib_views__WEBPACK_IMPORTED_MODULE_4__[\"JimuLayerView\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"JimuFeatureLayerView\", function() { return _lib_views__WEBPACK_IMPORTED_MODULE_4__[\"JimuFeatureLayerView\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"JimuMapView\", function() { return _lib_views__WEBPACK_IMPORTED_MODULE_4__[\"JimuMapView\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"JimuMapViewGroup\", function() { return _lib_views__WEBPACK_IMPORTED_MODULE_4__[\"JimuMapViewGroup\"]; });\n\n/* harmony import */ var _lib_mapview_manager__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./lib/mapview-manager */ \"./jimu-arcgis/lib/mapview-manager.tsx\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"MapViewManager\", function() { return _lib_mapview_manager__WEBPACK_IMPORTED_MODULE_5__[\"MapViewManager\"]; });\n\n/* harmony import */ var _lib_data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./lib/data-sources/arcgis-data-source-interface */ \"./jimu-arcgis/lib/data-sources/arcgis-data-source-interface.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DataSourceTypes\", function() { return _lib_data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_6__[\"DataSourceTypes\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"LayerTypes\", function() { return _lib_data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_6__[\"LayerTypes\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"FeatureLayerDataSource\", function() { return _lib_data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_6__[\"FeatureLayerDataSource\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"FeatureDataRecord\", function() { return _lib_data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_6__[\"FeatureDataRecord\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ArcGISDataSourceTypes\", function() { return _lib_data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_6__[\"ArcGISDataSourceTypes\"]; });\n\n/* harmony import */ var _lib_extensions_dependency_extension__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./lib/extensions/dependency-extension */ \"./jimu-arcgis/lib/extensions/dependency-extension.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ArcGISDependencyDefineExtension\", function() { return _lib_extensions_dependency_extension__WEBPACK_IMPORTED_MODULE_7__[\"ArcGISDependencyDefineExtension\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"ArcGISDataSourceFactoryUriExtension\", function() { return _lib_extensions_dependency_extension__WEBPACK_IMPORTED_MODULE_7__[\"ArcGISDataSourceFactoryUriExtension\"]; });\n\n/* harmony import */ var _lib_arcgis_js_api_module_loader__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./lib/arcgis-js-api-module-loader */ \"./jimu-arcgis/lib/arcgis-js-api-module-loader.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"loadArcGISJSAPIModules\", function() { return _lib_arcgis_js_api_module_loader__WEBPACK_IMPORTED_MODULE_8__[\"loadArcGISJSAPIModules\"]; });\n\n/* harmony import */ var _lib_components_jimu_map_view_component__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./lib/components/jimu-map-view-component */ \"./jimu-arcgis/lib/components/jimu-map-view-component.tsx\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"JimuMapViewComponent\", function() { return _lib_components_jimu_map_view_component__WEBPACK_IMPORTED_MODULE_9__[\"JimuMapViewComponent\"]; });\n\n/* harmony import */ var _lib_components_jimu_layer_view_component__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./lib/components/jimu-layer-view-component */ \"./jimu-arcgis/lib/components/jimu-layer-view-component.tsx\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"JimuLayerViewComponent\", function() { return _lib_components_jimu_layer_view_component__WEBPACK_IMPORTED_MODULE_10__[\"JimuLayerViewComponent\"]; });\n\n/* harmony import */ var _lib_init__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./lib/init */ \"./jimu-arcgis/lib/init.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"init\", function() { return _lib_init__WEBPACK_IMPORTED_MODULE_11__[\"init\"]; });\n\n// To avoid cases where the server is enabled for CORS but the application accessing this resource is not aware of this\n// more info: https://developers.arcgis.com/javascript/latest/guide/cors/index.html - Example: CORS is supported\n// esriConfig.request.corsEnabledServers && esriConfig.request.corsEnabledServers.push(window.jimuConfig.arcgisJsApiUrl);\n// if(window.env === 'development'){\n//   esriConfig.workers.loaderUrl = '../jimu-core/dojo.js.uncompressed.js';\n// }else{\n//   esriConfig.workers.loaderUrl = '../jimu-core/dojo.js'\n// }\n// esriConfig.workers.loaderConfig = window.dojoConfig;\n\n\n\n\n\n\n\n\n\n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9pbmRleC50c3guanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qaW11LWFyY2dpcy9pbmRleC50c3g/NjUwMCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUbyBhdm9pZCBjYXNlcyB3aGVyZSB0aGUgc2VydmVyIGlzIGVuYWJsZWQgZm9yIENPUlMgYnV0IHRoZSBhcHBsaWNhdGlvbiBhY2Nlc3NpbmcgdGhpcyByZXNvdXJjZSBpcyBub3QgYXdhcmUgb2YgdGhpc1xuLy8gbW9yZSBpbmZvOiBodHRwczovL2RldmVsb3BlcnMuYXJjZ2lzLmNvbS9qYXZhc2NyaXB0L2xhdGVzdC9ndWlkZS9jb3JzL2luZGV4Lmh0bWwgLSBFeGFtcGxlOiBDT1JTIGlzIHN1cHBvcnRlZFxuLy8gZXNyaUNvbmZpZy5yZXF1ZXN0LmNvcnNFbmFibGVkU2VydmVycyAmJiBlc3JpQ29uZmlnLnJlcXVlc3QuY29yc0VuYWJsZWRTZXJ2ZXJzLnB1c2god2luZG93LmppbXVDb25maWcuYXJjZ2lzSnNBcGlVcmwpO1xuXG4vLyBpZih3aW5kb3cuZW52ID09PSAnZGV2ZWxvcG1lbnQnKXtcbi8vICAgZXNyaUNvbmZpZy53b3JrZXJzLmxvYWRlclVybCA9ICcuLi9qaW11LWNvcmUvZG9qby5qcy51bmNvbXByZXNzZWQuanMnO1xuLy8gfWVsc2V7XG4vLyAgIGVzcmlDb25maWcud29ya2Vycy5sb2FkZXJVcmwgPSAnLi4vamltdS1jb3JlL2Rvam8uanMnXG4vLyB9XG5cbi8vIGVzcmlDb25maWcud29ya2Vycy5sb2FkZXJDb25maWcgPSB3aW5kb3cuZG9qb0NvbmZpZztcbmltcG9ydCAqIGFzIGdlb21ldHJ5VXRpbHMgZnJvbSAnLi9saWIvdXRpbHMvZ2VvbWV0cnktdXRpbHMnO1xuaW1wb3J0ICogYXMgem9vbVRvVXRpbHMgZnJvbSAnLi9saWIvdXRpbHMvem9vbXRvLXV0aWxzJztcbmltcG9ydCAqIGFzIHBvcnRhbFV0aWxzIGZyb20gJy4vbGliL3V0aWxzL3BvcnRhbC11dGlscyc7XG5pbXBvcnQgZGVmYXVsdE1lc3NhZ2VzIGZyb20gJy4vbGliL3RyYW5zbGF0aW9ucy9kZWZhdWx0JztcbmV4cG9ydCAqIGZyb20gJy4vbGliL3ZpZXdzJztcbmV4cG9ydCAqIGZyb20gJy4vbGliL21hcHZpZXctbWFuYWdlcic7XG5cbmV4cG9ydCAqIGZyb20gJy4vbGliL2RhdGEtc291cmNlcy9hcmNnaXMtZGF0YS1zb3VyY2UtaW50ZXJmYWNlJztcbmV4cG9ydCAqIGZyb20gJy4vbGliL2V4dGVuc2lvbnMvZGVwZW5kZW5jeS1leHRlbnNpb24nO1xuXG5leHBvcnQgKiBmcm9tICcuL2xpYi9hcmNnaXMtanMtYXBpLW1vZHVsZS1sb2FkZXInO1xuZXhwb3J0IHtKaW11TWFwVmlld0NvbXBvbmVudH0gZnJvbSAnLi9saWIvY29tcG9uZW50cy9qaW11LW1hcC12aWV3LWNvbXBvbmVudCc7XG5leHBvcnQgdHlwZSB7SU1KaW11TGF5ZXJWaWV3SW5mb30gZnJvbSAnLi9saWIvY29tcG9uZW50cy9qaW11LWxheWVyLXZpZXctY29tcG9uZW50JztcbmV4cG9ydCB7SmltdUxheWVyVmlld0NvbXBvbmVudH0gZnJvbSAnLi9saWIvY29tcG9uZW50cy9qaW11LWxheWVyLXZpZXctY29tcG9uZW50JztcbmV4cG9ydCB7aW5pdH0gZnJvbSAnLi9saWIvaW5pdCc7XG5leHBvcnQge2dlb21ldHJ5VXRpbHMsIHpvb21Ub1V0aWxzLCBwb3J0YWxVdGlscywgZGVmYXVsdE1lc3NhZ2VzfTsiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./jimu-arcgis/index.tsx\n");

/***/ }),

/***/ "./jimu-arcgis/lib/arcgis-js-api-module-loader.ts":
/*!********************************************************!*\
  !*** ./jimu-arcgis/lib/arcgis-js-api-module-loader.ts ***!
  \********************************************************/
/*! exports provided: loadArcGISJSAPIModules */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"loadArcGISJSAPIModules\", function() { return loadArcGISJSAPIModules; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n\nfunction loadArcGISJSAPIModules(modules) {\n    return Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"loadArcGISJSAPIModules\"])(modules);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9saWIvYXJjZ2lzLWpzLWFwaS1tb2R1bGUtbG9hZGVyLnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vamltdS1hcmNnaXMvbGliL2FyY2dpcy1qcy1hcGktbW9kdWxlLWxvYWRlci50cz84ZDFhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGxvYWRBcmNHSVNKU0FQSU1vZHVsZXMgYXMgamltdUNvcmVMb2FkQXJjR0lTSlNBUElNb2R1bGVzIH0gZnJvbSAnamltdS1jb3JlJztcblxuZXhwb3J0IGZ1bmN0aW9uIGxvYWRBcmNHSVNKU0FQSU1vZHVsZXMobW9kdWxlczogc3RyaW5nW10pOiBQcm9taXNlPGFueVtdPntcbiAgcmV0dXJuIGppbXVDb3JlTG9hZEFyY0dJU0pTQVBJTW9kdWxlcyhtb2R1bGVzKTtcbn1cbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./jimu-arcgis/lib/arcgis-js-api-module-loader.ts\n");

/***/ }),

/***/ "./jimu-arcgis/lib/components/jimu-layer-view-component.tsx":
/*!******************************************************************!*\
  !*** ./jimu-arcgis/lib/components/jimu-layer-view-component.tsx ***!
  \******************************************************************/
/*! exports provided: JimuLayerViewComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"JimuLayerViewComponent\", function() { return JimuLayerViewComponent; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _mapview_manager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../mapview-manager */ \"./jimu-arcgis/lib/mapview-manager.tsx\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/** @jsx jsx */\n\n\nvar _JimuLayerViewComponent = /** @class */ (function (_super) {\n    __extends(_JimuLayerViewComponent, _super);\n    function _JimuLayerViewComponent(props) {\n        var _this = _super.call(this, props) || this;\n        _this.getJimuMapViewIdsFromUseMapWidgetIds = function (useMapWidgetIds, infos, rootDatasourceId) {\n            var viewIds = [];\n            if (useMapWidgetIds) {\n                useMapWidgetIds.forEach(function (wId) {\n                    viewIds = viewIds.concat(_this.getJimuMapViewIdsFromMapWidgetId(wId, infos, rootDatasourceId));\n                });\n            }\n            return viewIds;\n        };\n        _this.getJimuMapViewIdsFromMapWidgetId = function (mapWidgetId, infos, rootDatasourceId) {\n            if (!rootDatasourceId) {\n                return [];\n            }\n            else {\n                return infos ? Object.keys(infos).filter(function (viewId) { return (infos[viewId].mapWidgetId === mapWidgetId\n                    && infos[viewId].datasourceId === rootDatasourceId); }) : [];\n            }\n        };\n        return _this;\n    }\n    _JimuLayerViewComponent.prototype.componentDidMount = function () {\n        var _this = this;\n        var viewIds = this.getJimuMapViewIdsFromUseMapWidgetIds(this.props.useMapWidgetIds, this.props.viewInfos, this.props.jimuLayerViewInfo && this.props.jimuLayerViewInfo.rootDatasourceId);\n        if (viewIds[0] && this.props.viewInfos[viewIds[0]].status === jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"JimuMapViewStatus\"].Loaded && this.props.jimuLayerViewInfo\n            && this.props.jimuLayerViewInfo.jimuMapViewId && this.props.jimuLayerViewInfo.jimuLayerId) {\n            var tempJimuMapView = _mapview_manager__WEBPACK_IMPORTED_MODULE_1__[\"MapViewManager\"].getInstance().getJimuMapViewById(viewIds[0]);\n            var tempJimuMapViewLoadPromise = tempJimuMapView.getJimuLayerViewLoadPromiseById(this.props.jimuLayerViewInfo.jimuMapViewId\n                + '-' + this.props.jimuLayerViewInfo.jimuLayerId);\n            if (tempJimuMapViewLoadPromise) {\n                tempJimuMapViewLoadPromise.then(function (jimuLayerView) {\n                    _this.props.onLayerViewCreated && _this.props.onLayerViewCreated(jimuLayerView);\n                }, function (error) {\n                    _this.props.onLayerViewFailed && _this.props.onLayerViewFailed(error);\n                });\n            }\n            else {\n                this.props.onLayerViewCreated && this.props.onLayerViewCreated(null);\n            }\n        }\n        if (viewIds[0] && this.props.viewInfos[viewIds[0]].status === jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"JimuMapViewStatus\"].Failed\n            && this.props.jimuLayerViewInfo && this.props.jimuLayerViewInfo.jimuMapViewId && this.props.jimuLayerViewInfo.jimuLayerId) {\n            this.props.onLayerViewFailed && this.props.onLayerViewFailed(null);\n        }\n    };\n    _JimuLayerViewComponent.prototype.componentDidUpdate = function (prevProps, prevState) {\n        var _this = this;\n        var preJimuMapViewIds = this.getJimuMapViewIdsFromUseMapWidgetIds(prevProps.useMapWidgetIds, prevProps.viewInfos, prevProps.jimuLayerViewInfo && prevProps.jimuLayerViewInfo.rootDatasourceId);\n        var preJimuMapInfo = prevProps.viewInfos[preJimuMapViewIds[0]];\n        var preJimuMapInfoStatus = preJimuMapInfo && preJimuMapInfo.status;\n        var currentJimuMapViewIds = this.getJimuMapViewIdsFromUseMapWidgetIds(this.props.useMapWidgetIds, this.props.viewInfos, this.props.jimuLayerViewInfo && this.props.jimuLayerViewInfo.rootDatasourceId);\n        var currentJimuMapInfo = this.props.viewInfos[currentJimuMapViewIds[0]];\n        var currentJimuMapInfoStatus = currentJimuMapInfo && currentJimuMapInfo.status;\n        if (preJimuMapInfoStatus !== currentJimuMapInfoStatus || (preJimuMapInfoStatus === currentJimuMapInfoStatus\n            && preJimuMapViewIds.join('') === currentJimuMapViewIds.join(''))) {\n            if (currentJimuMapInfo) {\n                if (currentJimuMapInfo.status === jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"JimuMapViewStatus\"].Loaded) {\n                    var tempJimuMapView = _mapview_manager__WEBPACK_IMPORTED_MODULE_1__[\"MapViewManager\"].getInstance().getJimuMapViewById(currentJimuMapViewIds[0]);\n                    var tempJimuMapViewLoadPromise = tempJimuMapView.getJimuLayerViewLoadPromiseById(this.props.jimuLayerViewInfo.jimuMapViewId\n                        + '-' + this.props.jimuLayerViewInfo.jimuLayerId);\n                    if (tempJimuMapViewLoadPromise) {\n                        tempJimuMapViewLoadPromise.then(function (jimuLayerView) {\n                            _this.props.onLayerViewCreated && _this.props.onLayerViewCreated(jimuLayerView);\n                        }, function (error) {\n                            _this.props.onLayerViewFailed && _this.props.onLayerViewFailed(error);\n                        });\n                    }\n                    else {\n                        this.props.onLayerViewCreated && this.props.onLayerViewCreated(null);\n                    }\n                }\n                if (currentJimuMapInfo.status === jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"JimuMapViewStatus\"].Failed) {\n                    this.props.onLayerViewFailed && this.props.onLayerViewFailed(null);\n                }\n            }\n            else {\n                this.props.onLayerViewCreated && this.props.onLayerViewCreated(null);\n            }\n        }\n    };\n    _JimuLayerViewComponent.prototype.render = function () {\n        return null;\n    };\n    return _JimuLayerViewComponent;\n}(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"React\"].PureComponent));\nvar mapStateToProps = function (state, ownProps) {\n    var jimuMapViewsInfo = state && state.jimuMapViewsInfo;\n    return {\n        viewInfos: jimuMapViewsInfo\n    };\n};\n/**\n * A react component that makes it easy to use JimuLayerView from the map widget.\n * In most cases, you can pass on `useMapWidgetIds`, `jimuLayerViewInfo`, and use `onLayerViewCreated`, `onLayerViewFailed` to get callback from the JimuLayerViewComponent.\n */\nvar JimuLayerViewComponent = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"ReactRedux\"].connect(mapStateToProps)(_JimuLayerViewComponent);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9saWIvY29tcG9uZW50cy9qaW11LWxheWVyLXZpZXctY29tcG9uZW50LnRzeC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtYXJjZ2lzL2xpYi9jb21wb25lbnRzL2ppbXUtbGF5ZXItdmlldy1jb21wb25lbnQudHN4PzYzNzQiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqIEBqc3gganN4ICovXG5pbXBvcnQge1JlYWN0LCBSZWFjdFJlZHV4LCBJTVN0YXRlLCBJbW11dGFibGVPYmplY3QsIElNSmltdU1hcFZpZXdJbmZvLCBJbW11dGFibGVBcnJheSwgSmltdU1hcFZpZXdTdGF0dXN9IGZyb20gJ2ppbXUtY29yZSc7XG5pbXBvcnQge0ppbXVMYXllclZpZXd9IGZyb20gJy4uL3ZpZXdzJztcbmltcG9ydCB7IE1hcFZpZXdNYW5hZ2VyIH0gZnJvbSAnLi4vbWFwdmlldy1tYW5hZ2VyJztcblxuLyoqXG4gKiBUaGUgSmltdUxheWVyVmlld0luZm9cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBKaW11TGF5ZXJWaWV3SW5mbyB7XG4gIGppbXVNYXBWaWV3SWQ/OiBzdHJpbmc7XG4gIGppbXVMYXllcklkPzogc3RyaW5nO1xuICByb290SmltdUxheWVySWQ/OiBzdHJpbmc7XG4gIGRhdGFzb3VyY2VJZD86IHN0cmluZztcbiAgcm9vdERhdGFzb3VyY2VJZD86IHN0cmluZztcbn1cblxuZXhwb3J0IHR5cGUgSU1KaW11TGF5ZXJWaWV3SW5mbyA9IEltbXV0YWJsZU9iamVjdDxKaW11TGF5ZXJWaWV3SW5mbz47XG5cbmludGVyZmFjZSBTdGF0ZXt9XG5cbi8qKlxuICogVGhlIEppbXVMYXllclZpZXdDb21wb25lbnQgcHJvcGVydGllc1xuICovXG5leHBvcnQgaW50ZXJmYWNlIEppbXVMYXllclZpZXdDb21wb25lbnRQcm9wc3tcblxuICAvKipcbiAgICogVGhlIGFycmF5IG9mIHRoZSBtYXAgd2lkZ2V0IGlkIHNlbGVjdGVkIGZyb20gdGhlIEppbXVNYXBWaWV3U2VsZWN0b3IgY29tcG9uZW50XG4gICAqL1xuICB1c2VNYXBXaWRnZXRJZHM6IEltbXV0YWJsZUFycmF5PHN0cmluZz47XG5cbiAgLyoqXG4gICAqIFRoZSBqaW11TGF5ZXJWaWV3SW5mbyBzZWxlY3RlZCBmcm9tIHRoZSBKaW11TGF5ZXJWaWV3U2VsZWN0b3IgY29tcG9uZW50XG4gICAqL1xuICBqaW11TGF5ZXJWaWV3SW5mbzogSU1KaW11TGF5ZXJWaWV3SW5mbztcblxuICAvKipcbiAgICogVGhlIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIHdoZW4gdGhlIEppbXVMYXllclZpZXcgaW5zdGFuY2UgaXMgY3JlYXRlZC5cbiAgICovXG4gIG9uTGF5ZXJWaWV3Q3JlYXRlZD86IChqaW11TGF5ZXJWaWV3OiBKaW11TGF5ZXJWaWV3KSA9PiB2b2lkO1xuXG4gIC8qKlxuICAgKiBUaGUgZnVuY3Rpb24gd2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgSmltdUxheWVyVmlldyBpbnN0YW5jZSBjcmVhdGlvbiBmYWlscy5cbiAgICovXG4gIG9uTGF5ZXJWaWV3RmFpbGVkPzogKGVycikgPT4gdm9pZDtcbn1cblxuaW50ZXJmYWNlIEV4dHJhUHJvcHMge1xuICB2aWV3SW5mb3M6IEltbXV0YWJsZU9iamVjdDx7W2ppbXVNYXBWaWV3SWQ6IHN0cmluZ106IElNSmltdU1hcFZpZXdJbmZvfT47XG59XG5cbmNsYXNzIF9KaW11TGF5ZXJWaWV3Q29tcG9uZW50IGV4dGVuZHMgUmVhY3QuUHVyZUNvbXBvbmVudDxKaW11TGF5ZXJWaWV3Q29tcG9uZW50UHJvcHMgJiBFeHRyYVByb3BzLCBTdGF0ZT57XG5cbiAgY29uc3RydWN0b3IocHJvcHMpe1xuICAgIHN1cGVyKHByb3BzKTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIGNvbnN0IHZpZXdJZHMgPSB0aGlzLmdldEppbXVNYXBWaWV3SWRzRnJvbVVzZU1hcFdpZGdldElkcyh0aGlzLnByb3BzLnVzZU1hcFdpZGdldElkcywgdGhpcy5wcm9wcy52aWV3SW5mb3MsXG4gICAgICB0aGlzLnByb3BzLmppbXVMYXllclZpZXdJbmZvICYmIHRoaXMucHJvcHMuamltdUxheWVyVmlld0luZm8ucm9vdERhdGFzb3VyY2VJZCk7XG5cbiAgICBpZiAodmlld0lkc1swXSAmJiB0aGlzLnByb3BzLnZpZXdJbmZvc1t2aWV3SWRzWzBdXS5zdGF0dXMgPT09IEppbXVNYXBWaWV3U3RhdHVzLkxvYWRlZCAmJiB0aGlzLnByb3BzLmppbXVMYXllclZpZXdJbmZvXG4gICAgICAmJiB0aGlzLnByb3BzLmppbXVMYXllclZpZXdJbmZvLmppbXVNYXBWaWV3SWQgJiYgdGhpcy5wcm9wcy5qaW11TGF5ZXJWaWV3SW5mby5qaW11TGF5ZXJJZCkge1xuICAgICAgY29uc3QgdGVtcEppbXVNYXBWaWV3ID0gTWFwVmlld01hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXRKaW11TWFwVmlld0J5SWQodmlld0lkc1swXSk7XG4gICAgICBjb25zdCB0ZW1wSmltdU1hcFZpZXdMb2FkUHJvbWlzZSA9IHRlbXBKaW11TWFwVmlldy5nZXRKaW11TGF5ZXJWaWV3TG9hZFByb21pc2VCeUlkKHRoaXMucHJvcHMuamltdUxheWVyVmlld0luZm8uamltdU1hcFZpZXdJZFxuICAgICAgICArICctJyArIHRoaXMucHJvcHMuamltdUxheWVyVmlld0luZm8uamltdUxheWVySWQpO1xuICAgICAgaWYgKHRlbXBKaW11TWFwVmlld0xvYWRQcm9taXNlKSB7XG4gICAgICAgIHRlbXBKaW11TWFwVmlld0xvYWRQcm9taXNlLnRoZW4oKGppbXVMYXllclZpZXcpID0+IHtcbiAgICAgICAgICB0aGlzLnByb3BzLm9uTGF5ZXJWaWV3Q3JlYXRlZCAmJiB0aGlzLnByb3BzLm9uTGF5ZXJWaWV3Q3JlYXRlZChqaW11TGF5ZXJWaWV3KTtcbiAgICAgICAgfSwgKGVycm9yKSA9PiB7XG4gICAgICAgICAgdGhpcy5wcm9wcy5vbkxheWVyVmlld0ZhaWxlZCAmJiB0aGlzLnByb3BzLm9uTGF5ZXJWaWV3RmFpbGVkKGVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnByb3BzLm9uTGF5ZXJWaWV3Q3JlYXRlZCAmJiB0aGlzLnByb3BzLm9uTGF5ZXJWaWV3Q3JlYXRlZChudWxsKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodmlld0lkc1swXSAmJiB0aGlzLnByb3BzLnZpZXdJbmZvc1t2aWV3SWRzWzBdXS5zdGF0dXMgPT09IEppbXVNYXBWaWV3U3RhdHVzLkZhaWxlZFxuICAgICAgJiYgdGhpcy5wcm9wcy5qaW11TGF5ZXJWaWV3SW5mbyAmJiB0aGlzLnByb3BzLmppbXVMYXllclZpZXdJbmZvLmppbXVNYXBWaWV3SWQgJiYgdGhpcy5wcm9wcy5qaW11TGF5ZXJWaWV3SW5mby5qaW11TGF5ZXJJZCkge1xuICAgICAgdGhpcy5wcm9wcy5vbkxheWVyVmlld0ZhaWxlZCAmJiB0aGlzLnByb3BzLm9uTGF5ZXJWaWV3RmFpbGVkKG51bGwpO1xuICAgIH1cbiAgfVxuXG4gIGNvbXBvbmVudERpZFVwZGF0ZShwcmV2UHJvcHM6IEppbXVMYXllclZpZXdDb21wb25lbnRQcm9wcyAmIEV4dHJhUHJvcHMsIHByZXZTdGF0ZTogU3RhdGUpIHtcbiAgICBjb25zdCBwcmVKaW11TWFwVmlld0lkcyA9IHRoaXMuZ2V0SmltdU1hcFZpZXdJZHNGcm9tVXNlTWFwV2lkZ2V0SWRzKHByZXZQcm9wcy51c2VNYXBXaWRnZXRJZHMsIHByZXZQcm9wcy52aWV3SW5mb3MsXG4gICAgICBwcmV2UHJvcHMuamltdUxheWVyVmlld0luZm8gJiYgcHJldlByb3BzLmppbXVMYXllclZpZXdJbmZvLnJvb3REYXRhc291cmNlSWQpO1xuICAgIGNvbnN0IHByZUppbXVNYXBJbmZvID0gcHJldlByb3BzLnZpZXdJbmZvc1twcmVKaW11TWFwVmlld0lkc1swXV07XG4gICAgY29uc3QgcHJlSmltdU1hcEluZm9TdGF0dXMgPSBwcmVKaW11TWFwSW5mbyAmJiBwcmVKaW11TWFwSW5mby5zdGF0dXM7XG4gICAgY29uc3QgY3VycmVudEppbXVNYXBWaWV3SWRzID0gdGhpcy5nZXRKaW11TWFwVmlld0lkc0Zyb21Vc2VNYXBXaWRnZXRJZHModGhpcy5wcm9wcy51c2VNYXBXaWRnZXRJZHMsIHRoaXMucHJvcHMudmlld0luZm9zLFxuICAgICAgdGhpcy5wcm9wcy5qaW11TGF5ZXJWaWV3SW5mbyAmJiB0aGlzLnByb3BzLmppbXVMYXllclZpZXdJbmZvLnJvb3REYXRhc291cmNlSWQpO1xuICAgIGNvbnN0IGN1cnJlbnRKaW11TWFwSW5mbyA9IHRoaXMucHJvcHMudmlld0luZm9zW2N1cnJlbnRKaW11TWFwVmlld0lkc1swXV07XG4gICAgY29uc3QgY3VycmVudEppbXVNYXBJbmZvU3RhdHVzID0gY3VycmVudEppbXVNYXBJbmZvICYmIGN1cnJlbnRKaW11TWFwSW5mby5zdGF0dXM7XG5cbiAgICBpZiAocHJlSmltdU1hcEluZm9TdGF0dXMgIT09IGN1cnJlbnRKaW11TWFwSW5mb1N0YXR1cyB8fCAocHJlSmltdU1hcEluZm9TdGF0dXMgPT09IGN1cnJlbnRKaW11TWFwSW5mb1N0YXR1c1xuICAgICAgJiYgcHJlSmltdU1hcFZpZXdJZHMuam9pbignJykgPT09IGN1cnJlbnRKaW11TWFwVmlld0lkcy5qb2luKCcnKSkpIHtcbiAgICAgIGlmIChjdXJyZW50SmltdU1hcEluZm8pIHtcbiAgICAgICAgaWYgKGN1cnJlbnRKaW11TWFwSW5mby5zdGF0dXMgPT09IEppbXVNYXBWaWV3U3RhdHVzLkxvYWRlZCkge1xuICAgICAgICAgIGNvbnN0IHRlbXBKaW11TWFwVmlldyA9IE1hcFZpZXdNYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0SmltdU1hcFZpZXdCeUlkKGN1cnJlbnRKaW11TWFwVmlld0lkc1swXSk7XG4gICAgICAgICAgY29uc3QgdGVtcEppbXVNYXBWaWV3TG9hZFByb21pc2UgPSB0ZW1wSmltdU1hcFZpZXcuZ2V0SmltdUxheWVyVmlld0xvYWRQcm9taXNlQnlJZCh0aGlzLnByb3BzLmppbXVMYXllclZpZXdJbmZvLmppbXVNYXBWaWV3SWRcbiAgICAgICAgICAgICsgJy0nICsgdGhpcy5wcm9wcy5qaW11TGF5ZXJWaWV3SW5mby5qaW11TGF5ZXJJZCk7XG4gICAgICAgICAgaWYgKHRlbXBKaW11TWFwVmlld0xvYWRQcm9taXNlKSB7XG4gICAgICAgICAgICB0ZW1wSmltdU1hcFZpZXdMb2FkUHJvbWlzZS50aGVuKChqaW11TGF5ZXJWaWV3KSA9PiB7XG4gICAgICAgICAgICAgIHRoaXMucHJvcHMub25MYXllclZpZXdDcmVhdGVkICYmIHRoaXMucHJvcHMub25MYXllclZpZXdDcmVhdGVkKGppbXVMYXllclZpZXcpO1xuICAgICAgICAgICAgfSwgKGVycm9yKSA9PiB7XG4gICAgICAgICAgICAgIHRoaXMucHJvcHMub25MYXllclZpZXdGYWlsZWQgJiYgdGhpcy5wcm9wcy5vbkxheWVyVmlld0ZhaWxlZChlcnJvcik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5vbkxheWVyVmlld0NyZWF0ZWQgJiYgdGhpcy5wcm9wcy5vbkxheWVyVmlld0NyZWF0ZWQobnVsbCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChjdXJyZW50SmltdU1hcEluZm8uc3RhdHVzID09PSBKaW11TWFwVmlld1N0YXR1cy5GYWlsZWQpIHtcbiAgICAgICAgICB0aGlzLnByb3BzLm9uTGF5ZXJWaWV3RmFpbGVkICYmIHRoaXMucHJvcHMub25MYXllclZpZXdGYWlsZWQobnVsbCk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucHJvcHMub25MYXllclZpZXdDcmVhdGVkICYmIHRoaXMucHJvcHMub25MYXllclZpZXdDcmVhdGVkKG51bGwpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGdldEppbXVNYXBWaWV3SWRzRnJvbVVzZU1hcFdpZGdldElkcyA9ICh1c2VNYXBXaWRnZXRJZHM6IEltbXV0YWJsZUFycmF5PHN0cmluZz4sIGluZm9zOiBJbW11dGFibGVPYmplY3Q8e1tqaW11TWFwVmlld0lkOiBzdHJpbmddOiBJTUppbXVNYXBWaWV3SW5mb30+LFxuICAgIHJvb3REYXRhc291cmNlSWQ6IHN0cmluZyk6IHN0cmluZ1tdID0+IHtcbiAgICBsZXQgdmlld0lkcyA9IFtdO1xuXG4gICAgaWYodXNlTWFwV2lkZ2V0SWRzKXtcbiAgICAgIHVzZU1hcFdpZGdldElkcy5mb3JFYWNoKHdJZCA9PiB7XG4gICAgICAgIHZpZXdJZHMgPSB2aWV3SWRzLmNvbmNhdCh0aGlzLmdldEppbXVNYXBWaWV3SWRzRnJvbU1hcFdpZGdldElkKHdJZCwgaW5mb3MsIHJvb3REYXRhc291cmNlSWQpKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB2aWV3SWRzO1xuICB9XG5cbiAgZ2V0SmltdU1hcFZpZXdJZHNGcm9tTWFwV2lkZ2V0SWQgPSAobWFwV2lkZ2V0SWQ6IHN0cmluZywgaW5mb3M6IEltbXV0YWJsZU9iamVjdDx7W2ppbXVNYXBWaWV3SWQ6IHN0cmluZ106IElNSmltdU1hcFZpZXdJbmZvfT4sXG4gICAgcm9vdERhdGFzb3VyY2VJZDogc3RyaW5nKTogc3RyaW5nW10gPT4ge1xuICAgIGlmICghcm9vdERhdGFzb3VyY2VJZCkge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gaW5mb3MgPyBPYmplY3Qua2V5cyhpbmZvcykuZmlsdGVyKHZpZXdJZCA9PiAoaW5mb3Nbdmlld0lkXS5tYXBXaWRnZXRJZCA9PT0gbWFwV2lkZ2V0SWRcbiAgICAgICAgJiYgaW5mb3Nbdmlld0lkXS5kYXRhc291cmNlSWQgPT09IHJvb3REYXRhc291cmNlSWQpKSA6IFtdO1xuICAgIH1cbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5jb25zdCBtYXBTdGF0ZVRvUHJvcHMgPSAoc3RhdGU6IElNU3RhdGUsIG93blByb3BzOiBKaW11TGF5ZXJWaWV3Q29tcG9uZW50UHJvcHMpOiBFeHRyYVByb3BzID0+IHtcbiAgY29uc3QgamltdU1hcFZpZXdzSW5mbyA9IHN0YXRlICYmIHN0YXRlLmppbXVNYXBWaWV3c0luZm87XG4gIHJldHVybiB7XG4gICAgdmlld0luZm9zOiBqaW11TWFwVmlld3NJbmZvXG4gIH07XG59XG5cbi8qKlxuICogQSByZWFjdCBjb21wb25lbnQgdGhhdCBtYWtlcyBpdCBlYXN5IHRvIHVzZSBKaW11TGF5ZXJWaWV3IGZyb20gdGhlIG1hcCB3aWRnZXQuXG4gKiBJbiBtb3N0IGNhc2VzLCB5b3UgY2FuIHBhc3Mgb24gYHVzZU1hcFdpZGdldElkc2AsIGBqaW11TGF5ZXJWaWV3SW5mb2AsIGFuZCB1c2UgYG9uTGF5ZXJWaWV3Q3JlYXRlZGAsIGBvbkxheWVyVmlld0ZhaWxlZGAgdG8gZ2V0IGNhbGxiYWNrIGZyb20gdGhlIEppbXVMYXllclZpZXdDb21wb25lbnQuXG4gKi9cbmV4cG9ydCBjb25zdCBKaW11TGF5ZXJWaWV3Q29tcG9uZW50ID0gUmVhY3RSZWR1eC5jb25uZWN0PEV4dHJhUHJvcHMsIHVua25vd24sIEppbXVMYXllclZpZXdDb21wb25lbnRQcm9wcz4obWFwU3RhdGVUb1Byb3BzKShfSmltdUxheWVyVmlld0NvbXBvbmVudCk7Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBRUE7QUErQ0E7QUFBQTtBQUVBO0FBQUE7QUFrRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQXJGQTtBQUVBO0FBQUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUF5QkE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7QUFHQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./jimu-arcgis/lib/components/jimu-layer-view-component.tsx\n");

/***/ }),

/***/ "./jimu-arcgis/lib/components/jimu-map-view-component.tsx":
/*!****************************************************************!*\
  !*** ./jimu-arcgis/lib/components/jimu-map-view-component.tsx ***!
  \****************************************************************/
/*! exports provided: JimuMapViewComponent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"JimuMapViewComponent\", function() { return JimuMapViewComponent; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _mapview_manager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../mapview-manager */ \"./jimu-arcgis/lib/mapview-manager.tsx\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\nvar _JimuMapViewComponent = /** @class */ (function (_super) {\n    __extends(_JimuMapViewComponent, _super);\n    function _JimuMapViewComponent(props) {\n        var _this = _super.call(this, props) || this;\n        _this.viewManager = _mapview_manager__WEBPACK_IMPORTED_MODULE_1__[\"MapViewManager\"].getInstance();\n        _this.onViewInfosChange = function (infos, useMapWidgetIds) {\n            if (!infos) {\n                return;\n            }\n            var activeViewId = _this.getActiveViewId();\n            var viewIds = _this.getViewIdsFromUseMapWidgetIds(useMapWidgetIds, infos);\n            var isActiveViewCreated = _this.getWhetherViewCreated(activeViewId, infos);\n            var areAllViewsCreated = _this.getWhetherAllViewsCreated(viewIds, infos);\n            _this.setState({ activeViewId: activeViewId, isActiveViewCreated: isActiveViewCreated, areAllViewsCreated: areAllViewsCreated });\n        };\n        _this.onViewsCreate = function (views) {\n            if (views && _this.state.activeViewId && Object.keys(views).some(function (vId) { return vId === _this.state.activeViewId; })) {\n                _this.setState({ isActiveViewCreated: true });\n            }\n            _this.props.onViewsCreate && _this.props.onViewsCreate(views);\n        };\n        _this.onViewGroupCreate = function () {\n            if (_this.props.onViewGroupCreate && _this.viewManager && _this.props.useMapWidgetIds && _this.props.useMapWidgetIds[0]) {\n                var jimuMapViewGroup = _this.viewManager.getJimuMapViewGroup(_this.props.useMapWidgetIds[0]);\n                _this.props.onViewGroupCreate(jimuMapViewGroup);\n            }\n        };\n        _this.getActiveViewId = function () {\n            var mapWidgetId = _this.props.useMapWidgetIds && _this.props.useMapWidgetIds[0]; // only support to select a single map widget now\n            var viewGroup = _this.viewManager.getJimuMapViewGroup(mapWidgetId);\n            var activeView = viewGroup && viewGroup.getActiveJimuMapView();\n            var activeViewId = (activeView && activeView.id) || null;\n            return activeViewId;\n        };\n        _this.getWhetherAllViewsCreated = function (viewIds, infos) {\n            if (viewIds === void 0) { viewIds = []; }\n            return viewIds.length > 0 && !viewIds.some(function (vId) { return !_this.getWhetherViewCreated(vId, infos); });\n        };\n        _this.getWhetherViewCreated = function (viewId, infos) {\n            if (!viewId) {\n                return true;\n            }\n            return !!(viewId && infos && infos[viewId] && infos[viewId].status && infos[viewId].status === jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"JimuMapViewStatus\"].Loaded);\n        };\n        _this.getViewIdsFromUseMapWidgetIds = function (useMapWidgetIds, infos) {\n            var viewIds = [];\n            if (useMapWidgetIds) {\n                useMapWidgetIds.forEach(function (wId) {\n                    viewIds = viewIds.concat(_this.getViewIdsFromMapWidgetId(wId, infos));\n                });\n            }\n            return viewIds;\n        };\n        _this.getViewIdsFromMapWidgetId = function (mapWidgetId, infos) {\n            return infos ? Object.keys(infos).filter(function (viewId) { return infos[viewId].mapWidgetId === mapWidgetId; }) : [];\n        };\n        _this.getViews = function (viewIds) {\n            if (!viewIds) {\n                return null;\n            }\n            var views = {};\n            viewIds.forEach(function (vId) {\n                views[vId] = _this.viewManager.getJimuMapViewById(vId);\n            });\n            return views;\n        };\n        var viewIds = _this.getViewIdsFromUseMapWidgetIds(_this.props.useMapWidgetIds, _this.props.viewInfos);\n        var activeViewId = _this.getActiveViewId();\n        _this.state = {\n            activeViewId: activeViewId,\n            isActiveViewCreated: _this.getWhetherViewCreated(activeViewId, _this.props.viewInfos),\n            areAllViewsCreated: _this.getWhetherAllViewsCreated(viewIds, _this.props.viewInfos)\n        };\n        return _this;\n    }\n    _JimuMapViewComponent.prototype.componentDidMount = function () {\n        if (this.onViewsCreate && this.state.areAllViewsCreated) {\n            var viewIds = this.getViewIdsFromUseMapWidgetIds(this.props.useMapWidgetIds, this.props.viewInfos);\n            var views = this.getViews(viewIds);\n            this.onViewsCreate(views);\n            this.onViewGroupCreate();\n        }\n        if (this.props.onActiveViewChange && this.state.isActiveViewCreated) {\n            var activeView = (this.viewManager && this.viewManager.getJimuMapViewById(this.state.activeViewId)) || null;\n            this.props.onActiveViewChange(activeView, null);\n        }\n    };\n    _JimuMapViewComponent.prototype.componentDidUpdate = function (prevProps, prevState) {\n        if (this.props.viewInfos !== prevProps.viewInfos || this.props.useMapWidgetIds !== prevProps.useMapWidgetIds) {\n            this.onViewInfosChange(this.props.viewInfos, this.props.useMapWidgetIds);\n        }\n        if (this.props.onActiveViewChange && this.state.isActiveViewCreated &&\n            (!prevState.isActiveViewCreated || this.state.activeViewId !== prevState.activeViewId)) {\n            var activeView = (this.viewManager && this.viewManager.getJimuMapViewById(this.state.activeViewId)) || null;\n            this.props.onActiveViewChange(activeView, prevState.activeViewId);\n        }\n        if (this.onViewsCreate && this.state.areAllViewsCreated &&\n            (!prevState.areAllViewsCreated || this.props.useMapWidgetIds !== prevProps.useMapWidgetIds)) {\n            var viewIds = this.getViewIdsFromUseMapWidgetIds(this.props.useMapWidgetIds, this.props.viewInfos);\n            var views = this.getViews(viewIds);\n            this.onViewsCreate(views);\n            this.onViewGroupCreate();\n        }\n    };\n    _JimuMapViewComponent.prototype.render = function () {\n        if (!this.props.useMapWidgetIds || !this.props.viewInfos || !this.props.children) {\n            return null;\n        }\n        var viewIds = this.getViewIdsFromUseMapWidgetIds(this.props.useMapWidgetIds, this.props.viewInfos);\n        var views = this.getViews(viewIds);\n        return typeof this.props.children === 'function' ?\n            this.props.children(views) : this.props.children;\n    };\n    return _JimuMapViewComponent;\n}(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"React\"].PureComponent));\nvar mapStateToProps = function (state, ownProps) {\n    if (state.appStateInBuilder) {\n        var jimuMapViewsInfo = state.appStateInBuilder && state.appStateInBuilder.jimuMapViewsInfo;\n        return {\n            viewInfos: jimuMapViewsInfo\n        };\n    }\n    else {\n        var jimuMapViewsInfo = state && state.jimuMapViewsInfo;\n        return {\n            viewInfos: jimuMapViewsInfo\n        };\n    }\n};\n/**\n * A react component that makes it easy to use JimuMapView from the map widget.\n * In most cases, you can pass on `useMapWidgetIds`, and use `onViewsCreate`, `onActiveViewChange` to get callback from the JimuMapViewComponent.\n */\nvar JimuMapViewComponent = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"ReactRedux\"].connect(mapStateToProps)(_JimuMapViewComponent);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9saWIvY29tcG9uZW50cy9qaW11LW1hcC12aWV3LWNvbXBvbmVudC50c3guanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qaW11LWFyY2dpcy9saWIvY29tcG9uZW50cy9qaW11LW1hcC12aWV3LWNvbXBvbmVudC50c3g/MjFiNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSZWFjdCwgUmVhY3RSZWR1eCwgSW1tdXRhYmxlQXJyYXksIElNU3RhdGUsIElNSmltdU1hcFZpZXdJbmZvLCBJbW11dGFibGVPYmplY3QsIEppbXVNYXBWaWV3U3RhdHVzIH0gZnJvbSAnamltdS1jb3JlJztcbmltcG9ydCB7IEppbXVNYXBWaWV3IH0gZnJvbSAnLi4vdmlld3MvamltdS1tYXAtdmlldyc7XG5pbXBvcnQgeyBNYXBWaWV3TWFuYWdlciB9IGZyb20gJy4uL21hcHZpZXctbWFuYWdlcic7XG5pbXBvcnQgeyBKaW11TWFwVmlld0dyb3VwIH0gZnJvbSAnLi4vdmlld3MvamltdS1tYXAtdmlldy1ncm91cCc7XG5cbi8qKiBAaWdub3JlICovXG5pbnRlcmZhY2UgVmlld1JlbmRlckZ1bmN0aW9uIHtcbiAgKHZpZXdzOiB7IFt2aWV3SWQ6IHN0cmluZ106IEppbXVNYXBWaWV3IH0pOiBSZWFjdC5SZWFjdE5vZGVcbn1cblxuLyoqIEBpZ25vcmUgKi9cbmludGVyZmFjZSBFeHRyYVByb3BzIHtcbiAgdmlld0luZm9zOiBJbW11dGFibGVPYmplY3Q8e1tqaW11TWFwVmlld0lkOiBzdHJpbmddOiBJTUppbXVNYXBWaWV3SW5mb30+O1xufVxuXG4vKipcbiAqIFRoZSBKaW11TWFwVmlld0NvbXBvbmVudCBwcm9wZXJ0aWVzXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSmltdU1hcFZpZXdDb21wb25lbnRQcm9wcyB7XG5cbiAgLyoqXG4gICAqIFRoZSBhcnJheSBvZiB0aGUgbWFwIHdpZGdldCBpZCBzZWxlY3RlZCBmcm9tIHRoZSBKaW11TWFwVmlld1NlbGVjdG9yIGNvbXBvbmVudC5cbiAgICovXG4gIHVzZU1hcFdpZGdldElkczogSW1tdXRhYmxlQXJyYXk8c3RyaW5nPjtcblxuICAvKiogQGlnbm9yZSAqL1xuICBjaGlsZHJlbj86IFZpZXdSZW5kZXJGdW5jdGlvbiB8IFJlYWN0LlJlYWN0Tm9kZTtcblxuICBvblZpZXdHcm91cENyZWF0ZT86ICh2aWV3R3JvdXA6IEppbXVNYXBWaWV3R3JvdXApID0+IHZvaWQ7XG5cbiAgLyoqXG4gICAqIFRoZSBmdW5jdGlvbiB3aWxsIGJlIGNhbGxlZCB3aGVuIHRoZSBKaW11TWFwVmlldyBpbnN0YW5jZSBpcyBjcmVhdGVkLlxuICAgKi9cbiAgb25WaWV3c0NyZWF0ZT86ICh2aWV3czogeyBbdmlld0lkOiBzdHJpbmddOiBKaW11TWFwVmlldyB9KSA9PiB2b2lkO1xuXG4gIC8qKlxuICAgKiBUaGUgZnVuY3Rpb24gd2lsbCBiZSBjYWxsZWQgd2hlbiB0aGUgY3VycmVudCBhY3RpdmUgdmlldyBvZiB0aGUgbWFwIHdpZGdldCBpcyBjaGFuZ2VkLlxuICAgKiBGb3IgZXhhbXBsZSwgd2hlbiB3ZSBjbGljayBvbiB0aGUgc3dpdGNoLW1hcCB0b29sIGZvciBtdWx0aS1zb3VyY2UgbWFwIG9yIGNoYW5nZSBkYXRhc291cmNlcyBmb3IgdGhlIG1hcCB3aWRnZXQuXG4gICAqL1xuICBvbkFjdGl2ZVZpZXdDaGFuZ2U/OiAoYWN0aXZlVmlldzogSmltdU1hcFZpZXcsIHByZXZpb3VzQWN0aXZlVmlld0lkOiBzdHJpbmcpID0+IHZvaWQ7XG59XG5cbi8qKiBAaWdub3JlICovXG5pbnRlcmZhY2UgU3RhdGUge1xuICBhY3RpdmVWaWV3SWQ6IHN0cmluZztcbiAgaXNBY3RpdmVWaWV3Q3JlYXRlZDogYm9vbGVhbjtcbiAgYXJlQWxsVmlld3NDcmVhdGVkOiBib29sZWFuO1xufVxuXG5jbGFzcyBfSmltdU1hcFZpZXdDb21wb25lbnQgZXh0ZW5kcyBSZWFjdC5QdXJlQ29tcG9uZW50PEppbXVNYXBWaWV3Q29tcG9uZW50UHJvcHMgJiBFeHRyYVByb3BzLCBTdGF0ZT57XG4gIHZpZXdNYW5hZ2VyID0gTWFwVmlld01hbmFnZXIuZ2V0SW5zdGFuY2UoKTtcblxuICBjb25zdHJ1Y3Rvcihwcm9wcyl7XG4gICAgc3VwZXIocHJvcHMpO1xuXG4gICAgY29uc3Qgdmlld0lkcyA9IHRoaXMuZ2V0Vmlld0lkc0Zyb21Vc2VNYXBXaWRnZXRJZHModGhpcy5wcm9wcy51c2VNYXBXaWRnZXRJZHMsIHRoaXMucHJvcHMudmlld0luZm9zKTtcbiAgICBjb25zdCBhY3RpdmVWaWV3SWQgPSB0aGlzLmdldEFjdGl2ZVZpZXdJZCgpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBhY3RpdmVWaWV3SWQsXG4gICAgICBpc0FjdGl2ZVZpZXdDcmVhdGVkOiB0aGlzLmdldFdoZXRoZXJWaWV3Q3JlYXRlZChhY3RpdmVWaWV3SWQsIHRoaXMucHJvcHMudmlld0luZm9zKSxcbiAgICAgIGFyZUFsbFZpZXdzQ3JlYXRlZDogdGhpcy5nZXRXaGV0aGVyQWxsVmlld3NDcmVhdGVkKHZpZXdJZHMsIHRoaXMucHJvcHMudmlld0luZm9zKVxuICAgIH07XG4gIH1cblxuICBjb21wb25lbnREaWRNb3VudCgpe1xuICAgIGlmKHRoaXMub25WaWV3c0NyZWF0ZSAmJiB0aGlzLnN0YXRlLmFyZUFsbFZpZXdzQ3JlYXRlZCl7XG4gICAgICBjb25zdCB2aWV3SWRzID0gdGhpcy5nZXRWaWV3SWRzRnJvbVVzZU1hcFdpZGdldElkcyh0aGlzLnByb3BzLnVzZU1hcFdpZGdldElkcywgdGhpcy5wcm9wcy52aWV3SW5mb3MpO1xuICAgICAgY29uc3Qgdmlld3MgPSB0aGlzLmdldFZpZXdzKHZpZXdJZHMpO1xuICAgICAgdGhpcy5vblZpZXdzQ3JlYXRlKHZpZXdzKTtcbiAgICAgIHRoaXMub25WaWV3R3JvdXBDcmVhdGUoKTtcbiAgICB9XG5cbiAgICBpZih0aGlzLnByb3BzLm9uQWN0aXZlVmlld0NoYW5nZSAmJiB0aGlzLnN0YXRlLmlzQWN0aXZlVmlld0NyZWF0ZWQpe1xuICAgICAgY29uc3QgYWN0aXZlVmlldyA9ICh0aGlzLnZpZXdNYW5hZ2VyICYmIHRoaXMudmlld01hbmFnZXIuZ2V0SmltdU1hcFZpZXdCeUlkKHRoaXMuc3RhdGUuYWN0aXZlVmlld0lkKSkgfHwgbnVsbDtcbiAgICAgIHRoaXMucHJvcHMub25BY3RpdmVWaWV3Q2hhbmdlKGFjdGl2ZVZpZXcsIG51bGwpO1xuICAgIH1cbiAgfVxuXG4gIGNvbXBvbmVudERpZFVwZGF0ZShwcmV2UHJvcHM6IEppbXVNYXBWaWV3Q29tcG9uZW50UHJvcHMgJiBFeHRyYVByb3BzLCBwcmV2U3RhdGU6IFN0YXRlKXtcbiAgICBpZih0aGlzLnByb3BzLnZpZXdJbmZvcyAhPT0gcHJldlByb3BzLnZpZXdJbmZvcyB8fCB0aGlzLnByb3BzLnVzZU1hcFdpZGdldElkcyAhPT0gcHJldlByb3BzLnVzZU1hcFdpZGdldElkcyl7XG4gICAgICB0aGlzLm9uVmlld0luZm9zQ2hhbmdlKHRoaXMucHJvcHMudmlld0luZm9zLCB0aGlzLnByb3BzLnVzZU1hcFdpZGdldElkcyk7XG4gICAgfVxuXG4gICAgaWYodGhpcy5wcm9wcy5vbkFjdGl2ZVZpZXdDaGFuZ2UgJiYgdGhpcy5zdGF0ZS5pc0FjdGl2ZVZpZXdDcmVhdGVkICYmXG4gICAgICAoXG4gICAgICAgICFwcmV2U3RhdGUuaXNBY3RpdmVWaWV3Q3JlYXRlZCB8fCB0aGlzLnN0YXRlLmFjdGl2ZVZpZXdJZCAhPT0gcHJldlN0YXRlLmFjdGl2ZVZpZXdJZFxuICAgICAgKVxuICAgICl7XG4gICAgICBjb25zdCBhY3RpdmVWaWV3ID0gKHRoaXMudmlld01hbmFnZXIgJiYgdGhpcy52aWV3TWFuYWdlci5nZXRKaW11TWFwVmlld0J5SWQodGhpcy5zdGF0ZS5hY3RpdmVWaWV3SWQpKSB8fCBudWxsO1xuICAgICAgdGhpcy5wcm9wcy5vbkFjdGl2ZVZpZXdDaGFuZ2UoYWN0aXZlVmlldywgcHJldlN0YXRlLmFjdGl2ZVZpZXdJZCk7XG4gICAgfVxuXG4gICAgaWYodGhpcy5vblZpZXdzQ3JlYXRlICYmIHRoaXMuc3RhdGUuYXJlQWxsVmlld3NDcmVhdGVkICYmXG4gICAgICAoXG4gICAgICAgICFwcmV2U3RhdGUuYXJlQWxsVmlld3NDcmVhdGVkIHx8IHRoaXMucHJvcHMudXNlTWFwV2lkZ2V0SWRzICE9PSBwcmV2UHJvcHMudXNlTWFwV2lkZ2V0SWRzXG4gICAgICApXG4gICAgKXtcbiAgICAgIGNvbnN0IHZpZXdJZHMgPSB0aGlzLmdldFZpZXdJZHNGcm9tVXNlTWFwV2lkZ2V0SWRzKHRoaXMucHJvcHMudXNlTWFwV2lkZ2V0SWRzLCB0aGlzLnByb3BzLnZpZXdJbmZvcyk7XG4gICAgICBjb25zdCB2aWV3cyA9IHRoaXMuZ2V0Vmlld3Modmlld0lkcyk7XG4gICAgICB0aGlzLm9uVmlld3NDcmVhdGUodmlld3MpO1xuICAgICAgdGhpcy5vblZpZXdHcm91cENyZWF0ZSgpO1xuICAgIH1cbiAgfVxuXG4gIG9uVmlld0luZm9zQ2hhbmdlID0gKGluZm9zOiBJbW11dGFibGVPYmplY3Q8e1tqaW11TWFwVmlld0lkOiBzdHJpbmddOiBJTUppbXVNYXBWaWV3SW5mb30+LCB1c2VNYXBXaWRnZXRJZHM6IEltbXV0YWJsZUFycmF5PHN0cmluZz4pID0+IHtcbiAgICBpZighaW5mb3Mpe1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGFjdGl2ZVZpZXdJZCA9IHRoaXMuZ2V0QWN0aXZlVmlld0lkKCk7XG4gICAgY29uc3Qgdmlld0lkcyA9IHRoaXMuZ2V0Vmlld0lkc0Zyb21Vc2VNYXBXaWRnZXRJZHModXNlTWFwV2lkZ2V0SWRzLCBpbmZvcyk7XG4gICAgY29uc3QgaXNBY3RpdmVWaWV3Q3JlYXRlZCA9IHRoaXMuZ2V0V2hldGhlclZpZXdDcmVhdGVkKGFjdGl2ZVZpZXdJZCwgaW5mb3MpO1xuICAgIGNvbnN0IGFyZUFsbFZpZXdzQ3JlYXRlZCA9IHRoaXMuZ2V0V2hldGhlckFsbFZpZXdzQ3JlYXRlZCh2aWV3SWRzLCBpbmZvcyk7XG5cbiAgICB0aGlzLnNldFN0YXRlKHthY3RpdmVWaWV3SWQsIGlzQWN0aXZlVmlld0NyZWF0ZWQsIGFyZUFsbFZpZXdzQ3JlYXRlZH0pO1xuICB9XG5cbiAgb25WaWV3c0NyZWF0ZSA9ICh2aWV3czogeyBbdmlld0lkOiBzdHJpbmddOiBKaW11TWFwVmlldyB9KSA9PiB7XG4gICAgaWYodmlld3MgJiYgdGhpcy5zdGF0ZS5hY3RpdmVWaWV3SWQgJiYgT2JqZWN0LmtleXModmlld3MpLnNvbWUodklkID0+IHZJZCA9PT0gdGhpcy5zdGF0ZS5hY3RpdmVWaWV3SWQpKXtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe2lzQWN0aXZlVmlld0NyZWF0ZWQ6IHRydWV9KTtcbiAgICB9XG4gICAgdGhpcy5wcm9wcy5vblZpZXdzQ3JlYXRlICYmIHRoaXMucHJvcHMub25WaWV3c0NyZWF0ZSh2aWV3cyk7XG4gIH1cblxuICBvblZpZXdHcm91cENyZWF0ZSA9ICgpOiB2b2lkID0+IHtcbiAgICBpZiAodGhpcy5wcm9wcy5vblZpZXdHcm91cENyZWF0ZSAmJiB0aGlzLnZpZXdNYW5hZ2VyICYmIHRoaXMucHJvcHMudXNlTWFwV2lkZ2V0SWRzICYmIHRoaXMucHJvcHMudXNlTWFwV2lkZ2V0SWRzWzBdKSB7XG4gICAgICBjb25zdCBqaW11TWFwVmlld0dyb3VwID0gdGhpcy52aWV3TWFuYWdlci5nZXRKaW11TWFwVmlld0dyb3VwKHRoaXMucHJvcHMudXNlTWFwV2lkZ2V0SWRzWzBdKTtcbiAgICAgIHRoaXMucHJvcHMub25WaWV3R3JvdXBDcmVhdGUoamltdU1hcFZpZXdHcm91cCk7XG4gICAgfVxuICB9XG5cbiAgZ2V0QWN0aXZlVmlld0lkID0gKCk6IHN0cmluZyA9PiB7XG4gICAgY29uc3QgbWFwV2lkZ2V0SWQgPSB0aGlzLnByb3BzLnVzZU1hcFdpZGdldElkcyAmJiB0aGlzLnByb3BzLnVzZU1hcFdpZGdldElkc1swXTsgLy8gb25seSBzdXBwb3J0IHRvIHNlbGVjdCBhIHNpbmdsZSBtYXAgd2lkZ2V0IG5vd1xuICAgIGNvbnN0IHZpZXdHcm91cCA9IHRoaXMudmlld01hbmFnZXIuZ2V0SmltdU1hcFZpZXdHcm91cChtYXBXaWRnZXRJZCk7XG4gICAgY29uc3QgYWN0aXZlVmlldyA9IHZpZXdHcm91cCAmJiB2aWV3R3JvdXAuZ2V0QWN0aXZlSmltdU1hcFZpZXcoKTtcbiAgICBjb25zdCBhY3RpdmVWaWV3SWQgPSAoYWN0aXZlVmlldyAmJiBhY3RpdmVWaWV3LmlkKSB8fCBudWxsO1xuXG4gICAgcmV0dXJuIGFjdGl2ZVZpZXdJZDtcbiAgfVxuXG4gIGdldFdoZXRoZXJBbGxWaWV3c0NyZWF0ZWQgPSAodmlld0lkczogc3RyaW5nW10gPSBbXSwgaW5mb3M6IEltbXV0YWJsZU9iamVjdDx7W2ppbXVNYXBWaWV3SWQ6IHN0cmluZ106IElNSmltdU1hcFZpZXdJbmZvfT4pOiBib29sZWFuID0+IHtcbiAgICByZXR1cm4gdmlld0lkcy5sZW5ndGggPiAwICYmICF2aWV3SWRzLnNvbWUodklkID0+ICF0aGlzLmdldFdoZXRoZXJWaWV3Q3JlYXRlZCh2SWQsIGluZm9zKSk7XG4gIH1cblxuICBnZXRXaGV0aGVyVmlld0NyZWF0ZWQgPSAodmlld0lkLCBpbmZvczogSW1tdXRhYmxlT2JqZWN0PHtbamltdU1hcFZpZXdJZDogc3RyaW5nXTogSU1KaW11TWFwVmlld0luZm99Pik6IGJvb2xlYW4gPT4ge1xuICAgIGlmKCF2aWV3SWQpe1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiAhISh2aWV3SWQgJiYgaW5mb3MgJiYgaW5mb3Nbdmlld0lkXSAmJiBpbmZvc1t2aWV3SWRdLnN0YXR1cyAmJiBpbmZvc1t2aWV3SWRdLnN0YXR1cyA9PT0gSmltdU1hcFZpZXdTdGF0dXMuTG9hZGVkKTtcbiAgfVxuXG4gIGdldFZpZXdJZHNGcm9tVXNlTWFwV2lkZ2V0SWRzID0gKHVzZU1hcFdpZGdldElkczogSW1tdXRhYmxlQXJyYXk8c3RyaW5nPiwgaW5mb3M6IEltbXV0YWJsZU9iamVjdDx7W2ppbXVNYXBWaWV3SWQ6IHN0cmluZ106IElNSmltdU1hcFZpZXdJbmZvfT4pOiBzdHJpbmdbXSA9PiB7XG4gICAgbGV0IHZpZXdJZHMgPSBbXTtcblxuICAgIGlmKHVzZU1hcFdpZGdldElkcyl7XG4gICAgICB1c2VNYXBXaWRnZXRJZHMuZm9yRWFjaCh3SWQgPT4ge1xuICAgICAgICB2aWV3SWRzID0gdmlld0lkcy5jb25jYXQodGhpcy5nZXRWaWV3SWRzRnJvbU1hcFdpZGdldElkKHdJZCwgaW5mb3MpKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiB2aWV3SWRzO1xuICB9XG5cbiAgZ2V0Vmlld0lkc0Zyb21NYXBXaWRnZXRJZCA9IChtYXBXaWRnZXRJZDogc3RyaW5nLCBpbmZvczogSW1tdXRhYmxlT2JqZWN0PHtbamltdU1hcFZpZXdJZDogc3RyaW5nXTogSU1KaW11TWFwVmlld0luZm99Pik6IHN0cmluZ1tdID0+IHtcbiAgICByZXR1cm4gaW5mb3MgPyBPYmplY3Qua2V5cyhpbmZvcykuZmlsdGVyKHZpZXdJZCA9PiBpbmZvc1t2aWV3SWRdLm1hcFdpZGdldElkID09PSBtYXBXaWRnZXRJZCkgOiBbXTtcbiAgfVxuXG4gIGdldFZpZXdzID0gKHZpZXdJZHM6IHN0cmluZ1tdKTogeyBbdmlld0lkOiBzdHJpbmddOiBKaW11TWFwVmlldyB9ID0+IHtcbiAgICBpZighdmlld0lkcyl7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCB2aWV3czogeyBbdmlld0lkOiBzdHJpbmddOiBKaW11TWFwVmlldyB9ID0ge307XG4gICAgdmlld0lkcy5mb3JFYWNoKHZJZCA9PiB7XG4gICAgICB2aWV3c1t2SWRdID0gdGhpcy52aWV3TWFuYWdlci5nZXRKaW11TWFwVmlld0J5SWQodklkKTtcbiAgICB9KTtcblxuICAgIHJldHVybiB2aWV3cztcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBpZighdGhpcy5wcm9wcy51c2VNYXBXaWRnZXRJZHMgfHwgIXRoaXMucHJvcHMudmlld0luZm9zIHx8ICF0aGlzLnByb3BzLmNoaWxkcmVuKXtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IHZpZXdJZHMgPSB0aGlzLmdldFZpZXdJZHNGcm9tVXNlTWFwV2lkZ2V0SWRzKHRoaXMucHJvcHMudXNlTWFwV2lkZ2V0SWRzLCB0aGlzLnByb3BzLnZpZXdJbmZvcyk7XG4gICAgY29uc3Qgdmlld3MgPSB0aGlzLmdldFZpZXdzKHZpZXdJZHMpO1xuXG4gICAgcmV0dXJuIHR5cGVvZiB0aGlzLnByb3BzLmNoaWxkcmVuID09PSAnZnVuY3Rpb24nID9cbiAgICAgICh0aGlzLnByb3BzLmNoaWxkcmVuIGFzIFZpZXdSZW5kZXJGdW5jdGlvbikodmlld3MpIDogdGhpcy5wcm9wcy5jaGlsZHJlbjtcbiAgfVxufVxuXG5jb25zdCBtYXBTdGF0ZVRvUHJvcHMgPSAoc3RhdGU6IElNU3RhdGUsIG93blByb3BzOiBKaW11TWFwVmlld0NvbXBvbmVudFByb3BzKTogRXh0cmFQcm9wcyA9PiB7XG4gIGlmIChzdGF0ZS5hcHBTdGF0ZUluQnVpbGRlcikge1xuICAgIGNvbnN0IGppbXVNYXBWaWV3c0luZm8gPSBzdGF0ZS5hcHBTdGF0ZUluQnVpbGRlciAmJiBzdGF0ZS5hcHBTdGF0ZUluQnVpbGRlci5qaW11TWFwVmlld3NJbmZvO1xuICAgIHJldHVybiB7XG4gICAgICB2aWV3SW5mb3M6IGppbXVNYXBWaWV3c0luZm9cbiAgICB9O1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IGppbXVNYXBWaWV3c0luZm8gPSBzdGF0ZSAmJiBzdGF0ZS5qaW11TWFwVmlld3NJbmZvO1xuICAgIHJldHVybiB7XG4gICAgICB2aWV3SW5mb3M6IGppbXVNYXBWaWV3c0luZm9cbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogQSByZWFjdCBjb21wb25lbnQgdGhhdCBtYWtlcyBpdCBlYXN5IHRvIHVzZSBKaW11TWFwVmlldyBmcm9tIHRoZSBtYXAgd2lkZ2V0LlxuICogSW4gbW9zdCBjYXNlcywgeW91IGNhbiBwYXNzIG9uIGB1c2VNYXBXaWRnZXRJZHNgLCBhbmQgdXNlIGBvblZpZXdzQ3JlYXRlYCwgYG9uQWN0aXZlVmlld0NoYW5nZWAgdG8gZ2V0IGNhbGxiYWNrIGZyb20gdGhlIEppbXVNYXBWaWV3Q29tcG9uZW50LlxuICovXG5leHBvcnQgY29uc3QgSmltdU1hcFZpZXdDb21wb25lbnQgPSBSZWFjdFJlZHV4LmNvbm5lY3Q8RXh0cmFQcm9wcywgdW5rbm93biwgSmltdU1hcFZpZXdDb21wb25lbnRQcm9wcz4obWFwU3RhdGVUb1Byb3BzKShfSmltdU1hcFZpZXdDb21wb25lbnQpO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUVBO0FBK0NBO0FBQUE7QUFHQTtBQUFBO0FBRkE7QUFzREE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUEzSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBOEVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7OztBQUdBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./jimu-arcgis/lib/components/jimu-map-view-component.tsx\n");

/***/ }),

/***/ "./jimu-arcgis/lib/data-sources/arcgis-data-source-interface.ts":
/*!**********************************************************************!*\
  !*** ./jimu-arcgis/lib/data-sources/arcgis-data-source-interface.ts ***!
  \**********************************************************************/
/*! exports provided: DataSourceTypes, LayerTypes, FeatureLayerDataSource, FeatureDataRecord, ArcGISDataSourceTypes */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DataSourceTypes\", function() { return DataSourceTypes; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LayerTypes\", function() { return LayerTypes; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ArcGISDataSourceTypes\", function() { return DataSourceTypes; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"FeatureLayerDataSource\", function() { return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"FeatureLayerDataSource\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"FeatureDataRecord\", function() { return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"FeatureDataRecord\"]; });\n\n\nvar DataSourceTypes;\n(function (DataSourceTypes) {\n    DataSourceTypes[\"Map\"] = \"MAP\";\n    DataSourceTypes[\"WebMap\"] = \"WEB_MAP\";\n    DataSourceTypes[\"WebScene\"] = \"WEB_SCENE\";\n})(DataSourceTypes || (DataSourceTypes = {}));\nvar LayerTypes;\n(function (LayerTypes) {\n    LayerTypes[\"BaseDynamicLayer\"] = \"base-dynamic\";\n    LayerTypes[\"BaseElevationLayer\"] = \"base-elevation\";\n    LayerTypes[\"BaseTileLayer\"] = \"base-tile\";\n    LayerTypes[\"BuildingSceneLayer\"] = \"building-scene\";\n    LayerTypes[\"CSVLayer\"] = \"csv\";\n    LayerTypes[\"ElevationLayer\"] = \"elevation\";\n    LayerTypes[\"FeatureLayer\"] = \"feature\";\n    LayerTypes[\"GeoJSONLayer\"] = \"geojson\";\n    LayerTypes[\"GeoRSSLayer\"] = \"geo-rss\";\n    LayerTypes[\"GraphicsLayer\"] = \"graphics\";\n    LayerTypes[\"GroupLayer\"] = \"group\";\n    LayerTypes[\"ImageryLayer\"] = \"imagery\";\n    LayerTypes[\"IntegratedMeshLayer\"] = \"integrated-mesh\";\n    LayerTypes[\"KMLLayer\"] = \"kml\";\n    LayerTypes[\"MapImageLayer\"] = \"map-image\";\n    LayerTypes[\"MapNotesLayer\"] = \"map-notes\";\n    LayerTypes[\"PointCloudLayer\"] = \"point-cloud\";\n    LayerTypes[\"SceneLayer\"] = \"scene\";\n    LayerTypes[\"TileLayer\"] = \"tile\";\n    LayerTypes[\"UnknownLayer\"] = \"unknown\";\n    LayerTypes[\"UnsupportedLayer\"] = \"unsupported\";\n    LayerTypes[\"VectorTileLayer\"] = \"vector-tile\";\n    LayerTypes[\"WMSLayer\"] = \"wms\";\n    LayerTypes[\"WMTSLayer\"] = \"wmts\";\n    LayerTypes[\"WebTileLayer\"] = \"web-tile\";\n})(LayerTypes || (LayerTypes = {}));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9saWIvZGF0YS1zb3VyY2VzL2FyY2dpcy1kYXRhLXNvdXJjZS1pbnRlcmZhY2UudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qaW11LWFyY2dpcy9saWIvZGF0YS1zb3VyY2VzL2FyY2dpcy1kYXRhLXNvdXJjZS1pbnRlcmZhY2UudHM/MDA2YiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJTURhdGFTb3VyY2VTY2hlbWEsIERhdGFTb3VyY2UsIEZlYXR1cmVMYXllckRhdGFTb3VyY2UsIE1hcFNlcnZpY2VEYXRhU291cmNlLCBGZWF0dXJlRGF0YVJlY29yZCwgR3JvdXBMYXllckRhdGFTb3VyY2UsXG4gIFNjZW5lTGF5ZXJEYXRhU291cmNlIH0gZnJvbSAnamltdS1jb3JlJztcblxuZXhwb3J0IGVudW0gRGF0YVNvdXJjZVR5cGVze1xuICBNYXAgPSAnTUFQJyxcbiAgV2ViTWFwID0gJ1dFQl9NQVAnLFxuICBXZWJTY2VuZSA9ICdXRUJfU0NFTkUnLFxufVxuXG5leHBvcnQgZW51bSBMYXllclR5cGVze1xuICBCYXNlRHluYW1pY0xheWVyID0gJ2Jhc2UtZHluYW1pYycsXG4gIEJhc2VFbGV2YXRpb25MYXllciA9ICdiYXNlLWVsZXZhdGlvbicsXG4gIEJhc2VUaWxlTGF5ZXIgPSAnYmFzZS10aWxlJyxcbiAgQnVpbGRpbmdTY2VuZUxheWVyID0gJ2J1aWxkaW5nLXNjZW5lJyxcbiAgQ1NWTGF5ZXIgPSAnY3N2JyxcbiAgRWxldmF0aW9uTGF5ZXIgPSAnZWxldmF0aW9uJyxcbiAgRmVhdHVyZUxheWVyID0gJ2ZlYXR1cmUnLFxuICBHZW9KU09OTGF5ZXIgPSAnZ2VvanNvbicsXG4gIEdlb1JTU0xheWVyID0gJ2dlby1yc3MnLFxuICBHcmFwaGljc0xheWVyID0gJ2dyYXBoaWNzJyxcbiAgR3JvdXBMYXllciA9ICdncm91cCcsXG4gIEltYWdlcnlMYXllciA9ICdpbWFnZXJ5JyxcbiAgSW50ZWdyYXRlZE1lc2hMYXllciA9ICdpbnRlZ3JhdGVkLW1lc2gnLFxuICBLTUxMYXllciA9ICdrbWwnLFxuICBNYXBJbWFnZUxheWVyID0gJ21hcC1pbWFnZScsXG4gIE1hcE5vdGVzTGF5ZXIgPSAnbWFwLW5vdGVzJyxcbiAgUG9pbnRDbG91ZExheWVyID0gJ3BvaW50LWNsb3VkJyxcbiAgU2NlbmVMYXllciA9ICdzY2VuZScsXG4gIFRpbGVMYXllciA9ICd0aWxlJyxcbiAgVW5rbm93bkxheWVyID0gJ3Vua25vd24nLFxuICBVbnN1cHBvcnRlZExheWVyID0gJ3Vuc3VwcG9ydGVkJyxcbiAgVmVjdG9yVGlsZUxheWVyID0gJ3ZlY3Rvci10aWxlJyxcbiAgV01TTGF5ZXIgPSAnd21zJyxcbiAgV01UU0xheWVyID0gJ3dtdHMnLFxuICBXZWJUaWxlTGF5ZXIgPSAnd2ViLXRpbGUnXG59XG5cbmV4cG9ydCB0eXBlIE1hcENoaWxkRGF0YVNvdXJjZSA9IEZlYXR1cmVMYXllckRhdGFTb3VyY2UgfCBNYXBTZXJ2aWNlRGF0YVNvdXJjZSB8IEdyb3VwTGF5ZXJEYXRhU291cmNlIHwgU2NlbmVMYXllckRhdGFTb3VyY2U7XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWFwRGF0YVNvdXJjZSBleHRlbmRzIERhdGFTb3VyY2V7XG4gIHR5cGU6IERhdGFTb3VyY2VUeXBlcy5NYXAgfCBEYXRhU291cmNlVHlwZXMuV2ViTWFwIHwgRGF0YVNvdXJjZVR5cGVzLldlYlNjZW5lO1xuICBtYXA6IF9fZXNyaS5NYXA7XG4gIHJlYWR5OiAoKSA9PiBQcm9taXNlPE1hcENoaWxkRGF0YVNvdXJjZVtdPjtcbiAgZmV0Y2hTY2hlbWE6ICgpID0+IFByb21pc2U8SU1EYXRhU291cmNlU2NoZW1hPjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBXZWJNYXBEYXRhU291cmNlIGV4dGVuZHMgTWFwRGF0YVNvdXJjZXtcbiAgdHlwZTogRGF0YVNvdXJjZVR5cGVzLldlYk1hcDtcbiAgbWFwOiBfX2VzcmkuV2ViTWFwO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFdlYlNjZW5lRGF0YVNvdXJjZSBleHRlbmRzIE1hcERhdGFTb3VyY2V7XG4gIHR5cGU6IERhdGFTb3VyY2VUeXBlcy5XZWJTY2VuZTtcbiAgbWFwOiBfX2VzcmkuV2ViU2NlbmU7XG59XG5cbmV4cG9ydCB7IEZlYXR1cmVMYXllckRhdGFTb3VyY2UsIEZlYXR1cmVEYXRhUmVjb3JkLCBEYXRhU291cmNlVHlwZXMgYXMgQXJjR0lTRGF0YVNvdXJjZVR5cGVzIH07XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQXFCQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./jimu-arcgis/lib/data-sources/arcgis-data-source-interface.ts\n");

/***/ }),

/***/ "./jimu-arcgis/lib/extensions/dependency-extension.ts":
/*!************************************************************!*\
  !*** ./jimu-arcgis/lib/extensions/dependency-extension.ts ***!
  \************************************************************/
/*! exports provided: ArcGISDependencyDefineExtension, ArcGISDataSourceFactoryUriExtension */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ArcGISDependencyDefineExtension\", function() { return ArcGISDependencyDefineExtension; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ArcGISDataSourceFactoryUriExtension\", function() { return ArcGISDataSourceFactoryUriExtension; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../data-sources/arcgis-data-source-interface */ \"./jimu-arcgis/lib/data-sources/arcgis-data-source-interface.ts\");\n\n\nvar ArcGISDependencyDefineExtension = /** @class */ (function () {\n    function ArcGISDependencyDefineExtension() {\n        this.id = 'arcgis-dependency-define';\n    }\n    ArcGISDependencyDefineExtension.prototype.getDependencyKey = function () {\n        return 'jimu-arcgis';\n    };\n    ArcGISDependencyDefineExtension.prototype.getResources = function () {\n        var apiUrl = window.jimuConfig.arcgisJsApiUrl;\n        if (Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().queryObject.apiurl) {\n            apiUrl = Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().queryObject.apiurl;\n            if (!this.checkApiUrl(apiUrl)) {\n                console.log('Bad apiurl.', apiUrl);\n                return;\n            }\n        }\n        if (!/\\/$/.test(apiUrl)) {\n            apiUrl = apiUrl + '/';\n        }\n        window.dojoConfig = {\n            baseUrl: jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"urlUtils\"].getFixedRootPath(),\n            parseOnLoad: false,\n            async: true,\n            tlmSiblingOfDojo: false,\n            has: {\n                'esri-featurelayer-webgl': 1,\n                /**\n                 * we disable these 2 features because they will cause `dojo/dojo.js` to look for the script that the `src` ends with `dojo.js`,\n                 * however, the dojo is loaded by systemjs, but systemjs delete the dojo script after load it, so we disable them.\n                 *\n                 * See `dojo/dojo.js`, line 692 - 717\n                 */\n                'dojo-sniff': 0,\n                'dojo-cdn': 0\n            },\n            locale: window.locale\n        };\n        window.dojoConfig.packages = [\n            //packages for arcgis js api\n            {\n                name: 'dojo',\n                location: apiUrl + 'dojo'\n            }, {\n                name: 'dijit',\n                location: apiUrl + 'dijit'\n            }, {\n                name: 'dojox',\n                location: apiUrl + 'dojox'\n            }, {\n                name: 'dgrid',\n                location: apiUrl + 'dgrid'\n            }, {\n                name: 'esri',\n                location: apiUrl + 'esri'\n            }, {\n                name: 'moment',\n                location: apiUrl + 'moment'\n            }, {\n                name: 'whatwg-fetch',\n                location: apiUrl + 'whatwg-fetch',\n                main: 'dist/fetch.umd'\n            }\n        ];\n        if (/src\\/$/.test(apiUrl)) { //means source code version\n            window.dojoConfig.packages = window.dojoConfig.packages.concat([\n                {\n                    name: '@dojo',\n                    location: apiUrl + 'node_modules/@dojo'\n                }, {\n                    name: 'tslib',\n                    location: apiUrl + 'node_modules/tslib',\n                    main: 'tslib'\n                }, {\n                    name: 'cldrjs',\n                    location: apiUrl + 'node_modules/cldrjs',\n                    main: 'dist/cldr'\n                }, {\n                    name: 'globalize',\n                    location: apiUrl + 'node_modules/globalize',\n                    main: 'dist/globalize'\n                }, {\n                    name: 'maquette',\n                    location: apiUrl + 'node_modules/maquette',\n                    main: 'dist/maquette.umd'\n                }, {\n                    name: 'maquette-jsx',\n                    location: apiUrl + 'node_modules/maquette-jsx',\n                    main: 'dist/maquette-jsx.umd'\n                }, {\n                    name: 'maquette-css-transitions',\n                    location: apiUrl + 'node_modules/maquette-css-transitions',\n                    main: 'dist/maquette-css-transitions.umd'\n                }\n            ]);\n        }\n        else {\n            window.dojoConfig.packages = window.dojoConfig.packages.concat([\n                {\n                    name: '@dojo',\n                    location: apiUrl + '@dojo'\n                }, {\n                    name: 'tslib',\n                    location: apiUrl + 'tslib',\n                    main: 'tslib'\n                }, {\n                    name: 'cldrjs',\n                    location: apiUrl + 'cldrjs',\n                    main: 'dist/cldr'\n                }, {\n                    name: 'globalize',\n                    location: apiUrl + 'globalize',\n                    main: 'dist/globalize'\n                }, {\n                    name: 'maquette',\n                    location: apiUrl + 'maquette',\n                    main: 'dist/maquette.umd'\n                }, {\n                    name: 'maquette-jsx',\n                    location: apiUrl + 'maquette-jsx',\n                    main: 'dist/maquette-jsx.umd'\n                }, {\n                    name: 'maquette-css-transitions',\n                    location: apiUrl + 'maquette-css-transitions',\n                    main: 'dist/maquette-css-transitions.umd'\n                }\n            ]);\n        }\n        return [{\n                url: 'jimu-arcgis',\n                dependencies: [{\n                        url: apiUrl + \"dojo/dojo.js\",\n                    }, {\n                        url: apiUrl + \"esri/css/main.css\"\n                    }]\n            }];\n    };\n    ArcGISDependencyDefineExtension.prototype.checkApiUrl = function (url) {\n        if (window.env === 'development') {\n            return true;\n        }\n        if (/^\\/\\//.test(url) || /^https?:\\/\\//.test(url)) {\n            return /(?:[\\w\\-\\_]+\\.)+(?:esri|arcgis)\\.com/.test(url); //api url must be in esri.com or arcgis.com\n        }\n        else {\n            return true;\n        }\n    };\n    return ArcGISDependencyDefineExtension;\n}());\n\nvar ArcGISDataSourceFactoryUriExtension = /** @class */ (function () {\n    function ArcGISDataSourceFactoryUriExtension() {\n        this.id = 'arcgis-ds-factory';\n    }\n    ArcGISDataSourceFactoryUriExtension.prototype.getFactoryUri = function (dataSourceType) {\n        if (Object.keys(_data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"ArcGISDataSourceTypes\"]).map(function (t) { return _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"ArcGISDataSourceTypes\"][t]; }).indexOf(dataSourceType) > -1) {\n            return 'jimu-arcgis/arcgis-data-source';\n        }\n    };\n    return ArcGISDataSourceFactoryUriExtension;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9saWIvZXh0ZW5zaW9ucy9kZXBlbmRlbmN5LWV4dGVuc2lvbi50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtYXJjZ2lzL2xpYi9leHRlbnNpb25zL2RlcGVuZGVuY3ktZXh0ZW5zaW9uLnRzP2M3ODEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtleHRlbnNpb25TcGVjLCBnZXRBcHBTdG9yZSwgdXJsVXRpbHMsIFJlc291cmNlfSBmcm9tICdqaW11LWNvcmUnO1xuaW1wb3J0IHtBcmNHSVNEYXRhU291cmNlVHlwZXN9IGZyb20gJy4uL2RhdGEtc291cmNlcy9hcmNnaXMtZGF0YS1zb3VyY2UtaW50ZXJmYWNlJztcblxuZGVjbGFyZSBnbG9iYWx7XG4gIGludGVyZmFjZSBXaW5kb3d7XG4gICAgZG9qb0NvbmZpZzogYW55O1xuICB9XG59XG5leHBvcnQgY2xhc3MgQXJjR0lTRGVwZW5kZW5jeURlZmluZUV4dGVuc2lvbiBpbXBsZW1lbnRzIGV4dGVuc2lvblNwZWMuRGVwZW5kZW5jeURlZmluZXtcbiAgaWQgPSAnYXJjZ2lzLWRlcGVuZGVuY3ktZGVmaW5lJztcblxuICBnZXREZXBlbmRlbmN5S2V5KCl7XG4gICAgcmV0dXJuICdqaW11LWFyY2dpcyc7XG4gIH1cblxuICBnZXRSZXNvdXJjZXMoKTogUmVzb3VyY2VbXXtcbiAgICBsZXQgYXBpVXJsID0gd2luZG93LmppbXVDb25maWcuYXJjZ2lzSnNBcGlVcmw7XG4gICAgaWYoZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLnF1ZXJ5T2JqZWN0LmFwaXVybCl7XG4gICAgICBhcGlVcmwgPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkucXVlcnlPYmplY3QuYXBpdXJsO1xuICAgICAgaWYoIXRoaXMuY2hlY2tBcGlVcmwoYXBpVXJsKSl7XG4gICAgICAgIGNvbnNvbGUubG9nKCdCYWQgYXBpdXJsLicsIGFwaVVybCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYoIS9cXC8kLy50ZXN0KGFwaVVybCkpe1xuICAgICAgYXBpVXJsID0gYXBpVXJsICsgJy8nO1xuICAgIH1cblxuICAgIHdpbmRvdy5kb2pvQ29uZmlnID0ge1xuICAgICAgYmFzZVVybDogdXJsVXRpbHMuZ2V0Rml4ZWRSb290UGF0aCgpLFxuICAgICAgcGFyc2VPbkxvYWQ6IGZhbHNlLFxuICAgICAgYXN5bmM6IHRydWUsXG4gICAgICB0bG1TaWJsaW5nT2ZEb2pvOiBmYWxzZSxcbiAgICAgIGhhczoge1xuICAgICAgICAnZXNyaS1mZWF0dXJlbGF5ZXItd2ViZ2wnOiAxLFxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiB3ZSBkaXNhYmxlIHRoZXNlIDIgZmVhdHVyZXMgYmVjYXVzZSB0aGV5IHdpbGwgY2F1c2UgYGRvam8vZG9qby5qc2AgdG8gbG9vayBmb3IgdGhlIHNjcmlwdCB0aGF0IHRoZSBgc3JjYCBlbmRzIHdpdGggYGRvam8uanNgLFxuICAgICAgICAgKiBob3dldmVyLCB0aGUgZG9qbyBpcyBsb2FkZWQgYnkgc3lzdGVtanMsIGJ1dCBzeXN0ZW1qcyBkZWxldGUgdGhlIGRvam8gc2NyaXB0IGFmdGVyIGxvYWQgaXQsIHNvIHdlIGRpc2FibGUgdGhlbS5cbiAgICAgICAgICpcbiAgICAgICAgICogU2VlIGBkb2pvL2Rvam8uanNgLCBsaW5lIDY5MiAtIDcxN1xuICAgICAgICAgKi9cbiAgICAgICAgJ2Rvam8tc25pZmYnOiAwLFxuICAgICAgICAnZG9qby1jZG4nOiAwXG4gICAgICB9LFxuICAgICAgbG9jYWxlOiB3aW5kb3cubG9jYWxlXG4gICAgfTtcblxuICAgIHdpbmRvdy5kb2pvQ29uZmlnLnBhY2thZ2VzID0gW1xuICAgICAgLy9wYWNrYWdlcyBmb3IgYXJjZ2lzIGpzIGFwaVxuICAgICAge1xuICAgICAgICBuYW1lOiAnZG9qbycsXG4gICAgICAgIGxvY2F0aW9uOiBhcGlVcmwgKyAnZG9qbydcbiAgICAgIH0sIHtcbiAgICAgICAgbmFtZTogJ2Rpaml0JyxcbiAgICAgICAgbG9jYXRpb246IGFwaVVybCArICdkaWppdCdcbiAgICAgIH0sIHtcbiAgICAgICAgbmFtZTogJ2Rvam94JyxcbiAgICAgICAgbG9jYXRpb246IGFwaVVybCArICdkb2pveCdcbiAgICAgIH0sIHtcbiAgICAgICAgbmFtZTogJ2RncmlkJyxcbiAgICAgICAgbG9jYXRpb246IGFwaVVybCArICdkZ3JpZCdcbiAgICAgIH0sIHtcbiAgICAgICAgbmFtZTogJ2VzcmknLFxuICAgICAgICBsb2NhdGlvbjogYXBpVXJsICsgJ2VzcmknXG4gICAgICB9LCB7XG4gICAgICAgIG5hbWU6ICdtb21lbnQnLFxuICAgICAgICBsb2NhdGlvbjogYXBpVXJsICsgJ21vbWVudCdcbiAgICAgIH0sIHtcbiAgICAgICAgbmFtZTogJ3doYXR3Zy1mZXRjaCcsXG4gICAgICAgIGxvY2F0aW9uOiBhcGlVcmwgKyAnd2hhdHdnLWZldGNoJyxcbiAgICAgICAgbWFpbjogJ2Rpc3QvZmV0Y2gudW1kJ1xuICAgICAgfVxuICAgIF07XG5cbiAgICBpZigvc3JjXFwvJC8udGVzdChhcGlVcmwpKXsvL21lYW5zIHNvdXJjZSBjb2RlIHZlcnNpb25cbiAgICAgIHdpbmRvdy5kb2pvQ29uZmlnLnBhY2thZ2VzID0gd2luZG93LmRvam9Db25maWcucGFja2FnZXMuY29uY2F0KFtcbiAgICAgICAge1xuICAgICAgICAgIG5hbWU6ICdAZG9qbycsXG4gICAgICAgICAgbG9jYXRpb246IGFwaVVybCArICdub2RlX21vZHVsZXMvQGRvam8nXG4gICAgICAgIH0sIHtcbiAgICAgICAgICBuYW1lOiAndHNsaWInLFxuICAgICAgICAgIGxvY2F0aW9uOiBhcGlVcmwgKyAnbm9kZV9tb2R1bGVzL3RzbGliJyxcbiAgICAgICAgICBtYWluOiAndHNsaWInXG4gICAgICAgIH0sIHtcbiAgICAgICAgICBuYW1lOiAnY2xkcmpzJyxcbiAgICAgICAgICBsb2NhdGlvbjogYXBpVXJsICsgJ25vZGVfbW9kdWxlcy9jbGRyanMnLFxuICAgICAgICAgIG1haW46ICdkaXN0L2NsZHInXG4gICAgICAgIH0sIHtcbiAgICAgICAgICBuYW1lOiAnZ2xvYmFsaXplJyxcbiAgICAgICAgICBsb2NhdGlvbjogYXBpVXJsICsgJ25vZGVfbW9kdWxlcy9nbG9iYWxpemUnLFxuICAgICAgICAgIG1haW46ICdkaXN0L2dsb2JhbGl6ZSdcbiAgICAgICAgfSwge1xuICAgICAgICAgIG5hbWU6ICdtYXF1ZXR0ZScsXG4gICAgICAgICAgbG9jYXRpb246IGFwaVVybCArICdub2RlX21vZHVsZXMvbWFxdWV0dGUnLFxuICAgICAgICAgIG1haW46ICdkaXN0L21hcXVldHRlLnVtZCdcbiAgICAgICAgfSwge1xuICAgICAgICAgIG5hbWU6ICdtYXF1ZXR0ZS1qc3gnLFxuICAgICAgICAgIGxvY2F0aW9uOiBhcGlVcmwgKyAnbm9kZV9tb2R1bGVzL21hcXVldHRlLWpzeCcsXG4gICAgICAgICAgbWFpbjogJ2Rpc3QvbWFxdWV0dGUtanN4LnVtZCdcbiAgICAgICAgfSwge1xuICAgICAgICAgIG5hbWU6ICdtYXF1ZXR0ZS1jc3MtdHJhbnNpdGlvbnMnLFxuICAgICAgICAgIGxvY2F0aW9uOiBhcGlVcmwgKyAnbm9kZV9tb2R1bGVzL21hcXVldHRlLWNzcy10cmFuc2l0aW9ucycsXG4gICAgICAgICAgbWFpbjogJ2Rpc3QvbWFxdWV0dGUtY3NzLXRyYW5zaXRpb25zLnVtZCdcbiAgICAgICAgfVxuICAgICAgXSlcbiAgICB9ZWxzZXtcbiAgICAgIHdpbmRvdy5kb2pvQ29uZmlnLnBhY2thZ2VzID0gd2luZG93LmRvam9Db25maWcucGFja2FnZXMuY29uY2F0KFtcbiAgICAgICAge1xuICAgICAgICAgIG5hbWU6ICdAZG9qbycsXG4gICAgICAgICAgbG9jYXRpb246IGFwaVVybCArICdAZG9qbydcbiAgICAgICAgfSwge1xuICAgICAgICAgIG5hbWU6ICd0c2xpYicsXG4gICAgICAgICAgbG9jYXRpb246IGFwaVVybCArICd0c2xpYicsXG4gICAgICAgICAgbWFpbjogJ3RzbGliJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgbmFtZTogJ2NsZHJqcycsXG4gICAgICAgICAgbG9jYXRpb246IGFwaVVybCArICdjbGRyanMnLFxuICAgICAgICAgIG1haW46ICdkaXN0L2NsZHInXG4gICAgICAgIH0sIHtcbiAgICAgICAgICBuYW1lOiAnZ2xvYmFsaXplJyxcbiAgICAgICAgICBsb2NhdGlvbjogYXBpVXJsICsgJ2dsb2JhbGl6ZScsXG4gICAgICAgICAgbWFpbjogJ2Rpc3QvZ2xvYmFsaXplJ1xuICAgICAgICB9LCB7XG4gICAgICAgICAgbmFtZTogJ21hcXVldHRlJyxcbiAgICAgICAgICBsb2NhdGlvbjogYXBpVXJsICsgJ21hcXVldHRlJyxcbiAgICAgICAgICBtYWluOiAnZGlzdC9tYXF1ZXR0ZS51bWQnXG4gICAgICAgIH0sIHtcbiAgICAgICAgICBuYW1lOiAnbWFxdWV0dGUtanN4JyxcbiAgICAgICAgICBsb2NhdGlvbjogYXBpVXJsICsgJ21hcXVldHRlLWpzeCcsXG4gICAgICAgICAgbWFpbjogJ2Rpc3QvbWFxdWV0dGUtanN4LnVtZCdcbiAgICAgICAgfSwge1xuICAgICAgICAgIG5hbWU6ICdtYXF1ZXR0ZS1jc3MtdHJhbnNpdGlvbnMnLFxuICAgICAgICAgIGxvY2F0aW9uOiBhcGlVcmwgKyAnbWFxdWV0dGUtY3NzLXRyYW5zaXRpb25zJyxcbiAgICAgICAgICBtYWluOiAnZGlzdC9tYXF1ZXR0ZS1jc3MtdHJhbnNpdGlvbnMudW1kJ1xuICAgICAgICB9XG4gICAgICBdKVxuICAgIH1cblxuICAgIHJldHVybiBbe1xuICAgICAgdXJsOiAnamltdS1hcmNnaXMnLFxuICAgICAgZGVwZW5kZW5jaWVzOiBbe1xuICAgICAgICB1cmw6IGAke2FwaVVybH1kb2pvL2Rvam8uanNgLFxuICAgICAgfSwge1xuICAgICAgICB1cmw6IGAke2FwaVVybH1lc3JpL2Nzcy9tYWluLmNzc2BcbiAgICAgIH1dXG4gICAgfV07XG4gIH1cblxuICBwcml2YXRlIGNoZWNrQXBpVXJsKHVybDogc3RyaW5nKTogYm9vbGVhbntcbiAgICBpZih3aW5kb3cuZW52ID09PSAnZGV2ZWxvcG1lbnQnKXtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBpZigvXlxcL1xcLy8udGVzdCh1cmwpIHx8IC9eaHR0cHM/OlxcL1xcLy8udGVzdCh1cmwpKXtcbiAgICAgIHJldHVybiAvKD86W1xcd1xcLVxcX10rXFwuKSsoPzplc3JpfGFyY2dpcylcXC5jb20vLnRlc3QodXJsKTsgLy9hcGkgdXJsIG11c3QgYmUgaW4gZXNyaS5jb20gb3IgYXJjZ2lzLmNvbVxuICAgIH1lbHNle1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBBcmNHSVNEYXRhU291cmNlRmFjdG9yeVVyaUV4dGVuc2lvbiBpbXBsZW1lbnRzIGV4dGVuc2lvblNwZWMuRGF0YVNvdXJjZUZhY3RvcnlVcml7XG4gIGlkID0gJ2FyY2dpcy1kcy1mYWN0b3J5JztcblxuICBnZXRGYWN0b3J5VXJpKGRhdGFTb3VyY2VUeXBlKTogc3RyaW5ne1xuICAgIGlmKE9iamVjdC5rZXlzKEFyY0dJU0RhdGFTb3VyY2VUeXBlcykubWFwKHQgPT4gQXJjR0lTRGF0YVNvdXJjZVR5cGVzW3RdKS5pbmRleE9mKGRhdGFTb3VyY2VUeXBlKSA+IC0xKXtcbiAgICAgIHJldHVybiAnamltdS1hcmNnaXMvYXJjZ2lzLWRhdGEtc291cmNlJztcbiAgICB9XG4gIH1cbn0iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFPQTtBQUFBO0FBQ0E7QUFzSkE7QUFwSkE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTs7QUFFQTtBQUFBO0FBQ0E7QUFPQTtBQUxBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBOzsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./jimu-arcgis/lib/extensions/dependency-extension.ts\n");

/***/ }),

/***/ "./jimu-arcgis/lib/init.ts":
/*!*********************************!*\
  !*** ./jimu-arcgis/lib/init.ts ***!
  \*********************************/
/*! exports provided: init */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"init\", function() { return init; });\nfunction init() {\n    return Promise.resolve();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9saWIvaW5pdC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtYXJjZ2lzL2xpYi9pbml0LnRzPzlkMmQiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIGluaXQoKTogUHJvbWlzZTxhbnk+IHtcbiAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xufSJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./jimu-arcgis/lib/init.ts\n");

/***/ }),

/***/ "./jimu-arcgis/lib/mapview-manager.tsx":
/*!*********************************************!*\
  !*** ./jimu-arcgis/lib/mapview-manager.tsx ***!
  \*********************************************/
/*! exports provided: MapViewManager */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MapViewManager\", function() { return MapViewManager; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _views_jimu_map_view__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./views/jimu-map-view */ \"./jimu-arcgis/lib/views/jimu-map-view.ts\");\n/* harmony import */ var _views_jimu_map_view_group__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./views/jimu-map-view-group */ \"./jimu-arcgis/lib/views/jimu-map-view-group.ts\");\n\n\n\n/**\n * The `MapViewManager` is used to manage jimumapview, including create/get/set/destroy jimumapview instance.\n * Please always use `MapViewManager.getInstance()` to use this class. For example, to get a jimumapview, you can use `MapViewManager.getInstance().getJimuMapViewById(dsId)`\n * For widget developer, `MapViewManager.getInstance()` in both of the widget and widget's setting return the same instance.\n *\n * To use jimumapview, the recommended way is to use `JimuMapViewComponent`, which is more easy to use.\n */\nvar MapViewManager = /** @class */ (function () {\n    function MapViewManager() {\n        /** @ignore */\n        this.jimuMapViewGroups = {};\n    }\n    MapViewManager.getInstance = function () {\n        if (window.jimuConfig.isBuilder) {\n            // The builder will use the app's map-view-manager, this means the builder can't have its own map-view-manager\n            // so builder can't have map-view-manager, whenever use map-view-manager in builder will use app's map-view-manager\n            return (window._appWindow && window._appWindow._mapViewManager);\n        }\n        if (!MapViewManager._instance) {\n            MapViewManager._instance = new MapViewManager();\n            window._mapViewManager = MapViewManager._instance;\n        }\n        return MapViewManager._instance;\n    };\n    /**\n     * Return the jimumapview instance by id\n     */\n    MapViewManager.prototype.getJimuMapViewById = function (id) {\n        var mapWidgetIds = Object.keys(this.jimuMapViewGroups);\n        if (mapWidgetIds.length === 0) {\n            return null;\n        }\n        else {\n            for (var i = 0; i < mapWidgetIds.length; i++) {\n                var tempMapWidgetId = mapWidgetIds[i];\n                var jimuMapViewIds = Object.keys(this.jimuMapViewGroups[tempMapWidgetId].jimuMapViews);\n                if (jimuMapViewIds.indexOf(id) > -1) {\n                    return this.jimuMapViewGroups[tempMapWidgetId].jimuMapViews[id];\n                    break;\n                }\n            }\n            return null;\n        }\n    };\n    /** @ignore */\n    MapViewManager.prototype.getJimuMapViewGroup = function (mapWidgetId) {\n        if (this.jimuMapViewGroups[mapWidgetId]) {\n            return this.jimuMapViewGroups[mapWidgetId];\n        }\n        else {\n            return null;\n        }\n    };\n    /**\n     * When start to create the jimumapview instance, this method will set the jimumapview instance status as `LOADING` first,\n     * after the create process is done, set the status as `LOADED`, if an error occurs, set the status as `FAILED`.\n     */\n    MapViewManager.prototype.createJimuMapView = function (jimuMapViewConstructorOptions) {\n        var jimuMapViewId = jimuMapViewConstructorOptions.mapWidgetId + '-' + jimuMapViewConstructorOptions.datasourceId;\n        if (this.getJimuMapViewById(jimuMapViewId)) {\n            return Promise.resolve(this.getJimuMapViewById(jimuMapViewId));\n        }\n        var jimuMapView = new _views_jimu_map_view__WEBPACK_IMPORTED_MODULE_1__[\"JimuMapView\"](jimuMapViewConstructorOptions);\n        this.addJimuMapView(jimuMapView);\n        return jimuMapView.whenJimuMapViewLoaded();\n    };\n    /** @ignore */\n    MapViewManager.prototype.addJimuMapView = function (jimuMapView) {\n        if (this.jimuMapViewGroups[jimuMapView.mapWidgetId]) {\n            this.jimuMapViewGroups[jimuMapView.mapWidgetId].addJimuMapView(jimuMapView);\n        }\n        else {\n            var jimuMapViewGroup = new _views_jimu_map_view_group__WEBPACK_IMPORTED_MODULE_2__[\"JimuMapViewGroup\"](jimuMapView.mapWidgetId);\n            jimuMapViewGroup.addJimuMapView(jimuMapView);\n            this.jimuMapViewGroups[jimuMapView.mapWidgetId] = jimuMapViewGroup;\n        }\n        Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].jimuMapViewAdded(jimuMapView.id, Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])({\n            id: jimuMapView.id,\n            mapWidgetId: jimuMapView.mapWidgetId,\n            datasourceId: jimuMapView.datasourceId,\n            status: jimuMapView.status\n        })));\n    };\n    /**\n     * update the jimumapview instance\n     */\n    MapViewManager.prototype.setJimuMapView = function (jimuMapView) {\n        if (this.jimuMapViewGroups[jimuMapView.mapWidgetId]) {\n            this.jimuMapViewGroups[jimuMapView.mapWidgetId].setJimuMapView(jimuMapView);\n        }\n        else {\n            var jimuMapViewGroup = new _views_jimu_map_view_group__WEBPACK_IMPORTED_MODULE_2__[\"JimuMapViewGroup\"](jimuMapView.mapWidgetId);\n            jimuMapViewGroup.addJimuMapView(jimuMapView);\n            this.jimuMapViewGroups[jimuMapView.mapWidgetId] = jimuMapViewGroup;\n        }\n        Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].jimuMapViewUpdated(jimuMapView.id, Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])({\n            id: jimuMapView.id,\n            mapWidgetId: jimuMapView.mapWidgetId,\n            datasourceId: jimuMapView.datasourceId,\n            isActive: jimuMapView.isActive,\n            status: jimuMapView.status\n        })));\n    };\n    /**\n     * destroy the jimumapview instance by id,\n     */\n    MapViewManager.prototype.destroyJimuMapView = function (jimuMapViewId) {\n        var removeJimuMapView = this.getJimuMapViewById(jimuMapViewId);\n        removeJimuMapView && removeJimuMapView.destroy();\n        var mapWidgetIds = Object.keys(this.jimuMapViewGroups);\n        if (mapWidgetIds.length === 0) {\n            return;\n        }\n        else {\n            for (var i = 0; i < mapWidgetIds.length; i++) {\n                var tempMapWidgetId = mapWidgetIds[i];\n                var jimuMapViewIds = Object.keys(this.jimuMapViewGroups[tempMapWidgetId].jimuMapViews);\n                if (jimuMapViewIds.indexOf(jimuMapViewId) > -1) {\n                    delete this.jimuMapViewGroups[tempMapWidgetId].jimuMapViews[jimuMapViewId];\n                    if (Object.keys(this.jimuMapViewGroups[tempMapWidgetId].jimuMapViews).length === 0) {\n                        delete this.jimuMapViewGroups[tempMapWidgetId];\n                    }\n                    Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].jimuMapViewRemoved(jimuMapViewId));\n                    break;\n                }\n            }\n        }\n    };\n    return MapViewManager;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9saWIvbWFwdmlldy1tYW5hZ2VyLnRzeC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtYXJjZ2lzL2xpYi9tYXB2aWV3LW1hbmFnZXIudHN4PzFlMDgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtnZXRBcHBTdG9yZSwgYXBwQWN0aW9ucywgSW1tdXRhYmxlfSBmcm9tICdqaW11LWNvcmUnO1xuaW1wb3J0IHtKaW11TWFwVmlldywgSmltdU1hcFZpZXdDb25zdHJ1Y3Rvck9wdGlvbnN9IGZyb20gJy4vdmlld3MvamltdS1tYXAtdmlldyc7XG5pbXBvcnQge0ppbXVNYXBWaWV3R3JvdXB9IGZyb20gJy4vdmlld3MvamltdS1tYXAtdmlldy1ncm91cCc7XG5cbi8qKlxuICogVGhlIGBNYXBWaWV3TWFuYWdlcmAgaXMgdXNlZCB0byBtYW5hZ2UgamltdW1hcHZpZXcsIGluY2x1ZGluZyBjcmVhdGUvZ2V0L3NldC9kZXN0cm95IGppbXVtYXB2aWV3IGluc3RhbmNlLlxuICogUGxlYXNlIGFsd2F5cyB1c2UgYE1hcFZpZXdNYW5hZ2VyLmdldEluc3RhbmNlKClgIHRvIHVzZSB0aGlzIGNsYXNzLiBGb3IgZXhhbXBsZSwgdG8gZ2V0IGEgamltdW1hcHZpZXcsIHlvdSBjYW4gdXNlIGBNYXBWaWV3TWFuYWdlci5nZXRJbnN0YW5jZSgpLmdldEppbXVNYXBWaWV3QnlJZChkc0lkKWBcbiAqIEZvciB3aWRnZXQgZGV2ZWxvcGVyLCBgTWFwVmlld01hbmFnZXIuZ2V0SW5zdGFuY2UoKWAgaW4gYm90aCBvZiB0aGUgd2lkZ2V0IGFuZCB3aWRnZXQncyBzZXR0aW5nIHJldHVybiB0aGUgc2FtZSBpbnN0YW5jZS5cbiAqXG4gKiBUbyB1c2UgamltdW1hcHZpZXcsIHRoZSByZWNvbW1lbmRlZCB3YXkgaXMgdG8gdXNlIGBKaW11TWFwVmlld0NvbXBvbmVudGAsIHdoaWNoIGlzIG1vcmUgZWFzeSB0byB1c2UuXG4gKi9cbmV4cG9ydCBjbGFzcyBNYXBWaWV3TWFuYWdlciB7XG5cbiAgc3RhdGljIF9pbnN0YW5jZTogTWFwVmlld01hbmFnZXI7XG4gIHN0YXRpYyBnZXRJbnN0YW5jZSgpIHtcbiAgICBpZih3aW5kb3cuamltdUNvbmZpZy5pc0J1aWxkZXIpe1xuICAgICAgLy8gVGhlIGJ1aWxkZXIgd2lsbCB1c2UgdGhlIGFwcCdzIG1hcC12aWV3LW1hbmFnZXIsIHRoaXMgbWVhbnMgdGhlIGJ1aWxkZXIgY2FuJ3QgaGF2ZSBpdHMgb3duIG1hcC12aWV3LW1hbmFnZXJcbiAgICAgIC8vIHNvIGJ1aWxkZXIgY2FuJ3QgaGF2ZSBtYXAtdmlldy1tYW5hZ2VyLCB3aGVuZXZlciB1c2UgbWFwLXZpZXctbWFuYWdlciBpbiBidWlsZGVyIHdpbGwgdXNlIGFwcCdzIG1hcC12aWV3LW1hbmFnZXJcbiAgICAgIHJldHVybiAod2luZG93Ll9hcHBXaW5kb3cgJiYgd2luZG93Ll9hcHBXaW5kb3cuX21hcFZpZXdNYW5hZ2VyKSBhcyBNYXBWaWV3TWFuYWdlcjtcbiAgICB9XG5cbiAgICBpZiAoIU1hcFZpZXdNYW5hZ2VyLl9pbnN0YW5jZSkge1xuICAgICAgTWFwVmlld01hbmFnZXIuX2luc3RhbmNlID0gbmV3IE1hcFZpZXdNYW5hZ2VyKCk7XG4gICAgICB3aW5kb3cuX21hcFZpZXdNYW5hZ2VyID0gTWFwVmlld01hbmFnZXIuX2luc3RhbmNlO1xuICAgIH1cbiAgICByZXR1cm4gTWFwVmlld01hbmFnZXIuX2luc3RhbmNlO1xuICB9XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgcHJpdmF0ZSBqaW11TWFwVmlld0dyb3Vwczoge1ttYXBXaWRnZXRJZDogc3RyaW5nXTogSmltdU1hcFZpZXdHcm91cH0gPSB7fTtcblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBqaW11bWFwdmlldyBpbnN0YW5jZSBieSBpZFxuICAgKi9cbiAgZ2V0SmltdU1hcFZpZXdCeUlkKGlkOiBzdHJpbmcpOiBKaW11TWFwVmlldyB7XG4gICAgY29uc3QgbWFwV2lkZ2V0SWRzID0gT2JqZWN0LmtleXModGhpcy5qaW11TWFwVmlld0dyb3Vwcyk7XG4gICAgaWYgKG1hcFdpZGdldElkcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1hcFdpZGdldElkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCB0ZW1wTWFwV2lkZ2V0SWQgPSBtYXBXaWRnZXRJZHNbaV07XG4gICAgICAgIGNvbnN0IGppbXVNYXBWaWV3SWRzID0gT2JqZWN0LmtleXModGhpcy5qaW11TWFwVmlld0dyb3Vwc1t0ZW1wTWFwV2lkZ2V0SWRdLmppbXVNYXBWaWV3cyk7XG4gICAgICAgIGlmIChqaW11TWFwVmlld0lkcy5pbmRleE9mKGlkKSA+IC0xKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuamltdU1hcFZpZXdHcm91cHNbdGVtcE1hcFdpZGdldElkXS5qaW11TWFwVmlld3NbaWRdO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBnZXRKaW11TWFwVmlld0dyb3VwKG1hcFdpZGdldElkOiBzdHJpbmcpOiBKaW11TWFwVmlld0dyb3VwIHtcbiAgICBpZiAodGhpcy5qaW11TWFwVmlld0dyb3Vwc1ttYXBXaWRnZXRJZF0pIHtcbiAgICAgIHJldHVybiB0aGlzLmppbXVNYXBWaWV3R3JvdXBzW21hcFdpZGdldElkXTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFdoZW4gc3RhcnQgdG8gY3JlYXRlIHRoZSBqaW11bWFwdmlldyBpbnN0YW5jZSwgdGhpcyBtZXRob2Qgd2lsbCBzZXQgdGhlIGppbXVtYXB2aWV3IGluc3RhbmNlIHN0YXR1cyBhcyBgTE9BRElOR2AgZmlyc3QsXG4gICAqIGFmdGVyIHRoZSBjcmVhdGUgcHJvY2VzcyBpcyBkb25lLCBzZXQgdGhlIHN0YXR1cyBhcyBgTE9BREVEYCwgaWYgYW4gZXJyb3Igb2NjdXJzLCBzZXQgdGhlIHN0YXR1cyBhcyBgRkFJTEVEYC5cbiAgICovXG4gIGNyZWF0ZUppbXVNYXBWaWV3KGppbXVNYXBWaWV3Q29uc3RydWN0b3JPcHRpb25zOiBKaW11TWFwVmlld0NvbnN0cnVjdG9yT3B0aW9ucyk6IFByb21pc2U8SmltdU1hcFZpZXc+IHtcbiAgICBjb25zdCBqaW11TWFwVmlld0lkID0gamltdU1hcFZpZXdDb25zdHJ1Y3Rvck9wdGlvbnMubWFwV2lkZ2V0SWQgKyAnLScgKyBqaW11TWFwVmlld0NvbnN0cnVjdG9yT3B0aW9ucy5kYXRhc291cmNlSWQ7XG4gICAgaWYgKHRoaXMuZ2V0SmltdU1hcFZpZXdCeUlkKGppbXVNYXBWaWV3SWQpKSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuZ2V0SmltdU1hcFZpZXdCeUlkKGppbXVNYXBWaWV3SWQpKTtcbiAgICB9XG5cbiAgICBjb25zdCBqaW11TWFwVmlldyA9IG5ldyBKaW11TWFwVmlldyhqaW11TWFwVmlld0NvbnN0cnVjdG9yT3B0aW9ucyk7XG4gICAgdGhpcy5hZGRKaW11TWFwVmlldyhqaW11TWFwVmlldyk7XG4gICAgcmV0dXJuIGppbXVNYXBWaWV3LndoZW5KaW11TWFwVmlld0xvYWRlZCgpO1xuICB9XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgYWRkSmltdU1hcFZpZXcoamltdU1hcFZpZXc6IEppbXVNYXBWaWV3KSB7XG4gICAgaWYgKHRoaXMuamltdU1hcFZpZXdHcm91cHNbamltdU1hcFZpZXcubWFwV2lkZ2V0SWRdKSB7XG4gICAgICB0aGlzLmppbXVNYXBWaWV3R3JvdXBzW2ppbXVNYXBWaWV3Lm1hcFdpZGdldElkXS5hZGRKaW11TWFwVmlldyhqaW11TWFwVmlldyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGppbXVNYXBWaWV3R3JvdXAgPSBuZXcgSmltdU1hcFZpZXdHcm91cChqaW11TWFwVmlldy5tYXBXaWRnZXRJZCk7XG4gICAgICBqaW11TWFwVmlld0dyb3VwLmFkZEppbXVNYXBWaWV3KGppbXVNYXBWaWV3KTtcbiAgICAgIHRoaXMuamltdU1hcFZpZXdHcm91cHNbamltdU1hcFZpZXcubWFwV2lkZ2V0SWRdID0gamltdU1hcFZpZXdHcm91cDtcbiAgICB9XG5cbiAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcEFjdGlvbnMuamltdU1hcFZpZXdBZGRlZChqaW11TWFwVmlldy5pZCwgSW1tdXRhYmxlKHtcbiAgICAgIGlkOiBqaW11TWFwVmlldy5pZCxcbiAgICAgIG1hcFdpZGdldElkOiBqaW11TWFwVmlldy5tYXBXaWRnZXRJZCxcbiAgICAgIGRhdGFzb3VyY2VJZDogamltdU1hcFZpZXcuZGF0YXNvdXJjZUlkLFxuICAgICAgc3RhdHVzOiBqaW11TWFwVmlldy5zdGF0dXNcbiAgICB9KSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIHVwZGF0ZSB0aGUgamltdW1hcHZpZXcgaW5zdGFuY2VcbiAgICovXG4gIHNldEppbXVNYXBWaWV3KGppbXVNYXBWaWV3OiBKaW11TWFwVmlldykge1xuICAgIGlmICh0aGlzLmppbXVNYXBWaWV3R3JvdXBzW2ppbXVNYXBWaWV3Lm1hcFdpZGdldElkXSkge1xuICAgICAgdGhpcy5qaW11TWFwVmlld0dyb3Vwc1tqaW11TWFwVmlldy5tYXBXaWRnZXRJZF0uc2V0SmltdU1hcFZpZXcoamltdU1hcFZpZXcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBqaW11TWFwVmlld0dyb3VwID0gbmV3IEppbXVNYXBWaWV3R3JvdXAoamltdU1hcFZpZXcubWFwV2lkZ2V0SWQpO1xuICAgICAgamltdU1hcFZpZXdHcm91cC5hZGRKaW11TWFwVmlldyhqaW11TWFwVmlldyk7XG4gICAgICB0aGlzLmppbXVNYXBWaWV3R3JvdXBzW2ppbXVNYXBWaWV3Lm1hcFdpZGdldElkXSA9IGppbXVNYXBWaWV3R3JvdXA7XG4gICAgfVxuXG4gICAgZ2V0QXBwU3RvcmUoKS5kaXNwYXRjaChhcHBBY3Rpb25zLmppbXVNYXBWaWV3VXBkYXRlZChqaW11TWFwVmlldy5pZCwgSW1tdXRhYmxlKHtcbiAgICAgIGlkOiBqaW11TWFwVmlldy5pZCxcbiAgICAgIG1hcFdpZGdldElkOiBqaW11TWFwVmlldy5tYXBXaWRnZXRJZCxcbiAgICAgIGRhdGFzb3VyY2VJZDogamltdU1hcFZpZXcuZGF0YXNvdXJjZUlkLFxuICAgICAgaXNBY3RpdmU6IGppbXVNYXBWaWV3LmlzQWN0aXZlLFxuICAgICAgc3RhdHVzOiBqaW11TWFwVmlldy5zdGF0dXNcbiAgICB9KSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIGRlc3Ryb3kgdGhlIGppbXVtYXB2aWV3IGluc3RhbmNlIGJ5IGlkLFxuICAgKi9cbiAgZGVzdHJveUppbXVNYXBWaWV3KGppbXVNYXBWaWV3SWQ6IHN0cmluZykge1xuICAgIGNvbnN0IHJlbW92ZUppbXVNYXBWaWV3ID0gdGhpcy5nZXRKaW11TWFwVmlld0J5SWQoamltdU1hcFZpZXdJZCk7XG4gICAgcmVtb3ZlSmltdU1hcFZpZXcgJiYgcmVtb3ZlSmltdU1hcFZpZXcuZGVzdHJveSgpO1xuXG4gICAgY29uc3QgbWFwV2lkZ2V0SWRzID0gT2JqZWN0LmtleXModGhpcy5qaW11TWFwVmlld0dyb3Vwcyk7XG4gICAgaWYgKG1hcFdpZGdldElkcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybjtcbiAgICB9IGVsc2Uge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtYXBXaWRnZXRJZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgdGVtcE1hcFdpZGdldElkID0gbWFwV2lkZ2V0SWRzW2ldO1xuICAgICAgICBjb25zdCBqaW11TWFwVmlld0lkcyA9IE9iamVjdC5rZXlzKHRoaXMuamltdU1hcFZpZXdHcm91cHNbdGVtcE1hcFdpZGdldElkXS5qaW11TWFwVmlld3MpO1xuICAgICAgICBpZiAoamltdU1hcFZpZXdJZHMuaW5kZXhPZihqaW11TWFwVmlld0lkKSA+IC0xKSB7XG4gICAgICAgICAgZGVsZXRlIHRoaXMuamltdU1hcFZpZXdHcm91cHNbdGVtcE1hcFdpZGdldElkXS5qaW11TWFwVmlld3NbamltdU1hcFZpZXdJZF07XG4gICAgICAgICAgaWYgKE9iamVjdC5rZXlzKHRoaXMuamltdU1hcFZpZXdHcm91cHNbdGVtcE1hcFdpZGdldElkXS5qaW11TWFwVmlld3MpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuamltdU1hcFZpZXdHcm91cHNbdGVtcE1hcFdpZGdldElkXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZ2V0QXBwU3RvcmUoKS5kaXNwYXRjaChhcHBBY3Rpb25zLmppbXVNYXBWaWV3UmVtb3ZlZChqaW11TWFwVmlld0lkKSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn0iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUVBOzs7Ozs7QUFNQTtBQUNBO0FBQUE7QUFpQkE7QUFDQTtBQThHQTtBQTdIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7OyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./jimu-arcgis/lib/mapview-manager.tsx\n");

/***/ }),

/***/ "./jimu-arcgis/lib/translations/default.ts":
/*!*************************************************!*\
  !*** ./jimu-arcgis/lib/translations/default.ts ***!
  \*************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n    layerIsNotSupported: 'This layer type is not supported.'\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9saWIvdHJhbnNsYXRpb25zL2RlZmF1bHQudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qaW11LWFyY2dpcy9saWIvdHJhbnNsYXRpb25zL2RlZmF1bHQudHM/NzdiOCJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCB7XG4gIGxheWVySXNOb3RTdXBwb3J0ZWQ6ICdUaGlzIGxheWVyIHR5cGUgaXMgbm90IHN1cHBvcnRlZC4nXG59XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./jimu-arcgis/lib/translations/default.ts\n");

/***/ }),

/***/ "./jimu-arcgis/lib/utils/geometry-utils.ts":
/*!*************************************************!*\
  !*** ./jimu-arcgis/lib/utils/geometry-utils.ts ***!
  \*************************************************/
/*! exports provided: projectToSpatialReference */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"projectToSpatialReference\", function() { return projectToSpatialReference; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _arcgis_js_api_module_loader__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../arcgis-js-api-module-loader */ \"./jimu-arcgis/lib/arcgis-js-api-module-loader.ts\");\n/* eslint-disable prefer-const */\n\n\nfunction projectToSpatialReference(geometries, spatialReference) {\n    if (!geometries || geometries.length === 0 || !geometries[0]\n        || spatialReference.wkid === geometries[0].spatialReference.wkid || (spatialReference.equals(geometries[0].spatialReference))) {\n        return Promise.resolve(geometries);\n    }\n    else {\n        return Object(_arcgis_js_api_module_loader__WEBPACK_IMPORTED_MODULE_1__[\"loadArcGISJSAPIModules\"])([\n            'esri/tasks/GeometryService',\n            'esri/tasks/support/ProjectParameters',\n            'esri/geometry/projection'\n        ]).then(function (modules) {\n            var GeometryService;\n            var ProjectParameters;\n            var projection;\n            GeometryService = modules[0], ProjectParameters = modules[1], projection = modules[2];\n            if (projection.isSupported()) {\n                if (projection.isLoaded()) {\n                    var resultGeometries = projectToSpatialReferenceByClient(geometries, spatialReference, projection);\n                    return Promise.resolve(resultGeometries);\n                }\n                else {\n                    projection.load();\n                    return projectToSpatialReferenceByServer(geometries, spatialReference, GeometryService, ProjectParameters).then(function (resultGeometries) {\n                        return Promise.resolve(resultGeometries);\n                    }, function (error) {\n                        console.error(error);\n                        return Promise.reject(error);\n                    });\n                }\n            }\n            else {\n                return projectToSpatialReferenceByServer(geometries, spatialReference, GeometryService, ProjectParameters).then(function (resultGeometries) {\n                    return Promise.resolve(resultGeometries);\n                }, function (error) {\n                    console.error(error);\n                    return Promise.reject(error);\n                });\n            }\n        });\n    }\n}\nfunction projectToSpatialReferenceByServer(geometries, spatialReference, GeometryService, ProjectParameters) {\n    var geometryServiceUrl = Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().portalSelf.helperServices.geometry.url;\n    var geometryService = new GeometryService({\n        url: geometryServiceUrl\n    });\n    var params = new ProjectParameters({\n        geometries: geometries,\n        outSpatialReference: spatialReference,\n    });\n    return geometryService.project(params);\n}\nfunction projectToSpatialReferenceByClient(geometries, spatialReference, projection) {\n    return projection.project(geometries, spatialReference);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9saWIvdXRpbHMvZ2VvbWV0cnktdXRpbHMudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qaW11LWFyY2dpcy9saWIvdXRpbHMvZ2VvbWV0cnktdXRpbHMudHM/ZTIxOCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBwcmVmZXItY29uc3QgKi9cbmltcG9ydCB7IGdldEFwcFN0b3JlIH0gZnJvbSAnamltdS1jb3JlJztcbmltcG9ydCB7IGxvYWRBcmNHSVNKU0FQSU1vZHVsZXMgfSBmcm9tICcuLi9hcmNnaXMtanMtYXBpLW1vZHVsZS1sb2FkZXInO1xuXG5leHBvcnQgZnVuY3Rpb24gcHJvamVjdFRvU3BhdGlhbFJlZmVyZW5jZShnZW9tZXRyaWVzOiBfX2VzcmkuR2VvbWV0cnlbXSwgc3BhdGlhbFJlZmVyZW5jZTogX19lc3JpLlNwYXRpYWxSZWZlcmVuY2UpOiBQcm9taXNlPF9fZXNyaS5HZW9tZXRyeVtdPiB7XG4gIGlmICghZ2VvbWV0cmllcyB8fCBnZW9tZXRyaWVzLmxlbmd0aCA9PT0gMCB8fCAhZ2VvbWV0cmllc1swXVxuICAgIHx8IHNwYXRpYWxSZWZlcmVuY2Uud2tpZCA9PT0gZ2VvbWV0cmllc1swXS5zcGF0aWFsUmVmZXJlbmNlLndraWQgfHwgKHNwYXRpYWxSZWZlcmVuY2UuZXF1YWxzKGdlb21ldHJpZXNbMF0uc3BhdGlhbFJlZmVyZW5jZSkpKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShnZW9tZXRyaWVzKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbG9hZEFyY0dJU0pTQVBJTW9kdWxlcyhbXG4gICAgICAnZXNyaS90YXNrcy9HZW9tZXRyeVNlcnZpY2UnLFxuICAgICAgJ2VzcmkvdGFza3Mvc3VwcG9ydC9Qcm9qZWN0UGFyYW1ldGVycycsXG4gICAgICAnZXNyaS9nZW9tZXRyeS9wcm9qZWN0aW9uJ1xuICAgIF0pLnRoZW4obW9kdWxlcyA9PiB7XG4gICAgICBsZXQgR2VvbWV0cnlTZXJ2aWNlOiB0eXBlb2YgX19lc3JpLkdlb21ldHJ5U2VydmljZTtcbiAgICAgIGxldCBQcm9qZWN0UGFyYW1ldGVyczogdHlwZW9mIF9fZXNyaS5Qcm9qZWN0UGFyYW1ldGVycztcbiAgICAgIGxldCBwcm9qZWN0aW9uOiB0eXBlb2YgX19lc3JpLnByb2plY3Rpb247XG4gICAgICBbR2VvbWV0cnlTZXJ2aWNlLCBQcm9qZWN0UGFyYW1ldGVycywgcHJvamVjdGlvbl0gPSBtb2R1bGVzO1xuXG4gICAgICBpZiAocHJvamVjdGlvbi5pc1N1cHBvcnRlZCgpKSB7XG4gICAgICAgIGlmIChwcm9qZWN0aW9uLmlzTG9hZGVkKCkpIHtcbiAgICAgICAgICBjb25zdCByZXN1bHRHZW9tZXRyaWVzID0gcHJvamVjdFRvU3BhdGlhbFJlZmVyZW5jZUJ5Q2xpZW50KGdlb21ldHJpZXMsIHNwYXRpYWxSZWZlcmVuY2UsIHByb2plY3Rpb24pO1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVzdWx0R2VvbWV0cmllcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcHJvamVjdGlvbi5sb2FkKCk7XG4gICAgICAgICAgcmV0dXJuIHByb2plY3RUb1NwYXRpYWxSZWZlcmVuY2VCeVNlcnZlcihnZW9tZXRyaWVzLCBzcGF0aWFsUmVmZXJlbmNlLCBHZW9tZXRyeVNlcnZpY2UsIFByb2plY3RQYXJhbWV0ZXJzKS50aGVuKChyZXN1bHRHZW9tZXRyaWVzKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHJlc3VsdEdlb21ldHJpZXMpO1xuICAgICAgICAgIH0sIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBwcm9qZWN0VG9TcGF0aWFsUmVmZXJlbmNlQnlTZXJ2ZXIoZ2VvbWV0cmllcywgc3BhdGlhbFJlZmVyZW5jZSwgR2VvbWV0cnlTZXJ2aWNlLCBQcm9qZWN0UGFyYW1ldGVycykudGhlbigocmVzdWx0R2VvbWV0cmllcykgPT4ge1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVzdWx0R2VvbWV0cmllcyk7XG4gICAgICAgIH0sIChlcnJvcikgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gcHJvamVjdFRvU3BhdGlhbFJlZmVyZW5jZUJ5U2VydmVyKGdlb21ldHJpZXM6IF9fZXNyaS5HZW9tZXRyeVtdLCBzcGF0aWFsUmVmZXJlbmNlOiBfX2VzcmkuU3BhdGlhbFJlZmVyZW5jZSxcbiAgR2VvbWV0cnlTZXJ2aWNlOiB0eXBlb2YgX19lc3JpLkdlb21ldHJ5U2VydmljZSwgUHJvamVjdFBhcmFtZXRlcnM6IHR5cGVvZiBfX2VzcmkuUHJvamVjdFBhcmFtZXRlcnMpOiBQcm9taXNlPF9fZXNyaS5HZW9tZXRyeVtdPiB7XG4gIGNvbnN0IGdlb21ldHJ5U2VydmljZVVybCA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5wb3J0YWxTZWxmLmhlbHBlclNlcnZpY2VzLmdlb21ldHJ5LnVybDtcbiAgY29uc3QgZ2VvbWV0cnlTZXJ2aWNlID0gbmV3IEdlb21ldHJ5U2VydmljZSh7XG4gICAgdXJsOiBnZW9tZXRyeVNlcnZpY2VVcmxcbiAgfSk7XG5cbiAgY29uc3QgcGFyYW1zID0gbmV3IFByb2plY3RQYXJhbWV0ZXJzKHtcbiAgICBnZW9tZXRyaWVzOiBnZW9tZXRyaWVzLFxuICAgIG91dFNwYXRpYWxSZWZlcmVuY2U6IHNwYXRpYWxSZWZlcmVuY2UsXG4gIH0pO1xuXG4gIHJldHVybiBnZW9tZXRyeVNlcnZpY2UucHJvamVjdChwYXJhbXMpO1xufVxuXG5mdW5jdGlvbiBwcm9qZWN0VG9TcGF0aWFsUmVmZXJlbmNlQnlDbGllbnQoZ2VvbWV0cmllczogX19lc3JpLkdlb21ldHJ5W10sIHNwYXRpYWxSZWZlcmVuY2U6IF9fZXNyaS5TcGF0aWFsUmVmZXJlbmNlLFxuICBwcm9qZWN0aW9uOiB0eXBlb2YgX19lc3JpLnByb2plY3Rpb24pOiBfX2VzcmkuR2VvbWV0cnlbXSB7XG4gIHJldHVybiBwcm9qZWN0aW9uLnByb2plY3QoZ2VvbWV0cmllcywgc3BhdGlhbFJlZmVyZW5jZSkgYXMgX19lc3JpLkdlb21ldHJ5W107XG59Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./jimu-arcgis/lib/utils/geometry-utils.ts\n");

/***/ }),

/***/ "./jimu-arcgis/lib/utils/portal-utils.ts":
/*!***********************************************!*\
  !*** ./jimu-arcgis/lib/utils/portal-utils.ts ***!
  \***********************************************/
/*! exports provided: checkDefaultBaseMapIsExist */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"checkDefaultBaseMapIsExist\", function() { return checkDefaultBaseMapIsExist; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n\nfunction checkDefaultBaseMapIsExist() {\n    var portalSelf = Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().portalSelf;\n    if (portalSelf && portalSelf.defaultBasemap && portalSelf.defaultBasemap.baseMapLayers\n        && portalSelf.defaultBasemap.baseMapLayers[0] && portalSelf.defaultBasemap.baseMapLayers[0].url) {\n        return true;\n    }\n    else {\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9saWIvdXRpbHMvcG9ydGFsLXV0aWxzLnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vamltdS1hcmNnaXMvbGliL3V0aWxzL3BvcnRhbC11dGlscy50cz9mNWJmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Z2V0QXBwU3RvcmV9IGZyb20gJ2ppbXUtY29yZSc7XG5cbmV4cG9ydCBmdW5jdGlvbiBjaGVja0RlZmF1bHRCYXNlTWFwSXNFeGlzdCgpIHtcbiAgY29uc3QgcG9ydGFsU2VsZiA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5wb3J0YWxTZWxmO1xuICBpZiAocG9ydGFsU2VsZiAmJiBwb3J0YWxTZWxmLmRlZmF1bHRCYXNlbWFwICYmIHBvcnRhbFNlbGYuZGVmYXVsdEJhc2VtYXAuYmFzZU1hcExheWVyc1xuICAgICYmIHBvcnRhbFNlbGYuZGVmYXVsdEJhc2VtYXAuYmFzZU1hcExheWVyc1swXSAmJiBwb3J0YWxTZWxmLmRlZmF1bHRCYXNlbWFwLmJhc2VNYXBMYXllcnNbMF0udXJsKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./jimu-arcgis/lib/utils/portal-utils.ts\n");

/***/ }),

/***/ "./jimu-arcgis/lib/utils/zoomto-utils.ts":
/*!***********************************************!*\
  !*** ./jimu-arcgis/lib/utils/zoomto-utils.ts ***!
  \***********************************************/
/*! exports provided: zoomTo */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"zoomTo\", function() { return zoomTo; });\n/* harmony import */ var _arcgis_js_api_module_loader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../arcgis-js-api-module-loader */ \"./jimu-arcgis/lib/arcgis-js-api-module-loader.ts\");\n/* harmony import */ var _geometry_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./geometry-utils */ \"./jimu-arcgis/lib/utils/geometry-utils.ts\");\n/* eslint-disable prefer-const */\n\n\nvar TileInfo = null;\n// 'target' parameter can be one of the following:\n//   * extent;\n//   * graphics;\n//   * layer;\n//   * object with a combination of {\n//       layer:\n//       extent: optional\n//   }\n//   * object with a combination of {\n//       layer:\n//       graphics: optional\n//   }\n// 'options' parameter {\n//   scale: optional\n// }\nfunction zoomTo(view, target, options) {\n    if (!view) {\n        return Promise.reject(new Error('Invalid target.'));\n    }\n    if (!target) {\n        return Promise.reject(new Error('Invalid target.'));\n    }\n    if (!options) {\n        options = {};\n    }\n    return Object(_arcgis_js_api_module_loader__WEBPACK_IMPORTED_MODULE_0__[\"loadArcGISJSAPIModules\"])([\n        'esri/Graphic',\n        'esri/geometry/Extent',\n        'esri/layers/Layer',\n        'esri/layers/support/TileInfo'\n    ]).then(function (modules) {\n        var Graphic;\n        var Extent;\n        var Layer;\n        Graphic = modules[0], Extent = modules[1], Layer = modules[2], TileInfo = modules[3];\n        if (target instanceof Extent) {\n            return zoomToExtent(view, target, options.scale);\n        }\n        else if (Array.isArray(target) && target.length && target[0] instanceof Graphic) {\n            return zoomToGraphics(view, target, options.scale);\n        }\n        else if (target instanceof Layer) {\n            return zoomToLayer(view, target, null, null, options.scale);\n        }\n        else if (target.layer && target.layer instanceof Layer && target.extent && target.extent instanceof Extent) {\n            return zoomToLayer(view, target.layer, null, target.extent, options.scale);\n        }\n        else if (target.layer && target.layer instanceof Layer && Array.isArray(target.graphics) && target.graphics.length && target.graphics[0] instanceof Graphic) {\n            return zoomToLayer(view, target.layer, target.graphics, null, options.scale);\n        }\n        else {\n            return Promise.reject(new Error('Invalid target.'));\n        }\n    });\n}\nfunction zoomToGraphics(view, graphics, scale) {\n    if (view.type === '3d' && !scale) {\n        // temporary solution\n        // miss spatialReference conversion\n        //@ts-ignore\n        return view.goTo(graphics);\n    }\n    return graphicsExtent(view, graphics).then(function (extent) {\n        return zoomToExtent(view, extent, scale);\n    }).catch(function (e) {\n        return Promise.reject(e);\n    });\n}\nfunction zoomToLayer(view, layer, graphics, extent, scale) {\n    var extentPromise;\n    if (extent && isValidExtent(extent)) {\n        if (view.type === '3d' && !scale) {\n            // temporary solution\n            return Object(_geometry_utils__WEBPACK_IMPORTED_MODULE_1__[\"projectToSpatialReference\"])([extent], view.spatialReference).then(function (resultExtents) {\n                //return resultExtents && resultExtents[0];\n                //@ts-ignore\n                return view.goTo(resultExtents);\n            });\n        }\n        extentPromise = Promise.resolve(extent);\n    }\n    else if (graphics) {\n        if (view.type === '3d' && !scale) {\n            // temporary solution\n            // miss spatialReference conversion\n            //@ts-ignore\n            return view.goTo(graphics);\n        }\n        extentPromise = graphicsExtent(view, graphics);\n    }\n    else {\n        extentPromise = layerExtent(view, layer);\n    }\n    return extentPromise.then(function (extent) {\n        return Object(_geometry_utils__WEBPACK_IMPORTED_MODULE_1__[\"projectToSpatialReference\"])([extent], view.spatialReference).then(function (resultExtents) {\n            return resultExtents && resultExtents[0];\n        });\n    }).then(function (extent) {\n        if (!isValidExtent(extent)) {\n            return Promise.reject(new Error('Invalid extent.'));\n        }\n        if (scale) {\n            extent = adjustHeightToAspectRatio(view, extent);\n            return getExtentForScale(view, extent, scale).then(function (extent) {\n                return goTo(view, extent);\n            });\n        }\n        var fixedScaleForScene = 4513.9887;\n        //@ts-ignore\n        var minScale = layer.minScale || 0;\n        //@ts-ignore\n        var maxScale = layer.maxScale || 0;\n        if (isSinglePointExtent(extent)) {\n            var targetScale = getTargetScale(view, minScale, maxScale, 3);\n            if (targetScale) {\n                if (view.type === '3d') {\n                    if (fixedScaleForScene > targetScale) {\n                        if (minScale === 0 || fixedScaleForScene < minScale) {\n                            targetScale = fixedScaleForScene;\n                        }\n                        else {\n                            targetScale = minScale;\n                        }\n                    }\n                }\n                extent = adjustHeightToAspectRatio(view, extent);\n                return getExtentForScale(view, extent, targetScale).then(function (extent) {\n                    return goTo(view, extent);\n                });\n            }\n        }\n        else {\n            extent = adjustExtentToAspectRatio(view, extent);\n            return getScaleForExtent(view, extent).then(function (expectScale) {\n                if (minScale > 0 && expectScale > minScale) {\n                    // zoom in\n                    minScale = getScaleForNextTileLevel(view, minScale, true);\n                    extent = adjustHeightToAspectRatio(view, extent);\n                    return getExtentForScale(view, extent, minScale).then(function (extent) {\n                        return goTo(view, extent);\n                    });\n                }\n                else if (expectScale < maxScale) {\n                    // zoom out\n                    maxScale = getScaleForNextTileLevel(view, maxScale, false);\n                    extent = adjustHeightToAspectRatio(view, extent);\n                    return getExtentForScale(view, extent, maxScale).then(function (extent) {\n                        return goTo(view, extent);\n                    });\n                }\n                else {\n                    return goTo(view, extent);\n                }\n            });\n        }\n    }).catch(function (e) {\n        return Promise.reject(e);\n    });\n}\nfunction zoomToExtent(view, extent, scale) {\n    extent = extent.clone();\n    //if(view.type === '3d' && !scale) {\n    //  // temporary solution\n    //  return view.goTo(extent);\n    //}\n    if (!isValidExtent(extent)) {\n        return Promise.reject(new Error('Invalid extent.'));\n    }\n    return Object(_geometry_utils__WEBPACK_IMPORTED_MODULE_1__[\"projectToSpatialReference\"])([extent], view.spatialReference).then(function (resultExtents) {\n        var resultExtent = resultExtents && resultExtents[0];\n        if (!resultExtent) {\n            resultExtent = extent;\n        }\n        //@ts-ignore\n        if (isSinglePointExtent(resultExtent)) {\n            //@ts-ignore\n            return convertSinglePointExtent(view, resultExtent);\n        }\n        else {\n            return resultExtent;\n        }\n    }).then(function (extent) {\n        if (scale) {\n            return getExtentForScale(view, extent, scale);\n        }\n        else {\n            return extent;\n        }\n    }).then(function (extent) {\n        return goTo(view, extent);\n    }).catch(function (e) {\n        return Promise.reject(e);\n    });\n}\nfunction goTo(view, extent) {\n    //@ts-ignore\n    return view.goTo(extent);\n}\nfunction isValidExtent(extent) {\n    return extent && isValidValue(extent.xmin) &&\n        isValidValue(extent.ymin) &&\n        isValidValue(extent.xmax) &&\n        isValidValue(extent.ymax);\n}\nfunction isValidValue(e) {\n    if (e === 0) {\n        return true;\n    }\n    return !!e;\n}\nfunction convertSinglePointExtent(view, extent) {\n    //@ts-ignore\n    //const targetScale = getMedianScale(view, view.scale, 0);\n    var targetScale = getTargetScale(view, 0, 0, 3);\n    if (targetScale) {\n        extent = adjustHeightToAspectRatio(view, extent);\n        return getExtentForScale(view, extent, targetScale);\n    }\n    else {\n        return Promise.reject();\n    }\n}\nvar SinglePointOffSet;\n(function (SinglePointOffSet) {\n    SinglePointOffSet[SinglePointOffSet[\"X\"] = 0.0001] = \"X\";\n    SinglePointOffSet[SinglePointOffSet[\"Y\"] = 0.0001] = \"Y\";\n})(SinglePointOffSet || (SinglePointOffSet = {}));\nfunction isSinglePointExtent(extent) {\n    if (extent.xmin + SinglePointOffSet.X === extent.xmax - SinglePointOffSet.X &&\n        extent.ymin + SinglePointOffSet.Y === extent.ymax - SinglePointOffSet.Y) {\n        return true;\n    }\n    else {\n        return false;\n    }\n    //if(extent.width <= SinglePointOffSet.X * 2 && extent.height <= SinglePointOffSet.Y * 2) {\n    //  return true;\n    //} else {\n    //  return false;\n    //}\n}\nfunction graphicsExtent(view, graphicsParam, option) {\n    if (option === void 0) { option = {}; }\n    var layer = graphicsParam && graphicsParam[0] && graphicsParam[0].layer;\n    if (layer && layer.type === 'scene') {\n        return graphicsExtentForSceneLayer(graphicsParam, layer, option.factor);\n    }\n    else {\n        if (view.type === '3d') {\n            return graphicsExtentBase(graphicsParam, 3);\n        }\n        else {\n            return graphicsExtentBase(graphicsParam);\n        }\n    }\n}\nfunction graphicsExtentForSceneLayer(graphicsParam, sceneLayer, factor) {\n    // can't get geometry from a graphic of sceneLayer.\n    return Object(_arcgis_js_api_module_loader__WEBPACK_IMPORTED_MODULE_0__[\"loadArcGISJSAPIModules\"])([\n        'esri/tasks/support/Query',\n    ]).then(function (modules) {\n        var Query = modules[0];\n        if (sceneLayer) {\n            var query = new Query();\n            query.objectIds = graphicsParam.map(function (graphic) { return graphic.attributes[sceneLayer.objectIdField]; });\n            query.returnGeometry = true;\n            return sceneLayer.queryExtent(query).then(function (result) {\n                if (result.count === 1) {\n                    // single graphic\n                    return result.extent.expand(3.5);\n                }\n                else {\n                    return result.extent.expand(2);\n                }\n            });\n        }\n        else {\n            return Promise.reject();\n        }\n    }).catch(function (e) { return Promise.reject(e); });\n}\nfunction graphicsExtentBase(graphicsParam, factor) {\n    return Object(_arcgis_js_api_module_loader__WEBPACK_IMPORTED_MODULE_0__[\"loadArcGISJSAPIModules\"])([\n        'esri/Graphic',\n        'esri/geometry/Extent',\n        'esri/geometry/Point'\n    ]).then(function (modules) {\n        var Graphic;\n        var Extent;\n        var Point;\n        var ext = null;\n        var graphics = graphicsParam;\n        Graphic = modules[0], Extent = modules[1], Point = modules[2];\n        try {\n            if (graphics &&\n                graphics.length === 1 &&\n                graphics[0].geometry &&\n                graphics[0].geometry.declaredClass === 'esri.geometry.Multipoint' &&\n                //@ts-ignore\n                graphics[0].geometry.points.length === 1) {\n                //@ts-ignore\n                var mPoint = graphics[0].geometry.points[0];\n                var point = new Point({\n                    x: mPoint[0],\n                    y: mPoint[1],\n                    spatialReference: graphics[0].geometry.spatialReference\n                });\n                graphics = [new Graphic({ geometry: point })];\n            }\n            if (graphics && graphics.length === 1 &&\n                graphics[0].geometry &&\n                graphics[0].geometry.declaredClass === 'esri.geometry.Point') {\n                var geometry = graphics[0].geometry;\n                ext = new Extent({\n                    //@ts-ignore\n                    xmin: geometry.x - SinglePointOffSet.X,\n                    //@ts-ignore\n                    ymin: geometry.y - SinglePointOffSet.Y,\n                    //@ts-ignore\n                    xmax: geometry.x + SinglePointOffSet.X,\n                    //@ts-ignore\n                    ymax: geometry.y + SinglePointOffSet.Y,\n                    spatialReference: geometry.spatialReference\n                });\n            }\n            else if (graphics && graphics.length > 0) {\n                ext = _graphicsExtentBase(graphics, Extent);\n                if (ext) {\n                    if (factor && factor > 0) {\n                        ext = ext.expand(factor);\n                    }\n                }\n            }\n            return ext;\n        }\n        catch (e) {\n            console.error(e);\n            return Promise.reject();\n        }\n    }).catch(function (e) { return Promise.reject(); });\n}\nfunction _graphicsExtentBase(graphics, Extent) {\n    if (!graphics || !graphics.length) {\n        return null;\n    }\n    var fullExtent = null, index, numGraphics = graphics.length;\n    for (index = 0; index < numGraphics; index++) {\n        var geometry = graphics[index].geometry;\n        if (!geometry) {\n            continue;\n        }\n        var extent = geometry.extent;\n        //@ts-ignore\n        if (!extent && geometry.type === 'point' && geometry.x != null && geometry.y != null) {\n            extent = new Extent({\n                //@ts-ignore\n                xmin: geometry.x,\n                //@ts-ignore\n                ymin: geometry.y,\n                //@ts-ignore\n                xmax: geometry.x,\n                //@ts-ignore\n                ymax: geometry.y,\n                spatialReference: geometry.spatialReference\n            });\n        }\n        if (!extent) {\n            continue;\n        }\n        if (fullExtent) {\n            fullExtent = fullExtent.union(extent);\n        }\n        else {\n            fullExtent = extent;\n        }\n    }\n    if (!fullExtent || fullExtent.width < 0 || fullExtent.height < 0) {\n        return null;\n    }\n    return fullExtent;\n}\n/**\n * lod:{level, resolution, scale}\n */\nfunction getMapLods(view) {\n    var lods = [];\n    var baseLayers = view.map.basemap.baseLayers;\n    baseLayers.forEach(function (baseLayer) {\n        if (baseLayer &&\n            //@ts-ignore\n            baseLayer.tileInfo &&\n            //@ts-ignore\n            baseLayer.tileInfo.lods &&\n            //@ts-ignore\n            lods.length < baseLayer.tileInfo.lods.length) {\n            //@ts-ignore\n            lods = baseLayer.tileInfo.lods;\n        }\n    });\n    //lods = lods.map((lod) => lod.toJSON());\n    if (lods.length === 0) {\n        return TileInfo.create().lods;\n    }\n    else {\n        return lods;\n    }\n}\n//function getMedianScale(view: __esri.View, minScale: number, maxScale: number): number {\n//  return getTargetScale(view, minScale, maxScale, 2);\n//}\nfunction getTargetScale(view, minScale, maxScale, factor) {\n    var mapLods = getMapLods(view);\n    var targetScale;\n    var migrationParam = 1;\n    if (mapLods) {\n        var visibleScales_1 = [];\n        var lessThanMaxScales_1 = [];\n        mapLods.forEach(function (mapLod) {\n            if (minScale > 0 && mapLod.scale > minScale) {\n                return;\n            }\n            else if (mapLod.scale < maxScale) {\n                lessThanMaxScales_1.push(mapLod.scale);\n                return;\n            }\n            else {\n                visibleScales_1.push(mapLod.scale);\n            }\n        });\n        visibleScales_1.reverse();\n        var targetIndex = void 0;\n        if (visibleScales_1.length >= 1) {\n            migrationParam = lessThanMaxScales_1.length ? lessThanMaxScales_1.length / mapLods.length : 1;\n            targetIndex = Math.floor((visibleScales_1.length - 1) / (factor / migrationParam));\n            targetScale = visibleScales_1[targetIndex];\n        }\n        else {\n            targetScale = null;\n        }\n    }\n    else {\n        if (minScale === 0) {\n            targetScale = null;\n        }\n        else {\n            targetScale = (minScale - maxScale) / factor;\n        }\n    }\n    return targetScale;\n}\nfunction getScaleForNextTileLevel(view, scale, zoomIn) {\n    var i;\n    var mapLods = getMapLods(view);\n    if (mapLods) {\n        if (zoomIn) {\n            for (i = 0; i < mapLods.length; i++) {\n                if (mapLods[i].scale < scale) {\n                    return mapLods[i].scale - 1;\n                }\n            }\n            return mapLods[mapLods.length - 1].scale - 1;\n        }\n        else {\n            for (i = mapLods.length - 1; i >= 0; i--) {\n                if (mapLods[i].scale > scale) {\n                    return mapLods[i].scale + 1;\n                }\n            }\n            return mapLods[0].scale + 1;\n        }\n    }\n    else {\n        if (zoomIn) {\n            return scale - 1;\n        }\n        else {\n            return scale + 1;\n        }\n    }\n    return scale;\n}\nfunction adjustExtentToAspectRatio(view, extent) {\n    var mapRatio = view.size[0] / view.size[1]; // width / height\n    var extentRatio = extent.width / extent.height;\n    if (extentRatio > mapRatio) {\n        var yBuf = extent.width / mapRatio / 2;\n        extent.ymin = extent.center.y - yBuf;\n        extent.ymax = extent.center.y + yBuf;\n    }\n    else if (extentRatio < mapRatio) {\n        var xBuf = extent.height * mapRatio / 2;\n        extent.xmin = extent.center.x - xBuf;\n        extent.xmax = extent.center.x + xBuf;\n    }\n    return extent;\n}\nfunction adjustHeightToAspectRatio(view, extent) {\n    // adjust the height of the extent so it won't mess up our scale calculations that we do with the width\n    // make it a little smaller to be sure\n    var buf = (extent.width * (view.size[1] / view.size[0])) / 5;\n    extent.ymin = extent.center.y - buf;\n    extent.ymax = extent.center.y + buf;\n    return extent;\n}\nfunction getExtentForScale(view, extent, scale) {\n    return Object(_arcgis_js_api_module_loader__WEBPACK_IMPORTED_MODULE_0__[\"loadArcGISJSAPIModules\"])([\n        'esri/config',\n        'esri/geometry/support/WKIDUnitConversion'\n    ]).then(function (modules) {\n        var esriConfig;\n        var WKIDUnitConversion;\n        esriConfig = modules[0], WKIDUnitConversion = modules[1];\n        var mapWidth = view.size[0];\n        var inchesPerMeter = 39.37, decDegToMeters = 20015077.0 / 180.0, lookup = WKIDUnitConversion;\n        var wkid, wkt, sr = extent.spatialReference;\n        if (sr) {\n            wkid = sr.wkid;\n            wkt = sr.wkt;\n        }\n        var unitValue = null;\n        if (wkid) {\n            unitValue = lookup.values[lookup[wkid]];\n        }\n        else if (wkt && (wkt.search(/^PROJCS/i) !== -1)) {\n            var result = /UNIT\\[([^\\]]+)\\]\\]$/i.exec(wkt);\n            if (result && result[1]) {\n                unitValue = parseFloat(result[1].split(',')[1]);\n            }\n        }\n        var newExtent = extent.expand(((scale * mapWidth) /\n            ((unitValue || decDegToMeters) * inchesPerMeter * (esriConfig.screenDPI || 96))) /\n            extent.width);\n        return newExtent;\n    }).catch(function (e) { return Promise.reject(); });\n}\nfunction getScaleForExtent(view, extent) {\n    return Object(_arcgis_js_api_module_loader__WEBPACK_IMPORTED_MODULE_0__[\"loadArcGISJSAPIModules\"])([\n        'esri/config',\n        'esri/geometry/support/WKIDUnitConversion'\n    ]).then(function (modules) {\n        var esriConfig;\n        var WKIDUnitConversion;\n        esriConfig = modules[0], WKIDUnitConversion = modules[1];\n        var scale;\n        var mapWidth = view.size[0];\n        var inchesPerMeter = 39.37, decDegToMeters = 20015077.0 / 180.0, lookup = WKIDUnitConversion;\n        var wkid, wkt, sr = extent.spatialReference;\n        if (sr) {\n            wkid = sr.wkid;\n            wkt = sr.wkt;\n        }\n        var unitValue = null;\n        if (wkid) {\n            unitValue = lookup.values[lookup[wkid]];\n        }\n        else if (wkt && (wkt.search(/^PROJCS/i) !== -1)) {\n            var result = /UNIT\\[([^\\]]+)\\]\\]$/i.exec(wkt);\n            if (result && result[1]) {\n                unitValue = parseFloat(result[1].split(',')[1]);\n            }\n        }\n        scale = (extent.width / mapWidth) * (unitValue || decDegToMeters) * inchesPerMeter * (esriConfig.screenDPI || 96);\n        return scale;\n    }).catch(function (e) { return Promise.reject(); });\n}\nfunction layerExtent(view, layer) {\n    if (layer.type === 'feature') {\n        return featureLayerExtent(view, layer);\n    }\n    else {\n        return Promise.resolve(layer.fullExtent.clone());\n    }\n}\nfunction featureLayerExtent(view, layer) {\n    /*\n    var layerView = null;\n    view.allLayerViews.some( _layerView => {\n      _layerView.layer.id === layer.id ? layerView = _layerView : false;\n    });\n    let queryExtent = layerView && layerView.queryExtent();\n    var defaultExtent =  isValidExtent(queryExtent) ? queryExtent : layer.fullExtent.clone();\n    */\n    var defaultExtent = layer.fullExtent.clone();\n    //@ts-ignore\n    if (!layer.url) {\n        return Promise.resolve(defaultExtent);\n    }\n    //@ts-ignore\n    var queryCapabilities = layer.capabilities.query;\n    if (queryCapabilities) {\n        return Object(_arcgis_js_api_module_loader__WEBPACK_IMPORTED_MODULE_0__[\"loadArcGISJSAPIModules\"])([\n            'esri/tasks/support/Query',\n        ]).then(function (modules) {\n            var Query;\n            Query = modules[0];\n            var query = new Query();\n            //@ts-ignore\n            query.where = layer.definitionExpression ? layer.definitionExpression : '1=1';\n            query.outSpatialReference = view.spatialReference;\n            query.returnGeometry = true;\n            if (queryCapabilities.supportsExtent) {\n                //@ts-ignore\n                return layer.queryExtent(query).then(function (result) {\n                    return result.extent;\n                }).catch(function (e) { return Promise.resolve(defaultExtent); });\n            }\n            else {\n                //@ts-ignore\n                return layer.queryFeatures(query).then(function (featureSet) {\n                    return graphicsExtent(view, featureSet.features);\n                }).catch(function (e) { return Promise.resolve(defaultExtent); });\n            }\n        }).catch(function (e) { return Promise.resolve(defaultExtent); });\n    }\n    else {\n        return Promise.resolve(defaultExtent);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9saWIvdXRpbHMvem9vbXRvLXV0aWxzLnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vamltdS1hcmNnaXMvbGliL3V0aWxzL3pvb210by11dGlscy50cz83Mzg2Il0sInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIHByZWZlci1jb25zdCAqL1xuaW1wb3J0IHsgbG9hZEFyY0dJU0pTQVBJTW9kdWxlcyB9IGZyb20gJy4uL2FyY2dpcy1qcy1hcGktbW9kdWxlLWxvYWRlcic7XG5pbXBvcnQgeyBwcm9qZWN0VG9TcGF0aWFsUmVmZXJlbmNlIH0gZnJvbSAnLi9nZW9tZXRyeS11dGlscyc7XG5cbmxldCBUaWxlSW5mbyA9IG51bGw7XG5cbi8vICd0YXJnZXQnIHBhcmFtZXRlciBjYW4gYmUgb25lIG9mIHRoZSBmb2xsb3dpbmc6XG4vLyAgICogZXh0ZW50O1xuLy8gICAqIGdyYXBoaWNzO1xuLy8gICAqIGxheWVyO1xuLy8gICAqIG9iamVjdCB3aXRoIGEgY29tYmluYXRpb24gb2Yge1xuLy8gICAgICAgbGF5ZXI6XG4vLyAgICAgICBleHRlbnQ6IG9wdGlvbmFsXG4vLyAgIH1cbi8vICAgKiBvYmplY3Qgd2l0aCBhIGNvbWJpbmF0aW9uIG9mIHtcbi8vICAgICAgIGxheWVyOlxuLy8gICAgICAgZ3JhcGhpY3M6IG9wdGlvbmFsXG4vLyAgIH1cbi8vICdvcHRpb25zJyBwYXJhbWV0ZXIge1xuLy8gICBzY2FsZTogb3B0aW9uYWxcbi8vIH1cbmV4cG9ydCBmdW5jdGlvbiB6b29tVG8odmlldzogX19lc3JpLlZpZXcsIHRhcmdldDogYW55LCBvcHRpb25zOiBhbnkpOiBQcm9taXNlPGFueT4ge1xuICBpZighdmlldykge1xuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ0ludmFsaWQgdGFyZ2V0LicpKTtcbiAgfVxuICBpZighdGFyZ2V0KSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcignSW52YWxpZCB0YXJnZXQuJykpO1xuICB9XG4gIGlmKCFvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IHt9O1xuICB9XG4gIHJldHVybiBsb2FkQXJjR0lTSlNBUElNb2R1bGVzKFtcbiAgICAnZXNyaS9HcmFwaGljJyxcbiAgICAnZXNyaS9nZW9tZXRyeS9FeHRlbnQnLFxuICAgICdlc3JpL2xheWVycy9MYXllcicsXG4gICAgJ2VzcmkvbGF5ZXJzL3N1cHBvcnQvVGlsZUluZm8nXG4gIF0pLnRoZW4obW9kdWxlcyA9PiB7XG4gICAgbGV0IEdyYXBoaWM6IHR5cGVvZiBfX2VzcmkuR3JhcGhpYztcbiAgICBsZXQgRXh0ZW50OiB0eXBlb2YgX19lc3JpLkV4dGVudDtcbiAgICBsZXQgTGF5ZXI6IHR5cGVvZiBfX2VzcmkuTGF5ZXI7XG4gICAgW0dyYXBoaWMsIEV4dGVudCwgTGF5ZXIsIFRpbGVJbmZvXSA9IG1vZHVsZXM7XG4gICAgaWYodGFyZ2V0IGluc3RhbmNlb2YgRXh0ZW50KSB7XG4gICAgICByZXR1cm4gem9vbVRvRXh0ZW50KHZpZXcsIHRhcmdldCwgb3B0aW9ucy5zY2FsZSk7XG4gICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHRhcmdldCkgJiYgdGFyZ2V0Lmxlbmd0aCAmJiB0YXJnZXRbMF0gaW5zdGFuY2VvZiBHcmFwaGljKSB7XG4gICAgICByZXR1cm4gem9vbVRvR3JhcGhpY3ModmlldywgdGFyZ2V0LCBvcHRpb25zLnNjYWxlKTtcbiAgICB9IGVsc2UgaWYgKHRhcmdldCBpbnN0YW5jZW9mIExheWVyKSB7XG4gICAgICByZXR1cm4gem9vbVRvTGF5ZXIodmlldywgdGFyZ2V0LCBudWxsLCBudWxsLCBvcHRpb25zLnNjYWxlKTtcbiAgICB9IGVsc2UgaWYgKHRhcmdldC5sYXllciAmJiB0YXJnZXQubGF5ZXIgaW5zdGFuY2VvZiBMYXllciAmJiB0YXJnZXQuZXh0ZW50ICYmIHRhcmdldC5leHRlbnQgaW5zdGFuY2VvZiBFeHRlbnQpIHtcbiAgICAgIHJldHVybiB6b29tVG9MYXllcih2aWV3LCB0YXJnZXQubGF5ZXIsIG51bGwsIHRhcmdldC5leHRlbnQsIG9wdGlvbnMuc2NhbGUpO1xuICAgIH0gZWxzZSBpZiAodGFyZ2V0LmxheWVyICYmIHRhcmdldC5sYXllciBpbnN0YW5jZW9mIExheWVyICYmIEFycmF5LmlzQXJyYXkodGFyZ2V0LmdyYXBoaWNzKSAmJiB0YXJnZXQuZ3JhcGhpY3MubGVuZ3RoICYmIHRhcmdldC5ncmFwaGljc1swXSBpbnN0YW5jZW9mIEdyYXBoaWMpIHtcbiAgICAgIHJldHVybiB6b29tVG9MYXllcih2aWV3LCB0YXJnZXQubGF5ZXIsIHRhcmdldC5ncmFwaGljcywgbnVsbCwgb3B0aW9ucy5zY2FsZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ0ludmFsaWQgdGFyZ2V0LicpKTtcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiB6b29tVG9HcmFwaGljcyh2aWV3OiBfX2VzcmkuVmlldywgZ3JhcGhpY3M6IF9fZXNyaS5HcmFwaGljW10sIHNjYWxlPzogbnVtYmVyKTogUHJvbWlzZTxhbnk+IHtcbiAgaWYodmlldy50eXBlID09PSAnM2QnICYmICFzY2FsZSkge1xuICAgIC8vIHRlbXBvcmFyeSBzb2x1dGlvblxuICAgIC8vIG1pc3Mgc3BhdGlhbFJlZmVyZW5jZSBjb252ZXJzaW9uXG4gICAgLy9AdHMtaWdub3JlXG4gICAgcmV0dXJuIHZpZXcuZ29UbyhncmFwaGljcyk7XG4gIH1cbiAgcmV0dXJuIGdyYXBoaWNzRXh0ZW50KHZpZXcsIGdyYXBoaWNzKS50aGVuKCAoZXh0ZW50KSA9PiB7XG4gICAgcmV0dXJuIHpvb21Ub0V4dGVudCh2aWV3LCBleHRlbnQsIHNjYWxlKTtcbiAgfSkuY2F0Y2goIChlKSA9PiB7XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gem9vbVRvTGF5ZXIodmlldzogX19lc3JpLlZpZXcsIGxheWVyOiBfX2VzcmkuTGF5ZXIsIGdyYXBoaWNzPzogX19lc3JpLkdyYXBoaWNbXSwgZXh0ZW50PzogX19lc3JpLkV4dGVudCwgc2NhbGU/OiBudW1iZXIgKTogUHJvbWlzZTxhbnk+IHtcbiAgbGV0IGV4dGVudFByb21pc2U7XG4gIGlmKGV4dGVudCAmJiBpc1ZhbGlkRXh0ZW50KGV4dGVudCkpIHtcbiAgICBpZih2aWV3LnR5cGUgPT09ICczZCcgJiYgIXNjYWxlKSB7XG4gICAgICAvLyB0ZW1wb3Jhcnkgc29sdXRpb25cbiAgICAgIHJldHVybiBwcm9qZWN0VG9TcGF0aWFsUmVmZXJlbmNlKFtleHRlbnRdLCB2aWV3LnNwYXRpYWxSZWZlcmVuY2UpLnRoZW4oKHJlc3VsdEV4dGVudHMpID0+IHtcbiAgICAgICAgLy9yZXR1cm4gcmVzdWx0RXh0ZW50cyAmJiByZXN1bHRFeHRlbnRzWzBdO1xuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgcmV0dXJuIHZpZXcuZ29UbyhyZXN1bHRFeHRlbnRzKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBleHRlbnRQcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKGV4dGVudCk7XG4gIH0gZWxzZSBpZihncmFwaGljcykge1xuICAgIGlmKHZpZXcudHlwZSA9PT0gJzNkJyAmJiAhc2NhbGUpIHtcbiAgICAgIC8vIHRlbXBvcmFyeSBzb2x1dGlvblxuICAgICAgLy8gbWlzcyBzcGF0aWFsUmVmZXJlbmNlIGNvbnZlcnNpb25cbiAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgcmV0dXJuIHZpZXcuZ29UbyhncmFwaGljcyk7XG4gICAgfVxuICAgIGV4dGVudFByb21pc2UgPSBncmFwaGljc0V4dGVudCh2aWV3LCBncmFwaGljcyk7XG4gIH0gZWxzZSB7XG4gICAgZXh0ZW50UHJvbWlzZSA9IGxheWVyRXh0ZW50KHZpZXcsIGxheWVyKTtcbiAgfVxuXG4gIHJldHVybiBleHRlbnRQcm9taXNlLnRoZW4oKGV4dGVudCkgPT4ge1xuICAgIHJldHVybiBwcm9qZWN0VG9TcGF0aWFsUmVmZXJlbmNlKFtleHRlbnRdLCB2aWV3LnNwYXRpYWxSZWZlcmVuY2UpLnRoZW4oKHJlc3VsdEV4dGVudHMpID0+IHtcbiAgICAgIHJldHVybiByZXN1bHRFeHRlbnRzICYmIHJlc3VsdEV4dGVudHNbMF07XG4gICAgfSk7XG4gIH0pLnRoZW4oKGV4dGVudCkgPT4ge1xuICAgIGlmKCFpc1ZhbGlkRXh0ZW50KGV4dGVudCkpIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ0ludmFsaWQgZXh0ZW50LicpKTtcbiAgICB9XG5cbiAgICBpZihzY2FsZSkge1xuICAgICAgZXh0ZW50ID0gYWRqdXN0SGVpZ2h0VG9Bc3BlY3RSYXRpbyh2aWV3LCBleHRlbnQpO1xuICAgICAgcmV0dXJuIGdldEV4dGVudEZvclNjYWxlKHZpZXcsIGV4dGVudCwgc2NhbGUpLnRoZW4oKGV4dGVudCkgPT4ge1xuICAgICAgICByZXR1cm4gZ29Ubyh2aWV3LCBleHRlbnQpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgZml4ZWRTY2FsZUZvclNjZW5lID0gNDUxMy45ODg3O1xuXG4gICAgLy9AdHMtaWdub3JlXG4gICAgbGV0IG1pblNjYWxlID0gbGF5ZXIubWluU2NhbGUgfHwgMDtcbiAgICAvL0B0cy1pZ25vcmVcbiAgICBsZXQgbWF4U2NhbGUgPSBsYXllci5tYXhTY2FsZSB8fCAwO1xuICAgIGlmKGlzU2luZ2xlUG9pbnRFeHRlbnQoZXh0ZW50KSkge1xuICAgICAgbGV0IHRhcmdldFNjYWxlID0gZ2V0VGFyZ2V0U2NhbGUodmlldywgbWluU2NhbGUsIG1heFNjYWxlLCAzKTtcbiAgICAgIGlmKHRhcmdldFNjYWxlKSB7XG4gICAgICAgIGlmKHZpZXcudHlwZSA9PT0gJzNkJykge1xuICAgICAgICAgIGlmKGZpeGVkU2NhbGVGb3JTY2VuZSA+IHRhcmdldFNjYWxlKSB7XG4gICAgICAgICAgICBpZihtaW5TY2FsZSA9PT0gMCB8fCBmaXhlZFNjYWxlRm9yU2NlbmUgPCBtaW5TY2FsZSkge1xuICAgICAgICAgICAgICB0YXJnZXRTY2FsZSA9IGZpeGVkU2NhbGVGb3JTY2VuZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRhcmdldFNjYWxlID0gbWluU2NhbGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGV4dGVudCA9IGFkanVzdEhlaWdodFRvQXNwZWN0UmF0aW8odmlldywgZXh0ZW50KTtcbiAgICAgICAgcmV0dXJuIGdldEV4dGVudEZvclNjYWxlKHZpZXcsIGV4dGVudCwgdGFyZ2V0U2NhbGUpLnRoZW4oKGV4dGVudCkgPT4ge1xuICAgICAgICAgIHJldHVybiBnb1RvKHZpZXcsIGV4dGVudCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBleHRlbnQgPSBhZGp1c3RFeHRlbnRUb0FzcGVjdFJhdGlvKHZpZXcsIGV4dGVudCk7XG4gICAgICByZXR1cm4gZ2V0U2NhbGVGb3JFeHRlbnQodmlldywgZXh0ZW50KS50aGVuKChleHBlY3RTY2FsZSkgPT4ge1xuICAgICAgICBpZiAobWluU2NhbGUgPiAwICYmIGV4cGVjdFNjYWxlID4gbWluU2NhbGUpIHtcbiAgICAgICAgICAvLyB6b29tIGluXG4gICAgICAgICAgbWluU2NhbGUgPSBnZXRTY2FsZUZvck5leHRUaWxlTGV2ZWwodmlldywgbWluU2NhbGUsIHRydWUpO1xuICAgICAgICAgIGV4dGVudCA9IGFkanVzdEhlaWdodFRvQXNwZWN0UmF0aW8odmlldywgZXh0ZW50KTtcbiAgICAgICAgICByZXR1cm4gZ2V0RXh0ZW50Rm9yU2NhbGUodmlldywgZXh0ZW50LCBtaW5TY2FsZSkudGhlbigoZXh0ZW50KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gZ29Ubyh2aWV3LCBleHRlbnQpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKGV4cGVjdFNjYWxlIDwgbWF4U2NhbGUpIHtcbiAgICAgICAgICAvLyB6b29tIG91dFxuICAgICAgICAgIG1heFNjYWxlID0gZ2V0U2NhbGVGb3JOZXh0VGlsZUxldmVsKHZpZXcsIG1heFNjYWxlLCBmYWxzZSk7XG4gICAgICAgICAgZXh0ZW50ID0gYWRqdXN0SGVpZ2h0VG9Bc3BlY3RSYXRpbyh2aWV3LCBleHRlbnQpO1xuICAgICAgICAgIHJldHVybiBnZXRFeHRlbnRGb3JTY2FsZSh2aWV3LCBleHRlbnQsIG1heFNjYWxlKS50aGVuKChleHRlbnQpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBnb1RvKHZpZXcsIGV4dGVudCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIGdvVG8odmlldywgZXh0ZW50KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9KS5jYXRjaCggKGUpID0+IHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiB6b29tVG9FeHRlbnQodmlldzogX19lc3JpLlZpZXcsIGV4dGVudDogX19lc3JpLkV4dGVudCwgc2NhbGU/OiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgZXh0ZW50ID0gZXh0ZW50LmNsb25lKCk7XG4gIC8vaWYodmlldy50eXBlID09PSAnM2QnICYmICFzY2FsZSkge1xuICAvLyAgLy8gdGVtcG9yYXJ5IHNvbHV0aW9uXG4gIC8vICByZXR1cm4gdmlldy5nb1RvKGV4dGVudCk7XG4gIC8vfVxuXG4gIGlmKCFpc1ZhbGlkRXh0ZW50KGV4dGVudCkpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdJbnZhbGlkIGV4dGVudC4nKSk7XG4gIH1cblxuICByZXR1cm4gcHJvamVjdFRvU3BhdGlhbFJlZmVyZW5jZShbZXh0ZW50XSwgdmlldy5zcGF0aWFsUmVmZXJlbmNlKS50aGVuKChyZXN1bHRFeHRlbnRzKSA9PiB7XG4gICAgbGV0IHJlc3VsdEV4dGVudCA9IHJlc3VsdEV4dGVudHMgJiYgcmVzdWx0RXh0ZW50c1swXTtcbiAgICBpZighcmVzdWx0RXh0ZW50KSB7XG4gICAgICByZXN1bHRFeHRlbnQgPSBleHRlbnQ7XG4gICAgfVxuXG4gICAgLy9AdHMtaWdub3JlXG4gICAgaWYoaXNTaW5nbGVQb2ludEV4dGVudChyZXN1bHRFeHRlbnQpKSB7XG4gICAgICAvL0B0cy1pZ25vcmVcbiAgICAgIHJldHVybiBjb252ZXJ0U2luZ2xlUG9pbnRFeHRlbnQodmlldywgcmVzdWx0RXh0ZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHJlc3VsdEV4dGVudDtcbiAgICB9XG4gIH0pLnRoZW4oKGV4dGVudCkgPT4ge1xuICAgIGlmKHNjYWxlKSB7XG4gICAgICByZXR1cm4gZ2V0RXh0ZW50Rm9yU2NhbGUodmlldywgZXh0ZW50IGFzIGFueSwgc2NhbGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gZXh0ZW50XG4gICAgfVxuICB9KS50aGVuKChleHRlbnQpID0+IHtcbiAgICByZXR1cm4gZ29Ubyh2aWV3LCBleHRlbnQgYXMgYW55KTtcbiAgfSkuY2F0Y2goIChlKSA9PiB7XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gZ29Ubyh2aWV3OiBfX2VzcmkuVmlldywgZXh0ZW50OiBfX2VzcmkuRXh0ZW50KSB7XG4gIC8vQHRzLWlnbm9yZVxuICByZXR1cm4gdmlldy5nb1RvKGV4dGVudCk7XG59XG5cbmZ1bmN0aW9uIGlzVmFsaWRFeHRlbnQoZXh0ZW50OiBfX2VzcmkuRXh0ZW50KTogYm9vbGVhbntcbiAgcmV0dXJuIGV4dGVudCAmJiBpc1ZhbGlkVmFsdWUoZXh0ZW50LnhtaW4pICYmXG4gICAgaXNWYWxpZFZhbHVlKGV4dGVudC55bWluKSAmJlxuICAgIGlzVmFsaWRWYWx1ZShleHRlbnQueG1heCkgJiZcbiAgICBpc1ZhbGlkVmFsdWUoZXh0ZW50LnltYXgpO1xufVxuXG5mdW5jdGlvbiBpc1ZhbGlkVmFsdWUoZTogbnVtYmVyKTogYm9vbGVhbiB7XG4gIGlmIChlID09PSAwKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgcmV0dXJuICEhZTtcbn1cblxuZnVuY3Rpb24gY29udmVydFNpbmdsZVBvaW50RXh0ZW50KHZpZXc6IF9fZXNyaS5WaWV3LCBleHRlbnQ6IF9fZXNyaS5FeHRlbnQpOiBQcm9taXNlPF9fZXNyaS5FeHRlbnQ+IHtcbiAgLy9AdHMtaWdub3JlXG4gIC8vY29uc3QgdGFyZ2V0U2NhbGUgPSBnZXRNZWRpYW5TY2FsZSh2aWV3LCB2aWV3LnNjYWxlLCAwKTtcbiAgY29uc3QgdGFyZ2V0U2NhbGUgPSBnZXRUYXJnZXRTY2FsZSh2aWV3LCAwLCAwLCAzKTtcbiAgaWYodGFyZ2V0U2NhbGUpIHtcbiAgICBleHRlbnQgPSBhZGp1c3RIZWlnaHRUb0FzcGVjdFJhdGlvKHZpZXcsIGV4dGVudCk7XG4gICAgcmV0dXJuIGdldEV4dGVudEZvclNjYWxlKHZpZXcsIGV4dGVudCwgdGFyZ2V0U2NhbGUpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgpO1xuICB9XG59XG5cbmVudW0gU2luZ2xlUG9pbnRPZmZTZXQge1xuICBYID0gMC4wMDAxLFxuICBZID0gMC4wMDAxXG59XG5cbmZ1bmN0aW9uIGlzU2luZ2xlUG9pbnRFeHRlbnQoZXh0ZW50OiBfX2VzcmkuRXh0ZW50KTogYm9vbGVhbiAge1xuICBpZihleHRlbnQueG1pbiArIFNpbmdsZVBvaW50T2ZmU2V0LlggPT09IGV4dGVudC54bWF4IC0gU2luZ2xlUG9pbnRPZmZTZXQuWCAmJlxuICAgICBleHRlbnQueW1pbiArIFNpbmdsZVBvaW50T2ZmU2V0LlkgID09PSBleHRlbnQueW1heCAtIFNpbmdsZVBvaW50T2ZmU2V0LllcbiAgKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIC8vaWYoZXh0ZW50LndpZHRoIDw9IFNpbmdsZVBvaW50T2ZmU2V0LlggKiAyICYmIGV4dGVudC5oZWlnaHQgPD0gU2luZ2xlUG9pbnRPZmZTZXQuWSAqIDIpIHtcbiAgLy8gIHJldHVybiB0cnVlO1xuICAvL30gZWxzZSB7XG4gIC8vICByZXR1cm4gZmFsc2U7XG4gIC8vfVxufVxuXG5mdW5jdGlvbiBncmFwaGljc0V4dGVudCh2aWV3OiBfX2VzcmkuVmlldywgZ3JhcGhpY3NQYXJhbTogX19lc3JpLkdyYXBoaWNbXSwgb3B0aW9uOiBhbnkgPSB7fSk6IFByb21pc2U8X19lc3JpLkV4dGVudD4ge1xuICBsZXQgbGF5ZXIgPSBncmFwaGljc1BhcmFtICYmIGdyYXBoaWNzUGFyYW1bMF0gJiYgZ3JhcGhpY3NQYXJhbVswXS5sYXllcjtcbiAgaWYobGF5ZXIgJiYgbGF5ZXIudHlwZSA9PT0gJ3NjZW5lJykge1xuICAgIHJldHVybiBncmFwaGljc0V4dGVudEZvclNjZW5lTGF5ZXIoZ3JhcGhpY3NQYXJhbSwgbGF5ZXIgYXMgX19lc3JpLlNjZW5lTGF5ZXIsIG9wdGlvbi5mYWN0b3IpO1xuICB9IGVsc2Uge1xuICAgIGlmKHZpZXcudHlwZSA9PT0gJzNkJykge1xuICAgICAgcmV0dXJuIGdyYXBoaWNzRXh0ZW50QmFzZShncmFwaGljc1BhcmFtLCAzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGdyYXBoaWNzRXh0ZW50QmFzZShncmFwaGljc1BhcmFtKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gZ3JhcGhpY3NFeHRlbnRGb3JTY2VuZUxheWVyKGdyYXBoaWNzUGFyYW06IF9fZXNyaS5HcmFwaGljW10sIHNjZW5lTGF5ZXI6IF9fZXNyaS5TY2VuZUxheWVyLCBmYWN0b3I/OiBudW1iZXIpOiBQcm9taXNlPF9fZXNyaS5FeHRlbnQ+IHtcbiAgLy8gY2FuJ3QgZ2V0IGdlb21ldHJ5IGZyb20gYSBncmFwaGljIG9mIHNjZW5lTGF5ZXIuXG4gIHJldHVybiBsb2FkQXJjR0lTSlNBUElNb2R1bGVzKFtcbiAgICAnZXNyaS90YXNrcy9zdXBwb3J0L1F1ZXJ5JyxcbiAgXSkudGhlbihtb2R1bGVzID0+IHtcbiAgICBjb25zdCBbUXVlcnldID0gbW9kdWxlcztcbiAgICBpZihzY2VuZUxheWVyKSB7XG4gICAgICBjb25zdCBxdWVyeSA9IG5ldyBRdWVyeSgpO1xuICAgICAgcXVlcnkub2JqZWN0SWRzID0gZ3JhcGhpY3NQYXJhbS5tYXAoIGdyYXBoaWMgPT4gZ3JhcGhpYy5hdHRyaWJ1dGVzW3NjZW5lTGF5ZXIub2JqZWN0SWRGaWVsZF0pO1xuICAgICAgcXVlcnkucmV0dXJuR2VvbWV0cnkgPSB0cnVlO1xuICAgICAgcmV0dXJuIHNjZW5lTGF5ZXIucXVlcnlFeHRlbnQocXVlcnkpLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgICBpZihyZXN1bHQuY291bnQgPT09IDEpIHtcbiAgICAgICAgICAvLyBzaW5nbGUgZ3JhcGhpY1xuICAgICAgICAgIHJldHVybiByZXN1bHQuZXh0ZW50LmV4cGFuZCgzLjUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiByZXN1bHQuZXh0ZW50LmV4cGFuZCgyKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgpO1xuICAgIH1cbiAgfSkuY2F0Y2goKGUpID0+IFByb21pc2UucmVqZWN0KGUpKTtcbn1cblxuZnVuY3Rpb24gZ3JhcGhpY3NFeHRlbnRCYXNlKGdyYXBoaWNzUGFyYW06IF9fZXNyaS5HcmFwaGljW10sIGZhY3Rvcj86IG51bWJlcik6IFByb21pc2U8X19lc3JpLkV4dGVudD4ge1xuICByZXR1cm4gbG9hZEFyY0dJU0pTQVBJTW9kdWxlcyhbXG4gICAgJ2VzcmkvR3JhcGhpYycsXG4gICAgJ2VzcmkvZ2VvbWV0cnkvRXh0ZW50JyxcbiAgICAnZXNyaS9nZW9tZXRyeS9Qb2ludCdcbiAgXSkudGhlbihtb2R1bGVzID0+IHtcbiAgICBsZXQgR3JhcGhpYzogdHlwZW9mIF9fZXNyaS5HcmFwaGljO1xuICAgIGxldCBFeHRlbnQ6IHR5cGVvZiBfX2VzcmkuRXh0ZW50O1xuICAgIGxldCBQb2ludDogdHlwZW9mIF9fZXNyaS5Qb2ludDtcbiAgICBsZXQgZXh0ID0gbnVsbDtcbiAgICBsZXQgZ3JhcGhpY3MgPSBncmFwaGljc1BhcmFtO1xuICAgIFtHcmFwaGljLCBFeHRlbnQsIFBvaW50XSA9IG1vZHVsZXM7XG4gICAgdHJ5IHtcbiAgICAgIGlmKGdyYXBoaWNzICYmXG4gICAgICAgICBncmFwaGljcy5sZW5ndGggPT09IDEgJiZcbiAgICAgICAgIGdyYXBoaWNzWzBdLmdlb21ldHJ5ICYmXG4gICAgICAgICBncmFwaGljc1swXS5nZW9tZXRyeS5kZWNsYXJlZENsYXNzID09PSAnZXNyaS5nZW9tZXRyeS5NdWx0aXBvaW50JyAmJlxuICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICBncmFwaGljc1swXS5nZW9tZXRyeS5wb2ludHMubGVuZ3RoID09PSAxKSB7XG5cbiAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgIGNvbnN0IG1Qb2ludCA9IGdyYXBoaWNzWzBdLmdlb21ldHJ5LnBvaW50c1swXTtcbiAgICAgICAgY29uc3QgcG9pbnQgPSBuZXcgUG9pbnQoe1xuICAgICAgICAgIHg6IG1Qb2ludFswXSxcbiAgICAgICAgICB5OiBtUG9pbnRbMV0sXG4gICAgICAgICAgc3BhdGlhbFJlZmVyZW5jZTogZ3JhcGhpY3NbMF0uZ2VvbWV0cnkuc3BhdGlhbFJlZmVyZW5jZVxuICAgICAgICB9KTtcbiAgICAgICAgZ3JhcGhpY3MgPSBbbmV3IEdyYXBoaWMoe2dlb21ldHJ5OiBwb2ludH0pXTtcbiAgICAgIH1cblxuICAgICAgaWYoZ3JhcGhpY3MgJiYgZ3JhcGhpY3MubGVuZ3RoID09PSAxICYmXG4gICAgICAgIGdyYXBoaWNzWzBdLmdlb21ldHJ5ICYmXG4gICAgICAgIGdyYXBoaWNzWzBdLmdlb21ldHJ5LmRlY2xhcmVkQ2xhc3MgPT09ICdlc3JpLmdlb21ldHJ5LlBvaW50Jykge1xuICAgICAgICBjb25zdCBnZW9tZXRyeSA9IGdyYXBoaWNzWzBdLmdlb21ldHJ5O1xuICAgICAgICBleHQgPSBuZXcgRXh0ZW50KHtcbiAgICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgICB4bWluOiBnZW9tZXRyeS54IC0gU2luZ2xlUG9pbnRPZmZTZXQuWCxcbiAgICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgICB5bWluOiBnZW9tZXRyeS55IC0gU2luZ2xlUG9pbnRPZmZTZXQuWSxcbiAgICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgICB4bWF4OiBnZW9tZXRyeS54ICsgU2luZ2xlUG9pbnRPZmZTZXQuWCxcbiAgICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgICB5bWF4OiBnZW9tZXRyeS55ICsgU2luZ2xlUG9pbnRPZmZTZXQuWSxcbiAgICAgICAgICBzcGF0aWFsUmVmZXJlbmNlOiBnZW9tZXRyeS5zcGF0aWFsUmVmZXJlbmNlXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIGlmKGdyYXBoaWNzICYmIGdyYXBoaWNzLmxlbmd0aCA+IDApe1xuICAgICAgICBleHQgPSBfZ3JhcGhpY3NFeHRlbnRCYXNlKGdyYXBoaWNzLCBFeHRlbnQpO1xuICAgICAgICBpZiAoZXh0KSB7XG4gICAgICAgICAgaWYoZmFjdG9yICYmIGZhY3RvciA+IDApe1xuICAgICAgICAgICAgZXh0ID0gZXh0LmV4cGFuZChmYWN0b3IpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGV4dDtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCk7XG4gICAgfVxuICB9KS5jYXRjaCgoZSkgPT4gUHJvbWlzZS5yZWplY3QoKSk7XG59XG5cbmZ1bmN0aW9uIF9ncmFwaGljc0V4dGVudEJhc2UoZ3JhcGhpY3M6IF9fZXNyaS5HcmFwaGljW10sIEV4dGVudCk6IF9fZXNyaS5FeHRlbnQge1xuICBpZiAoIWdyYXBoaWNzIHx8ICFncmFwaGljcy5sZW5ndGgpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGxldCBmdWxsRXh0ZW50ID0gbnVsbCwgaW5kZXgsIG51bUdyYXBoaWNzID0gZ3JhcGhpY3MubGVuZ3RoO1xuXG4gIGZvciAoaW5kZXggPSAwOyBpbmRleCA8IG51bUdyYXBoaWNzOyBpbmRleCsrKSB7XG4gICAgY29uc3QgZ2VvbWV0cnkgPSBncmFwaGljc1tpbmRleF0uZ2VvbWV0cnk7XG4gICAgaWYgKCFnZW9tZXRyeSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgbGV0IGV4dGVudCA9IGdlb21ldHJ5LmV4dGVudDtcblxuICAgIC8vQHRzLWlnbm9yZVxuICAgIGlmICghZXh0ZW50ICYmIGdlb21ldHJ5LnR5cGUgPT09ICdwb2ludCcgJiYgZ2VvbWV0cnkueCAhPSBudWxsICYmIGdlb21ldHJ5LnkgIT0gbnVsbCkge1xuICAgICAgZXh0ZW50ID0gbmV3IEV4dGVudCh7XG4gICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICB4bWluOiBnZW9tZXRyeS54LFxuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgeW1pbjogZ2VvbWV0cnkueSxcbiAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgIHhtYXg6IGdlb21ldHJ5LngsXG4gICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICB5bWF4OiBnZW9tZXRyeS55LFxuICAgICAgICBzcGF0aWFsUmVmZXJlbmNlOiBnZW9tZXRyeS5zcGF0aWFsUmVmZXJlbmNlXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAoIWV4dGVudCkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgaWYgKGZ1bGxFeHRlbnQpIHtcbiAgICAgIGZ1bGxFeHRlbnQgPSBmdWxsRXh0ZW50LnVuaW9uKGV4dGVudCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgZnVsbEV4dGVudCA9IGV4dGVudDtcbiAgICB9XG4gIH1cblxuICBpZiAoIWZ1bGxFeHRlbnQgfHwgZnVsbEV4dGVudC53aWR0aCA8IDAgfHwgZnVsbEV4dGVudC5oZWlnaHQgPCAwKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICByZXR1cm4gZnVsbEV4dGVudDtcbn1cblxuLyoqXG4gKiBsb2Q6e2xldmVsLCByZXNvbHV0aW9uLCBzY2FsZX1cbiAqL1xuZnVuY3Rpb24gZ2V0TWFwTG9kcyh2aWV3OiBfX2VzcmkuVmlldyk6IGFueVtde1xuICBsZXQgbG9kcyA9IFtdO1xuICBjb25zdCBiYXNlTGF5ZXJzID0gdmlldy5tYXAuYmFzZW1hcC5iYXNlTGF5ZXJzO1xuICBiYXNlTGF5ZXJzLmZvckVhY2goKGJhc2VMYXllcikgPT4ge1xuICAgIGlmKGJhc2VMYXllciAmJlxuICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgIGJhc2VMYXllci50aWxlSW5mbyAmJlxuICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgIGJhc2VMYXllci50aWxlSW5mby5sb2RzICYmXG4gICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgbG9kcy5sZW5ndGggPCBiYXNlTGF5ZXIudGlsZUluZm8ubG9kcy5sZW5ndGgpIHtcbiAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgbG9kcyA9IGJhc2VMYXllci50aWxlSW5mby5sb2RzO1xuICAgIH1cbiAgfSk7XG5cbiAgLy9sb2RzID0gbG9kcy5tYXAoKGxvZCkgPT4gbG9kLnRvSlNPTigpKTtcbiAgaWYobG9kcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gVGlsZUluZm8uY3JlYXRlKCkubG9kcztcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbG9kcztcbiAgfVxufVxuXG4vL2Z1bmN0aW9uIGdldE1lZGlhblNjYWxlKHZpZXc6IF9fZXNyaS5WaWV3LCBtaW5TY2FsZTogbnVtYmVyLCBtYXhTY2FsZTogbnVtYmVyKTogbnVtYmVyIHtcbi8vICByZXR1cm4gZ2V0VGFyZ2V0U2NhbGUodmlldywgbWluU2NhbGUsIG1heFNjYWxlLCAyKTtcbi8vfVxuXG5mdW5jdGlvbiBnZXRUYXJnZXRTY2FsZSh2aWV3OiBfX2VzcmkuVmlldywgbWluU2NhbGU6IG51bWJlciwgbWF4U2NhbGU6IG51bWJlciwgZmFjdG9yOiBudW1iZXIpOiBudW1iZXIgIHtcbiAgY29uc3QgbWFwTG9kcyA9IGdldE1hcExvZHModmlldyk7XG4gIGxldCB0YXJnZXRTY2FsZTtcbiAgbGV0IG1pZ3JhdGlvblBhcmFtID0gMTtcbiAgaWYobWFwTG9kcykge1xuICAgIGNvbnN0IHZpc2libGVTY2FsZXMgPSBbXTtcbiAgICBjb25zdCBsZXNzVGhhbk1heFNjYWxlcyA9IFtdO1xuXG4gICAgbWFwTG9kcy5mb3JFYWNoKChtYXBMb2QpID0+IHtcbiAgICAgIGlmIChtaW5TY2FsZSA+IDAgJiYgbWFwTG9kLnNjYWxlID4gbWluU2NhbGUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfSBlbHNlIGlmIChtYXBMb2Quc2NhbGUgPCBtYXhTY2FsZSkge1xuICAgICAgICBsZXNzVGhhbk1heFNjYWxlcy5wdXNoKG1hcExvZC5zY2FsZSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZpc2libGVTY2FsZXMucHVzaChtYXBMb2Quc2NhbGUpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHZpc2libGVTY2FsZXMucmV2ZXJzZSgpO1xuICAgIGxldCB0YXJnZXRJbmRleDtcbiAgICBpZih2aXNpYmxlU2NhbGVzLmxlbmd0aCA+PSAxKSB7XG4gICAgICBtaWdyYXRpb25QYXJhbSA9IGxlc3NUaGFuTWF4U2NhbGVzLmxlbmd0aCA/IGxlc3NUaGFuTWF4U2NhbGVzLmxlbmd0aCAvIG1hcExvZHMubGVuZ3RoIDogMTtcbiAgICAgIHRhcmdldEluZGV4ID0gTWF0aC5mbG9vciggKHZpc2libGVTY2FsZXMubGVuZ3RoIC0gMSkgLyAoZmFjdG9yIC8gbWlncmF0aW9uUGFyYW0pKTtcbiAgICAgIHRhcmdldFNjYWxlID0gdmlzaWJsZVNjYWxlc1t0YXJnZXRJbmRleF07XG4gICAgfSBlbHNlIHtcbiAgICAgIHRhcmdldFNjYWxlID0gbnVsbDtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgaWYobWluU2NhbGUgPT09IDApIHtcbiAgICAgIHRhcmdldFNjYWxlID0gbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGFyZ2V0U2NhbGUgPSAobWluU2NhbGUgLSBtYXhTY2FsZSkgLyBmYWN0b3I7XG4gICAgfVxuICB9XG4gIHJldHVybiB0YXJnZXRTY2FsZTtcbn1cblxuZnVuY3Rpb24gZ2V0U2NhbGVGb3JOZXh0VGlsZUxldmVsKHZpZXc6IF9fZXNyaS5WaWV3LCBzY2FsZTogbnVtYmVyLCB6b29tSW46IGJvb2xlYW4pOiBudW1iZXIge1xuICBsZXQgaTtcbiAgY29uc3QgbWFwTG9kcyA9IGdldE1hcExvZHModmlldyk7XG4gIGlmIChtYXBMb2RzKSB7XG4gICAgaWYgKHpvb21Jbikge1xuICAgICAgZm9yIChpID0gMDsgaSA8IG1hcExvZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKG1hcExvZHNbaV0uc2NhbGUgPCBzY2FsZSkge1xuICAgICAgICAgIHJldHVybiBtYXBMb2RzW2ldLnNjYWxlIC0gMTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG1hcExvZHNbbWFwTG9kcy5sZW5ndGggLSAxXS5zY2FsZSAtIDE7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZvciAoaSA9IG1hcExvZHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgaWYgKG1hcExvZHNbaV0uc2NhbGUgPiBzY2FsZSkge1xuICAgICAgICAgIHJldHVybiBtYXBMb2RzW2ldLnNjYWxlICsgMTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG1hcExvZHNbMF0uc2NhbGUgKyAxO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpZiAoem9vbUluKSB7XG4gICAgICByZXR1cm4gc2NhbGUgLSAxO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gc2NhbGUgKyAxO1xuICAgIH1cbiAgfVxuICByZXR1cm4gc2NhbGU7XG59XG5cbmZ1bmN0aW9uIGFkanVzdEV4dGVudFRvQXNwZWN0UmF0aW8odmlldzogX19lc3JpLlZpZXcsIGV4dGVudDogX19lc3JpLkV4dGVudCk6IF9fZXNyaS5FeHRlbnQge1xuICBjb25zdCBtYXBSYXRpbyA9IHZpZXcuc2l6ZVswXSAvIHZpZXcuc2l6ZVsxXTsgLy8gd2lkdGggLyBoZWlnaHRcbiAgY29uc3QgZXh0ZW50UmF0aW8gPSBleHRlbnQud2lkdGggLyBleHRlbnQuaGVpZ2h0O1xuXG4gIGlmKGV4dGVudFJhdGlvID4gbWFwUmF0aW8pIHtcbiAgICBjb25zdCB5QnVmID0gZXh0ZW50LndpZHRoIC8gbWFwUmF0aW8gLyAyO1xuICAgIGV4dGVudC55bWluID0gZXh0ZW50LmNlbnRlci55IC0geUJ1ZjtcbiAgICBleHRlbnQueW1heCA9IGV4dGVudC5jZW50ZXIueSArIHlCdWY7XG4gIH0gZWxzZSBpZihleHRlbnRSYXRpbyA8IG1hcFJhdGlvKXtcbiAgICBjb25zdCB4QnVmID0gZXh0ZW50LmhlaWdodCAqIG1hcFJhdGlvIC8gMjtcbiAgICBleHRlbnQueG1pbiA9IGV4dGVudC5jZW50ZXIueCAtIHhCdWY7XG4gICAgZXh0ZW50LnhtYXggPSBleHRlbnQuY2VudGVyLnggKyB4QnVmO1xuICB9XG5cbiAgcmV0dXJuIGV4dGVudDtcbn1cblxuZnVuY3Rpb24gYWRqdXN0SGVpZ2h0VG9Bc3BlY3RSYXRpbyh2aWV3OiBfX2VzcmkuVmlldywgZXh0ZW50OiBfX2VzcmkuRXh0ZW50KTogX19lc3JpLkV4dGVudCB7XG4gIC8vIGFkanVzdCB0aGUgaGVpZ2h0IG9mIHRoZSBleHRlbnQgc28gaXQgd29uJ3QgbWVzcyB1cCBvdXIgc2NhbGUgY2FsY3VsYXRpb25zIHRoYXQgd2UgZG8gd2l0aCB0aGUgd2lkdGhcbiAgLy8gbWFrZSBpdCBhIGxpdHRsZSBzbWFsbGVyIHRvIGJlIHN1cmVcbiAgY29uc3QgYnVmID0gKGV4dGVudC53aWR0aCAqICh2aWV3LnNpemVbMV0gLyB2aWV3LnNpemVbMF0pKSAvIDU7XG4gIGV4dGVudC55bWluID0gZXh0ZW50LmNlbnRlci55IC0gYnVmO1xuICBleHRlbnQueW1heCA9IGV4dGVudC5jZW50ZXIueSArIGJ1ZjtcbiAgcmV0dXJuIGV4dGVudDtcbn1cblxuZnVuY3Rpb24gZ2V0RXh0ZW50Rm9yU2NhbGUodmlldzogX19lc3JpLlZpZXcsIGV4dGVudDogX19lc3JpLkV4dGVudCwgc2NhbGU6IG51bWJlcik6IFByb21pc2U8X19lc3JpLkV4dGVudD4ge1xuICByZXR1cm4gbG9hZEFyY0dJU0pTQVBJTW9kdWxlcyhbXG4gICAgJ2VzcmkvY29uZmlnJyxcbiAgICAnZXNyaS9nZW9tZXRyeS9zdXBwb3J0L1dLSURVbml0Q29udmVyc2lvbidcbiAgXSkudGhlbihtb2R1bGVzID0+IHtcbiAgICBsZXQgZXNyaUNvbmZpZztcbiAgICBsZXQgV0tJRFVuaXRDb252ZXJzaW9uO1xuICAgIFtlc3JpQ29uZmlnLCBXS0lEVW5pdENvbnZlcnNpb25dID0gbW9kdWxlcztcbiAgICBjb25zdCBtYXBXaWR0aCA9IHZpZXcuc2l6ZVswXTtcbiAgICBjb25zdCBpbmNoZXNQZXJNZXRlciA9IDM5LjM3LFxuICAgICAgZGVjRGVnVG9NZXRlcnMgPSAyMDAxNTA3Ny4wIC8gMTgwLjAsXG4gICAgICBsb29rdXAgPSBXS0lEVW5pdENvbnZlcnNpb247XG4gICAgbGV0IHdraWQsIHdrdCwgc3IgPSBleHRlbnQuc3BhdGlhbFJlZmVyZW5jZTtcbiAgICBpZiAoc3IpIHtcbiAgICAgIHdraWQgPSBzci53a2lkO1xuICAgICAgd2t0ID0gc3Iud2t0O1xuICAgIH1cblxuICAgIGxldCB1bml0VmFsdWUgPSBudWxsO1xuICAgIGlmICh3a2lkKSB7XG4gICAgICB1bml0VmFsdWUgPSBsb29rdXAudmFsdWVzW2xvb2t1cFt3a2lkXV07XG4gICAgfSBlbHNlIGlmICh3a3QgJiYgKHdrdC5zZWFyY2goL15QUk9KQ1MvaSkgIT09IC0xKSkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gL1VOSVRcXFsoW15cXF1dKylcXF1cXF0kL2kuZXhlYyh3a3QpO1xuICAgICAgaWYgKHJlc3VsdCAmJiByZXN1bHRbMV0pIHtcbiAgICAgICAgdW5pdFZhbHVlID0gcGFyc2VGbG9hdChyZXN1bHRbMV0uc3BsaXQoJywnKVsxXSk7XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IG5ld0V4dGVudCA9IGV4dGVudC5leHBhbmQoKChzY2FsZSAqIG1hcFdpZHRoKSAvXG4gICAgICAgICAgICAgICAgICAgICgodW5pdFZhbHVlIHx8IGRlY0RlZ1RvTWV0ZXJzKSAqIGluY2hlc1Blck1ldGVyICogKGVzcmlDb25maWcuc2NyZWVuRFBJIHx8IDk2KSkpIC9cbiAgICAgICAgICAgICAgICAgICAgZXh0ZW50LndpZHRoKTtcbiAgICByZXR1cm4gbmV3RXh0ZW50O1xuICB9KS5jYXRjaCggKGUpID0+IFByb21pc2UucmVqZWN0KCkgKTtcbn1cblxuZnVuY3Rpb24gZ2V0U2NhbGVGb3JFeHRlbnQodmlldzogX19lc3JpLlZpZXcsIGV4dGVudDogX19lc3JpLkV4dGVudCk6IFByb21pc2U8bnVtYmVyPiB7XG4gIHJldHVybiBsb2FkQXJjR0lTSlNBUElNb2R1bGVzKFtcbiAgICAnZXNyaS9jb25maWcnLFxuICAgICdlc3JpL2dlb21ldHJ5L3N1cHBvcnQvV0tJRFVuaXRDb252ZXJzaW9uJ1xuICBdKS50aGVuKG1vZHVsZXMgPT4ge1xuICAgIGxldCBlc3JpQ29uZmlnO1xuICAgIGxldCBXS0lEVW5pdENvbnZlcnNpb247XG4gICAgW2VzcmlDb25maWcsIFdLSURVbml0Q29udmVyc2lvbl0gPSBtb2R1bGVzO1xuICAgIGxldCBzY2FsZTtcbiAgICBjb25zdCBtYXBXaWR0aCA9IHZpZXcuc2l6ZVswXTtcbiAgICBjb25zdCBpbmNoZXNQZXJNZXRlciA9IDM5LjM3LFxuICAgICAgZGVjRGVnVG9NZXRlcnMgPSAyMDAxNTA3Ny4wIC8gMTgwLjAsXG4gICAgICBsb29rdXAgPSBXS0lEVW5pdENvbnZlcnNpb247XG5cbiAgICBsZXQgd2tpZCwgd2t0LCBzciA9IGV4dGVudC5zcGF0aWFsUmVmZXJlbmNlO1xuICAgIGlmIChzcikge1xuICAgICAgd2tpZCA9IHNyLndraWQ7XG4gICAgICB3a3QgPSBzci53a3Q7XG4gICAgfVxuXG4gICAgbGV0IHVuaXRWYWx1ZSA9IG51bGw7XG4gICAgaWYgKHdraWQpIHtcbiAgICAgIHVuaXRWYWx1ZSA9IGxvb2t1cC52YWx1ZXNbbG9va3VwW3draWRdXTtcbiAgICB9IGVsc2UgaWYgKHdrdCAmJiAod2t0LnNlYXJjaCgvXlBST0pDUy9pKSAhPT0gLTEpKSB7XG4gICAgICBjb25zdCByZXN1bHQgPSAvVU5JVFxcWyhbXlxcXV0rKVxcXVxcXSQvaS5leGVjKHdrdCk7XG4gICAgICBpZiAocmVzdWx0ICYmIHJlc3VsdFsxXSkge1xuICAgICAgICB1bml0VmFsdWUgPSBwYXJzZUZsb2F0KHJlc3VsdFsxXS5zcGxpdCgnLCcpWzFdKTtcbiAgICAgIH1cbiAgICB9XG4gICAgc2NhbGUgPSAoZXh0ZW50LndpZHRoIC8gbWFwV2lkdGgpICogKHVuaXRWYWx1ZSB8fCBkZWNEZWdUb01ldGVycykgKiBpbmNoZXNQZXJNZXRlciAqIChlc3JpQ29uZmlnLnNjcmVlbkRQSSB8fCA5Nik7XG4gICAgcmV0dXJuIHNjYWxlO1xuICB9KS5jYXRjaCggKGUpID0+IFByb21pc2UucmVqZWN0KCkgKTtcbn1cblxuZnVuY3Rpb24gbGF5ZXJFeHRlbnQodmlldzogX19lc3JpLlZpZXcsIGxheWVyOiBfX2VzcmkuTGF5ZXIpOiBQcm9taXNlPF9fZXNyaS5FeHRlbnQ+IHtcbiAgaWYobGF5ZXIudHlwZSA9PT0gJ2ZlYXR1cmUnKSB7XG4gICAgcmV0dXJuIGZlYXR1cmVMYXllckV4dGVudCh2aWV3LCBsYXllcik7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShsYXllci5mdWxsRXh0ZW50LmNsb25lKCkpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGZlYXR1cmVMYXllckV4dGVudCh2aWV3OiBfX2VzcmkuVmlldywgbGF5ZXI6IF9fZXNyaS5MYXllcik6IFByb21pc2U8X19lc3JpLkV4dGVudD4ge1xuICAvKlxuICB2YXIgbGF5ZXJWaWV3ID0gbnVsbDtcbiAgdmlldy5hbGxMYXllclZpZXdzLnNvbWUoIF9sYXllclZpZXcgPT4ge1xuICAgIF9sYXllclZpZXcubGF5ZXIuaWQgPT09IGxheWVyLmlkID8gbGF5ZXJWaWV3ID0gX2xheWVyVmlldyA6IGZhbHNlO1xuICB9KTtcbiAgbGV0IHF1ZXJ5RXh0ZW50ID0gbGF5ZXJWaWV3ICYmIGxheWVyVmlldy5xdWVyeUV4dGVudCgpO1xuICB2YXIgZGVmYXVsdEV4dGVudCA9ICBpc1ZhbGlkRXh0ZW50KHF1ZXJ5RXh0ZW50KSA/IHF1ZXJ5RXh0ZW50IDogbGF5ZXIuZnVsbEV4dGVudC5jbG9uZSgpO1xuICAqL1xuICBjb25zdCBkZWZhdWx0RXh0ZW50ID0gbGF5ZXIuZnVsbEV4dGVudC5jbG9uZSgpO1xuXG4gIC8vQHRzLWlnbm9yZVxuICBpZighbGF5ZXIudXJsKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShkZWZhdWx0RXh0ZW50KTtcbiAgfVxuXG4gIC8vQHRzLWlnbm9yZVxuICBjb25zdCBxdWVyeUNhcGFiaWxpdGllcyA9IGxheWVyLmNhcGFiaWxpdGllcy5xdWVyeTtcbiAgaWYgKHF1ZXJ5Q2FwYWJpbGl0aWVzKSB7XG4gICAgcmV0dXJuIGxvYWRBcmNHSVNKU0FQSU1vZHVsZXMoW1xuICAgICAgJ2VzcmkvdGFza3Mvc3VwcG9ydC9RdWVyeScsXG4gICAgXSkudGhlbihtb2R1bGVzID0+IHtcbiAgICAgIGxldCBRdWVyeTtcbiAgICAgIFtRdWVyeV0gPSBtb2R1bGVzO1xuICAgICAgY29uc3QgcXVlcnkgPSBuZXcgUXVlcnkoKTtcbiAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgcXVlcnkud2hlcmUgPSBsYXllci5kZWZpbml0aW9uRXhwcmVzc2lvbiA/IGxheWVyLmRlZmluaXRpb25FeHByZXNzaW9uIDogJzE9MSc7XG4gICAgICBxdWVyeS5vdXRTcGF0aWFsUmVmZXJlbmNlID0gdmlldy5zcGF0aWFsUmVmZXJlbmNlO1xuICAgICAgcXVlcnkucmV0dXJuR2VvbWV0cnkgPSB0cnVlO1xuXG4gICAgICBpZihxdWVyeUNhcGFiaWxpdGllcy5zdXBwb3J0c0V4dGVudCkge1xuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgcmV0dXJuIGxheWVyLnF1ZXJ5RXh0ZW50KHF1ZXJ5KS50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgICByZXR1cm4gcmVzdWx0LmV4dGVudDtcbiAgICAgICAgfSkuY2F0Y2goKGUpID0+IFByb21pc2UucmVzb2x2ZShkZWZhdWx0RXh0ZW50KSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgcmV0dXJuIGxheWVyLnF1ZXJ5RmVhdHVyZXMocXVlcnkpLnRoZW4oKGZlYXR1cmVTZXQpID0+IHtcbiAgICAgICAgICByZXR1cm4gZ3JhcGhpY3NFeHRlbnQodmlldywgZmVhdHVyZVNldC5mZWF0dXJlcyk7XG4gICAgICAgIH0pLmNhdGNoKChlKSA9PiBQcm9taXNlLnJlc29sdmUoZGVmYXVsdEV4dGVudCkpO1xuICAgICAgfVxuICAgIH0pLmNhdGNoKChlKSA9PiBQcm9taXNlLnJlc29sdmUoZGVmYXVsdEV4dGVudCkpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZGVmYXVsdEV4dGVudCk7XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7Ozs7OztBQU9BO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./jimu-arcgis/lib/utils/zoomto-utils.ts\n");

/***/ }),

/***/ "./jimu-arcgis/lib/views/index.ts":
/*!****************************************!*\
  !*** ./jimu-arcgis/lib/views/index.ts ***!
  \****************************************/
/*! exports provided: JimuLayerView, JimuFeatureLayerView, JimuMapView, JimuMapViewGroup */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _layers_jimu_layer_view__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./layers/jimu-layer-view */ \"./jimu-arcgis/lib/views/layers/jimu-layer-view.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"JimuLayerView\", function() { return _layers_jimu_layer_view__WEBPACK_IMPORTED_MODULE_0__[\"JimuLayerView\"]; });\n\n/* harmony import */ var _layers_jimu_feature_layer_view__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./layers/jimu-feature-layer-view */ \"./jimu-arcgis/lib/views/layers/jimu-feature-layer-view.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"JimuFeatureLayerView\", function() { return _layers_jimu_feature_layer_view__WEBPACK_IMPORTED_MODULE_1__[\"JimuFeatureLayerView\"]; });\n\n/* harmony import */ var _jimu_map_view__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./jimu-map-view */ \"./jimu-arcgis/lib/views/jimu-map-view.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"JimuMapView\", function() { return _jimu_map_view__WEBPACK_IMPORTED_MODULE_2__[\"JimuMapView\"]; });\n\n/* harmony import */ var _jimu_map_view_group__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./jimu-map-view-group */ \"./jimu-arcgis/lib/views/jimu-map-view-group.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"JimuMapViewGroup\", function() { return _jimu_map_view_group__WEBPACK_IMPORTED_MODULE_3__[\"JimuMapViewGroup\"]; });\n\n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9saWIvdmlld3MvaW5kZXgudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qaW11LWFyY2dpcy9saWIvdmlld3MvaW5kZXgudHM/MjcyNiJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgKiBmcm9tICcuL2xheWVycy9qaW11LWxheWVyLXZpZXcnO1xuZXhwb3J0ICogZnJvbSAnLi9sYXllcnMvamltdS1mZWF0dXJlLWxheWVyLXZpZXcnO1xuZXhwb3J0ICogZnJvbSAnLi9qaW11LW1hcC12aWV3JztcbmV4cG9ydCAqIGZyb20gJy4vamltdS1tYXAtdmlldy1ncm91cCc7Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./jimu-arcgis/lib/views/index.ts\n");

/***/ }),

/***/ "./jimu-arcgis/lib/views/jimu-map-view-group.ts":
/*!******************************************************!*\
  !*** ./jimu-arcgis/lib/views/jimu-map-view-group.ts ***!
  \******************************************************/
/*! exports provided: JimuMapViewGroup */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"JimuMapViewGroup\", function() { return JimuMapViewGroup; });\n/** @ignore */\nvar JimuMapViewGroup = /** @class */ (function () {\n    function JimuMapViewGroup(mapWidgetId) {\n        var _this = this;\n        this.switchMap = function () {\n            if (_this.mapWidgetInstance) {\n                return _this.mapWidgetInstance.switchMap();\n            }\n            else {\n                return Promise.resolve();\n            }\n        };\n        this.fullScreenMap = function () {\n            if (_this.mapWidgetInstance) {\n                _this.mapWidgetInstance.fullScreenMap();\n            }\n        };\n        this.mapWidgetId = mapWidgetId;\n        this.jimuMapViews = {};\n    }\n    JimuMapViewGroup.prototype.setMapWidgetInstance = function (mapWidgetInstance) {\n        this.mapWidgetInstance = mapWidgetInstance;\n    };\n    JimuMapViewGroup.prototype.addJimuMapView = function (jimuMapView) {\n        this.jimuMapViews[jimuMapView.id] = jimuMapView;\n    };\n    JimuMapViewGroup.prototype.setJimuMapView = function (jimuMapView) {\n        this.jimuMapViews[jimuMapView.id] = jimuMapView;\n    };\n    JimuMapViewGroup.prototype.removeJimuMapView = function (jimuMapView) {\n        delete this.jimuMapViews[jimuMapView.id];\n    };\n    JimuMapViewGroup.prototype.getActiveJimuMapView = function () {\n        var jimuMapViewIds = Object.keys(this.jimuMapViews);\n        for (var i = 0; i < jimuMapViewIds.length; i++) {\n            if (this.jimuMapViews[jimuMapViewIds[i]].isActive) {\n                return this.jimuMapViews[jimuMapViewIds[i]];\n                break;\n            }\n        }\n        return null;\n    };\n    return JimuMapViewGroup;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9saWIvdmlld3MvamltdS1tYXAtdmlldy1ncm91cC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtYXJjZ2lzL2xpYi92aWV3cy9qaW11LW1hcC12aWV3LWdyb3VwLnRzP2YzYTciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtKaW11TWFwVmlld30gZnJvbSAnLi9qaW11LW1hcC12aWV3JztcblxuZXhwb3J0IHR5cGUgSmltdU1hcENsYXNzID0ge1xuICBzd2l0Y2hNYXA6ICgpID0+IFByb21pc2U8YW55PjtcbiAgZnVsbFNjcmVlbk1hcDogKCkgPT4gdm9pZDtcbn1cblxuLyoqIEBpZ25vcmUgKi9cbmV4cG9ydCBjbGFzcyBKaW11TWFwVmlld0dyb3VwIHtcbiAgbWFwV2lkZ2V0SWQ6IHN0cmluZztcbiAgamltdU1hcFZpZXdzOiB7W2lkOiBzdHJpbmddOiBKaW11TWFwVmlld307XG4gIG1hcFdpZGdldEluc3RhbmNlOiBKaW11TWFwQ2xhc3M7XG5cbiAgY29uc3RydWN0b3IobWFwV2lkZ2V0SWQ6IHN0cmluZykge1xuICAgIHRoaXMubWFwV2lkZ2V0SWQgPSBtYXBXaWRnZXRJZDtcbiAgICB0aGlzLmppbXVNYXBWaWV3cyA9IHt9O1xuICB9XG5cbiAgc2V0TWFwV2lkZ2V0SW5zdGFuY2UobWFwV2lkZ2V0SW5zdGFuY2U6IEppbXVNYXBDbGFzcykge1xuICAgIHRoaXMubWFwV2lkZ2V0SW5zdGFuY2UgPSBtYXBXaWRnZXRJbnN0YW5jZTtcbiAgfVxuXG4gIGFkZEppbXVNYXBWaWV3KGppbXVNYXBWaWV3OiBKaW11TWFwVmlldykge1xuICAgIHRoaXMuamltdU1hcFZpZXdzW2ppbXVNYXBWaWV3LmlkXSA9IGppbXVNYXBWaWV3O1xuICB9XG5cbiAgc2V0SmltdU1hcFZpZXcoamltdU1hcFZpZXc6IEppbXVNYXBWaWV3KSB7XG4gICAgdGhpcy5qaW11TWFwVmlld3NbamltdU1hcFZpZXcuaWRdID0gamltdU1hcFZpZXc7XG4gIH1cblxuICByZW1vdmVKaW11TWFwVmlldyhqaW11TWFwVmlldzogSmltdU1hcFZpZXcpIHtcbiAgICBkZWxldGUgdGhpcy5qaW11TWFwVmlld3NbamltdU1hcFZpZXcuaWRdO1xuICB9XG5cbiAgZ2V0QWN0aXZlSmltdU1hcFZpZXcoKTogSmltdU1hcFZpZXcge1xuICAgIGNvbnN0IGppbXVNYXBWaWV3SWRzID0gT2JqZWN0LmtleXModGhpcy5qaW11TWFwVmlld3MpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgamltdU1hcFZpZXdJZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0aGlzLmppbXVNYXBWaWV3c1tqaW11TWFwVmlld0lkc1tpXV0uaXNBY3RpdmUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuamltdU1hcFZpZXdzW2ppbXVNYXBWaWV3SWRzW2ldXTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgc3dpdGNoTWFwID0gKCk6IFByb21pc2U8YW55PiA9PiB7XG4gICAgaWYgKHRoaXMubWFwV2lkZ2V0SW5zdGFuY2UpIHtcbiAgICAgIHJldHVybiB0aGlzLm1hcFdpZGdldEluc3RhbmNlLnN3aXRjaE1hcCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICB9XG5cbiAgZnVsbFNjcmVlbk1hcCA9ICgpID0+IHtcbiAgICBpZiAodGhpcy5tYXBXaWRnZXRJbnN0YW5jZSkge1xuICAgICAgdGhpcy5tYXBXaWRnZXRJbnN0YW5jZS5mdWxsU2NyZWVuTWFwKCk7XG4gICAgfVxuICB9XG59Il0sIm1hcHBpbmdzIjoiQUFPQTtBQUFBO0FBQUE7QUFDQTtBQUtBO0FBQUE7QUFnQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUEzQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFlQTtBQUFBOzsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./jimu-arcgis/lib/views/jimu-map-view-group.ts\n");

/***/ }),

/***/ "./jimu-arcgis/lib/views/jimu-map-view.ts":
/*!************************************************!*\
  !*** ./jimu-arcgis/lib/views/jimu-map-view.ts ***!
  \************************************************/
/*! exports provided: JimuMapView */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"JimuMapView\", function() { return JimuMapView; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _layers_jimu_layer_view__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./layers/jimu-layer-view */ \"./jimu-arcgis/lib/views/layers/jimu-layer-view.ts\");\n/* harmony import */ var _layers_jimu_feature_layer_view__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./layers/jimu-feature-layer-view */ \"./jimu-arcgis/lib/views/layers/jimu-feature-layer-view.ts\");\n/* harmony import */ var _layers_jimu_group_layer_view__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./layers/jimu-group-layer-view */ \"./jimu-arcgis/lib/views/layers/jimu-group-layer-view.ts\");\n/* harmony import */ var _layers_jimu_tile_layer_view__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./layers/jimu-tile-layer-view */ \"./jimu-arcgis/lib/views/layers/jimu-tile-layer-view.ts\");\n/* harmony import */ var _layers_jimu_mapimage_layer_view__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./layers/jimu-mapimage-layer-view */ \"./jimu-arcgis/lib/views/layers/jimu-mapimage-layer-view.ts\");\n/* harmony import */ var _mapview_manager__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../mapview-manager */ \"./jimu-arcgis/lib/mapview-manager.tsx\");\n/* harmony import */ var _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../data-sources/arcgis-data-source-interface */ \"./jimu-arcgis/lib/data-sources/arcgis-data-source-interface.ts\");\n/* harmony import */ var _arcgis_js_api_module_loader__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../arcgis-js-api-module-loader */ \"./jimu-arcgis/lib/arcgis-js-api-module-loader.ts\");\n\n\n\n\n\n\n\n\n\n/**\n * JimuMapView is the view for developers to develop the related map function.\n * For example, developers can use the view property of the JimuMapView instance to get the original arcgis api 4.x view, then use\n * the original view to develop the related map function. At the same time,\n * JimuMapView also provides properties such as `isActive`, `status`, etc. to indicate the current status in the map widget.\n */\nvar JimuMapView = /** @class */ (function () {\n    function JimuMapView(options) {\n        var _this = this;\n        /** @ignore */\n        this.jimuLayerViewLoadPromises = {};\n        /** @ignore */\n        this.isEnableHighlight = true;\n        /** @ignore */\n        this.getJimuLayerViewId = function (rootDsId, layerId) {\n            var rootDs = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"DataSourceManager\"].getInstance().getDataSource(rootDsId);\n            if (!rootDs) {\n                return null;\n            }\n            var jimuLayerId = rootDs.getJimuChildId(layerId)[0];\n            return _this.id + '-' + jimuLayerId;\n        };\n        /** @ignore */\n        this.clearSelectedFeatures = function () {\n            var jimuLayerViews = _this.jimuLayerViews;\n            var jimuLayerViewKeys = Object.keys(jimuLayerViews);\n            for (var i = 0; i < jimuLayerViewKeys.length; i++) {\n                var tempJimuLayerView = jimuLayerViews[jimuLayerViewKeys[i]];\n                if (tempJimuLayerView.type === _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_7__[\"LayerTypes\"].FeatureLayer) {\n                    tempJimuLayerView.selectFeaturesByIds([]);\n                }\n            }\n            jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"MessageManager\"].getInstance().publishMessage(new jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"DataRecordsSelectionChangeMessage\"](_this.mapWidgetId, []));\n        };\n        /** @ignore */\n        this.getSelectRecordsByQueryPromise = function (tempJimuFeatureLayerView, query) {\n            return tempJimuFeatureLayerView.selectRecordsByQuery(query);\n        };\n        this.id = options.mapWidgetId + '-' + options.datasourceId;\n        this.mapWidgetId = options.mapWidgetId;\n        this.isActive = options.isActive;\n        this.datasourceId = options.datasourceId;\n        this.view = options.view;\n        this.jimuLayerViews = {};\n        this.status = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"JimuMapViewStatus\"].Loading;\n        this.isEnablePopup = (options.isEnablePopup === undefined || options.isEnablePopup === null) ? true : options.isEnablePopup;\n        this.isEditing = false;\n        this.initView(this.view);\n    }\n    /** @ignore */\n    JimuMapView.prototype.startEdit = function () {\n        this.isEditing = true;\n    };\n    /** @ignore */\n    JimuMapView.prototype.exitEdit = function () {\n        this.isEditing = false;\n    };\n    /** @ignore */\n    JimuMapView.prototype.getIsEditing = function () {\n        return this.isEditing;\n    };\n    /** @ignore */\n    JimuMapView.prototype.enablePopup = function () {\n        if (!this.isEditing || this.isEnablePopup) {\n            return;\n        }\n        if (this.view && this.view.popup) {\n            this.view.popup.autoOpenEnabled = true;\n            this.isEnablePopup = true;\n        }\n    };\n    /** @ignore */\n    JimuMapView.prototype.disablePopup = function () {\n        if (!this.isEditing || !this.isEnablePopup) {\n            return;\n        }\n        if (this.view && this.view.popup) {\n            this.view.popup.autoOpenEnabled = false;\n            this.isEnablePopup = false;\n        }\n    };\n    /** @ignore */\n    JimuMapView.prototype.getIsEnablePopup = function () {\n        return this.isEnablePopup;\n    };\n    /** @ignore */\n    JimuMapView.prototype.enableHighlight = function () {\n        if (!this.isEditing || this.isEnableHighlight) {\n            return;\n        }\n        this.isEnableHighlight = true;\n    };\n    /** @ignore */\n    JimuMapView.prototype.disableHighlight = function () {\n        if (!this.isEditing || !this.isEnableHighlight) {\n            return;\n        }\n        this.isEnableHighlight = false;\n    };\n    /** @ignore */\n    JimuMapView.prototype.getIsEnableHighlight = function () {\n        return this.isEnableHighlight;\n    };\n    /** @ignore */\n    JimuMapView.prototype.setIsActive = function (isActive) {\n        this.isActive = isActive;\n        _mapview_manager__WEBPACK_IMPORTED_MODULE_6__[\"MapViewManager\"].getInstance().setJimuMapView(this);\n    };\n    /** @ignore */\n    JimuMapView.prototype.initView = function (view) {\n        var _this = this;\n        if (!view) {\n            return;\n        }\n        view.when(function () {\n            view.on('click', _this.onClick.bind(_this));\n        });\n    };\n    /** @ignore */\n    JimuMapView.prototype.onClick = function (event) {\n        var _this = this;\n        var screenPoint = {\n            x: event.x,\n            y: event.y\n        };\n        this.view.hitTest(screenPoint).then(function (response) {\n            if (!_this.isEnableHighlight) {\n                return;\n            }\n            if (!response || !response.results || response.results.length === 0) {\n                _this.clearAllJimuLayerViewsSelectRecord();\n                jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"MessageManager\"].getInstance().publishMessage(new jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"DataRecordsSelectionChangeMessage\"](_this.mapWidgetId, []));\n            }\n            if (response.results.length) {\n                var jimuLayerViews = _this.jimuLayerViews;\n                var jimuLayerViewIds_1 = Object.keys(jimuLayerViews);\n                var originalJimuLayerViewIds = Object.keys(jimuLayerViews);\n                if (_this.view.type == '2d') {\n                    var isSelectByManual_1 = false;\n                    if (!_this.isEnablePopup && !_this.isEditing) {\n                        isSelectByManual_1 = true;\n                    }\n                    response.results.forEach(function (result, index) {\n                        var graphic = result.graphic;\n                        if (!graphic || !graphic.layer) {\n                            return;\n                        }\n                        var layerId = graphic.layer.id;\n                        var tempJimuLayerViewId = _this.getJimuLayerViewId(_this.datasourceId, layerId);\n                        var tempJimuLayerView = _this.jimuLayerViews[tempJimuLayerViewId];\n                        if (tempJimuLayerView) {\n                            switch (tempJimuLayerView.type) {\n                                case _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_7__[\"LayerTypes\"].FeatureLayer:\n                                    if (isSelectByManual_1 && graphic.layer.popupEnabled) {\n                                        jimuLayerViewIds_1.splice(jimuLayerViewIds_1.indexOf(tempJimuLayerViewId), 1);\n                                        tempJimuLayerView.clearHighLight();\n                                        var tempId_1 = String(graphic.attributes[graphic.layer.objectIdField]);\n                                        var layerDataSource = tempJimuLayerView.getLayerDataSource();\n                                        tempJimuLayerView.selectedIds = tempId_1;\n                                        layerDataSource.queryById(tempId_1).then(function (record) {\n                                            tempJimuLayerView.selectFeatureById(tempId_1, record);\n                                            jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"MessageManager\"].getInstance().publishMessage(new jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"DataRecordsSelectionChangeMessage\"](_this.mapWidgetId, [record]));\n                                        });\n                                        isSelectByManual_1 = false;\n                                    }\n                                    break;\n                            }\n                        }\n                    });\n                }\n                else {\n                    response.results.forEach(function (result, index) {\n                        var graphic = result.graphic;\n                        if (!graphic || !graphic.layer) {\n                            return;\n                        }\n                        var layerId = graphic.layer.id;\n                        var tempJimuLayerViewId = _this.getJimuLayerViewId(_this.datasourceId, layerId);\n                        var tempJimuLayerView = _this.jimuLayerViews[tempJimuLayerViewId];\n                        if (tempJimuLayerView) {\n                            switch (tempJimuLayerView.type) {\n                                case _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_7__[\"LayerTypes\"].FeatureLayer:\n                                    if (index === 0 && graphic.layer.popupEnabled) {\n                                        jimuLayerViewIds_1.splice(jimuLayerViewIds_1.indexOf(tempJimuLayerViewId), 1);\n                                        tempJimuLayerView.clearHighLight();\n                                        var tempId_2 = String(graphic.attributes[graphic.layer.objectIdField]);\n                                        var layerDataSource = tempJimuLayerView.getLayerDataSource();\n                                        tempJimuLayerView.selectedIds = tempId_2;\n                                        layerDataSource.queryById(tempId_2).then(function (record) {\n                                            tempJimuLayerView.selectFeatureById(tempId_2, record);\n                                            jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"MessageManager\"].getInstance().publishMessage(new jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"DataRecordsSelectionChangeMessage\"](_this.mapWidgetId, [record]));\n                                        });\n                                    }\n                                    break;\n                            }\n                        }\n                    });\n                }\n                // clear other featurelayer\n                if (jimuLayerViewIds_1) {\n                    for (var i = 0; i < jimuLayerViewIds_1.length; i++) {\n                        var tempJimuLayerView = _this.jimuLayerViews[jimuLayerViewIds_1[i]];\n                        if (tempJimuLayerView) {\n                            switch (tempJimuLayerView.type) {\n                                case _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_7__[\"LayerTypes\"].FeatureLayer:\n                                    tempJimuLayerView.selectFeaturesByIds([]);\n                                    break;\n                            }\n                        }\n                    }\n                }\n                if (originalJimuLayerViewIds && jimuLayerViewIds_1 && originalJimuLayerViewIds.length === jimuLayerViewIds_1.length && originalJimuLayerViewIds.length > 0) {\n                    jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"MessageManager\"].getInstance().publishMessage(new jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"DataRecordsSelectionChangeMessage\"](_this.mapWidgetId, []));\n                }\n            }\n        }, function () {\n            _this.clearAllJimuLayerViewsSelectRecord();\n        });\n    };\n    /** @ignore */\n    JimuMapView.prototype.clearAllJimuLayerViewsSelectRecord = function () {\n        var jimuLayerViews = this.jimuLayerViews;\n        var jimuLayerViewIds = Object.keys(jimuLayerViews);\n        for (var i = 0; i < jimuLayerViewIds.length; i++) {\n            var tempJimuLayerView = jimuLayerViews[jimuLayerViewIds[i]];\n            tempJimuLayerView.selectFeaturesByIds([]);\n        }\n    };\n    /** @ignore */\n    JimuMapView.prototype.createJimuLayerViews = function () {\n        return this.whenAllJimuLayerViewsLoaded(this.view);\n    };\n    /** @ignore */\n    JimuMapView.prototype.addJimuLayerView = function (jimuLayerView) {\n        this.jimuLayerViews[jimuLayerView.id] = jimuLayerView;\n    };\n    /** @ignore */\n    JimuMapView.prototype.whenJimuMapViewLoaded = function () {\n        var _this = this;\n        if (this.jimuMapViewLoadPromise) {\n            return this.jimuMapViewLoadPromise;\n        }\n        else {\n            if (!this.view) {\n                this.status = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"JimuMapViewStatus\"].Failed;\n                _mapview_manager__WEBPACK_IMPORTED_MODULE_6__[\"MapViewManager\"].getInstance().setJimuMapView(this);\n                this.jimuMapViewLoadPromise = Promise.reject(this);\n                return this.jimuMapViewLoadPromise;\n            }\n            this.jimuMapViewLoadPromise = this.view.when().then(function () {\n                return _this.createJimuLayerViews().then(function () {\n                    _this.status = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"JimuMapViewStatus\"].Loaded;\n                    _mapview_manager__WEBPACK_IMPORTED_MODULE_6__[\"MapViewManager\"].getInstance().setJimuMapView(_this);\n                    return Promise.resolve(_this);\n                });\n            }, function (error) {\n                console.error(error);\n                _this.status = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"JimuMapViewStatus\"].Failed;\n                _mapview_manager__WEBPACK_IMPORTED_MODULE_6__[\"MapViewManager\"].getInstance().setJimuMapView(_this);\n                return Promise.reject(_this);\n            });\n            return this.jimuMapViewLoadPromise;\n        }\n    };\n    /** @ignore */\n    JimuMapView.prototype.whenAllJimuLayerViewsLoaded = function (view) {\n        var _this = this;\n        var promises = [];\n        var self = this;\n        view.map.layers.toArray().map(function (layer, index) {\n            var rootDs = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"DataSourceManager\"].getInstance().getDataSource(_this.datasourceId);\n            if (!rootDs) {\n                return;\n            }\n            var rootJimuLayerId = rootDs.getJimuChildId(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].fixLayerId(layer.id))[0];\n            _this.maxLayerIndex = view.map.layers.length - 1;\n            var layerLoadPromise = view.whenLayerView(layer).then(function (layerView) {\n                var jimuLayerViewConstructorOptions = null;\n                var jimuLayerView = null;\n                var tempLayerDS = rootDs.getDataSourceByLayer(layer.id.toString(), jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getUrlByLayer(layer), layer.id);\n                switch (layer.type) {\n                    case _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_7__[\"LayerTypes\"].FeatureLayer:\n                        jimuLayerViewConstructorOptions = {\n                            jimuLayerId: rootJimuLayerId,\n                            rootJimuLayerId: null,\n                            layerDataSourceId: tempLayerDS && tempLayerDS.id,\n                            view: layerView,\n                            jimuMapViewId: _this.id,\n                            type: layer.type,\n                            layer: layer,\n                            layerIndex: index,\n                            parentJimuLayerViewId: null\n                        };\n                        jimuLayerView = new _layers_jimu_feature_layer_view__WEBPACK_IMPORTED_MODULE_2__[\"JimuFeatureLayerView\"](jimuLayerViewConstructorOptions);\n                        _this.addJimuLayerView(jimuLayerView);\n                        break;\n                    case _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_7__[\"LayerTypes\"].MapImageLayer:\n                    case _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_7__[\"LayerTypes\"].TileLayer:\n                        jimuLayerViewConstructorOptions = {\n                            jimuLayerId: rootJimuLayerId,\n                            rootJimuLayerId: null,\n                            layerDataSourceId: tempLayerDS && tempLayerDS.id,\n                            view: layerView,\n                            jimuMapViewId: _this.id,\n                            type: layer.type,\n                            layer: layer,\n                            layerIndex: index,\n                            parentJimuLayerViewId: null\n                        };\n                        if (layer.type === _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_7__[\"LayerTypes\"].MapImageLayer) {\n                            jimuLayerView = new _layers_jimu_mapimage_layer_view__WEBPACK_IMPORTED_MODULE_5__[\"JimuMapImageLayerView\"](jimuLayerViewConstructorOptions);\n                        }\n                        if (layer.type === _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_7__[\"LayerTypes\"].TileLayer) {\n                            jimuLayerView = new _layers_jimu_tile_layer_view__WEBPACK_IMPORTED_MODULE_4__[\"JimuTileLayerView\"](jimuLayerViewConstructorOptions);\n                        }\n                        _this.addJimuLayerView(jimuLayerView);\n                        var sublayers = layer.sublayers;\n                        if (sublayers && sublayers.length > 0) {\n                            for (var k = 0; k < sublayers.length; k++) {\n                                var tempSubLayer = sublayers.getItemAt(k);\n                                _this.createJimuLayerViewInSublayers(tempSubLayer, jimuLayerView.id, rootJimuLayerId, layer.id);\n                            }\n                        }\n                        break;\n                    default:\n                        jimuLayerViewConstructorOptions = {\n                            jimuLayerId: rootJimuLayerId,\n                            rootJimuLayerId: null,\n                            layerDataSourceId: tempLayerDS && tempLayerDS.id,\n                            view: layerView,\n                            jimuMapViewId: _this.id,\n                            type: layer.type,\n                            layer: layer,\n                            layerIndex: index,\n                            parentJimuLayerViewId: null\n                        };\n                        jimuLayerView = new _layers_jimu_layer_view__WEBPACK_IMPORTED_MODULE_1__[\"JimuLayerView\"](jimuLayerViewConstructorOptions);\n                        _this.addJimuLayerView(jimuLayerView);\n                        break;\n                }\n                return Promise.resolve(jimuLayerView);\n            }, function () {\n                return Promise.resolve(null);\n            });\n            promises.push(layerLoadPromise);\n            self.jimuLayerViewLoadPromises[\"\" + (_this.id + '-' + rootJimuLayerId)] = layerLoadPromise;\n        });\n        return Promise.all(promises);\n    };\n    /** @ignore */\n    JimuMapView.prototype.getParentLayerViews = function (jimuLayerViewId) {\n        var parentLayerViews = [];\n        if (this.jimuLayerViews[jimuLayerViewId]) {\n            this.findParentLayerView(this.jimuLayerViews[jimuLayerViewId].parentJimuLayerViewId, parentLayerViews);\n        }\n        return parentLayerViews;\n    };\n    /** @ignore */\n    JimuMapView.prototype.findParentLayerView = function (parentJimuLayerViewId, parentLayerViews) {\n        var layerViews = this.jimuLayerViews;\n        if (!parentJimuLayerViewId && !layerViews[parentJimuLayerViewId]) {\n            return;\n        }\n        parentLayerViews.push(layerViews[parentJimuLayerViewId]);\n        if (layerViews[parentJimuLayerViewId].parentJimuLayerViewId) {\n            this.findParentLayerView(layerViews[parentJimuLayerViewId].parentJimuLayerViewId, parentLayerViews);\n        }\n    };\n    /** @ignore */\n    JimuMapView.prototype.getChildLayerViews = function (jimuLayerViewId) {\n        var childLayerViews = [];\n        this.findChildLayerView(jimuLayerViewId, childLayerViews);\n        return childLayerViews;\n    };\n    /** @ignore */\n    JimuMapView.prototype.findChildLayerView = function (parentJimuLayerViewId, childLayerViews) {\n        var layerViews = this.jimuLayerViews;\n        var layerViewsKeys = Object.keys(layerViews);\n        for (var i = 0; i < layerViewsKeys.length; i++) {\n            if (layerViews[layerViewsKeys[i]].parentJimuLayerViewId === parentJimuLayerViewId) {\n                childLayerViews.push(layerViews[layerViewsKeys[i]]);\n                this.findChildLayerView(layerViews[layerViewsKeys[i]].jimuLayerId, childLayerViews);\n            }\n        }\n    };\n    /** @ignore */\n    JimuMapView.prototype.updateMaxLayerIndex = function () {\n        this.maxLayerIndex = this.maxLayerIndex + 1;\n        return this.maxLayerIndex;\n    };\n    /** @ignore */\n    JimuMapView.prototype.createJimuLayerViewInSublayers = function (layer, parentJimuLayerViewId, rootJimuLayerId, rootLayerId) {\n        var rootDs = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"DataSourceManager\"].getInstance().getDataSource(this.datasourceId);\n        if (layer.sublayers && layer.sublayers.length > 0) {\n            var tempDs = rootDs.getDataSourceByLayer(layer.id.toString(), jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getUrlByLayer(layer), rootLayerId);\n            if (!tempDs) {\n                return;\n            }\n            var tempJimuLayerViewConstructorOptions = {\n                jimuLayerId: layer.id,\n                rootJimuLayerId: rootJimuLayerId,\n                layerDataSourceId: tempDs && tempDs.id,\n                view: null,\n                url: layer.url,\n                jimuMapViewId: this.id,\n                type: _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_7__[\"LayerTypes\"].GroupLayer,\n                layer: layer,\n                parentJimuLayerViewId: parentJimuLayerViewId,\n                layerIndex: this.updateMaxLayerIndex()\n            };\n            var tempJimuLayerView = new _layers_jimu_group_layer_view__WEBPACK_IMPORTED_MODULE_3__[\"JimuGroupLayerView\"](tempJimuLayerViewConstructorOptions);\n            this.addJimuLayerView(tempJimuLayerView);\n            for (var i = 0; i < layer.sublayers.length; i++) {\n                this.createJimuLayerViewInSublayers(layer.sublayers.getItemAt(i), tempJimuLayerView.jimuLayerId, rootJimuLayerId, rootLayerId);\n            }\n        }\n        else {\n            var tempDs = rootDs.getDataSourceByLayer(layer.id.toString(), jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getUrlByLayer(layer), rootLayerId);\n            if (!tempDs) {\n                return;\n            }\n            var tempJimuLayerViewConstructorOptions = {\n                jimuLayerId: layer.id,\n                rootJimuLayerId: rootJimuLayerId,\n                layerDataSourceId: tempDs && tempDs.id,\n                view: null,\n                url: layer.url,\n                jimuMapViewId: this.id,\n                type: _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_7__[\"LayerTypes\"].FeatureLayer,\n                layer: layer,\n                parentJimuLayerViewId: parentJimuLayerViewId,\n                layerIndex: this.updateMaxLayerIndex()\n            };\n            var tempJimuLayerView = new _layers_jimu_feature_layer_view__WEBPACK_IMPORTED_MODULE_2__[\"JimuFeatureLayerView\"](tempJimuLayerViewConstructorOptions);\n            this.addJimuLayerView(tempJimuLayerView);\n        }\n    };\n    /** @ignore */\n    JimuMapView.prototype.getJimuLayerViewLoadPromiseById = function (jimuLayerViewId) {\n        return this.jimuLayerViewLoadPromises[jimuLayerViewId];\n    };\n    /** @ignore */\n    JimuMapView.prototype.selectFeaturesByGraphic = function (graphic, spatialRelationship) {\n        var _this = this;\n        return Object(_arcgis_js_api_module_loader__WEBPACK_IMPORTED_MODULE_8__[\"loadArcGISJSAPIModules\"])([\n            'esri/geometry/geometryEngine'\n        ]).then(function (modules) {\n            var geometryEngine = modules[0];\n            var geometry = graphic.geometry;\n            if ((geometry.type === 'point' || geometry.type === 'polyline')) {\n                var resolution = _this.view.scale * 2.54 / 9600;\n                geometry = geometryEngine.buffer(geometry, 10 * resolution, 'meters');\n            }\n            var query = {\n                geometry: geometry,\n                spatialRelationship: spatialRelationship,\n                returnGeometry: true,\n                outFields: ['*']\n            };\n            var jimuLayerViews = _this.jimuLayerViews;\n            var jimuLayerViewKeys = Object.keys(jimuLayerViews);\n            var allSelectPromises = [];\n            for (var i = 0; i < jimuLayerViewKeys.length; i++) {\n                var tempJimuLayerView = jimuLayerViews[jimuLayerViewKeys[i]];\n                if (tempJimuLayerView.type === _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_7__[\"LayerTypes\"].FeatureLayer) {\n                    var tempSelectPromise = _this.getSelectRecordsByQueryPromise(tempJimuLayerView, query);\n                    allSelectPromises.push(tempSelectPromise);\n                }\n            }\n            return Promise.all(allSelectPromises);\n        });\n    };\n    /**\n     * Destroy the JimuMapView instance, and also destroy the arcgis 4.x view at the same time.\n     */\n    JimuMapView.prototype.destroy = function () {\n        var jimuLayerViews = this.jimuLayerViews;\n        var jimuLayerViewIds = Object.keys(jimuLayerViews);\n        for (var i = 0; i < jimuLayerViewIds.length; i++) {\n            var tempJimuLayerView = jimuLayerViews[jimuLayerViewIds[i]];\n            tempJimuLayerView.destroy();\n        }\n        if (this.view) {\n            if (!this.view.destroyed) {\n                if (this.view.graphics && this.view.graphics.destroyed) {\n                    this.view.graphics.destroy();\n                }\n                this.view.container = null;\n                if (this.view.allLayerViews && this.view.allLayerViews.destroyed) {\n                    this.view.allLayerViews.destroy();\n                }\n                if (this.view.layerViews && this.view.layerViews.destroyed) {\n                    this.view.layerViews.destroy();\n                }\n                var ui_1 = this.view.ui;\n                if (ui_1.exbMapTools && Object.keys(ui_1.exbMapTools).length !== 0) {\n                    Object.keys(ui_1.exbMapTools).map(function (key, index) {\n                        ui_1.exbMapTools[key].destroy();\n                    });\n                }\n                ui_1.exbMapTools = {};\n                this.view.destroy();\n                this.view = null;\n            }\n        }\n    };\n    return JimuMapView;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9saWIvdmlld3MvamltdS1tYXAtdmlldy50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtYXJjZ2lzL2xpYi92aWV3cy9qaW11LW1hcC12aWV3LnRzPzYxOWMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtKaW11TWFwVmlld1N0YXR1cywgTWVzc2FnZU1hbmFnZXIsIERhdGFSZWNvcmRzU2VsZWN0aW9uQ2hhbmdlTWVzc2FnZSwgRGF0YVNvdXJjZU1hbmFnZXIsIGRhdGFTb3VyY2VVdGlscywgRmVhdHVyZUxheWVyRGF0YVNvdXJjZSwgRmVhdHVyZUxheWVyUXVlcnlQYXJhbXN9IGZyb20gJ2ppbXUtY29yZSc7XG5pbXBvcnQge0ppbXVMYXllclZpZXcsIEppbXVMYXllclZpZXdDb25zdHJ1Y3Rvck9wdGlvbnN9IGZyb20gJy4vbGF5ZXJzL2ppbXUtbGF5ZXItdmlldyc7XG5pbXBvcnQge0ppbXVGZWF0dXJlTGF5ZXJWaWV3LCBKaW11RmVhdHVyZUxheWVyVmlld09wdGlvbnN9IGZyb20gJy4vbGF5ZXJzL2ppbXUtZmVhdHVyZS1sYXllci12aWV3JztcbmltcG9ydCB7SmltdUdyb3VwTGF5ZXJWaWV3fSBmcm9tICcuL2xheWVycy9qaW11LWdyb3VwLWxheWVyLXZpZXcnO1xuaW1wb3J0IHtKaW11VGlsZUxheWVyVmlld30gZnJvbSAnLi9sYXllcnMvamltdS10aWxlLWxheWVyLXZpZXcnO1xuaW1wb3J0IHtKaW11TWFwSW1hZ2VMYXllclZpZXd9IGZyb20gJy4vbGF5ZXJzL2ppbXUtbWFwaW1hZ2UtbGF5ZXItdmlldyc7XG5pbXBvcnQge01hcFZpZXdNYW5hZ2VyfSBmcm9tICcuLi9tYXB2aWV3LW1hbmFnZXInO1xuaW1wb3J0IHtMYXllclR5cGVzfSBmcm9tICcuLi9kYXRhLXNvdXJjZXMvYXJjZ2lzLWRhdGEtc291cmNlLWludGVyZmFjZSc7XG5pbXBvcnQge2xvYWRBcmNHSVNKU0FQSU1vZHVsZXN9IGZyb20gJy4uL2FyY2dpcy1qcy1hcGktbW9kdWxlLWxvYWRlcic7XG5cbi8qKlxuICogQGlnbm9yZVxuICogSmltdU1hcFZpZXdDb25zdHJ1Y3Rvck9wdGlvbnMgaXMgdXNlZCBpbiBjb25zdHJ1Y3RvciBvZiBKaW11TWFwVmlldywgdG8gaW5pdGlhdGUgYSBKaW11TWFwVmlldyBpbnN0YW5jZS5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBKaW11TWFwVmlld0NvbnN0cnVjdG9yT3B0aW9uc3tcbiAgLyoqXG4gICAqIFRoZSB3aWRnZXQgaWQgdG8gY3JlYXRlIHRoZSBKaW11TWFwVmlldyBpbnN0YW5jZS5cbiAgICovXG4gIG1hcFdpZGdldElkOiBzdHJpbmc7XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgaXNBY3RpdmU/OiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBUaGUgaWQgb2YgdGhlIGRhdGFzb3VyY2Ugc2VsZWN0ZWQgdG8gY3JlYXRlIHRoZSBtYXAuXG4gICAqL1xuICBkYXRhc291cmNlSWQ6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIHZpZXcgaXMgYXJjZ2lzIGFwaSA0LnggdmlldywgaW5jbHVkaW5nIF9fZXNyaS5NYXBWaWV3IG9yIF9fZXNyaS5TY2VuZVZpZXcuXG4gICAqL1xuICB2aWV3OiBfX2VzcmkuTWFwVmlldyB8IF9fZXNyaS5TY2VuZVZpZXc7XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgaXNFbmFibGVQb3B1cD86IGJvb2xlYW47XG59XG5cbi8qKlxuICogSmltdU1hcFZpZXcgaXMgdGhlIHZpZXcgZm9yIGRldmVsb3BlcnMgdG8gZGV2ZWxvcCB0aGUgcmVsYXRlZCBtYXAgZnVuY3Rpb24uXG4gKiBGb3IgZXhhbXBsZSwgZGV2ZWxvcGVycyBjYW4gdXNlIHRoZSB2aWV3IHByb3BlcnR5IG9mIHRoZSBKaW11TWFwVmlldyBpbnN0YW5jZSB0byBnZXQgdGhlIG9yaWdpbmFsIGFyY2dpcyBhcGkgNC54IHZpZXcsIHRoZW4gdXNlXG4gKiB0aGUgb3JpZ2luYWwgdmlldyB0byBkZXZlbG9wIHRoZSByZWxhdGVkIG1hcCBmdW5jdGlvbi4gQXQgdGhlIHNhbWUgdGltZSxcbiAqIEppbXVNYXBWaWV3IGFsc28gcHJvdmlkZXMgcHJvcGVydGllcyBzdWNoIGFzIGBpc0FjdGl2ZWAsIGBzdGF0dXNgLCBldGMuIHRvIGluZGljYXRlIHRoZSBjdXJyZW50IHN0YXR1cyBpbiB0aGUgbWFwIHdpZGdldC5cbiAqL1xuZXhwb3J0IGNsYXNzIEppbXVNYXBWaWV3IHtcbiAgLyoqXG4gICAqIFRoZSBpZCBvZiB0aGUgSmltdU1hcFZpZXcgaW5zdGFuY2UuXG4gICAqL1xuICBpZDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgaWQgb2YgdGhlIHdpZGdldCB3aGljaCBjcmVhdGVzIHRoZSBKaW11TWFwVmlldyBpbnN0YW5jZS5cbiAgICovXG4gIG1hcFdpZGdldElkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBpc0FjdGl2ZSBwcm9wZXJ0eSBpbmRpY2F0ZXMgd2hldGhlciB0aGUgbWFwIGluIHRoZSBtYXAgd2lkZ2V0IGlzIGFjY2Vzc2libGUuXG4gICAqIEZvciBleGFtcGxlLCBmb3Igc2luZ2xlLXNvdXJjZSBtYXAsIGlzQWN0aXZlIGlzIGFsd2F5cyB0cnVlO1xuICAgKiBmb3IgbXVsdGktc291cmNlIG1hcCwgdGhlcmUgYXJlIHR3byBKaW11TWFwVmlldyBpbnN0YW5jZXMgaW4gaXQuXG4gICAqIFRoZSBwcm9wZXJ0eSBpc0FjdGl2ZSBpcyB0cnVlIGZvciB0aGUgSmltdU1hcFZpZXcgaW5zdGFuY2UgYWJvdmUsIGFuZCBmYWxzZSBmb3IgdGhlIG9uZSBiZW5lYXRoO1xuICAgKiBhZnRlciBjbGlja2luZyBvbiB0aGUgc3dpdGNoLW1hcCB0b29sLCB0aGUgaXNBY3RpdmUgcHJvcGVydGllcyB3aWxsIHN3aXRjaC5cbiAgICovXG4gIGlzQWN0aXZlPzogYm9vbGVhbjtcblxuICAvKipcbiAgICogVGhlIGlkIG9mIHRoZSBkYXRhc291cmNlIHNlbGVjdGVkIHRvIGNyZWF0ZSB0aGUgbWFwLlxuICAgKi9cbiAgZGF0YXNvdXJjZUlkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSB2aWV3IGlzIGFyY2dpcyBhcGkgNC54IHZpZXcsIGluY2x1ZGluZyBfX2VzcmkuTWFwVmlldyBvciBfX2VzcmkuU2NlbmVWaWV3LlxuICAgKi9cbiAgdmlldzogX19lc3JpLk1hcFZpZXcgfCBfX2VzcmkuU2NlbmVWaWV3O1xuXG4gIC8qKlxuICAgKiBUaGUgc3RhdHVzIGZvciB0aGUgSmltdU1hcFZpZXcgaW5zdGFuY2UuXG4gICAqL1xuICBzdGF0dXM6IEppbXVNYXBWaWV3U3RhdHVzO1xuXG4gIC8qKlxuICAgKiBUaGUgdW5pb24gZm9yIGFsbCBKaW11TGF5ZXJWaWV3IGluc3RhbmNlcy5cbiAgICovXG4gIGppbXVMYXllclZpZXdzPzoge1tqaW11TGF5ZXJWaWV3SWQ6IHN0cmluZ106IEppbXVMYXllclZpZXd9O1xuXG4gIC8qKlxuICAgKiBAaWdub3JlXG4gICAqIFRoZSBtYXggbGF5ZXIgaW5kZXggaW4gbWFwdmlldy5cbiAgICovXG4gIG1heExheWVySW5kZXg/OiBudW1iZXI7XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgcHJpdmF0ZSBqaW11TGF5ZXJWaWV3TG9hZFByb21pc2VzOiB7W2ppbXVMYXllclZpZXdJZDogc3RyaW5nXTogUHJvbWlzZTxKaW11TGF5ZXJWaWV3Pn0gPSB7fTtcblxuICAvKiogQGlnbm9yZSAqL1xuICBwcml2YXRlIGlzRWRpdGluZzogYm9vbGVhbjtcblxuICAvKiogQGlnbm9yZSAqL1xuICBwcml2YXRlIGlzRW5hYmxlUG9wdXA6IGJvb2xlYW47XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgcHJpdmF0ZSBpc0VuYWJsZUhpZ2hsaWdodDogYm9vbGVhbiA9IHRydWU7XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgcHJpdmF0ZSBqaW11TWFwVmlld0xvYWRQcm9taXNlOiBQcm9taXNlPEppbXVNYXBWaWV3PjtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBKaW11TWFwVmlld0NvbnN0cnVjdG9yT3B0aW9ucykge1xuICAgIHRoaXMuaWQgPSBvcHRpb25zLm1hcFdpZGdldElkICsgJy0nICsgb3B0aW9ucy5kYXRhc291cmNlSWQ7XG4gICAgdGhpcy5tYXBXaWRnZXRJZCA9IG9wdGlvbnMubWFwV2lkZ2V0SWQ7XG4gICAgdGhpcy5pc0FjdGl2ZSA9IG9wdGlvbnMuaXNBY3RpdmU7XG4gICAgdGhpcy5kYXRhc291cmNlSWQgPSBvcHRpb25zLmRhdGFzb3VyY2VJZDtcbiAgICB0aGlzLnZpZXcgPSBvcHRpb25zLnZpZXc7XG4gICAgdGhpcy5qaW11TGF5ZXJWaWV3cyA9IHt9O1xuICAgIHRoaXMuc3RhdHVzID0gSmltdU1hcFZpZXdTdGF0dXMuTG9hZGluZztcbiAgICB0aGlzLmlzRW5hYmxlUG9wdXAgPSAob3B0aW9ucy5pc0VuYWJsZVBvcHVwID09PSB1bmRlZmluZWQgfHwgb3B0aW9ucy5pc0VuYWJsZVBvcHVwID09PSBudWxsKSA/IHRydWUgOiBvcHRpb25zLmlzRW5hYmxlUG9wdXA7XG4gICAgdGhpcy5pc0VkaXRpbmcgPSBmYWxzZTtcblxuICAgIHRoaXMuaW5pdFZpZXcodGhpcy52aWV3KTtcbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIHN0YXJ0RWRpdCgpIHtcbiAgICB0aGlzLmlzRWRpdGluZyA9IHRydWU7XG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBleGl0RWRpdCgpIHtcbiAgICB0aGlzLmlzRWRpdGluZyA9IGZhbHNlO1xuICB9XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgZ2V0SXNFZGl0aW5nKCkge1xuICAgIHJldHVybiB0aGlzLmlzRWRpdGluZztcbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIGVuYWJsZVBvcHVwKCkge1xuICAgIGlmICghdGhpcy5pc0VkaXRpbmcgfHwgdGhpcy5pc0VuYWJsZVBvcHVwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMudmlldyAmJiB0aGlzLnZpZXcucG9wdXApIHtcbiAgICAgIHRoaXMudmlldy5wb3B1cC5hdXRvT3BlbkVuYWJsZWQgPSB0cnVlO1xuICAgICAgdGhpcy5pc0VuYWJsZVBvcHVwID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBkaXNhYmxlUG9wdXAoKSB7XG4gICAgaWYgKCF0aGlzLmlzRWRpdGluZyB8fCAhdGhpcy5pc0VuYWJsZVBvcHVwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMudmlldyAmJiB0aGlzLnZpZXcucG9wdXApIHtcbiAgICAgIHRoaXMudmlldy5wb3B1cC5hdXRvT3BlbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuaXNFbmFibGVQb3B1cCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIGdldElzRW5hYmxlUG9wdXAoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuaXNFbmFibGVQb3B1cDtcbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIGVuYWJsZUhpZ2hsaWdodCgpIHtcbiAgICBpZiAoIXRoaXMuaXNFZGl0aW5nIHx8IHRoaXMuaXNFbmFibGVIaWdobGlnaHQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmlzRW5hYmxlSGlnaGxpZ2h0ID0gdHJ1ZTtcbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIGRpc2FibGVIaWdobGlnaHQoKSB7XG4gICAgaWYgKCF0aGlzLmlzRWRpdGluZyB8fCAhdGhpcy5pc0VuYWJsZUhpZ2hsaWdodCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuaXNFbmFibGVIaWdobGlnaHQgPSBmYWxzZTtcbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIGdldElzRW5hYmxlSGlnaGxpZ2h0KCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmlzRW5hYmxlSGlnaGxpZ2h0O1xuICB9XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgc2V0SXNBY3RpdmUoaXNBY3RpdmU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLmlzQWN0aXZlID0gaXNBY3RpdmU7XG4gICAgTWFwVmlld01hbmFnZXIuZ2V0SW5zdGFuY2UoKS5zZXRKaW11TWFwVmlldyh0aGlzKTtcbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIHByaXZhdGUgaW5pdFZpZXcodmlldzogX19lc3JpLk1hcFZpZXcgfCBfX2VzcmkuU2NlbmVWaWV3KXtcbiAgICBpZiAoIXZpZXcpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2aWV3LndoZW4oKCkgPT4ge1xuICAgICAgdmlldy5vbignY2xpY2snLCB0aGlzLm9uQ2xpY2suYmluZCh0aGlzKSk7XG4gICAgfSk7XG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBwcml2YXRlIG9uQ2xpY2soZXZlbnQpe1xuICAgIGNvbnN0IHNjcmVlblBvaW50ID0ge1xuICAgICAgeDogZXZlbnQueCxcbiAgICAgIHk6IGV2ZW50LnlcbiAgICB9O1xuXG4gICAgdGhpcy52aWV3LmhpdFRlc3Qoc2NyZWVuUG9pbnQpLnRoZW4ocmVzcG9uc2UgPT4ge1xuICAgICAgaWYgKCF0aGlzLmlzRW5hYmxlSGlnaGxpZ2h0KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKCFyZXNwb25zZSB8fCAhcmVzcG9uc2UucmVzdWx0cyB8fCByZXNwb25zZS5yZXN1bHRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB0aGlzLmNsZWFyQWxsSmltdUxheWVyVmlld3NTZWxlY3RSZWNvcmQoKTtcblxuICAgICAgICBNZXNzYWdlTWFuYWdlci5nZXRJbnN0YW5jZSgpLnB1Ymxpc2hNZXNzYWdlKG5ldyBEYXRhUmVjb3Jkc1NlbGVjdGlvbkNoYW5nZU1lc3NhZ2UodGhpcy5tYXBXaWRnZXRJZCwgW10pKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHJlc3BvbnNlLnJlc3VsdHMubGVuZ3RoKSB7XG4gICAgICAgIGNvbnN0IGppbXVMYXllclZpZXdzID0gdGhpcy5qaW11TGF5ZXJWaWV3cztcbiAgICAgICAgY29uc3QgamltdUxheWVyVmlld0lkcyA9IE9iamVjdC5rZXlzKGppbXVMYXllclZpZXdzKTtcbiAgICAgICAgY29uc3Qgb3JpZ2luYWxKaW11TGF5ZXJWaWV3SWRzID0gT2JqZWN0LmtleXMoamltdUxheWVyVmlld3MpO1xuXG4gICAgICAgIGlmICh0aGlzLnZpZXcudHlwZSA9PSAnMmQnKSB7XG4gICAgICAgICAgbGV0IGlzU2VsZWN0QnlNYW51YWwgPSBmYWxzZTtcbiAgICAgICAgICBpZiAoIXRoaXMuaXNFbmFibGVQb3B1cCAmJiAhdGhpcy5pc0VkaXRpbmcpIHtcbiAgICAgICAgICAgIGlzU2VsZWN0QnlNYW51YWwgPSB0cnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJlc3BvbnNlLnJlc3VsdHMuZm9yRWFjaCgocmVzdWx0LCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZ3JhcGhpYyA9IHJlc3VsdC5ncmFwaGljO1xuXG4gICAgICAgICAgICBpZiAoIWdyYXBoaWMgfHwgIWdyYXBoaWMubGF5ZXIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBsYXllcklkID0gZ3JhcGhpYy5sYXllci5pZDtcblxuICAgICAgICAgICAgY29uc3QgdGVtcEppbXVMYXllclZpZXdJZCA9IHRoaXMuZ2V0SmltdUxheWVyVmlld0lkKHRoaXMuZGF0YXNvdXJjZUlkLCBsYXllcklkKTtcbiAgICAgICAgICAgIGNvbnN0IHRlbXBKaW11TGF5ZXJWaWV3ID0gdGhpcy5qaW11TGF5ZXJWaWV3c1t0ZW1wSmltdUxheWVyVmlld0lkXTtcblxuICAgICAgICAgICAgaWYgKHRlbXBKaW11TGF5ZXJWaWV3KSB7XG4gICAgICAgICAgICAgIHN3aXRjaCh0ZW1wSmltdUxheWVyVmlldy50eXBlKXtcbiAgICAgICAgICAgICAgICBjYXNlIExheWVyVHlwZXMuRmVhdHVyZUxheWVyOlxuICAgICAgICAgICAgICAgICAgaWYgKGlzU2VsZWN0QnlNYW51YWwgJiYgKGdyYXBoaWMubGF5ZXIgYXMgYW55KS5wb3B1cEVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgamltdUxheWVyVmlld0lkcy5zcGxpY2UoamltdUxheWVyVmlld0lkcy5pbmRleE9mKHRlbXBKaW11TGF5ZXJWaWV3SWQpLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgKHRlbXBKaW11TGF5ZXJWaWV3IGFzIEppbXVGZWF0dXJlTGF5ZXJWaWV3KS5jbGVhckhpZ2hMaWdodCgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZW1wSWQgPSBTdHJpbmcoZ3JhcGhpYy5hdHRyaWJ1dGVzWyhncmFwaGljLmxheWVyIGFzIF9fZXNyaS5GZWF0dXJlTGF5ZXIpLm9iamVjdElkRmllbGRdKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGF5ZXJEYXRhU291cmNlID0gKHRlbXBKaW11TGF5ZXJWaWV3IGFzIEppbXVGZWF0dXJlTGF5ZXJWaWV3KS5nZXRMYXllckRhdGFTb3VyY2UoKSBhcyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlO1xuICAgICAgICAgICAgICAgICAgICAodGVtcEppbXVMYXllclZpZXcgYXMgSmltdUZlYXR1cmVMYXllclZpZXcpLnNlbGVjdGVkSWRzID0gdGVtcElkO1xuICAgICAgICAgICAgICAgICAgICBsYXllckRhdGFTb3VyY2UucXVlcnlCeUlkKHRlbXBJZCkudGhlbigocmVjb3JkKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgKHRlbXBKaW11TGF5ZXJWaWV3IGFzIEppbXVGZWF0dXJlTGF5ZXJWaWV3KS5zZWxlY3RGZWF0dXJlQnlJZCh0ZW1wSWQsIHJlY29yZCk7XG4gICAgICAgICAgICAgICAgICAgICAgTWVzc2FnZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5wdWJsaXNoTWVzc2FnZShuZXcgRGF0YVJlY29yZHNTZWxlY3Rpb25DaGFuZ2VNZXNzYWdlKHRoaXMubWFwV2lkZ2V0SWQsIFtyZWNvcmRdKSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGlzU2VsZWN0QnlNYW51YWwgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc3BvbnNlLnJlc3VsdHMuZm9yRWFjaCgocmVzdWx0LCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZ3JhcGhpYyA9IHJlc3VsdC5ncmFwaGljO1xuXG4gICAgICAgICAgICBpZiAoIWdyYXBoaWMgfHwgIWdyYXBoaWMubGF5ZXIpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBsYXllcklkID0gZ3JhcGhpYy5sYXllci5pZDtcbiAgICAgICAgICAgIGNvbnN0IHRlbXBKaW11TGF5ZXJWaWV3SWQgPSB0aGlzLmdldEppbXVMYXllclZpZXdJZCh0aGlzLmRhdGFzb3VyY2VJZCwgbGF5ZXJJZCk7XG4gICAgICAgICAgICBjb25zdCB0ZW1wSmltdUxheWVyVmlldyA9IHRoaXMuamltdUxheWVyVmlld3NbdGVtcEppbXVMYXllclZpZXdJZF07XG5cbiAgICAgICAgICAgIGlmICh0ZW1wSmltdUxheWVyVmlldykge1xuICAgICAgICAgICAgICBzd2l0Y2godGVtcEppbXVMYXllclZpZXcudHlwZSl7XG4gICAgICAgICAgICAgICAgY2FzZSBMYXllclR5cGVzLkZlYXR1cmVMYXllcjpcbiAgICAgICAgICAgICAgICAgIGlmIChpbmRleCA9PT0gMCAmJiAoZ3JhcGhpYy5sYXllciBhcyBhbnkpLnBvcHVwRW5hYmxlZCkge1xuICAgICAgICAgICAgICAgICAgICBqaW11TGF5ZXJWaWV3SWRzLnNwbGljZShqaW11TGF5ZXJWaWV3SWRzLmluZGV4T2YodGVtcEppbXVMYXllclZpZXdJZCksIDEpO1xuICAgICAgICAgICAgICAgICAgICAodGVtcEppbXVMYXllclZpZXcgYXMgSmltdUZlYXR1cmVMYXllclZpZXcpLmNsZWFySGlnaExpZ2h0KCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBJZCA9IFN0cmluZyhncmFwaGljLmF0dHJpYnV0ZXNbKGdyYXBoaWMubGF5ZXIgYXMgX19lc3JpLkZlYXR1cmVMYXllcikub2JqZWN0SWRGaWVsZF0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsYXllckRhdGFTb3VyY2UgPSAodGVtcEppbXVMYXllclZpZXcgYXMgSmltdUZlYXR1cmVMYXllclZpZXcpLmdldExheWVyRGF0YVNvdXJjZSgpIGFzIEZlYXR1cmVMYXllckRhdGFTb3VyY2U7XG4gICAgICAgICAgICAgICAgICAgICh0ZW1wSmltdUxheWVyVmlldyBhcyBKaW11RmVhdHVyZUxheWVyVmlldykuc2VsZWN0ZWRJZHMgPSB0ZW1wSWQ7XG4gICAgICAgICAgICAgICAgICAgIGxheWVyRGF0YVNvdXJjZS5xdWVyeUJ5SWQodGVtcElkKS50aGVuKChyZWNvcmQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAodGVtcEppbXVMYXllclZpZXcgYXMgSmltdUZlYXR1cmVMYXllclZpZXcpLnNlbGVjdEZlYXR1cmVCeUlkKHRlbXBJZCwgcmVjb3JkKTtcbiAgICAgICAgICAgICAgICAgICAgICBNZXNzYWdlTWFuYWdlci5nZXRJbnN0YW5jZSgpLnB1Ymxpc2hNZXNzYWdlKG5ldyBEYXRhUmVjb3Jkc1NlbGVjdGlvbkNoYW5nZU1lc3NhZ2UodGhpcy5tYXBXaWRnZXRJZCwgW3JlY29yZF0pKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuICAgICAgICAvLyBjbGVhciBvdGhlciBmZWF0dXJlbGF5ZXJcbiAgICAgICAgaWYgKGppbXVMYXllclZpZXdJZHMpIHtcbiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGppbXVMYXllclZpZXdJZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IHRlbXBKaW11TGF5ZXJWaWV3ID0gdGhpcy5qaW11TGF5ZXJWaWV3c1tqaW11TGF5ZXJWaWV3SWRzW2ldXTtcbiAgICAgICAgICAgIGlmICh0ZW1wSmltdUxheWVyVmlldykge1xuICAgICAgICAgICAgICBzd2l0Y2godGVtcEppbXVMYXllclZpZXcudHlwZSl7XG4gICAgICAgICAgICAgICAgY2FzZSBMYXllclR5cGVzLkZlYXR1cmVMYXllcjpcbiAgICAgICAgICAgICAgICAgICh0ZW1wSmltdUxheWVyVmlldyBhcyBKaW11RmVhdHVyZUxheWVyVmlldykuc2VsZWN0RmVhdHVyZXNCeUlkcyhbXSk7XG4gICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChvcmlnaW5hbEppbXVMYXllclZpZXdJZHMgJiYgamltdUxheWVyVmlld0lkcyAmJiBvcmlnaW5hbEppbXVMYXllclZpZXdJZHMubGVuZ3RoID09PSBqaW11TGF5ZXJWaWV3SWRzLmxlbmd0aCAmJiBvcmlnaW5hbEppbXVMYXllclZpZXdJZHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIE1lc3NhZ2VNYW5hZ2VyLmdldEluc3RhbmNlKCkucHVibGlzaE1lc3NhZ2UobmV3IERhdGFSZWNvcmRzU2VsZWN0aW9uQ2hhbmdlTWVzc2FnZSh0aGlzLm1hcFdpZGdldElkLCBbXSkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSwgKCkgPT4ge1xuICAgICAgdGhpcy5jbGVhckFsbEppbXVMYXllclZpZXdzU2VsZWN0UmVjb3JkKCk7XG4gICAgfSk7XG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBwcml2YXRlIGdldEppbXVMYXllclZpZXdJZCA9IChyb290RHNJZDogc3RyaW5nLCBsYXllcklkKSA9PiB7XG4gICAgY29uc3Qgcm9vdERzID0gRGF0YVNvdXJjZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXREYXRhU291cmNlKHJvb3REc0lkKTtcbiAgICBpZiAoIXJvb3REcykge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgamltdUxheWVySWQgPSByb290RHMuZ2V0SmltdUNoaWxkSWQobGF5ZXJJZClbMF07XG4gICAgcmV0dXJuIHRoaXMuaWQgKyAnLScgKyBqaW11TGF5ZXJJZDtcbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIHByaXZhdGUgY2xlYXJBbGxKaW11TGF5ZXJWaWV3c1NlbGVjdFJlY29yZCgpe1xuICAgIGNvbnN0IGppbXVMYXllclZpZXdzID0gdGhpcy5qaW11TGF5ZXJWaWV3cztcbiAgICBjb25zdCBqaW11TGF5ZXJWaWV3SWRzID0gT2JqZWN0LmtleXMoamltdUxheWVyVmlld3MpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgamltdUxheWVyVmlld0lkcy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgdGVtcEppbXVMYXllclZpZXcgPSBqaW11TGF5ZXJWaWV3c1tqaW11TGF5ZXJWaWV3SWRzW2ldXTtcbiAgICAgIHRlbXBKaW11TGF5ZXJWaWV3LnNlbGVjdEZlYXR1cmVzQnlJZHMoW10pO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIGNyZWF0ZUppbXVMYXllclZpZXdzKCk6IFByb21pc2U8SmltdUxheWVyVmlld1tdPntcbiAgICByZXR1cm4gdGhpcy53aGVuQWxsSmltdUxheWVyVmlld3NMb2FkZWQodGhpcy52aWV3KTtcbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIHByaXZhdGUgYWRkSmltdUxheWVyVmlldyhqaW11TGF5ZXJWaWV3OiBKaW11TGF5ZXJWaWV3KSB7XG4gICAgdGhpcy5qaW11TGF5ZXJWaWV3c1tqaW11TGF5ZXJWaWV3LmlkXSA9IGppbXVMYXllclZpZXc7XG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICB3aGVuSmltdU1hcFZpZXdMb2FkZWQoKTogUHJvbWlzZTxKaW11TWFwVmlldz4ge1xuICAgIGlmICh0aGlzLmppbXVNYXBWaWV3TG9hZFByb21pc2UpIHtcbiAgICAgIHJldHVybiB0aGlzLmppbXVNYXBWaWV3TG9hZFByb21pc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICghdGhpcy52aWV3KSB7XG4gICAgICAgIHRoaXMuc3RhdHVzID0gSmltdU1hcFZpZXdTdGF0dXMuRmFpbGVkO1xuICAgICAgICBNYXBWaWV3TWFuYWdlci5nZXRJbnN0YW5jZSgpLnNldEppbXVNYXBWaWV3KHRoaXMpO1xuICAgICAgICB0aGlzLmppbXVNYXBWaWV3TG9hZFByb21pc2UgPSBQcm9taXNlLnJlamVjdCh0aGlzKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuamltdU1hcFZpZXdMb2FkUHJvbWlzZTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5qaW11TWFwVmlld0xvYWRQcm9taXNlID0gdGhpcy52aWV3LndoZW4oKS50aGVuKCgpID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlSmltdUxheWVyVmlld3MoKS50aGVuKCgpID0+IHtcbiAgICAgICAgICB0aGlzLnN0YXR1cyA9IEppbXVNYXBWaWV3U3RhdHVzLkxvYWRlZDtcbiAgICAgICAgICBNYXBWaWV3TWFuYWdlci5nZXRJbnN0YW5jZSgpLnNldEppbXVNYXBWaWV3KHRoaXMpO1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcyk7XG4gICAgICAgIH0pO1xuICAgICAgfSwgKGVycm9yKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICB0aGlzLnN0YXR1cyA9IEppbXVNYXBWaWV3U3RhdHVzLkZhaWxlZDtcbiAgICAgICAgTWFwVmlld01hbmFnZXIuZ2V0SW5zdGFuY2UoKS5zZXRKaW11TWFwVmlldyh0aGlzKTtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHRoaXMpO1xuICAgICAgfSlcblxuICAgICAgcmV0dXJuIHRoaXMuamltdU1hcFZpZXdMb2FkUHJvbWlzZTtcbiAgICB9XG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBwcml2YXRlIHdoZW5BbGxKaW11TGF5ZXJWaWV3c0xvYWRlZCh2aWV3OiBfX2VzcmkuVmlldyk6IFByb21pc2U8SmltdUxheWVyVmlld1tdPntcbiAgICBjb25zdCBwcm9taXNlcyA9IFtdO1xuXG4gICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgdmlldy5tYXAubGF5ZXJzLnRvQXJyYXkoKS5tYXAoKGxheWVyLCBpbmRleCkgPT4ge1xuICAgICAgY29uc3Qgcm9vdERzID0gRGF0YVNvdXJjZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXREYXRhU291cmNlKHRoaXMuZGF0YXNvdXJjZUlkKTtcbiAgICAgIGlmICghcm9vdERzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3Qgcm9vdEppbXVMYXllcklkID0gcm9vdERzLmdldEppbXVDaGlsZElkKGRhdGFTb3VyY2VVdGlscy5maXhMYXllcklkKGxheWVyLmlkKSlbMF07XG4gICAgICB0aGlzLm1heExheWVySW5kZXggPSB2aWV3Lm1hcC5sYXllcnMubGVuZ3RoIC0gMTtcblxuICAgICAgY29uc3QgbGF5ZXJMb2FkUHJvbWlzZSA9IHZpZXcud2hlbkxheWVyVmlldyhsYXllcikudGhlbihsYXllclZpZXcgPT4ge1xuICAgICAgICBsZXQgamltdUxheWVyVmlld0NvbnN0cnVjdG9yT3B0aW9uczogSmltdUxheWVyVmlld0NvbnN0cnVjdG9yT3B0aW9ucyA9IG51bGw7XG4gICAgICAgIGxldCBqaW11TGF5ZXJWaWV3OiBKaW11TGF5ZXJWaWV3ID0gbnVsbDtcbiAgICAgICAgY29uc3QgdGVtcExheWVyRFMgPSAocm9vdERzIGFzIGFueSkuZ2V0RGF0YVNvdXJjZUJ5TGF5ZXIobGF5ZXIuaWQudG9TdHJpbmcoKSwgZGF0YVNvdXJjZVV0aWxzLmdldFVybEJ5TGF5ZXIobGF5ZXIpLCBsYXllci5pZClcbiAgICAgICAgc3dpdGNoKGxheWVyLnR5cGUpe1xuICAgICAgICAgIGNhc2UgTGF5ZXJUeXBlcy5GZWF0dXJlTGF5ZXI6XG4gICAgICAgICAgICBqaW11TGF5ZXJWaWV3Q29uc3RydWN0b3JPcHRpb25zID0ge1xuICAgICAgICAgICAgICBqaW11TGF5ZXJJZDogcm9vdEppbXVMYXllcklkLFxuICAgICAgICAgICAgICByb290SmltdUxheWVySWQ6IG51bGwsXG4gICAgICAgICAgICAgIGxheWVyRGF0YVNvdXJjZUlkOiB0ZW1wTGF5ZXJEUyAmJiB0ZW1wTGF5ZXJEUy5pZCxcbiAgICAgICAgICAgICAgdmlldzogbGF5ZXJWaWV3IGFzIF9fZXNyaS5GZWF0dXJlTGF5ZXJWaWV3LFxuICAgICAgICAgICAgICBqaW11TWFwVmlld0lkOiB0aGlzLmlkLFxuICAgICAgICAgICAgICB0eXBlOiBsYXllci50eXBlLFxuICAgICAgICAgICAgICBsYXllcjogbGF5ZXIsXG4gICAgICAgICAgICAgIGxheWVySW5kZXg6IGluZGV4LFxuICAgICAgICAgICAgICBwYXJlbnRKaW11TGF5ZXJWaWV3SWQ6IG51bGxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBqaW11TGF5ZXJWaWV3ID0gbmV3IEppbXVGZWF0dXJlTGF5ZXJWaWV3KGppbXVMYXllclZpZXdDb25zdHJ1Y3Rvck9wdGlvbnMgYXMgSmltdUZlYXR1cmVMYXllclZpZXdPcHRpb25zKTtcbiAgICAgICAgICAgIHRoaXMuYWRkSmltdUxheWVyVmlldyhqaW11TGF5ZXJWaWV3KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIGNhc2UgTGF5ZXJUeXBlcy5NYXBJbWFnZUxheWVyOlxuICAgICAgICAgIGNhc2UgTGF5ZXJUeXBlcy5UaWxlTGF5ZXI6XG4gICAgICAgICAgICBqaW11TGF5ZXJWaWV3Q29uc3RydWN0b3JPcHRpb25zID0ge1xuICAgICAgICAgICAgICBqaW11TGF5ZXJJZDogcm9vdEppbXVMYXllcklkLFxuICAgICAgICAgICAgICByb290SmltdUxheWVySWQ6IG51bGwsXG4gICAgICAgICAgICAgIGxheWVyRGF0YVNvdXJjZUlkOiB0ZW1wTGF5ZXJEUyAmJiB0ZW1wTGF5ZXJEUy5pZCxcbiAgICAgICAgICAgICAgdmlldzogbGF5ZXJWaWV3LFxuICAgICAgICAgICAgICBqaW11TWFwVmlld0lkOiB0aGlzLmlkLFxuICAgICAgICAgICAgICB0eXBlOiBsYXllci50eXBlLFxuICAgICAgICAgICAgICBsYXllcjogbGF5ZXIsXG4gICAgICAgICAgICAgIGxheWVySW5kZXg6IGluZGV4LFxuICAgICAgICAgICAgICBwYXJlbnRKaW11TGF5ZXJWaWV3SWQ6IG51bGxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAobGF5ZXIudHlwZSA9PT0gTGF5ZXJUeXBlcy5NYXBJbWFnZUxheWVyKSB7XG4gICAgICAgICAgICAgIGppbXVMYXllclZpZXcgPSBuZXcgSmltdU1hcEltYWdlTGF5ZXJWaWV3KGppbXVMYXllclZpZXdDb25zdHJ1Y3Rvck9wdGlvbnMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobGF5ZXIudHlwZSA9PT0gTGF5ZXJUeXBlcy5UaWxlTGF5ZXIpIHtcbiAgICAgICAgICAgICAgamltdUxheWVyVmlldyA9IG5ldyBKaW11VGlsZUxheWVyVmlldyhqaW11TGF5ZXJWaWV3Q29uc3RydWN0b3JPcHRpb25zKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5hZGRKaW11TGF5ZXJWaWV3KGppbXVMYXllclZpZXcpO1xuICAgICAgICAgICAgY29uc3Qgc3VibGF5ZXJzID0gKGxheWVyIGFzIGFueSkuc3VibGF5ZXJzO1xuICAgICAgICAgICAgaWYgKHN1YmxheWVycyAmJiBzdWJsYXllcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICBmb3IgKGxldCBrID0gMDsgayA8IHN1YmxheWVycy5sZW5ndGg7IGsrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRlbXBTdWJMYXllciA9IChzdWJsYXllcnMgYXMgYW55KS5nZXRJdGVtQXQoayk7XG4gICAgICAgICAgICAgICAgdGhpcy5jcmVhdGVKaW11TGF5ZXJWaWV3SW5TdWJsYXllcnModGVtcFN1YkxheWVyLCBqaW11TGF5ZXJWaWV3LmlkLCByb290SmltdUxheWVySWQsIGxheWVyLmlkKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGppbXVMYXllclZpZXdDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgIGppbXVMYXllcklkOiByb290SmltdUxheWVySWQsXG4gICAgICAgICAgICAgIHJvb3RKaW11TGF5ZXJJZDogbnVsbCxcbiAgICAgICAgICAgICAgbGF5ZXJEYXRhU291cmNlSWQ6IHRlbXBMYXllckRTICYmIHRlbXBMYXllckRTLmlkLFxuICAgICAgICAgICAgICB2aWV3OiBsYXllclZpZXcsXG4gICAgICAgICAgICAgIGppbXVNYXBWaWV3SWQ6IHRoaXMuaWQsXG4gICAgICAgICAgICAgIHR5cGU6IGxheWVyLnR5cGUsXG4gICAgICAgICAgICAgIGxheWVyOiBsYXllcixcbiAgICAgICAgICAgICAgbGF5ZXJJbmRleDogaW5kZXgsXG4gICAgICAgICAgICAgIHBhcmVudEppbXVMYXllclZpZXdJZDogbnVsbFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGppbXVMYXllclZpZXcgPSBuZXcgSmltdUxheWVyVmlldyhqaW11TGF5ZXJWaWV3Q29uc3RydWN0b3JPcHRpb25zKTtcbiAgICAgICAgICAgIHRoaXMuYWRkSmltdUxheWVyVmlldyhqaW11TGF5ZXJWaWV3KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoamltdUxheWVyVmlldyk7XG4gICAgICB9LCAoKSA9PiB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobnVsbCk7XG4gICAgICB9KTtcbiAgICAgIHByb21pc2VzLnB1c2gobGF5ZXJMb2FkUHJvbWlzZSk7XG4gICAgICBzZWxmLmppbXVMYXllclZpZXdMb2FkUHJvbWlzZXNbYCR7dGhpcy5pZCArICctJyArIHJvb3RKaW11TGF5ZXJJZH1gXSA9IGxheWVyTG9hZFByb21pc2U7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xuICB9XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgZ2V0UGFyZW50TGF5ZXJWaWV3cyhqaW11TGF5ZXJWaWV3SWQpOiBKaW11TGF5ZXJWaWV3W10ge1xuICAgIGNvbnN0IHBhcmVudExheWVyVmlld3MgPSBbXTtcbiAgICBpZiAodGhpcy5qaW11TGF5ZXJWaWV3c1tqaW11TGF5ZXJWaWV3SWRdKSB7XG4gICAgICB0aGlzLmZpbmRQYXJlbnRMYXllclZpZXcodGhpcy5qaW11TGF5ZXJWaWV3c1tqaW11TGF5ZXJWaWV3SWRdLnBhcmVudEppbXVMYXllclZpZXdJZCwgcGFyZW50TGF5ZXJWaWV3cyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHBhcmVudExheWVyVmlld3M7XG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBmaW5kUGFyZW50TGF5ZXJWaWV3KHBhcmVudEppbXVMYXllclZpZXdJZDogc3RyaW5nLCBwYXJlbnRMYXllclZpZXdzOiBKaW11TGF5ZXJWaWV3W10pIHtcbiAgICBjb25zdCBsYXllclZpZXdzID0gdGhpcy5qaW11TGF5ZXJWaWV3cztcbiAgICBpZiAoIXBhcmVudEppbXVMYXllclZpZXdJZCAmJiAhbGF5ZXJWaWV3c1twYXJlbnRKaW11TGF5ZXJWaWV3SWRdKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHBhcmVudExheWVyVmlld3MucHVzaChsYXllclZpZXdzW3BhcmVudEppbXVMYXllclZpZXdJZF0pO1xuICAgIGlmIChsYXllclZpZXdzW3BhcmVudEppbXVMYXllclZpZXdJZF0ucGFyZW50SmltdUxheWVyVmlld0lkKSB7XG4gICAgICB0aGlzLmZpbmRQYXJlbnRMYXllclZpZXcobGF5ZXJWaWV3c1twYXJlbnRKaW11TGF5ZXJWaWV3SWRdLnBhcmVudEppbXVMYXllclZpZXdJZCwgcGFyZW50TGF5ZXJWaWV3cyk7XG4gICAgfVxuICB9XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgZ2V0Q2hpbGRMYXllclZpZXdzKGppbXVMYXllclZpZXdJZCk6IEppbXVMYXllclZpZXdbXSB7XG4gICAgY29uc3QgY2hpbGRMYXllclZpZXdzID0gW107XG4gICAgdGhpcy5maW5kQ2hpbGRMYXllclZpZXcoamltdUxheWVyVmlld0lkLCBjaGlsZExheWVyVmlld3MpO1xuICAgIHJldHVybiBjaGlsZExheWVyVmlld3M7XG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBmaW5kQ2hpbGRMYXllclZpZXcocGFyZW50SmltdUxheWVyVmlld0lkOiBzdHJpbmcsIGNoaWxkTGF5ZXJWaWV3czogSmltdUxheWVyVmlld1tdKSB7XG4gICAgY29uc3QgbGF5ZXJWaWV3cyA9IHRoaXMuamltdUxheWVyVmlld3M7XG4gICAgY29uc3QgbGF5ZXJWaWV3c0tleXMgPSBPYmplY3Qua2V5cyhsYXllclZpZXdzKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxheWVyVmlld3NLZXlzLmxlbmd0aDsgaSArKykge1xuICAgICAgaWYgKGxheWVyVmlld3NbbGF5ZXJWaWV3c0tleXNbaV1dLnBhcmVudEppbXVMYXllclZpZXdJZCA9PT0gcGFyZW50SmltdUxheWVyVmlld0lkKSB7XG4gICAgICAgIGNoaWxkTGF5ZXJWaWV3cy5wdXNoKGxheWVyVmlld3NbbGF5ZXJWaWV3c0tleXNbaV1dKTtcbiAgICAgICAgdGhpcy5maW5kQ2hpbGRMYXllclZpZXcobGF5ZXJWaWV3c1tsYXllclZpZXdzS2V5c1tpXV0uamltdUxheWVySWQsIGNoaWxkTGF5ZXJWaWV3cyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgdXBkYXRlTWF4TGF5ZXJJbmRleCgpIHtcbiAgICB0aGlzLm1heExheWVySW5kZXggPSB0aGlzLm1heExheWVySW5kZXggKyAxO1xuICAgIHJldHVybiB0aGlzLm1heExheWVySW5kZXg7XG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBjcmVhdGVKaW11TGF5ZXJWaWV3SW5TdWJsYXllcnMobGF5ZXIsIHBhcmVudEppbXVMYXllclZpZXdJZCwgcm9vdEppbXVMYXllcklkLCByb290TGF5ZXJJZCkge1xuICAgIGNvbnN0IHJvb3REcyA9IERhdGFTb3VyY2VNYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0RGF0YVNvdXJjZSh0aGlzLmRhdGFzb3VyY2VJZCk7XG4gICAgaWYgKGxheWVyLnN1YmxheWVycyAmJiBsYXllci5zdWJsYXllcnMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgdGVtcERzID0gKHJvb3REcyBhcyBhbnkpLmdldERhdGFTb3VyY2VCeUxheWVyKGxheWVyLmlkLnRvU3RyaW5nKCksIGRhdGFTb3VyY2VVdGlscy5nZXRVcmxCeUxheWVyKGxheWVyKSwgcm9vdExheWVySWQpO1xuICAgICAgaWYgKCF0ZW1wRHMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB0ZW1wSmltdUxheWVyVmlld0NvbnN0cnVjdG9yT3B0aW9ucyA9IHtcbiAgICAgICAgamltdUxheWVySWQ6IGxheWVyLmlkLFxuICAgICAgICByb290SmltdUxheWVySWQ6IHJvb3RKaW11TGF5ZXJJZCxcbiAgICAgICAgbGF5ZXJEYXRhU291cmNlSWQ6IHRlbXBEcyAmJiB0ZW1wRHMuaWQsXG4gICAgICAgIHZpZXc6IG51bGwsXG4gICAgICAgIHVybDogbGF5ZXIudXJsLFxuICAgICAgICBqaW11TWFwVmlld0lkOiB0aGlzLmlkLFxuICAgICAgICB0eXBlOiBMYXllclR5cGVzLkdyb3VwTGF5ZXIsXG4gICAgICAgIGxheWVyOiBsYXllcixcbiAgICAgICAgcGFyZW50SmltdUxheWVyVmlld0lkOiBwYXJlbnRKaW11TGF5ZXJWaWV3SWQsXG4gICAgICAgIGxheWVySW5kZXg6IHRoaXMudXBkYXRlTWF4TGF5ZXJJbmRleCgpXG4gICAgICB9O1xuXG4gICAgICBjb25zdCB0ZW1wSmltdUxheWVyVmlldyA9IG5ldyBKaW11R3JvdXBMYXllclZpZXcodGVtcEppbXVMYXllclZpZXdDb25zdHJ1Y3Rvck9wdGlvbnMgYXMgSmltdUZlYXR1cmVMYXllclZpZXdPcHRpb25zKTtcbiAgICAgIHRoaXMuYWRkSmltdUxheWVyVmlldyh0ZW1wSmltdUxheWVyVmlldyk7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGF5ZXIuc3VibGF5ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMuY3JlYXRlSmltdUxheWVyVmlld0luU3VibGF5ZXJzKGxheWVyLnN1YmxheWVycy5nZXRJdGVtQXQoaSksIHRlbXBKaW11TGF5ZXJWaWV3LmppbXVMYXllcklkLCByb290SmltdUxheWVySWQsIHJvb3RMYXllcklkKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgdGVtcERzID0gKHJvb3REcyBhcyBhbnkpLmdldERhdGFTb3VyY2VCeUxheWVyKGxheWVyLmlkLnRvU3RyaW5nKCksIGRhdGFTb3VyY2VVdGlscy5nZXRVcmxCeUxheWVyKGxheWVyKSwgcm9vdExheWVySWQpO1xuICAgICAgaWYgKCF0ZW1wRHMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB0ZW1wSmltdUxheWVyVmlld0NvbnN0cnVjdG9yT3B0aW9ucyA9IHtcbiAgICAgICAgamltdUxheWVySWQ6IGxheWVyLmlkLFxuICAgICAgICByb290SmltdUxheWVySWQ6IHJvb3RKaW11TGF5ZXJJZCxcbiAgICAgICAgbGF5ZXJEYXRhU291cmNlSWQ6IHRlbXBEcyAmJiB0ZW1wRHMuaWQsXG4gICAgICAgIHZpZXc6IG51bGwsXG4gICAgICAgIHVybDogbGF5ZXIudXJsLFxuICAgICAgICBqaW11TWFwVmlld0lkOiB0aGlzLmlkLFxuICAgICAgICB0eXBlOiBMYXllclR5cGVzLkZlYXR1cmVMYXllcixcbiAgICAgICAgbGF5ZXI6IGxheWVyLFxuICAgICAgICBwYXJlbnRKaW11TGF5ZXJWaWV3SWQ6IHBhcmVudEppbXVMYXllclZpZXdJZCxcbiAgICAgICAgbGF5ZXJJbmRleDogdGhpcy51cGRhdGVNYXhMYXllckluZGV4KClcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHRlbXBKaW11TGF5ZXJWaWV3ID0gbmV3IEppbXVGZWF0dXJlTGF5ZXJWaWV3KHRlbXBKaW11TGF5ZXJWaWV3Q29uc3RydWN0b3JPcHRpb25zIGFzIEppbXVGZWF0dXJlTGF5ZXJWaWV3T3B0aW9ucyk7XG4gICAgICB0aGlzLmFkZEppbXVMYXllclZpZXcodGVtcEppbXVMYXllclZpZXcpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIGdldEppbXVMYXllclZpZXdMb2FkUHJvbWlzZUJ5SWQoamltdUxheWVyVmlld0lkOiBzdHJpbmcpOiBQcm9taXNlPEppbXVMYXllclZpZXc+IHtcbiAgICByZXR1cm4gdGhpcy5qaW11TGF5ZXJWaWV3TG9hZFByb21pc2VzW2ppbXVMYXllclZpZXdJZF07XG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBjbGVhclNlbGVjdGVkRmVhdHVyZXMgPSAoKSA9PiB7XG4gICAgY29uc3QgamltdUxheWVyVmlld3MgPSB0aGlzLmppbXVMYXllclZpZXdzO1xuICAgIGNvbnN0IGppbXVMYXllclZpZXdLZXlzID0gT2JqZWN0LmtleXMoamltdUxheWVyVmlld3MpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgamltdUxheWVyVmlld0tleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHRlbXBKaW11TGF5ZXJWaWV3ID0gamltdUxheWVyVmlld3NbamltdUxheWVyVmlld0tleXNbaV1dO1xuICAgICAgaWYgKHRlbXBKaW11TGF5ZXJWaWV3LnR5cGUgPT09IExheWVyVHlwZXMuRmVhdHVyZUxheWVyKSB7XG4gICAgICAgICh0ZW1wSmltdUxheWVyVmlldyBhcyBKaW11RmVhdHVyZUxheWVyVmlldykuc2VsZWN0RmVhdHVyZXNCeUlkcyhbXSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgTWVzc2FnZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5wdWJsaXNoTWVzc2FnZShuZXcgRGF0YVJlY29yZHNTZWxlY3Rpb25DaGFuZ2VNZXNzYWdlKHRoaXMubWFwV2lkZ2V0SWQsIFtdKSk7XG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBzZWxlY3RGZWF0dXJlc0J5R3JhcGhpYyhncmFwaGljOiBfX2VzcmkuR3JhcGhpYywgc3BhdGlhbFJlbGF0aW9uc2hpcDogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcbiAgICByZXR1cm4gbG9hZEFyY0dJU0pTQVBJTW9kdWxlcyhbXG4gICAgICAnZXNyaS9nZW9tZXRyeS9nZW9tZXRyeUVuZ2luZSdcbiAgICBdKS50aGVuKG1vZHVsZXMgPT4ge1xuICAgICAgY29uc3QgZ2VvbWV0cnlFbmdpbmU6IF9fZXNyaS5nZW9tZXRyeUVuZ2luZSA9IG1vZHVsZXNbMF07XG4gICAgICBsZXQgZ2VvbWV0cnkgPSBncmFwaGljLmdlb21ldHJ5O1xuICAgICAgaWYgKChnZW9tZXRyeS50eXBlID09PSAncG9pbnQnIHx8IGdlb21ldHJ5LnR5cGUgPT09ICdwb2x5bGluZScpKSB7XG4gICAgICAgIGNvbnN0IHJlc29sdXRpb24gPSB0aGlzLnZpZXcuc2NhbGUgKiAyLjU0IC8gOTYwMDtcbiAgICAgICAgZ2VvbWV0cnkgPSBnZW9tZXRyeUVuZ2luZS5idWZmZXIoZ2VvbWV0cnksIDEwICogcmVzb2x1dGlvbiwgJ21ldGVycycpIGFzIGFueTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcXVlcnkgPSB7XG4gICAgICAgIGdlb21ldHJ5OiBnZW9tZXRyeSxcbiAgICAgICAgc3BhdGlhbFJlbGF0aW9uc2hpcDogc3BhdGlhbFJlbGF0aW9uc2hpcCxcbiAgICAgICAgcmV0dXJuR2VvbWV0cnk6IHRydWUsXG4gICAgICAgIG91dEZpZWxkczogWycqJ11cbiAgICAgIH0gYXMgYW55O1xuXG4gICAgICBjb25zdCBqaW11TGF5ZXJWaWV3cyA9IHRoaXMuamltdUxheWVyVmlld3M7XG4gICAgICBjb25zdCBqaW11TGF5ZXJWaWV3S2V5cyA9IE9iamVjdC5rZXlzKGppbXVMYXllclZpZXdzKTtcbiAgICAgIGNvbnN0IGFsbFNlbGVjdFByb21pc2VzID0gW107XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgamltdUxheWVyVmlld0tleXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgdGVtcEppbXVMYXllclZpZXcgPSBqaW11TGF5ZXJWaWV3c1tqaW11TGF5ZXJWaWV3S2V5c1tpXV07XG4gICAgICAgIGlmICh0ZW1wSmltdUxheWVyVmlldy50eXBlID09PSBMYXllclR5cGVzLkZlYXR1cmVMYXllcikge1xuICAgICAgICAgIGNvbnN0IHRlbXBTZWxlY3RQcm9taXNlID0gdGhpcy5nZXRTZWxlY3RSZWNvcmRzQnlRdWVyeVByb21pc2UodGVtcEppbXVMYXllclZpZXcgYXMgSmltdUZlYXR1cmVMYXllclZpZXcsIHF1ZXJ5KTtcbiAgICAgICAgICBhbGxTZWxlY3RQcm9taXNlcy5wdXNoKHRlbXBTZWxlY3RQcm9taXNlKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gUHJvbWlzZS5hbGwoYWxsU2VsZWN0UHJvbWlzZXMpO1xuICAgIH0pXG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBnZXRTZWxlY3RSZWNvcmRzQnlRdWVyeVByb21pc2UgPSAodGVtcEppbXVGZWF0dXJlTGF5ZXJWaWV3OiBKaW11RmVhdHVyZUxheWVyVmlldywgcXVlcnk6IEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zKSA9PiB7XG4gICAgcmV0dXJuIHRlbXBKaW11RmVhdHVyZUxheWVyVmlldy5zZWxlY3RSZWNvcmRzQnlRdWVyeShxdWVyeSk7XG4gIH1cblxuICAvKipcbiAgICogRGVzdHJveSB0aGUgSmltdU1hcFZpZXcgaW5zdGFuY2UsIGFuZCBhbHNvIGRlc3Ryb3kgdGhlIGFyY2dpcyA0LnggdmlldyBhdCB0aGUgc2FtZSB0aW1lLlxuICAgKi9cbiAgZGVzdHJveSgpIHtcbiAgICBjb25zdCBqaW11TGF5ZXJWaWV3cyA9IHRoaXMuamltdUxheWVyVmlld3M7XG4gICAgY29uc3QgamltdUxheWVyVmlld0lkcyA9IE9iamVjdC5rZXlzKGppbXVMYXllclZpZXdzKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGppbXVMYXllclZpZXdJZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHRlbXBKaW11TGF5ZXJWaWV3ID0gamltdUxheWVyVmlld3NbamltdUxheWVyVmlld0lkc1tpXV07XG4gICAgICB0ZW1wSmltdUxheWVyVmlldy5kZXN0cm95KCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMudmlldykge1xuICAgICAgaWYgKCF0aGlzLnZpZXcuZGVzdHJveWVkKSB7XG4gICAgICAgIGlmICh0aGlzLnZpZXcuZ3JhcGhpY3MgJiYgdGhpcy52aWV3LmdyYXBoaWNzLmRlc3Ryb3llZCkge1xuICAgICAgICAgIHRoaXMudmlldy5ncmFwaGljcy5kZXN0cm95KCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy52aWV3LmNvbnRhaW5lciA9IG51bGw7XG4gICAgICAgIGlmICh0aGlzLnZpZXcuYWxsTGF5ZXJWaWV3cyAmJiB0aGlzLnZpZXcuYWxsTGF5ZXJWaWV3cy5kZXN0cm95ZWQpIHtcbiAgICAgICAgICB0aGlzLnZpZXcuYWxsTGF5ZXJWaWV3cy5kZXN0cm95KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMudmlldy5sYXllclZpZXdzICYmIHRoaXMudmlldy5sYXllclZpZXdzLmRlc3Ryb3llZCkge1xuICAgICAgICAgIHRoaXMudmlldy5sYXllclZpZXdzLmRlc3Ryb3koKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHVpID0gdGhpcy52aWV3LnVpO1xuICAgICAgICBpZiAodWkuZXhiTWFwVG9vbHMgJiYgT2JqZWN0LmtleXModWkuZXhiTWFwVG9vbHMpLmxlbmd0aCAhPT0gMCkge1xuICAgICAgICAgIE9iamVjdC5rZXlzKHVpLmV4Yk1hcFRvb2xzKS5tYXAoKGtleSwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIHVpLmV4Yk1hcFRvb2xzW2tleV0uZGVzdHJveSgpO1xuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgICAgdWkuZXhiTWFwVG9vbHMgPSB7fTtcbiAgICAgICAgdGhpcy52aWV3LmRlc3Ryb3koKTtcblxuICAgICAgICB0aGlzLnZpZXcgPSBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBNkJBOzs7OztBQUtBO0FBQ0E7QUE2REE7QUFBQTtBQWZBO0FBQ0E7QUFRQTtBQUNBO0FBNE5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQXNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFxQ0E7QUFDQTtBQUNBO0FBQ0E7QUF6Z0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBZ0JBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBT0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7OyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./jimu-arcgis/lib/views/jimu-map-view.ts\n");

/***/ }),

/***/ "./jimu-arcgis/lib/views/layers/jimu-feature-layer-view.ts":
/*!*****************************************************************!*\
  !*** ./jimu-arcgis/lib/views/layers/jimu-feature-layer-view.ts ***!
  \*****************************************************************/
/*! exports provided: JimuFeatureLayerView */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"JimuFeatureLayerView\", function() { return JimuFeatureLayerView; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _jimu_layer_view__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./jimu-layer-view */ \"./jimu-arcgis/lib/views/layers/jimu-layer-view.ts\");\n/* harmony import */ var _mapview_manager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../mapview-manager */ \"./jimu-arcgis/lib/mapview-manager.tsx\");\n/* harmony import */ var _arcgis_js_api_module_loader__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../arcgis-js-api-module-loader */ \"./jimu-arcgis/lib/arcgis-js-api-module-loader.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (undefined && undefined.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\n\n\n\n\n/**\n * The JimuFeatureLayerView extends from the JimuLayerView.\n */\nvar JimuFeatureLayerView = /** @class */ (function (_super) {\n    __extends(JimuFeatureLayerView, _super);\n    function JimuFeatureLayerView(options) {\n        var _this = _super.call(this, options) || this;\n        /** @ignore */\n        _this.features = [];\n        /** @ignore */\n        _this.isReservePopup = false;\n        /**\n         * @ignore\n         * virtualLayer is used highlight layer in mapservice\n         */\n        _this.virtualLayer = null;\n        /** @ignore */\n        _this.selectedIds = '';\n        /** @ignore */\n        _this.localDefinitionExpression = '';\n        /** @ignore */\n        _this.originalGdbVersion = null;\n        if (_this.view) {\n            _this.originalGdbVersion = _this.layer.gdbVersion;\n        }\n        if (_this.layer) {\n            _this.layer.watch('visible', function (newValue, oldValue) {\n                if (_this.virtualLayer) {\n                    _this.virtualLayer.visible = newValue;\n                }\n                if (!_this.view) {\n                    _this.highLightSelectedFeaturesWithVirtualLayer();\n                }\n            });\n        }\n        _this.getViewForMap().popup.watch('selectedFeature', function (graphic) {\n            if (graphic) {\n                if (!graphic || !graphic.layer) {\n                    return;\n                }\n                if (graphic.layer === _this.layer) {\n                    var tempId_1 = String(graphic.attributes[graphic.layer.objectIdField]);\n                    if (tempId_1 === _this.selectedIds) {\n                        return;\n                    }\n                    var layerDataSource = _this.getLayerDataSource();\n                    var jimuMapView_1 = _mapview_manager__WEBPACK_IMPORTED_MODULE_2__[\"MapViewManager\"].getInstance().getJimuMapViewById(_this.jimuMapViewId);\n                    layerDataSource.queryById(tempId_1).then(function (record) {\n                        _this.selectFeatureById(tempId_1, record);\n                        _this.isReservePopup = true;\n                        jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"MessageManager\"].getInstance().publishMessage(new jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"DataRecordsSelectionChangeMessage\"](jimuMapView_1.mapWidgetId, [record]));\n                    });\n                }\n                else {\n                    _this.isReservePopup = false;\n                    _this.selectFeatureById(null);\n                }\n            }\n        });\n        _this.getViewForMap().popup.watch('visible', function (visible) {\n            var view = _this.getViewForMap();\n            if (!visible && view.popup.selectedFeature && view.popup.selectedFeature.layer === _this.layer) {\n                var jimuMapView = _mapview_manager__WEBPACK_IMPORTED_MODULE_2__[\"MapViewManager\"].getInstance().getJimuMapViewById(_this.jimuMapViewId);\n                jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"MessageManager\"].getInstance().publishMessage(new jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"DataRecordsSelectionChangeMessage\"](jimuMapView.mapWidgetId, []));\n                _this.isReservePopup = false;\n                _this.selectFeatureById(null);\n            }\n        });\n        if (_this.getSelectedRecordIds().length > 0) {\n            _this.moveFeatureToCenter(_this.getSelectedRecordIds()[0]).then(function () {\n                _this.highLightSelectedFeatures();\n            });\n        }\n        else if (_this.getLayerDataSource() && _this.getLayerDataSource().getSelectedRecordIds().length > 0) {\n            _this.moveFeatureToCenter(_this.getLayerDataSource().getSelectedRecordIds()[0]).then(function () {\n                _this.highLightFeatures(_this.getLayerDataSource().getSelectedRecordIds().map(function (id) { return parseInt(id); }));\n            }, function (err) { return console.error(err); });\n        }\n        var isInbuilder = window && window.jimuConfig && window.jimuConfig.isInBuilder;\n        if (isInbuilder) {\n            _this.appModeObserver = Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"observeStore\"])(_this.onAppModeInfoChange.bind(_this), ['appRuntimeInfo', 'appMode']);\n        }\n        return _this;\n    }\n    /**\n     * @ignore\n     * this queries from client\n     * @param query\n     */\n    JimuFeatureLayerView.prototype.doQuery = function (query) {\n        var _this = this;\n        return new Promise(function (resolve) {\n            if (_this.view.updating) {\n                if (_this.updateWatchHandle) {\n                    _this.updateWatchHandle.remove();\n                    _this.updateWatchHandle = null;\n                }\n                _this.updateWatchHandle = _this.view.watch('updating', function (val) {\n                    if (!val) { // wait for the layer view to finish updating\n                        _this.view.queryFeatures(query).then(function (featureSet) {\n                            _this.features = featureSet.features;\n                            resolve(_this.features);\n                        });\n                    }\n                });\n            }\n            else {\n                _this.view.queryFeatures(query).then(function (featureSet) {\n                    _this.features = featureSet.features;\n                    resolve(_this.features);\n                }, function (err) {\n                    console.error(err);\n                });\n            }\n        });\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.doQueryById = function (id) {\n        //we can't use the layer.createQuery() because the created query will not be supported\n        //return false from esri.layers.graphics.QueryEngine._isSupportedQuery()\n        // let q = this.view.layer.createQuery();\n        var q = {\n            objectIds: [parseInt(id)],\n            returnGeometry: true\n        };\n        return this.doQuery(q).then(function (features) { return features[0]; });\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.mergeQuery = function (baseQuery, newQuery) {\n        var where = \"(\" + baseQuery.where + \") and (\" + newQuery.where + \")\";\n        return __assign(__assign(__assign({}, baseQuery), newQuery), { where: where });\n    };\n    JimuFeatureLayerView.prototype.setRefreshIntervalForLayer = function (refreshInterval) {\n        if (!this.view || refreshInterval === undefined || refreshInterval === null) {\n            return;\n        }\n        var appMode = Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().appRuntimeInfo.appMode;\n        if (appMode === jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"AppMode\"].Design) {\n            this.layer.refreshInterval = 0;\n        }\n        else {\n            this.layer.refreshInterval = refreshInterval / 60;\n        }\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.setDefinitionExpressionForLayer = function (query) {\n        var _this = this;\n        if (query) {\n            if (this.view && this.view.layer) {\n                var localQuery = {\n                    outFields: ['*'],\n                    where: this.localDefinitionExpression,\n                    returnGeometry: true\n                };\n                var mergedQuery = this.getLayerDataSource().getRealQueryParams(localQuery, 'query');\n                if (mergedQuery) {\n                    this.view.layer.definitionExpression = mergedQuery.where;\n                }\n                if (query.geometry) {\n                    if (this.view.filter) {\n                        if (this.view.filter.geometry === query.geometry) {\n                            return;\n                        }\n                    }\n                    Object(_arcgis_js_api_module_loader__WEBPACK_IMPORTED_MODULE_3__[\"loadArcGISJSAPIModules\"])([\n                        'esri/geometry/support/jsonUtils'\n                    ]).then(function (modules) {\n                        var jsonUtils = modules[0];\n                        _this.view.filter = {\n                            geometry: jsonUtils.fromJSON(query.geometry)\n                        };\n                    });\n                }\n                else {\n                    if (this.view.filter) {\n                        this.view.filter = null;\n                    }\n                }\n                return;\n            }\n            if (!this.view && this.layer) {\n                var localQuery = {\n                    outFields: ['*'],\n                    where: this.localDefinitionExpression,\n                    returnGeometry: true\n                };\n                var mergedQuery = this.getLayerDataSource().getRealQueryParams(localQuery, 'query');\n                if (mergedQuery) {\n                    this.layer.definitionExpression = mergedQuery.where;\n                }\n                return;\n            }\n        }\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.setLocalDefinitionExpression = function (localDefinitionExpression) {\n        this.localDefinitionExpression = localDefinitionExpression;\n        if (this.getLayerDataSource().getCurrentQueryParams()) {\n            this.setDefinitionExpressionForLayer(this.getLayerDataSource().getCurrentQueryParams());\n        }\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.highLightSelectedFeatures = function () {\n        //TODO handle multiple features\n        if (this.view) {\n            this.highLightFeatures(this.getSelectedRecordIds().map(function (id) { return parseInt(id); }));\n        }\n        else {\n            this.highLightSelectedFeaturesWithVirtualLayer();\n        }\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.highLightSelectedFeaturesWithVirtualLayer = function () {\n        var _this = this;\n        var jimuMapView = _mapview_manager__WEBPACK_IMPORTED_MODULE_2__[\"MapViewManager\"].getInstance().getJimuMapViewById(this.jimuMapViewId);\n        var parentJimuLayerViews = jimuMapView.getParentLayerViews(this.id);\n        var isParentLayerVisibleShow = true;\n        for (var i = 0; i < parentJimuLayerViews.length; i++) {\n            if (!parentJimuLayerViews[i].layer.visible) {\n                isParentLayerVisibleShow = false;\n                break;\n            }\n        }\n        if (!isParentLayerVisibleShow || !this.layer.visible) {\n            return;\n        }\n        if (this.virtualLayer) {\n            jimuMapView.view.map.remove(this.virtualLayer);\n            this.virtualLayer = null;\n            this.clearHighLight();\n        }\n        var layerDs = this.getLayerDataSource();\n        var seletedRecords = layerDs.getSelectedRecords();\n        if (seletedRecords && seletedRecords.length > 0) {\n            var layerFromFeatureSet_1 = layerDs.layer;\n            var objectIdFieldInFeaturelayer_1 = this.getObjectIdField(layerFromFeatureSet_1.fields, layerFromFeatureSet_1.objectIdField);\n            var sourceFeatures_1 = [];\n            for (var i = 0; i < seletedRecords.length; i++) {\n                var tempFeature = seletedRecords[i].feature.clone();\n                var objectIdFieldValue = tempFeature.attributes[layerFromFeatureSet_1.objectIdField];\n                tempFeature.attributes = {};\n                tempFeature.attributes[layerFromFeatureSet_1.objectIdField] = objectIdFieldValue;\n                sourceFeatures_1.push(tempFeature);\n            }\n            Object(_arcgis_js_api_module_loader__WEBPACK_IMPORTED_MODULE_3__[\"loadArcGISJSAPIModules\"])([\n                'esri/layers/FeatureLayer'\n            ]).then(function (modules) {\n                var FeatureLayer = modules[0];\n                _this.virtualLayer = new FeatureLayer({\n                    title: layerFromFeatureSet_1.title,\n                    source: sourceFeatures_1,\n                    fields: objectIdFieldInFeaturelayer_1 ? [objectIdFieldInFeaturelayer_1] : [],\n                    objectIdField: layerFromFeatureSet_1.objectIdField,\n                    renderer: _this.getRendererForVirtualLayer(sourceFeatures_1[0].geometry.type),\n                    listMode: 'hide',\n                    legendEnabled: false\n                });\n                jimuMapView.view.map.add(_this.virtualLayer, _this.layerIndex);\n                _this.virtualLayer.on('layerview-create', function (event) {\n                    var featureLayerView = event.layerView;\n                    _this.highLightHandle = featureLayerView.highlight(sourceFeatures_1);\n                });\n            });\n        }\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.highLightFeatures = function (features) {\n        var _this = this;\n        if (this.highLightHandle) {\n            this.highLightHandle.remove();\n            this.highLightHandle = null;\n        }\n        if (this.view) {\n            this.view.when(function () {\n                if (_this.highLightHandle) {\n                    _this.highLightHandle.remove();\n                    _this.highLightHandle = null;\n                }\n                _this.highLightHandle = _this.view.highlight(features);\n            });\n        }\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.clearHighLight = function () {\n        if (this.highLightHandle) {\n            this.highLightHandle.remove();\n            this.highLightHandle = null;\n            if (this.isReservePopup) {\n                this.getViewForMap().popup.close();\n                this.isReservePopup = false;\n            }\n        }\n        if (this.virtualLayer) {\n            var jimuMapView = _mapview_manager__WEBPACK_IMPORTED_MODULE_2__[\"MapViewManager\"].getInstance().getJimuMapViewById(this.jimuMapViewId);\n            jimuMapView.view.map.remove(this.virtualLayer);\n            this.virtualLayer = null;\n        }\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.selectFeatureById = function (id, record) {\n        this.getLayerDataSource().selectRecordById(id, record);\n        if (id === null || id === undefined) {\n            this.clearHighLight();\n        }\n        else {\n            this.highLightSelectedFeatures();\n        }\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.selectFeaturesByIds = function (ids, records) {\n        this.getLayerDataSource().selectRecordsByIds(ids, records);\n        if (!(ids && ids.length > 0)) {\n            this.clearHighLight();\n        }\n        else {\n            this.highLightSelectedFeatures();\n        }\n        //TODO extents for all features\n        // this.moveFeatureToCenter(ids[0]);\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.onAppModeInfoChange = function (preDsInfo, dsInfo) {\n        var _a;\n        this.setRefreshIntervalForLayer((_a = this.getLayerDataSource()) === null || _a === void 0 ? void 0 : _a.getAutoRefreshInterval());\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.onLayerDataSourceInfoChange = function (preDsInfo, dsInfo) {\n        var _a, _b, _c;\n        if (((_a = dsInfo.selectedIds) === null || _a === void 0 ? void 0 : _a.length) > 0 || ((_b = dsInfo.selectedIndexes) === null || _b === void 0 ? void 0 : _b.length) > 0) {\n            if (this.selectedIds !== dsInfo.selectedIds.join(',')) {\n                this.selectedIds = dsInfo.selectedIds.join(',');\n                this.highLightSelectedFeatures();\n            }\n        }\n        else {\n            this.selectedIds = '';\n            this.clearHighLight();\n        }\n        if (this.getLayerDataSource().getCurrentQueryParams()) {\n            this.setDefinitionExpressionForLayer(this.getLayerDataSource().getCurrentQueryParams());\n        }\n        if (this.view) {\n            if (dsInfo.gdbVersion) {\n                this.layer.gdbVersion = dsInfo.gdbVersion;\n            }\n            if (!dsInfo.gdbVersion) {\n                this.layer.gdbVersion = this.originalGdbVersion;\n            }\n        }\n        this.setRefreshIntervalForLayer((_c = this.getLayerDataSource()) === null || _c === void 0 ? void 0 : _c.getAutoRefreshInterval());\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.getViewForMap = function () {\n        var jimuMapView = _mapview_manager__WEBPACK_IMPORTED_MODULE_2__[\"MapViewManager\"].getInstance().getJimuMapViewById(this.jimuMapViewId);\n        return jimuMapView && jimuMapView.view;\n    };\n    // the function is used for handling featureNavigate at popup\n    /** @ignore */\n    JimuFeatureLayerView.prototype.handleFeatureNavigationAtPopUp = function (id) {\n        var layerDs = this.getLayerDataSource();\n        this.isReservePopup = true;\n        layerDs.selectRecordById(id);\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.moveFeatureToCenter = function (id) {\n        var _this = this;\n        return this.doQueryById(id).then(function (feature) {\n            if (feature) {\n                return feature;\n            }\n            else {\n                if (_this.getLayerDataSource()) {\n                    return _this.getLayerDataSource().queryById(id).then(function (record) {\n                        return record && record.feature;\n                    });\n                }\n                else {\n                    return null;\n                }\n            }\n        }).then(function (feature) {\n            if (feature) {\n                var centerPoint = _this.getCenterPoint(feature.geometry);\n                if (centerPoint) {\n                    return _this.getViewForMap().goTo(centerPoint);\n                }\n                else {\n                    return Promise.reject('Does not find center point.');\n                }\n            }\n            else {\n                return Promise.reject('Dose not find feature.' + id);\n            }\n        });\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.getCenterPoint = function (geometry) {\n        //point | multipoint | polyline | polygon | extent | mesh\n        switch (geometry.type) {\n            case 'point':\n                return geometry;\n            case 'extent':\n                return geometry.center;\n            case 'polygon':\n                return geometry.centroid;\n            case 'polyline':\n                return geometry.extent.center;\n            default:\n                return geometry && geometry.extent ? geometry.extent.center : undefined;\n            //todo\n        }\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.getSelectedRecordIds = function () {\n        var _this = this;\n        if (!Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[this.layerDataSourceId]) {\n            return [];\n        }\n        if (Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[this.layerDataSourceId].selectedIds) {\n            return Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[this.layerDataSourceId].selectedIds.asMutable();\n        }\n        else if (Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[this.layerDataSourceId].selectedIndexes) {\n            return Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[this.layerDataSourceId].selectedIndexes.asMutable().map(function (index) { return _this.features[index].attributes[_this.getIdField()]; });\n        }\n        else {\n            return [];\n        }\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.getIdField = function () {\n        // return this.getLayerDataSource() && this.getLayerDataSource().getIdField();\n        var objectIdField = this.view.layer.objectIdField;\n        if (!objectIdField) {\n            var f = this.view.layer.fields.find(function (f) { return f.type === 'oid'; });\n            if (f) {\n                objectIdField = f.name;\n            }\n        }\n        if (!objectIdField) {\n            objectIdField = 'OBJECTID';\n        }\n        return objectIdField;\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.getLayerDataSource = function () {\n        return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"DataSourceManager\"].getInstance().getDataSource(this.layerDataSourceId);\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.selectRecordsByQuery = function (query) {\n        var _this = this;\n        return Object(_arcgis_js_api_module_loader__WEBPACK_IMPORTED_MODULE_3__[\"loadArcGISJSAPIModules\"])([\n            'esri/layers/FeatureLayer'\n        ]).then(function (modules) {\n            var jimuMapView = _mapview_manager__WEBPACK_IMPORTED_MODULE_2__[\"MapViewManager\"].getInstance().getJimuMapViewById(_this.jimuMapViewId);\n            var parentJimuLayerViews = jimuMapView.getParentLayerViews(_this.id);\n            var isParentLayerVisibleShow = true;\n            for (var i = 0; i < parentJimuLayerViews.length; i++) {\n                if (!parentJimuLayerViews[i].layer.visible) {\n                    isParentLayerVisibleShow = false;\n                    break;\n                }\n            }\n            if (!isParentLayerVisibleShow || !_this.layer.visible) {\n                return Promise.resolve([]);\n            }\n            if (_this.virtualLayer) {\n                jimuMapView.view.map.remove(_this.virtualLayer);\n                _this.virtualLayer = null;\n                _this.clearHighLight();\n            }\n            var layerDs = _this.getLayerDataSource();\n            query.geometry = query.geometry.toJSON ? query.geometry.toJSON() : query.geometry;\n            var layerViewDs = layerDs.dataSourceManager.createLocalDataSource(layerDs, 'view');\n            if (layerViewDs && layerViewDs.layer) {\n                return layerViewDs.load(query, { widgetId: 'view' }).then(function (result) {\n                    if (result && result.length > 0) {\n                        var selectedIds = [];\n                        var sourceFeatures = [];\n                        var messageRecords = [];\n                        for (var i = 0; i < result.length; i++) {\n                            selectedIds.push(result[i].getId());\n                            sourceFeatures.push(result[i].feature);\n                            messageRecords.push(result[i]);\n                        }\n                        jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"MessageManager\"].getInstance().publishMessage(new jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"DataRecordsSelectionChangeMessage\"](jimuMapView.mapWidgetId, messageRecords));\n                        layerViewDs.selectRecordsByIds(selectedIds);\n                        return Promise.resolve(sourceFeatures);\n                    }\n                    else {\n                        return Promise.resolve([]);\n                    }\n                });\n            }\n            else {\n                return Promise.resolve([]);\n            }\n        }, function () {\n            return Promise.resolve([]);\n        }).then(function (features) {\n            if (!features || (features && features.length === 0)) {\n                var layerDs = _this.getLayerDataSource();\n                layerDs.selectRecordsByIds([]);\n            }\n            return Promise.resolve(features);\n        });\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.getObjectIdField = function (fields, objectIdFieldName) {\n        var objectIdField = null;\n        for (var i = 0; i < fields.length; i++) {\n            if (fields[i].name === objectIdFieldName) {\n                objectIdField = fields[i];\n                return objectIdField;\n            }\n        }\n        return objectIdField;\n    };\n    /** @ignore */\n    JimuFeatureLayerView.prototype.getRendererForVirtualLayer = function (geometryType) {\n        if (['point', 'multipoint'].indexOf(geometryType) > -1) {\n            return {\n                type: 'simple',\n                symbol: {\n                    type: 'simple-marker',\n                    style: 'circle',\n                    color: [0, 255, 255, 1],\n                    size: '16px',\n                    outline: {\n                        color: [0, 255, 255, 1],\n                        width: 1\n                    }\n                }\n            };\n        }\n        else if (['polyline'].indexOf(geometryType) > -1) {\n            return {\n                type: 'simple',\n                symbol: {\n                    type: 'simple-line',\n                    color: [0, 255, 255, 1],\n                    width: 1,\n                    style: 'solid'\n                }\n            };\n        }\n        else if (['polygon', 'extent'].indexOf(geometryType) > -1) {\n            return {\n                type: 'simple',\n                symbol: {\n                    type: 'simple-fill',\n                    color: [0, 255, 255, 0],\n                    style: 'solid',\n                    outline: {\n                        color: [0, 255, 255, 1],\n                        width: 1\n                    }\n                }\n            };\n        }\n        else if (['mesh'].indexOf(geometryType) > -1) {\n            return {\n                type: 'simple',\n                symbol: {\n                    type: 'mesh-3d',\n                    symbolLayers: [{\n                            type: 'fill',\n                            material: { color: [0, 255, 255, 1] }\n                        }]\n                }\n            };\n        }\n        else {\n            return null;\n        }\n    };\n    return JimuFeatureLayerView;\n}(_jimu_layer_view__WEBPACK_IMPORTED_MODULE_1__[\"JimuLayerView\"]));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9saWIvdmlld3MvbGF5ZXJzL2ppbXUtZmVhdHVyZS1sYXllci12aWV3LnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vamltdS1hcmNnaXMvbGliL3ZpZXdzL2xheWVycy9qaW11LWZlYXR1cmUtbGF5ZXItdmlldy50cz8zNTkyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Z2V0QXBwU3RvcmUsIERhdGFTb3VyY2VNYW5hZ2VyLCBGZWF0dXJlTGF5ZXJEYXRhU291cmNlLCBJTURhdGFTb3VyY2VJbmZvLCBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcyxcbiAgRmVhdHVyZURhdGFSZWNvcmQsIE1lc3NhZ2VNYW5hZ2VyLCBEYXRhUmVjb3Jkc1NlbGVjdGlvbkNoYW5nZU1lc3NhZ2UsIG9ic2VydmVTdG9yZSwgQXBwTW9kZX0gZnJvbSAnamltdS1jb3JlJztcbmltcG9ydCB7SmltdUxheWVyVmlldywgSmltdUxheWVyVmlld0NvbnN0cnVjdG9yT3B0aW9uc30gZnJvbSAnLi9qaW11LWxheWVyLXZpZXcnO1xuaW1wb3J0IHtNYXBWaWV3TWFuYWdlcn0gZnJvbSAnLi4vLi4vbWFwdmlldy1tYW5hZ2VyJztcbmltcG9ydCB7IGxvYWRBcmNHSVNKU0FQSU1vZHVsZXMgfSBmcm9tICcuLi8uLi9hcmNnaXMtanMtYXBpLW1vZHVsZS1sb2FkZXInO1xuXG4vKiogQGlnbm9yZSAqL1xuZXhwb3J0IGludGVyZmFjZSBKaW11RmVhdHVyZUxheWVyVmlld09wdGlvbnMgZXh0ZW5kcyBKaW11TGF5ZXJWaWV3Q29uc3RydWN0b3JPcHRpb25zIHtcbiAgdmlldzogX19lc3JpLkZlYXR1cmVMYXllclZpZXc7XG59XG5cbi8qKlxuICogVGhlIEppbXVGZWF0dXJlTGF5ZXJWaWV3IGV4dGVuZHMgZnJvbSB0aGUgSmltdUxheWVyVmlldy5cbiAqL1xuZXhwb3J0IGNsYXNzIEppbXVGZWF0dXJlTGF5ZXJWaWV3IGV4dGVuZHMgSmltdUxheWVyVmlldyB7XG5cbiAgLyoqXG4gICAqIFRoZSB2aWV3IGlzIF9fZXNyaS5GZWF0dXJlTGF5ZXJWaWV3LlxuICAgKiBJZiB0aGUgbGF5ZXIgaXMgZnJvbSBtYXBzZXJ2aWNlLCB2aWV3ID0gbnVsbFxuICAgKi9cbiAgdmlldzogX19lc3JpLkZlYXR1cmVMYXllclZpZXc7XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgaGlnaExpZ2h0SGFuZGxlO1xuXG4gIC8qKiBAaWdub3JlICovXG4gIHVwZGF0ZVdhdGNoSGFuZGxlO1xuXG4gIC8qKiBAaWdub3JlICovXG4gIGZlYXR1cmVzOiBfX2VzcmkuR3JhcGhpY1tdID0gW107XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgaXNSZXNlcnZlUG9wdXA6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKiB2aXJ0dWFsTGF5ZXIgaXMgdXNlZCBoaWdobGlnaHQgbGF5ZXIgaW4gbWFwc2VydmljZVxuICAgKi9cbiAgdmlydHVhbExheWVyOiBfX2VzcmkuRmVhdHVyZUxheWVyID0gbnVsbDtcblxuICAvKiogQGlnbm9yZSAqL1xuICBzZWxlY3RlZElkczogc3RyaW5nID0gJyc7XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgbG9jYWxEZWZpbml0aW9uRXhwcmVzc2lvbjogc3RyaW5nID0gJyc7XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgb3JpZ2luYWxHZGJWZXJzaW9uID0gbnVsbDtcblxuICAvKiogQGlnbm9yZSAqL1xuICBwcml2YXRlIGFwcE1vZGVPYnNlcnZlcjtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBKaW11RmVhdHVyZUxheWVyVmlld09wdGlvbnMpIHtcbiAgICBzdXBlcihvcHRpb25zKTtcblxuICAgIGlmICh0aGlzLnZpZXcpIHtcbiAgICAgIHRoaXMub3JpZ2luYWxHZGJWZXJzaW9uID0gdGhpcy5sYXllci5nZGJWZXJzaW9uO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmxheWVyKSB7XG4gICAgICB0aGlzLmxheWVyLndhdGNoKCd2aXNpYmxlJywgKG5ld1ZhbHVlLCBvbGRWYWx1ZSkgPT4ge1xuICAgICAgICBpZiAodGhpcy52aXJ0dWFsTGF5ZXIpIHtcbiAgICAgICAgICB0aGlzLnZpcnR1YWxMYXllci52aXNpYmxlID0gbmV3VmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnZpZXcpIHtcbiAgICAgICAgICB0aGlzLmhpZ2hMaWdodFNlbGVjdGVkRmVhdHVyZXNXaXRoVmlydHVhbExheWVyKCk7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuXG4gICAgdGhpcy5nZXRWaWV3Rm9yTWFwKCkucG9wdXAud2F0Y2goJ3NlbGVjdGVkRmVhdHVyZScsIGdyYXBoaWMgPT4ge1xuICAgICAgaWYgKGdyYXBoaWMpIHtcbiAgICAgICAgaWYgKCFncmFwaGljIHx8ICFncmFwaGljLmxheWVyKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmIChncmFwaGljLmxheWVyID09PSB0aGlzLmxheWVyKSB7XG4gICAgICAgICAgY29uc3QgdGVtcElkID0gU3RyaW5nKGdyYXBoaWMuYXR0cmlidXRlc1soZ3JhcGhpYy5sYXllciBhcyBfX2VzcmkuRmVhdHVyZUxheWVyKS5vYmplY3RJZEZpZWxkXSk7XG4gICAgICAgICAgaWYgKHRlbXBJZCA9PT0gdGhpcy5zZWxlY3RlZElkcykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGNvbnN0IGxheWVyRGF0YVNvdXJjZSA9IHRoaXMuZ2V0TGF5ZXJEYXRhU291cmNlKCkgYXMgRmVhdHVyZUxheWVyRGF0YVNvdXJjZTtcbiAgICAgICAgICBjb25zdCBqaW11TWFwVmlldyA9IE1hcFZpZXdNYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0SmltdU1hcFZpZXdCeUlkKHRoaXMuamltdU1hcFZpZXdJZCk7XG4gICAgICAgICAgbGF5ZXJEYXRhU291cmNlLnF1ZXJ5QnlJZCh0ZW1wSWQpLnRoZW4oKHJlY29yZCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RGZWF0dXJlQnlJZCh0ZW1wSWQsIHJlY29yZCk7XG4gICAgICAgICAgICB0aGlzLmlzUmVzZXJ2ZVBvcHVwID0gdHJ1ZTtcbiAgICAgICAgICAgIE1lc3NhZ2VNYW5hZ2VyLmdldEluc3RhbmNlKCkucHVibGlzaE1lc3NhZ2UobmV3IERhdGFSZWNvcmRzU2VsZWN0aW9uQ2hhbmdlTWVzc2FnZShqaW11TWFwVmlldy5tYXBXaWRnZXRJZCwgW3JlY29yZF0pKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmlzUmVzZXJ2ZVBvcHVwID0gZmFsc2U7XG4gICAgICAgICAgdGhpcy5zZWxlY3RGZWF0dXJlQnlJZChudWxsKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG5cbiAgICB0aGlzLmdldFZpZXdGb3JNYXAoKS5wb3B1cC53YXRjaCgndmlzaWJsZScsIHZpc2libGUgPT4ge1xuICAgICAgY29uc3QgdmlldyA9IHRoaXMuZ2V0Vmlld0Zvck1hcCgpO1xuICAgICAgaWYgKCF2aXNpYmxlICYmIHZpZXcucG9wdXAuc2VsZWN0ZWRGZWF0dXJlICYmIHZpZXcucG9wdXAuc2VsZWN0ZWRGZWF0dXJlLmxheWVyID09PSB0aGlzLmxheWVyKSB7XG4gICAgICAgIGNvbnN0IGppbXVNYXBWaWV3ID0gTWFwVmlld01hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXRKaW11TWFwVmlld0J5SWQodGhpcy5qaW11TWFwVmlld0lkKTtcbiAgICAgICAgTWVzc2FnZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5wdWJsaXNoTWVzc2FnZShuZXcgRGF0YVJlY29yZHNTZWxlY3Rpb25DaGFuZ2VNZXNzYWdlKGppbXVNYXBWaWV3Lm1hcFdpZGdldElkLCBbXSkpO1xuXG4gICAgICAgIHRoaXMuaXNSZXNlcnZlUG9wdXAgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5zZWxlY3RGZWF0dXJlQnlJZChudWxsKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmKHRoaXMuZ2V0U2VsZWN0ZWRSZWNvcmRJZHMoKS5sZW5ndGggPiAwKXtcbiAgICAgIHRoaXMubW92ZUZlYXR1cmVUb0NlbnRlcih0aGlzLmdldFNlbGVjdGVkUmVjb3JkSWRzKClbMF0pLnRoZW4oKCkgPT4ge1xuICAgICAgICB0aGlzLmhpZ2hMaWdodFNlbGVjdGVkRmVhdHVyZXMoKTtcbiAgICAgIH0pO1xuICAgIH1lbHNlIGlmKHRoaXMuZ2V0TGF5ZXJEYXRhU291cmNlKCkgJiYgdGhpcy5nZXRMYXllckRhdGFTb3VyY2UoKS5nZXRTZWxlY3RlZFJlY29yZElkcygpLmxlbmd0aCA+IDApe1xuICAgICAgdGhpcy5tb3ZlRmVhdHVyZVRvQ2VudGVyKHRoaXMuZ2V0TGF5ZXJEYXRhU291cmNlKCkuZ2V0U2VsZWN0ZWRSZWNvcmRJZHMoKVswXSkudGhlbigoKSA9PiB7XG4gICAgICAgIHRoaXMuaGlnaExpZ2h0RmVhdHVyZXModGhpcy5nZXRMYXllckRhdGFTb3VyY2UoKS5nZXRTZWxlY3RlZFJlY29yZElkcygpLm1hcChpZCA9PiBwYXJzZUludChpZCkpKTtcbiAgICAgIH0sIGVyciA9PiBjb25zb2xlLmVycm9yKGVycikpO1xuICAgIH1cblxuICAgIGNvbnN0IGlzSW5idWlsZGVyID0gd2luZG93ICYmIHdpbmRvdy5qaW11Q29uZmlnICYmIHdpbmRvdy5qaW11Q29uZmlnLmlzSW5CdWlsZGVyO1xuICAgIGlmIChpc0luYnVpbGRlcikge1xuICAgICAgdGhpcy5hcHBNb2RlT2JzZXJ2ZXIgPSBvYnNlcnZlU3RvcmUodGhpcy5vbkFwcE1vZGVJbmZvQ2hhbmdlLmJpbmQodGhpcyksIFsnYXBwUnVudGltZUluZm8nLCAnYXBwTW9kZSddKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQGlnbm9yZVxuICAgKiB0aGlzIHF1ZXJpZXMgZnJvbSBjbGllbnRcbiAgICogQHBhcmFtIHF1ZXJ5XG4gICAqL1xuICBkb1F1ZXJ5KHF1ZXJ5KTogUHJvbWlzZTxfX2VzcmkuR3JhcGhpY1tdPntcbiAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XG5cbiAgICAgIGlmKHRoaXMudmlldy51cGRhdGluZyl7XG4gICAgICAgIGlmKHRoaXMudXBkYXRlV2F0Y2hIYW5kbGUpe1xuICAgICAgICAgIHRoaXMudXBkYXRlV2F0Y2hIYW5kbGUucmVtb3ZlKCk7XG4gICAgICAgICAgdGhpcy51cGRhdGVXYXRjaEhhbmRsZSA9IG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLnVwZGF0ZVdhdGNoSGFuZGxlID0gdGhpcy52aWV3LndhdGNoKCd1cGRhdGluZycsIHZhbCA9PiB7XG4gICAgICAgICAgaWYoIXZhbCl7ICAvLyB3YWl0IGZvciB0aGUgbGF5ZXIgdmlldyB0byBmaW5pc2ggdXBkYXRpbmdcbiAgICAgICAgICAgIHRoaXMudmlldy5xdWVyeUZlYXR1cmVzKHF1ZXJ5KS50aGVuKGZlYXR1cmVTZXQgPT4ge1xuICAgICAgICAgICAgICB0aGlzLmZlYXR1cmVzID0gZmVhdHVyZVNldC5mZWF0dXJlcztcbiAgICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLmZlYXR1cmVzKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgdGhpcy52aWV3LnF1ZXJ5RmVhdHVyZXMocXVlcnkpLnRoZW4oZmVhdHVyZVNldCA9PiB7XG4gICAgICAgICAgdGhpcy5mZWF0dXJlcyA9IGZlYXR1cmVTZXQuZmVhdHVyZXM7XG4gICAgICAgICAgcmVzb2x2ZSh0aGlzLmZlYXR1cmVzKTtcbiAgICAgICAgfSwgZXJyID0+IHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgZG9RdWVyeUJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8X19lc3JpLkdyYXBoaWM+e1xuICAgIC8vd2UgY2FuJ3QgdXNlIHRoZSBsYXllci5jcmVhdGVRdWVyeSgpIGJlY2F1c2UgdGhlIGNyZWF0ZWQgcXVlcnkgd2lsbCBub3QgYmUgc3VwcG9ydGVkXG4gICAgLy9yZXR1cm4gZmFsc2UgZnJvbSBlc3JpLmxheWVycy5ncmFwaGljcy5RdWVyeUVuZ2luZS5faXNTdXBwb3J0ZWRRdWVyeSgpXG5cbiAgICAvLyBsZXQgcSA9IHRoaXMudmlldy5sYXllci5jcmVhdGVRdWVyeSgpO1xuXG4gICAgY29uc3QgcSA9IHtcbiAgICAgIG9iamVjdElkczogW3BhcnNlSW50KGlkKV0sXG4gICAgICByZXR1cm5HZW9tZXRyeTogdHJ1ZVxuICAgIH07XG4gICAgcmV0dXJuIHRoaXMuZG9RdWVyeShxKS50aGVuKGZlYXR1cmVzID0+IGZlYXR1cmVzWzBdKTtcbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIG1lcmdlUXVlcnkoYmFzZVF1ZXJ5OiBfX2VzcmkuUXVlcnkgfCBfX2VzcmkuUXVlcnlQcm9wZXJ0aWVzLCBuZXdRdWVyeTogX19lc3JpLlF1ZXJ5IHwgX19lc3JpLlF1ZXJ5UHJvcGVydGllcyk6IF9fZXNyaS5RdWVyeSB8IF9fZXNyaS5RdWVyeVByb3BlcnRpZXN7XG4gICAgY29uc3Qgd2hlcmUgPSBgKCR7YmFzZVF1ZXJ5LndoZXJlfSkgYW5kICgke25ld1F1ZXJ5LndoZXJlfSlgO1xuICAgIHJldHVybiB7Li4uYmFzZVF1ZXJ5LCAuLi5uZXdRdWVyeSwgLi4ue3doZXJlfX07XG4gIH1cblxuICBzZXRSZWZyZXNoSW50ZXJ2YWxGb3JMYXllcihyZWZyZXNoSW50ZXJ2YWw6IG51bWJlcikge1xuICAgIGlmICghdGhpcy52aWV3IHx8IHJlZnJlc2hJbnRlcnZhbCA9PT0gdW5kZWZpbmVkIHx8IHJlZnJlc2hJbnRlcnZhbCA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IGFwcE1vZGUgPSBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuYXBwUnVudGltZUluZm8uYXBwTW9kZTtcbiAgICBpZiAoYXBwTW9kZSA9PT0gQXBwTW9kZS5EZXNpZ24pIHtcbiAgICAgIHRoaXMubGF5ZXIucmVmcmVzaEludGVydmFsID0gMDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5sYXllci5yZWZyZXNoSW50ZXJ2YWwgPSByZWZyZXNoSW50ZXJ2YWwgLyA2MDtcbiAgICB9XG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBzZXREZWZpbml0aW9uRXhwcmVzc2lvbkZvckxheWVyKHF1ZXJ5OiBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcykge1xuICAgIGlmIChxdWVyeSkge1xuICAgICAgaWYgKHRoaXMudmlldyAmJiB0aGlzLnZpZXcubGF5ZXIpIHtcbiAgICAgICAgY29uc3QgbG9jYWxRdWVyeSA9IHtcbiAgICAgICAgICBvdXRGaWVsZHM6IFsnKiddLFxuICAgICAgICAgIHdoZXJlOiB0aGlzLmxvY2FsRGVmaW5pdGlvbkV4cHJlc3Npb24sXG4gICAgICAgICAgcmV0dXJuR2VvbWV0cnk6IHRydWVcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBtZXJnZWRRdWVyeSA9IHRoaXMuZ2V0TGF5ZXJEYXRhU291cmNlKCkuZ2V0UmVhbFF1ZXJ5UGFyYW1zKGxvY2FsUXVlcnksICdxdWVyeScpO1xuICAgICAgICBpZiAobWVyZ2VkUXVlcnkpIHtcbiAgICAgICAgICB0aGlzLnZpZXcubGF5ZXIuZGVmaW5pdGlvbkV4cHJlc3Npb24gPSBtZXJnZWRRdWVyeS53aGVyZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChxdWVyeS5nZW9tZXRyeSkge1xuICAgICAgICAgIGlmICh0aGlzLnZpZXcuZmlsdGVyKSB7XG4gICAgICAgICAgICBpZiAodGhpcy52aWV3LmZpbHRlci5nZW9tZXRyeSA9PT0gcXVlcnkuZ2VvbWV0cnkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGxvYWRBcmNHSVNKU0FQSU1vZHVsZXMoW1xuICAgICAgICAgICAgJ2VzcmkvZ2VvbWV0cnkvc3VwcG9ydC9qc29uVXRpbHMnXG4gICAgICAgICAgXSkudGhlbihtb2R1bGVzID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGpzb25VdGlsczogX19lc3JpLmpzb25VdGlscyA9IG1vZHVsZXNbMF07XG4gICAgICAgICAgICB0aGlzLnZpZXcuZmlsdGVyID0ge1xuICAgICAgICAgICAgICBnZW9tZXRyeToganNvblV0aWxzLmZyb21KU09OKHF1ZXJ5Lmdlb21ldHJ5KVxuICAgICAgICAgICAgfSBhcyBhbnk7XG4gICAgICAgICAgfSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAodGhpcy52aWV3LmZpbHRlcikge1xuICAgICAgICAgICAgdGhpcy52aWV3LmZpbHRlciA9IG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXRoaXMudmlldyAmJiB0aGlzLmxheWVyKSB7XG4gICAgICAgIGNvbnN0IGxvY2FsUXVlcnkgPSB7XG4gICAgICAgICAgb3V0RmllbGRzOiBbJyonXSxcbiAgICAgICAgICB3aGVyZTogdGhpcy5sb2NhbERlZmluaXRpb25FeHByZXNzaW9uLFxuICAgICAgICAgIHJldHVybkdlb21ldHJ5OiB0cnVlXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgbWVyZ2VkUXVlcnkgPSB0aGlzLmdldExheWVyRGF0YVNvdXJjZSgpLmdldFJlYWxRdWVyeVBhcmFtcyhsb2NhbFF1ZXJ5LCAncXVlcnknKTtcbiAgICAgICAgaWYgKG1lcmdlZFF1ZXJ5KSB7XG4gICAgICAgICAgdGhpcy5sYXllci5kZWZpbml0aW9uRXhwcmVzc2lvbiA9IG1lcmdlZFF1ZXJ5LndoZXJlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBzZXRMb2NhbERlZmluaXRpb25FeHByZXNzaW9uKGxvY2FsRGVmaW5pdGlvbkV4cHJlc3Npb246IHN0cmluZykge1xuICAgIHRoaXMubG9jYWxEZWZpbml0aW9uRXhwcmVzc2lvbiA9IGxvY2FsRGVmaW5pdGlvbkV4cHJlc3Npb247XG5cbiAgICBpZih0aGlzLmdldExheWVyRGF0YVNvdXJjZSgpLmdldEN1cnJlbnRRdWVyeVBhcmFtcygpKXtcbiAgICAgIHRoaXMuc2V0RGVmaW5pdGlvbkV4cHJlc3Npb25Gb3JMYXllcih0aGlzLmdldExheWVyRGF0YVNvdXJjZSgpLmdldEN1cnJlbnRRdWVyeVBhcmFtcygpKTtcbiAgICB9XG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBoaWdoTGlnaHRTZWxlY3RlZEZlYXR1cmVzKCl7XG4gICAgLy9UT0RPIGhhbmRsZSBtdWx0aXBsZSBmZWF0dXJlc1xuICAgIGlmICh0aGlzLnZpZXcpIHtcbiAgICAgIHRoaXMuaGlnaExpZ2h0RmVhdHVyZXModGhpcy5nZXRTZWxlY3RlZFJlY29yZElkcygpLm1hcChpZCA9PiBwYXJzZUludChpZCkpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5oaWdoTGlnaHRTZWxlY3RlZEZlYXR1cmVzV2l0aFZpcnR1YWxMYXllcigpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIGhpZ2hMaWdodFNlbGVjdGVkRmVhdHVyZXNXaXRoVmlydHVhbExheWVyKCkge1xuICAgIGNvbnN0IGppbXVNYXBWaWV3ID0gTWFwVmlld01hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXRKaW11TWFwVmlld0J5SWQodGhpcy5qaW11TWFwVmlld0lkKTtcbiAgICBjb25zdCBwYXJlbnRKaW11TGF5ZXJWaWV3cyA9IGppbXVNYXBWaWV3LmdldFBhcmVudExheWVyVmlld3ModGhpcy5pZCk7XG4gICAgbGV0IGlzUGFyZW50TGF5ZXJWaXNpYmxlU2hvdyA9IHRydWU7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYXJlbnRKaW11TGF5ZXJWaWV3cy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKCFwYXJlbnRKaW11TGF5ZXJWaWV3c1tpXS5sYXllci52aXNpYmxlKSB7XG4gICAgICAgIGlzUGFyZW50TGF5ZXJWaXNpYmxlU2hvdyA9IGZhbHNlO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIWlzUGFyZW50TGF5ZXJWaXNpYmxlU2hvdyB8fCAhdGhpcy5sYXllci52aXNpYmxlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKHRoaXMudmlydHVhbExheWVyKSB7XG4gICAgICBqaW11TWFwVmlldy52aWV3Lm1hcC5yZW1vdmUodGhpcy52aXJ0dWFsTGF5ZXIpO1xuICAgICAgdGhpcy52aXJ0dWFsTGF5ZXIgPSBudWxsO1xuICAgICAgdGhpcy5jbGVhckhpZ2hMaWdodCgpO1xuICAgIH1cblxuICAgIGNvbnN0IGxheWVyRHMgPSB0aGlzLmdldExheWVyRGF0YVNvdXJjZSgpO1xuICAgIGNvbnN0IHNlbGV0ZWRSZWNvcmRzID0gbGF5ZXJEcy5nZXRTZWxlY3RlZFJlY29yZHMoKTtcbiAgICBpZiAoc2VsZXRlZFJlY29yZHMgJiYgc2VsZXRlZFJlY29yZHMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3QgbGF5ZXJGcm9tRmVhdHVyZVNldCA9IGxheWVyRHMubGF5ZXI7XG4gICAgICBjb25zdCBvYmplY3RJZEZpZWxkSW5GZWF0dXJlbGF5ZXIgPSB0aGlzLmdldE9iamVjdElkRmllbGQobGF5ZXJGcm9tRmVhdHVyZVNldC5maWVsZHMsIGxheWVyRnJvbUZlYXR1cmVTZXQub2JqZWN0SWRGaWVsZCk7XG5cbiAgICAgIGNvbnN0IHNvdXJjZUZlYXR1cmVzID0gW107XG4gICAgICBmb3IobGV0IGkgPSAwOyBpIDwgc2VsZXRlZFJlY29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgdGVtcEZlYXR1cmUgPSAoc2VsZXRlZFJlY29yZHNbaV0gYXMgYW55KS5mZWF0dXJlLmNsb25lKCk7XG4gICAgICAgIGNvbnN0IG9iamVjdElkRmllbGRWYWx1ZSA9IHRlbXBGZWF0dXJlLmF0dHJpYnV0ZXNbbGF5ZXJGcm9tRmVhdHVyZVNldC5vYmplY3RJZEZpZWxkXTtcblxuICAgICAgICB0ZW1wRmVhdHVyZS5hdHRyaWJ1dGVzID0ge307XG4gICAgICAgIHRlbXBGZWF0dXJlLmF0dHJpYnV0ZXNbbGF5ZXJGcm9tRmVhdHVyZVNldC5vYmplY3RJZEZpZWxkXSA9IG9iamVjdElkRmllbGRWYWx1ZTtcbiAgICAgICAgc291cmNlRmVhdHVyZXMucHVzaCh0ZW1wRmVhdHVyZSk7XG4gICAgICB9XG5cbiAgICAgIGxvYWRBcmNHSVNKU0FQSU1vZHVsZXMoW1xuICAgICAgICAnZXNyaS9sYXllcnMvRmVhdHVyZUxheWVyJ1xuICAgICAgXSkudGhlbihtb2R1bGVzID0+IHtcbiAgICAgICAgY29uc3QgRmVhdHVyZUxheWVyOiB0eXBlb2YgX19lc3JpLkZlYXR1cmVMYXllciA9IG1vZHVsZXNbMF07XG5cbiAgICAgICAgdGhpcy52aXJ0dWFsTGF5ZXIgPSBuZXcgRmVhdHVyZUxheWVyKHtcbiAgICAgICAgICB0aXRsZTogbGF5ZXJGcm9tRmVhdHVyZVNldC50aXRsZSxcbiAgICAgICAgICBzb3VyY2U6IHNvdXJjZUZlYXR1cmVzLFxuICAgICAgICAgIGZpZWxkczogb2JqZWN0SWRGaWVsZEluRmVhdHVyZWxheWVyID8gW29iamVjdElkRmllbGRJbkZlYXR1cmVsYXllcl0gOiBbXSxcbiAgICAgICAgICBvYmplY3RJZEZpZWxkOiBsYXllckZyb21GZWF0dXJlU2V0Lm9iamVjdElkRmllbGQsXG4gICAgICAgICAgcmVuZGVyZXI6IHRoaXMuZ2V0UmVuZGVyZXJGb3JWaXJ0dWFsTGF5ZXIoc291cmNlRmVhdHVyZXNbMF0uZ2VvbWV0cnkudHlwZSkgYXMgYW55LFxuICAgICAgICAgIGxpc3RNb2RlOiAnaGlkZScsXG4gICAgICAgICAgbGVnZW5kRW5hYmxlZDogZmFsc2VcbiAgICAgICAgfSk7XG5cbiAgICAgICAgamltdU1hcFZpZXcudmlldy5tYXAuYWRkKHRoaXMudmlydHVhbExheWVyLCB0aGlzLmxheWVySW5kZXgpO1xuICAgICAgICB0aGlzLnZpcnR1YWxMYXllci5vbignbGF5ZXJ2aWV3LWNyZWF0ZScsIGV2ZW50ID0+IHtcbiAgICAgICAgICBjb25zdCBmZWF0dXJlTGF5ZXJWaWV3OiBfX2VzcmkuRmVhdHVyZUxheWVyVmlldyA9IGV2ZW50LmxheWVyVmlldyBhcyBfX2VzcmkuRmVhdHVyZUxheWVyVmlldztcbiAgICAgICAgICB0aGlzLmhpZ2hMaWdodEhhbmRsZSA9IGZlYXR1cmVMYXllclZpZXcuaGlnaGxpZ2h0KHNvdXJjZUZlYXR1cmVzKTtcbiAgICAgICAgfSk7XG4gICAgICB9KVxuICAgIH1cbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIGhpZ2hMaWdodEZlYXR1cmVzKGZlYXR1cmVzOiBfX2VzcmkuR3JhcGhpY1tdIHwgbnVtYmVyW10pe1xuICAgIGlmKHRoaXMuaGlnaExpZ2h0SGFuZGxlKXtcbiAgICAgIHRoaXMuaGlnaExpZ2h0SGFuZGxlLnJlbW92ZSgpO1xuICAgICAgdGhpcy5oaWdoTGlnaHRIYW5kbGUgPSBudWxsO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnZpZXcpIHtcbiAgICAgIHRoaXMudmlldy53aGVuKCgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuaGlnaExpZ2h0SGFuZGxlKSB7XG4gICAgICAgICAgdGhpcy5oaWdoTGlnaHRIYW5kbGUucmVtb3ZlKCk7XG4gICAgICAgICAgdGhpcy5oaWdoTGlnaHRIYW5kbGUgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaGlnaExpZ2h0SGFuZGxlID0gdGhpcy52aWV3LmhpZ2hsaWdodChmZWF0dXJlcyk7XG4gICAgICB9KVxuICAgIH1cbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIGNsZWFySGlnaExpZ2h0KCkge1xuICAgIGlmICh0aGlzLmhpZ2hMaWdodEhhbmRsZSkge1xuICAgICAgdGhpcy5oaWdoTGlnaHRIYW5kbGUucmVtb3ZlKCk7XG4gICAgICB0aGlzLmhpZ2hMaWdodEhhbmRsZSA9IG51bGw7XG4gICAgICBpZiAodGhpcy5pc1Jlc2VydmVQb3B1cCkge1xuICAgICAgICB0aGlzLmdldFZpZXdGb3JNYXAoKS5wb3B1cC5jbG9zZSgpO1xuICAgICAgICB0aGlzLmlzUmVzZXJ2ZVBvcHVwID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMudmlydHVhbExheWVyKSB7XG4gICAgICBjb25zdCBqaW11TWFwVmlldyA9IE1hcFZpZXdNYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0SmltdU1hcFZpZXdCeUlkKHRoaXMuamltdU1hcFZpZXdJZCk7XG4gICAgICBqaW11TWFwVmlldy52aWV3Lm1hcC5yZW1vdmUodGhpcy52aXJ0dWFsTGF5ZXIpO1xuICAgICAgdGhpcy52aXJ0dWFsTGF5ZXIgPSBudWxsO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIHNlbGVjdEZlYXR1cmVCeUlkKGlkOiBzdHJpbmcsIHJlY29yZD86IEZlYXR1cmVEYXRhUmVjb3JkKSB7XG4gICAgdGhpcy5nZXRMYXllckRhdGFTb3VyY2UoKS5zZWxlY3RSZWNvcmRCeUlkKGlkLCByZWNvcmQpO1xuXG4gICAgaWYgKGlkID09PSBudWxsIHx8IGlkID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuY2xlYXJIaWdoTGlnaHQoKTtcbiAgICB9ZWxzZXtcbiAgICAgIHRoaXMuaGlnaExpZ2h0U2VsZWN0ZWRGZWF0dXJlcygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIHNlbGVjdEZlYXR1cmVzQnlJZHMoaWRzOiBzdHJpbmdbXSwgcmVjb3Jkcz86IEZlYXR1cmVEYXRhUmVjb3JkW10pe1xuICAgIHRoaXMuZ2V0TGF5ZXJEYXRhU291cmNlKCkuc2VsZWN0UmVjb3Jkc0J5SWRzKGlkcywgcmVjb3Jkcyk7XG5cbiAgICBpZiAoIShpZHMgJiYgaWRzLmxlbmd0aCA+IDApKSB7XG4gICAgICB0aGlzLmNsZWFySGlnaExpZ2h0KCk7XG4gICAgfWVsc2V7XG4gICAgICB0aGlzLmhpZ2hMaWdodFNlbGVjdGVkRmVhdHVyZXMoKTtcbiAgICB9XG4gICAgLy9UT0RPIGV4dGVudHMgZm9yIGFsbCBmZWF0dXJlc1xuICAgIC8vIHRoaXMubW92ZUZlYXR1cmVUb0NlbnRlcihpZHNbMF0pO1xuICB9XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgb25BcHBNb2RlSW5mb0NoYW5nZShwcmVEc0luZm86IElNRGF0YVNvdXJjZUluZm8sIGRzSW5mbzogSU1EYXRhU291cmNlSW5mbyl7XG4gICAgdGhpcy5zZXRSZWZyZXNoSW50ZXJ2YWxGb3JMYXllcih0aGlzLmdldExheWVyRGF0YVNvdXJjZSgpPy5nZXRBdXRvUmVmcmVzaEludGVydmFsKCkpO1xuICB9XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgb25MYXllckRhdGFTb3VyY2VJbmZvQ2hhbmdlKHByZURzSW5mbzogSU1EYXRhU291cmNlSW5mbywgZHNJbmZvOiBJTURhdGFTb3VyY2VJbmZvKXtcbiAgICBpZihkc0luZm8uc2VsZWN0ZWRJZHM/Lmxlbmd0aCA+IDAgfHwgZHNJbmZvLnNlbGVjdGVkSW5kZXhlcz8ubGVuZ3RoID4gMCl7XG4gICAgICBpZiAodGhpcy5zZWxlY3RlZElkcyAhPT0gZHNJbmZvLnNlbGVjdGVkSWRzLmpvaW4oJywnKSkge1xuICAgICAgICB0aGlzLnNlbGVjdGVkSWRzID0gZHNJbmZvLnNlbGVjdGVkSWRzLmpvaW4oJywnKTtcbiAgICAgICAgdGhpcy5oaWdoTGlnaHRTZWxlY3RlZEZlYXR1cmVzKCk7XG4gICAgICB9XG4gICAgfWVsc2V7XG4gICAgICB0aGlzLnNlbGVjdGVkSWRzID0gJyc7XG4gICAgICB0aGlzLmNsZWFySGlnaExpZ2h0KCk7XG4gICAgfVxuXG4gICAgaWYodGhpcy5nZXRMYXllckRhdGFTb3VyY2UoKS5nZXRDdXJyZW50UXVlcnlQYXJhbXMoKSl7XG4gICAgICB0aGlzLnNldERlZmluaXRpb25FeHByZXNzaW9uRm9yTGF5ZXIodGhpcy5nZXRMYXllckRhdGFTb3VyY2UoKS5nZXRDdXJyZW50UXVlcnlQYXJhbXMoKSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMudmlldykge1xuICAgICAgaWYgKGRzSW5mby5nZGJWZXJzaW9uKSB7XG4gICAgICAgIHRoaXMubGF5ZXIuZ2RiVmVyc2lvbiA9IGRzSW5mby5nZGJWZXJzaW9uO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWRzSW5mby5nZGJWZXJzaW9uKSB7XG4gICAgICAgIHRoaXMubGF5ZXIuZ2RiVmVyc2lvbiA9IHRoaXMub3JpZ2luYWxHZGJWZXJzaW9uO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuc2V0UmVmcmVzaEludGVydmFsRm9yTGF5ZXIodGhpcy5nZXRMYXllckRhdGFTb3VyY2UoKT8uZ2V0QXV0b1JlZnJlc2hJbnRlcnZhbCgpKTtcbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIGdldFZpZXdGb3JNYXAoKTogX19lc3JpLk1hcFZpZXcgfCBfX2VzcmkuU2NlbmVWaWV3e1xuICAgIGNvbnN0IGppbXVNYXBWaWV3ID0gTWFwVmlld01hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXRKaW11TWFwVmlld0J5SWQodGhpcy5qaW11TWFwVmlld0lkKTtcbiAgICByZXR1cm4gamltdU1hcFZpZXcgJiYgamltdU1hcFZpZXcudmlldztcbiAgfVxuXG4gIC8vIHRoZSBmdW5jdGlvbiBpcyB1c2VkIGZvciBoYW5kbGluZyBmZWF0dXJlTmF2aWdhdGUgYXQgcG9wdXBcbiAgLyoqIEBpZ25vcmUgKi9cbiAgaGFuZGxlRmVhdHVyZU5hdmlnYXRpb25BdFBvcFVwKGlkOiBzdHJpbmcpIHtcbiAgICBjb25zdCBsYXllckRzID0gdGhpcy5nZXRMYXllckRhdGFTb3VyY2UoKTtcbiAgICB0aGlzLmlzUmVzZXJ2ZVBvcHVwID0gdHJ1ZTtcbiAgICBsYXllckRzLnNlbGVjdFJlY29yZEJ5SWQoaWQpO1xuICB9XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgbW92ZUZlYXR1cmVUb0NlbnRlcihpZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPntcbiAgICByZXR1cm4gdGhpcy5kb1F1ZXJ5QnlJZChpZCkudGhlbihmZWF0dXJlID0+IHtcbiAgICAgIGlmKGZlYXR1cmUpe1xuICAgICAgICByZXR1cm4gZmVhdHVyZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmKHRoaXMuZ2V0TGF5ZXJEYXRhU291cmNlKCkpe1xuICAgICAgICAgIHJldHVybiAodGhpcy5nZXRMYXllckRhdGFTb3VyY2UoKSBhcyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlKS5xdWVyeUJ5SWQoaWQpLnRoZW4ocmVjb3JkID0+IHtcbiAgICAgICAgICAgIHJldHVybiByZWNvcmQgJiYgcmVjb3JkLmZlYXR1cmUgYXMgX19lc3JpLkdyYXBoaWM7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KS50aGVuKGZlYXR1cmUgPT4ge1xuICAgICAgaWYoZmVhdHVyZSl7XG4gICAgICAgIGNvbnN0IGNlbnRlclBvaW50ID0gdGhpcy5nZXRDZW50ZXJQb2ludChmZWF0dXJlLmdlb21ldHJ5KVxuICAgICAgICBpZiAoY2VudGVyUG9pbnQpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5nZXRWaWV3Rm9yTWFwKCkuZ29UbyhjZW50ZXJQb2ludCk7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgnRG9lcyBub3QgZmluZCBjZW50ZXIgcG9pbnQuJyk7XG4gICAgICAgIH1cbiAgICAgIH1lbHNle1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ0Rvc2Ugbm90IGZpbmQgZmVhdHVyZS4nICsgaWQpO1xuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBnZXRDZW50ZXJQb2ludChnZW9tZXRyeTogX19lc3JpLkdlb21ldHJ5KTogX19lc3JpLlBvaW50e1xuICAgIC8vcG9pbnQgfCBtdWx0aXBvaW50IHwgcG9seWxpbmUgfCBwb2x5Z29uIHwgZXh0ZW50IHwgbWVzaFxuICAgIHN3aXRjaChnZW9tZXRyeS50eXBlKXtcbiAgICAgIGNhc2UgJ3BvaW50JzpcbiAgICAgICAgcmV0dXJuIGdlb21ldHJ5IGFzICBfX2VzcmkuUG9pbnQ7XG4gICAgICBjYXNlICdleHRlbnQnOlxuICAgICAgICByZXR1cm4gKGdlb21ldHJ5IGFzIF9fZXNyaS5FeHRlbnQpLmNlbnRlcjtcbiAgICAgIGNhc2UgJ3BvbHlnb24nOlxuICAgICAgICByZXR1cm4gKGdlb21ldHJ5IGFzIF9fZXNyaS5Qb2x5Z29uKS5jZW50cm9pZDtcbiAgICAgIGNhc2UgJ3BvbHlsaW5lJzpcbiAgICAgICAgcmV0dXJuIChnZW9tZXRyeSBhcyBfX2VzcmkuUG9seWxpbmUpLmV4dGVudC5jZW50ZXI7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gZ2VvbWV0cnkgJiYgZ2VvbWV0cnkuZXh0ZW50ID8gZ2VvbWV0cnkuZXh0ZW50LmNlbnRlciA6IHVuZGVmaW5lZDtcbiAgICAgICAgLy90b2RvXG4gICAgfVxuICB9XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgZ2V0U2VsZWN0ZWRSZWNvcmRJZHMoKTogc3RyaW5nW10ge1xuICAgIGlmICghZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmRhdGFTb3VyY2VzSW5mb1t0aGlzLmxheWVyRGF0YVNvdXJjZUlkXSkge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBpZiAoZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmRhdGFTb3VyY2VzSW5mb1t0aGlzLmxheWVyRGF0YVNvdXJjZUlkXS5zZWxlY3RlZElkcykge1xuICAgICAgcmV0dXJuIGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5kYXRhU291cmNlc0luZm9bdGhpcy5sYXllckRhdGFTb3VyY2VJZF0uc2VsZWN0ZWRJZHMuYXNNdXRhYmxlKCk7XG4gICAgfSBlbHNlIGlmIChnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuZGF0YVNvdXJjZXNJbmZvW3RoaXMubGF5ZXJEYXRhU291cmNlSWRdLnNlbGVjdGVkSW5kZXhlcykge1xuICAgICAgcmV0dXJuIGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5kYXRhU291cmNlc0luZm9bdGhpcy5sYXllckRhdGFTb3VyY2VJZF0uc2VsZWN0ZWRJbmRleGVzLmFzTXV0YWJsZSgpLm1hcChpbmRleCA9PiB0aGlzLmZlYXR1cmVzW2luZGV4XS5hdHRyaWJ1dGVzW3RoaXMuZ2V0SWRGaWVsZCgpXSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBnZXRJZEZpZWxkKCl7XG4gICAgLy8gcmV0dXJuIHRoaXMuZ2V0TGF5ZXJEYXRhU291cmNlKCkgJiYgdGhpcy5nZXRMYXllckRhdGFTb3VyY2UoKS5nZXRJZEZpZWxkKCk7XG5cbiAgICBsZXQgb2JqZWN0SWRGaWVsZCA9IHRoaXMudmlldy5sYXllci5vYmplY3RJZEZpZWxkO1xuXG4gICAgaWYoIW9iamVjdElkRmllbGQpe1xuICAgICAgY29uc3QgZiA9IHRoaXMudmlldy5sYXllci5maWVsZHMuZmluZChmID0+IGYudHlwZSA9PT0gJ29pZCcpO1xuICAgICAgaWYoZil7XG4gICAgICAgIG9iamVjdElkRmllbGQgPSBmLm5hbWU7XG4gICAgICB9XG4gICAgfVxuICAgIGlmKCFvYmplY3RJZEZpZWxkKXtcbiAgICAgIG9iamVjdElkRmllbGQgPSAnT0JKRUNUSUQnO1xuICAgIH1cblxuICAgIHJldHVybiBvYmplY3RJZEZpZWxkO1xuICB9XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgZ2V0TGF5ZXJEYXRhU291cmNlKCk6IEZlYXR1cmVMYXllckRhdGFTb3VyY2V7XG4gICAgcmV0dXJuIERhdGFTb3VyY2VNYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0RGF0YVNvdXJjZSh0aGlzLmxheWVyRGF0YVNvdXJjZUlkKSBhcyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlO1xuICB9XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgc2VsZWN0UmVjb3Jkc0J5UXVlcnkocXVlcnk6IEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zKTogUHJvbWlzZTxfX2VzcmkuR3JhcGhpY1tdPiB7XG4gICAgcmV0dXJuIGxvYWRBcmNHSVNKU0FQSU1vZHVsZXMoW1xuICAgICAgJ2VzcmkvbGF5ZXJzL0ZlYXR1cmVMYXllcidcbiAgICBdKS50aGVuKG1vZHVsZXMgPT4ge1xuICAgICAgY29uc3QgamltdU1hcFZpZXcgPSBNYXBWaWV3TWFuYWdlci5nZXRJbnN0YW5jZSgpLmdldEppbXVNYXBWaWV3QnlJZCh0aGlzLmppbXVNYXBWaWV3SWQpO1xuXG4gICAgICBjb25zdCBwYXJlbnRKaW11TGF5ZXJWaWV3cyA9IGppbXVNYXBWaWV3LmdldFBhcmVudExheWVyVmlld3ModGhpcy5pZCk7XG4gICAgICBsZXQgaXNQYXJlbnRMYXllclZpc2libGVTaG93ID0gdHJ1ZTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcGFyZW50SmltdUxheWVyVmlld3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKCFwYXJlbnRKaW11TGF5ZXJWaWV3c1tpXS5sYXllci52aXNpYmxlKSB7XG4gICAgICAgICAgaXNQYXJlbnRMYXllclZpc2libGVTaG93ID0gZmFsc2U7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKCFpc1BhcmVudExheWVyVmlzaWJsZVNob3cgfHwgIXRoaXMubGF5ZXIudmlzaWJsZSkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFtdKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMudmlydHVhbExheWVyKSB7XG4gICAgICAgIGppbXVNYXBWaWV3LnZpZXcubWFwLnJlbW92ZSh0aGlzLnZpcnR1YWxMYXllcik7XG4gICAgICAgIHRoaXMudmlydHVhbExheWVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5jbGVhckhpZ2hMaWdodCgpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBsYXllckRzID0gdGhpcy5nZXRMYXllckRhdGFTb3VyY2UoKTtcbiAgICAgIHF1ZXJ5Lmdlb21ldHJ5ID0gKHF1ZXJ5Lmdlb21ldHJ5IGFzIGFueSkudG9KU09OID8gKHF1ZXJ5Lmdlb21ldHJ5IGFzIGFueSkudG9KU09OKCkgOiBxdWVyeS5nZW9tZXRyeTtcbiAgICAgIGNvbnN0IGxheWVyVmlld0RzID0gbGF5ZXJEcy5kYXRhU291cmNlTWFuYWdlci5jcmVhdGVMb2NhbERhdGFTb3VyY2UobGF5ZXJEcywgJ3ZpZXcnKSBhcyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlO1xuICAgICAgaWYgKGxheWVyVmlld0RzICYmIGxheWVyVmlld0RzLmxheWVyKSB7XG4gICAgICAgIHJldHVybiBsYXllclZpZXdEcy5sb2FkKHF1ZXJ5LCB7d2lkZ2V0SWQ6ICd2aWV3J30pLnRoZW4ocmVzdWx0ID0+IHtcbiAgICAgICAgICBpZiAocmVzdWx0ICYmIHJlc3VsdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZElkcyA9IFtdO1xuICAgICAgICAgICAgY29uc3Qgc291cmNlRmVhdHVyZXMgPSBbXTtcbiAgICAgICAgICAgIGNvbnN0IG1lc3NhZ2VSZWNvcmRzID0gW107XG4gICAgICAgICAgICBmb3IobGV0IGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgIHNlbGVjdGVkSWRzLnB1c2goKHJlc3VsdFtpXSBhcyBGZWF0dXJlRGF0YVJlY29yZCkuZ2V0SWQoKSk7XG4gICAgICAgICAgICAgIHNvdXJjZUZlYXR1cmVzLnB1c2goKHJlc3VsdFtpXSBhcyBGZWF0dXJlRGF0YVJlY29yZCkuZmVhdHVyZSk7XG4gICAgICAgICAgICAgIG1lc3NhZ2VSZWNvcmRzLnB1c2goKHJlc3VsdFtpXSBhcyBGZWF0dXJlRGF0YVJlY29yZCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgTWVzc2FnZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5wdWJsaXNoTWVzc2FnZShuZXcgRGF0YVJlY29yZHNTZWxlY3Rpb25DaGFuZ2VNZXNzYWdlKGppbXVNYXBWaWV3Lm1hcFdpZGdldElkLCBtZXNzYWdlUmVjb3JkcykpO1xuXG4gICAgICAgICAgICBsYXllclZpZXdEcy5zZWxlY3RSZWNvcmRzQnlJZHMoc2VsZWN0ZWRJZHMpO1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShzb3VyY2VGZWF0dXJlcyk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoW10pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoW10pO1xuICAgICAgfVxuICAgIH0sICgpID0+IHtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoW10pO1xuICAgIH0pLnRoZW4oKGZlYXR1cmVzKSA9PiB7XG4gICAgICBpZiAoIWZlYXR1cmVzIHx8IChmZWF0dXJlcyAmJiBmZWF0dXJlcy5sZW5ndGggPT09IDApKSB7XG4gICAgICAgIGNvbnN0IGxheWVyRHMgPSB0aGlzLmdldExheWVyRGF0YVNvdXJjZSgpO1xuICAgICAgICBsYXllckRzLnNlbGVjdFJlY29yZHNCeUlkcyhbXSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoZmVhdHVyZXMpO1xuICAgIH0pXG4gIH1cblxuICAvKiogQGlnbm9yZSAqL1xuICBnZXRPYmplY3RJZEZpZWxkKGZpZWxkczogX19lc3JpLkZpZWxkW10sIG9iamVjdElkRmllbGROYW1lOiBzdHJpbmcpOiBfX2VzcmkuRmllbGQge1xuICAgIGxldCBvYmplY3RJZEZpZWxkID0gbnVsbDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZpZWxkcy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKGZpZWxkc1tpXS5uYW1lID09PSBvYmplY3RJZEZpZWxkTmFtZSkge1xuICAgICAgICBvYmplY3RJZEZpZWxkID0gZmllbGRzW2ldO1xuICAgICAgICByZXR1cm4gb2JqZWN0SWRGaWVsZDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gb2JqZWN0SWRGaWVsZDtcbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIGdldFJlbmRlcmVyRm9yVmlydHVhbExheWVyIChnZW9tZXRyeVR5cGU6IHN0cmluZykge1xuICAgIGlmIChbJ3BvaW50JywgJ211bHRpcG9pbnQnXS5pbmRleE9mKGdlb21ldHJ5VHlwZSkgPiAtMSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogJ3NpbXBsZScsXG4gICAgICAgIHN5bWJvbDoge1xuICAgICAgICAgIHR5cGU6ICdzaW1wbGUtbWFya2VyJyxcbiAgICAgICAgICBzdHlsZTogJ2NpcmNsZScsXG4gICAgICAgICAgY29sb3I6IFswLCAyNTUsIDI1NSwgMV0sXG4gICAgICAgICAgc2l6ZTogJzE2cHgnLFxuICAgICAgICAgIG91dGxpbmU6IHtcbiAgICAgICAgICAgIGNvbG9yOiBbMCwgMjU1LCAyNTUsIDFdLFxuICAgICAgICAgICAgd2lkdGg6IDFcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKFsncG9seWxpbmUnXS5pbmRleE9mKGdlb21ldHJ5VHlwZSkgPiAtMSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdHlwZTogJ3NpbXBsZScsXG4gICAgICAgIHN5bWJvbDoge1xuICAgICAgICAgIHR5cGU6ICdzaW1wbGUtbGluZScsXG4gICAgICAgICAgY29sb3I6IFswLCAyNTUsIDI1NSwgMV0sXG4gICAgICAgICAgd2lkdGg6IDEsXG4gICAgICAgICAgc3R5bGU6ICdzb2xpZCdcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoWydwb2x5Z29uJywgJ2V4dGVudCddLmluZGV4T2YoZ2VvbWV0cnlUeXBlKSA+IC0xKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnc2ltcGxlJyxcbiAgICAgICAgc3ltYm9sOiB7XG4gICAgICAgICAgdHlwZTogJ3NpbXBsZS1maWxsJywgIC8vIGF1dG9jYXN0cyBhcyBuZXcgU2ltcGxlRmlsbFN5bWJvbCgpXG4gICAgICAgICAgY29sb3I6IFswLCAyNTUsIDI1NSwgMF0sXG4gICAgICAgICAgc3R5bGU6ICdzb2xpZCcsXG4gICAgICAgICAgb3V0bGluZTogeyAgLy8gYXV0b2Nhc3RzIGFzIG5ldyBTaW1wbGVMaW5lU3ltYm9sKClcbiAgICAgICAgICAgIGNvbG9yOiBbMCwgMjU1LCAyNTUsIDFdLFxuICAgICAgICAgICAgd2lkdGg6IDFcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKFsnbWVzaCddLmluZGV4T2YoZ2VvbWV0cnlUeXBlKSA+IC0xKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB0eXBlOiAnc2ltcGxlJyxcbiAgICAgICAgc3ltYm9sOiB7XG4gICAgICAgICAgdHlwZTogJ21lc2gtM2QnLCAgLy8gYXV0b2Nhc3RzIGFzIG5ldyBNZXNoU3ltYm9sM0QoKVxuICAgICAgICAgIHN5bWJvbExheWVyczogW3tcbiAgICAgICAgICAgIHR5cGU6ICdmaWxsJywgIC8vIGF1dG9jYXN0cyBhcyBuZXcgRmlsbFN5bWJvbDNETGF5ZXIoKVxuICAgICAgICAgICAgbWF0ZXJpYWw6IHsgY29sb3I6IFswLCAyNTUsIDI1NSwgMV0gfVxuICAgICAgICAgIH1dXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9XG59Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFPQTs7QUFFQTtBQUNBO0FBQUE7QUFzQ0E7QUFBQTtBQXhCQTtBQUNBO0FBRUE7QUFDQTtBQUVBOzs7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBUUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBRUE7Ozs7QUFJQTtBQUNBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7O0FBQ0E7QUFDQTtBQUVBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBOzsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./jimu-arcgis/lib/views/layers/jimu-feature-layer-view.ts\n");

/***/ }),

/***/ "./jimu-arcgis/lib/views/layers/jimu-group-layer-view.ts":
/*!***************************************************************!*\
  !*** ./jimu-arcgis/lib/views/layers/jimu-group-layer-view.ts ***!
  \***************************************************************/
/*! exports provided: JimuGroupLayerView */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"JimuGroupLayerView\", function() { return JimuGroupLayerView; });\n/* harmony import */ var _jimu_layer_view__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./jimu-layer-view */ \"./jimu-arcgis/lib/views/layers/jimu-layer-view.ts\");\n/* harmony import */ var _mapview_manager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../mapview-manager */ \"./jimu-arcgis/lib/mapview-manager.tsx\");\n/* harmony import */ var _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../data-sources/arcgis-data-source-interface */ \"./jimu-arcgis/lib/data-sources/arcgis-data-source-interface.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar JimuGroupLayerView = /** @class */ (function (_super) {\n    __extends(JimuGroupLayerView, _super);\n    function JimuGroupLayerView(options) {\n        var _this = _super.call(this, options) || this;\n        _this.url = null;\n        _this.url = options.url;\n        if (_this.layer) {\n            _this.layer.watch('visible', function (newValue) {\n                var childLayerViews = _mapview_manager__WEBPACK_IMPORTED_MODULE_1__[\"MapViewManager\"].getInstance().getJimuMapViewById(_this.jimuMapViewId).getChildLayerViews(_this.id);\n                if (childLayerViews && childLayerViews.length > 0) {\n                    for (var i = 0; i < childLayerViews.length; i++) {\n                        if (childLayerViews[i].virtualLayer) {\n                            childLayerViews[i].virtualLayer.visible = newValue && childLayerViews[i].layer.visible;\n                        }\n                        if (!childLayerViews[i].view && childLayerViews[i].type === _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"LayerTypes\"].FeatureLayer) {\n                            childLayerViews[i].highLightSelectedFeaturesWithVirtualLayer();\n                        }\n                    }\n                }\n            });\n        }\n        return _this;\n    }\n    return JimuGroupLayerView;\n}(_jimu_layer_view__WEBPACK_IMPORTED_MODULE_0__[\"JimuLayerView\"]));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9saWIvdmlld3MvbGF5ZXJzL2ppbXUtZ3JvdXAtbGF5ZXItdmlldy50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtYXJjZ2lzL2xpYi92aWV3cy9sYXllcnMvamltdS1ncm91cC1sYXllci12aWV3LnRzPzE0ZmMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtKaW11TGF5ZXJWaWV3LCBKaW11TGF5ZXJWaWV3Q29uc3RydWN0b3JPcHRpb25zfSBmcm9tICcuL2ppbXUtbGF5ZXItdmlldyc7XG5pbXBvcnQge01hcFZpZXdNYW5hZ2VyfSBmcm9tICcuLi8uLi9tYXB2aWV3LW1hbmFnZXInO1xuaW1wb3J0IHtMYXllclR5cGVzfSBmcm9tICcuLi8uLi9kYXRhLXNvdXJjZXMvYXJjZ2lzLWRhdGEtc291cmNlLWludGVyZmFjZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSmltdUdyb3VwTGF5ZXJWaWV3T3B0aW9ucyBleHRlbmRzIEppbXVMYXllclZpZXdDb25zdHJ1Y3Rvck9wdGlvbnMge1xuICB1cmw/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBKaW11R3JvdXBMYXllclZpZXcgZXh0ZW5kcyBKaW11TGF5ZXJWaWV3IHtcbiAgdXJsOiBzdHJpbmcgPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IEppbXVHcm91cExheWVyVmlld09wdGlvbnMpIHtcbiAgICBzdXBlcihvcHRpb25zKTtcbiAgICB0aGlzLnVybCA9IG9wdGlvbnMudXJsO1xuXG4gICAgaWYgKHRoaXMubGF5ZXIpIHtcbiAgICAgIHRoaXMubGF5ZXIud2F0Y2goJ3Zpc2libGUnLCAobmV3VmFsdWUpID0+IHtcbiAgICAgICAgY29uc3QgY2hpbGRMYXllclZpZXdzID0gTWFwVmlld01hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXRKaW11TWFwVmlld0J5SWQodGhpcy5qaW11TWFwVmlld0lkKS5nZXRDaGlsZExheWVyVmlld3ModGhpcy5pZCk7XG4gICAgICAgIGlmIChjaGlsZExheWVyVmlld3MgJiYgY2hpbGRMYXllclZpZXdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoaWxkTGF5ZXJWaWV3cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKChjaGlsZExheWVyVmlld3NbaV0gYXMgYW55KS52aXJ0dWFsTGF5ZXIpIHtcbiAgICAgICAgICAgICAgKGNoaWxkTGF5ZXJWaWV3c1tpXSBhcyBhbnkpLnZpcnR1YWxMYXllci52aXNpYmxlID0gbmV3VmFsdWUgJiYgKGNoaWxkTGF5ZXJWaWV3c1tpXSBhcyBhbnkpLmxheWVyLnZpc2libGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIShjaGlsZExheWVyVmlld3NbaV0gYXMgYW55KS52aWV3ICYmIChjaGlsZExheWVyVmlld3NbaV0gYXMgYW55KS50eXBlID09PSBMYXllclR5cGVzLkZlYXR1cmVMYXllcikge1xuICAgICAgICAgICAgICAoY2hpbGRMYXllclZpZXdzW2ldIGFzIGFueSkuaGlnaExpZ2h0U2VsZWN0ZWRGZWF0dXJlc1dpdGhWaXJ0dWFsTGF5ZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICB9XG5cbn0iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQU1BO0FBQUE7QUFHQTtBQUFBO0FBRkE7QUFJQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUVBO0FBQUE7OyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./jimu-arcgis/lib/views/layers/jimu-group-layer-view.ts\n");

/***/ }),

/***/ "./jimu-arcgis/lib/views/layers/jimu-layer-view.ts":
/*!*********************************************************!*\
  !*** ./jimu-arcgis/lib/views/layers/jimu-layer-view.ts ***!
  \*********************************************************/
/*! exports provided: JimuLayerView */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"JimuLayerView\", function() { return JimuLayerView; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n\n/**\n * The base class JimuLayerView.\n */\nvar JimuLayerView = /** @class */ (function () {\n    function JimuLayerView(options) {\n        if (options.rootJimuLayerId) {\n            this.id = options.jimuMapViewId + '-' + options.rootJimuLayerId + '-' + options.jimuLayerId;\n        }\n        else {\n            this.id = options.jimuMapViewId + '-' + options.jimuLayerId;\n        }\n        this.view = options.view;\n        this.type = options.type;\n        this.layerDataSourceId = options.layerDataSourceId;\n        this.jimuMapViewId = options.jimuMapViewId;\n        this.jimuLayerId = options.jimuLayerId;\n        this.layer = options.layer;\n        this.layerIndex = options.layerIndex;\n        this.parentJimuLayerViewId = options.parentJimuLayerViewId;\n        this.dataSourceInfoObserver = Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"observeStore\"])(this.onLayerDataSourceInfoChange.bind(this), ['dataSourcesInfo', this.layerDataSourceId]);\n    }\n    /** @ignore */\n    JimuLayerView.prototype.onLayerDataSourceInfoChange = function (preDsInfo, dsInfo) {\n    };\n    /** @ignore */\n    JimuLayerView.prototype.selectFeaturesByIds = function (ids) { };\n    JimuLayerView.prototype.selectFeatureById = function (id) { };\n    /**\n     * Destroy the JimuLayerView instance.\n     */\n    JimuLayerView.prototype.destroy = function () {\n        this.dataSourceInfoObserver && this.dataSourceInfoObserver();\n    };\n    return JimuLayerView;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9saWIvdmlld3MvbGF5ZXJzL2ppbXUtbGF5ZXItdmlldy50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtYXJjZ2lzL2xpYi92aWV3cy9sYXllcnMvamltdS1sYXllci12aWV3LnRzP2FjMjEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgb2JzZXJ2ZVN0b3JlLCBJTURhdGFTb3VyY2VJbmZvfSBmcm9tICdqaW11LWNvcmUnO1xuXG4vKiogQGlnbm9yZSAqL1xuZXhwb3J0IGludGVyZmFjZSBKaW11TGF5ZXJWaWV3Q29uc3RydWN0b3JPcHRpb25ze1xuICB2aWV3OiBfX2VzcmkuTGF5ZXJWaWV3O1xuICB0eXBlOiBzdHJpbmc7XG4gIGxheWVyRGF0YVNvdXJjZUlkOiBzdHJpbmc7XG4gIGppbXVNYXBWaWV3SWQ6IHN0cmluZztcbiAgamltdUxheWVySWQ6IHN0cmluZztcbiAgcm9vdEppbXVMYXllcklkOiBzdHJpbmc7XG4gIGxheWVyOiBhbnk7XG4gIGxheWVySW5kZXg6IG51bWJlcjtcbiAgcGFyZW50SmltdUxheWVyVmlld0lkOiBzdHJpbmc7XG59XG5cbi8qKlxuICogVGhlIGJhc2UgY2xhc3MgSmltdUxheWVyVmlldy5cbiAqL1xuZXhwb3J0IGNsYXNzIEppbXVMYXllclZpZXcge1xuXG4gIC8qKlxuICAgKiBUaGUgaWQgb2YgdGhlIEppbXVMYXllclZpZXcgaW5zdGFuY2UuXG4gICAqL1xuICBpZDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgdmlldyBpcyBfX2VzcmkuTGF5ZXJWaWV3LlxuICAgKi9cbiAgdmlldzogX19lc3JpLkxheWVyVmlldztcblxuICAvKiogQGlnbm9yZSAqL1xuICB0eXBlOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBsYXllckRhdGFTb3VyY2VJZCBpcyB0aGUgY29ycmVzcG9uZGluZyBkYXRhc291cmNlIGlkLlxuICAgKi9cbiAgbGF5ZXJEYXRhU291cmNlSWQ6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIGppbXVNYXBWaWV3SWQgaXMgdGhlIGNvcnJlc3BvbmRpbmcgSmltdU1hcFZpZXcgaW5zdGFuY2UgaWQuXG4gICAqL1xuICBqaW11TWFwVmlld0lkOiBzdHJpbmc7XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgamltdUxheWVySWQ6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIGxheWVyIGlzIHRoZSBjb3JyZXNwb25kaW5nIGxheWVyIG9iamVjdCBpbiBBcmNHSVMgSmF2YVNjcmlwdCBBUEkgVmlldy5tYXAuXG4gICAqL1xuICBsYXllcjogYW55O1xuXG4gIC8qKiBAaWdub3JlICovXG4gIGxheWVySW5kZXg/OiBudW1iZXI7XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgcGFyZW50SmltdUxheWVyVmlld0lkOiBzdHJpbmc7XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgcHJpdmF0ZSBkYXRhU291cmNlSW5mb09ic2VydmVyO1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IEppbXVMYXllclZpZXdDb25zdHJ1Y3Rvck9wdGlvbnMpIHtcbiAgICBpZiAob3B0aW9ucy5yb290SmltdUxheWVySWQpIHtcbiAgICAgIHRoaXMuaWQgPSBvcHRpb25zLmppbXVNYXBWaWV3SWQgKyAnLScgKyBvcHRpb25zLnJvb3RKaW11TGF5ZXJJZCArICctJyArIG9wdGlvbnMuamltdUxheWVySWQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaWQgPSBvcHRpb25zLmppbXVNYXBWaWV3SWQgKyAnLScgKyBvcHRpb25zLmppbXVMYXllcklkO1xuICAgIH1cblxuICAgIHRoaXMudmlldyA9IG9wdGlvbnMudmlldztcbiAgICB0aGlzLnR5cGUgPSBvcHRpb25zLnR5cGU7XG4gICAgdGhpcy5sYXllckRhdGFTb3VyY2VJZCA9IG9wdGlvbnMubGF5ZXJEYXRhU291cmNlSWQ7XG4gICAgdGhpcy5qaW11TWFwVmlld0lkID0gb3B0aW9ucy5qaW11TWFwVmlld0lkO1xuICAgIHRoaXMuamltdUxheWVySWQgPSBvcHRpb25zLmppbXVMYXllcklkO1xuICAgIHRoaXMubGF5ZXIgPSBvcHRpb25zLmxheWVyO1xuICAgIHRoaXMubGF5ZXJJbmRleCA9IG9wdGlvbnMubGF5ZXJJbmRleDtcbiAgICB0aGlzLnBhcmVudEppbXVMYXllclZpZXdJZCA9IG9wdGlvbnMucGFyZW50SmltdUxheWVyVmlld0lkO1xuICAgIHRoaXMuZGF0YVNvdXJjZUluZm9PYnNlcnZlciA9IG9ic2VydmVTdG9yZSh0aGlzLm9uTGF5ZXJEYXRhU291cmNlSW5mb0NoYW5nZS5iaW5kKHRoaXMpLCBbJ2RhdGFTb3VyY2VzSW5mbycsIHRoaXMubGF5ZXJEYXRhU291cmNlSWRdKTtcbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIG9uTGF5ZXJEYXRhU291cmNlSW5mb0NoYW5nZShwcmVEc0luZm86IElNRGF0YVNvdXJjZUluZm8sIGRzSW5mbzogSU1EYXRhU291cmNlSW5mbyl7XG5cbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIHNlbGVjdEZlYXR1cmVzQnlJZHMoaWRzOiBzdHJpbmdbXSl7fVxuICBzZWxlY3RGZWF0dXJlQnlJZChpZDogc3RyaW5nKXt9XG5cbiAgLyoqXG4gICAqIERlc3Ryb3kgdGhlIEppbXVMYXllclZpZXcgaW5zdGFuY2UuXG4gICAqL1xuICBkZXN0cm95KCl7XG4gICAgdGhpcy5kYXRhU291cmNlSW5mb09ic2VydmVyICYmIHRoaXMuZGF0YVNvdXJjZUluZm9PYnNlcnZlcigpO1xuICB9XG59Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBZUE7O0FBRUE7QUFDQTtBQTBDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBOzsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./jimu-arcgis/lib/views/layers/jimu-layer-view.ts\n");

/***/ }),

/***/ "./jimu-arcgis/lib/views/layers/jimu-mapimage-layer-view.ts":
/*!******************************************************************!*\
  !*** ./jimu-arcgis/lib/views/layers/jimu-mapimage-layer-view.ts ***!
  \******************************************************************/
/*! exports provided: JimuMapImageLayerView */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"JimuMapImageLayerView\", function() { return JimuMapImageLayerView; });\n/* harmony import */ var _jimu_layer_view__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./jimu-layer-view */ \"./jimu-arcgis/lib/views/layers/jimu-layer-view.ts\");\n/* harmony import */ var _mapview_manager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../mapview-manager */ \"./jimu-arcgis/lib/mapview-manager.tsx\");\n/* harmony import */ var _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../data-sources/arcgis-data-source-interface */ \"./jimu-arcgis/lib/data-sources/arcgis-data-source-interface.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar JimuMapImageLayerView = /** @class */ (function (_super) {\n    __extends(JimuMapImageLayerView, _super);\n    function JimuMapImageLayerView(options) {\n        var _this = _super.call(this, options) || this;\n        _this.url = null;\n        _this.url = options.url;\n        if (_this.layer) {\n            _this.layer.watch('visible', function (newValue) {\n                var childLayerViews = _mapview_manager__WEBPACK_IMPORTED_MODULE_1__[\"MapViewManager\"].getInstance().getJimuMapViewById(_this.jimuMapViewId).getChildLayerViews(_this.id);\n                if (childLayerViews && childLayerViews.length > 0) {\n                    for (var i = 0; i < childLayerViews.length; i++) {\n                        if (childLayerViews[i].virtualLayer) {\n                            childLayerViews[i].virtualLayer.visible = newValue && childLayerViews[i].layer.visible;\n                        }\n                        if (!childLayerViews[i].view && childLayerViews[i].type === _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"LayerTypes\"].FeatureLayer) {\n                            childLayerViews[i].highLightSelectedFeaturesWithVirtualLayer();\n                        }\n                    }\n                }\n            });\n        }\n        return _this;\n    }\n    return JimuMapImageLayerView;\n}(_jimu_layer_view__WEBPACK_IMPORTED_MODULE_0__[\"JimuLayerView\"]));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9saWIvdmlld3MvbGF5ZXJzL2ppbXUtbWFwaW1hZ2UtbGF5ZXItdmlldy50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtYXJjZ2lzL2xpYi92aWV3cy9sYXllcnMvamltdS1tYXBpbWFnZS1sYXllci12aWV3LnRzP2NhNzUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtKaW11TGF5ZXJWaWV3LCBKaW11TGF5ZXJWaWV3Q29uc3RydWN0b3JPcHRpb25zfSBmcm9tICcuL2ppbXUtbGF5ZXItdmlldyc7XG5pbXBvcnQge01hcFZpZXdNYW5hZ2VyfSBmcm9tICcuLi8uLi9tYXB2aWV3LW1hbmFnZXInO1xuaW1wb3J0IHtMYXllclR5cGVzfSBmcm9tICcuLi8uLi9kYXRhLXNvdXJjZXMvYXJjZ2lzLWRhdGEtc291cmNlLWludGVyZmFjZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSmltdU1hcEltYWdlTGF5ZXJWaWV3T3B0aW9ucyBleHRlbmRzIEppbXVMYXllclZpZXdDb25zdHJ1Y3Rvck9wdGlvbnMge1xuICB1cmw/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBKaW11TWFwSW1hZ2VMYXllclZpZXcgZXh0ZW5kcyBKaW11TGF5ZXJWaWV3IHtcbiAgdXJsOiBzdHJpbmcgPSBudWxsO1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IEppbXVNYXBJbWFnZUxheWVyVmlld09wdGlvbnMpIHtcbiAgICBzdXBlcihvcHRpb25zKTtcbiAgICB0aGlzLnVybCA9IG9wdGlvbnMudXJsO1xuXG4gICAgaWYgKHRoaXMubGF5ZXIpIHtcbiAgICAgIHRoaXMubGF5ZXIud2F0Y2goJ3Zpc2libGUnLCAobmV3VmFsdWUpID0+IHtcbiAgICAgICAgY29uc3QgY2hpbGRMYXllclZpZXdzID0gTWFwVmlld01hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXRKaW11TWFwVmlld0J5SWQodGhpcy5qaW11TWFwVmlld0lkKS5nZXRDaGlsZExheWVyVmlld3ModGhpcy5pZCk7XG4gICAgICAgIGlmIChjaGlsZExheWVyVmlld3MgJiYgY2hpbGRMYXllclZpZXdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNoaWxkTGF5ZXJWaWV3cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKChjaGlsZExheWVyVmlld3NbaV0gYXMgYW55KS52aXJ0dWFsTGF5ZXIpIHtcbiAgICAgICAgICAgICAgKGNoaWxkTGF5ZXJWaWV3c1tpXSBhcyBhbnkpLnZpcnR1YWxMYXllci52aXNpYmxlID0gbmV3VmFsdWUgJiYgKGNoaWxkTGF5ZXJWaWV3c1tpXSBhcyBhbnkpLmxheWVyLnZpc2libGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIShjaGlsZExheWVyVmlld3NbaV0gYXMgYW55KS52aWV3ICYmIChjaGlsZExheWVyVmlld3NbaV0gYXMgYW55KS50eXBlID09PSBMYXllclR5cGVzLkZlYXR1cmVMYXllcikge1xuICAgICAgICAgICAgICAoY2hpbGRMYXllclZpZXdzW2ldIGFzIGFueSkuaGlnaExpZ2h0U2VsZWN0ZWRGZWF0dXJlc1dpdGhWaXJ0dWFsTGF5ZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfVxuICB9XG59Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFNQTtBQUFBO0FBR0E7QUFBQTtBQUZBO0FBSUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUFBOzsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./jimu-arcgis/lib/views/layers/jimu-mapimage-layer-view.ts\n");

/***/ }),

/***/ "./jimu-arcgis/lib/views/layers/jimu-tile-layer-view.ts":
/*!**************************************************************!*\
  !*** ./jimu-arcgis/lib/views/layers/jimu-tile-layer-view.ts ***!
  \**************************************************************/
/*! exports provided: JimuTileLayerView */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"JimuTileLayerView\", function() { return JimuTileLayerView; });\n/* harmony import */ var _jimu_layer_view__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./jimu-layer-view */ \"./jimu-arcgis/lib/views/layers/jimu-layer-view.ts\");\n/* harmony import */ var _mapview_manager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../mapview-manager */ \"./jimu-arcgis/lib/mapview-manager.tsx\");\n/* harmony import */ var _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../data-sources/arcgis-data-source-interface */ \"./jimu-arcgis/lib/data-sources/arcgis-data-source-interface.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar JimuTileLayerView = /** @class */ (function (_super) {\n    __extends(JimuTileLayerView, _super);\n    function JimuTileLayerView(options) {\n        var _this = _super.call(this, options) || this;\n        _this.url = null;\n        _this.url = options.url;\n        if (_this.layer) {\n            _this.layer.watch('visible', function (newValue) {\n                var childLayerViews = _mapview_manager__WEBPACK_IMPORTED_MODULE_1__[\"MapViewManager\"].getInstance().getJimuMapViewById(_this.jimuMapViewId).getChildLayerViews(_this.id);\n                if (childLayerViews && childLayerViews.length > 0) {\n                    for (var i = 0; i < childLayerViews.length; i++) {\n                        if (childLayerViews[i].virtualLayer) {\n                            childLayerViews[i].virtualLayer.visible = newValue && childLayerViews[i].layer.visible;\n                        }\n                        if (!childLayerViews[i].view && childLayerViews[i].type === _data_sources_arcgis_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"LayerTypes\"].FeatureLayer) {\n                            childLayerViews[i].highLightSelectedFeaturesWithVirtualLayer();\n                        }\n                    }\n                }\n            });\n        }\n        return _this;\n    }\n    return JimuTileLayerView;\n}(_jimu_layer_view__WEBPACK_IMPORTED_MODULE_0__[\"JimuLayerView\"]));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWFyY2dpcy9saWIvdmlld3MvbGF5ZXJzL2ppbXUtdGlsZS1sYXllci12aWV3LnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vamltdS1hcmNnaXMvbGliL3ZpZXdzL2xheWVycy9qaW11LXRpbGUtbGF5ZXItdmlldy50cz9hMjkzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7SmltdUxheWVyVmlldywgSmltdUxheWVyVmlld0NvbnN0cnVjdG9yT3B0aW9uc30gZnJvbSAnLi9qaW11LWxheWVyLXZpZXcnO1xuaW1wb3J0IHtNYXBWaWV3TWFuYWdlcn0gZnJvbSAnLi4vLi4vbWFwdmlldy1tYW5hZ2VyJztcbmltcG9ydCB7TGF5ZXJUeXBlc30gZnJvbSAnLi4vLi4vZGF0YS1zb3VyY2VzL2FyY2dpcy1kYXRhLXNvdXJjZS1pbnRlcmZhY2UnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEppbXVUaWxlTGF5ZXJWaWV3T3B0aW9ucyBleHRlbmRzIEppbXVMYXllclZpZXdDb25zdHJ1Y3Rvck9wdGlvbnMge1xuICB1cmw/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjbGFzcyBKaW11VGlsZUxheWVyVmlldyBleHRlbmRzIEppbXVMYXllclZpZXcge1xuICB1cmw6IHN0cmluZyA9IG51bGw7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogSmltdVRpbGVMYXllclZpZXdPcHRpb25zKSB7XG4gICAgc3VwZXIob3B0aW9ucyk7XG4gICAgdGhpcy51cmwgPSBvcHRpb25zLnVybDtcblxuICAgIGlmICh0aGlzLmxheWVyKSB7XG4gICAgICB0aGlzLmxheWVyLndhdGNoKCd2aXNpYmxlJywgKG5ld1ZhbHVlKSA9PiB7XG4gICAgICAgIGNvbnN0IGNoaWxkTGF5ZXJWaWV3cyA9IE1hcFZpZXdNYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0SmltdU1hcFZpZXdCeUlkKHRoaXMuamltdU1hcFZpZXdJZCkuZ2V0Q2hpbGRMYXllclZpZXdzKHRoaXMuaWQpO1xuICAgICAgICBpZiAoY2hpbGRMYXllclZpZXdzICYmIGNoaWxkTGF5ZXJWaWV3cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZExheWVyVmlld3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmICgoY2hpbGRMYXllclZpZXdzW2ldIGFzIGFueSkudmlydHVhbExheWVyKSB7XG4gICAgICAgICAgICAgIChjaGlsZExheWVyVmlld3NbaV0gYXMgYW55KS52aXJ0dWFsTGF5ZXIudmlzaWJsZSA9IG5ld1ZhbHVlICYmIChjaGlsZExheWVyVmlld3NbaV0gYXMgYW55KS5sYXllci52aXNpYmxlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCEoY2hpbGRMYXllclZpZXdzW2ldIGFzIGFueSkudmlldyAmJiAoY2hpbGRMYXllclZpZXdzW2ldIGFzIGFueSkudHlwZSA9PT0gTGF5ZXJUeXBlcy5GZWF0dXJlTGF5ZXIpIHtcbiAgICAgICAgICAgICAgKGNoaWxkTGF5ZXJWaWV3c1tpXSBhcyBhbnkpLmhpZ2hMaWdodFNlbGVjdGVkRmVhdHVyZXNXaXRoVmlydHVhbExheWVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cbiAgfVxuXG59Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFNQTtBQUFBO0FBR0E7QUFBQTtBQUZBO0FBSUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFFQTtBQUFBOzsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./jimu-arcgis/lib/views/layers/jimu-tile-layer-view.ts\n");

/***/ }),

/***/ "jimu-core":
/*!****************************!*\
  !*** external "jimu-core" ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = __WEBPACK_EXTERNAL_MODULE_jimu_core__;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiamltdS1jb3JlLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiamltdS1jb3JlXCI/YzY5NSJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfamltdV9jb3JlX187Il0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///jimu-core\n");

/***/ })

/******/ })
			);
		}
	};
});