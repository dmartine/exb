System.register(["jimu-core"], function(__WEBPACK_DYNAMIC_EXPORT__) {
	var __WEBPACK_EXTERNAL_MODULE_jimu_core__;
	return {
		setters: [
			function(module) {
				__WEBPACK_EXTERNAL_MODULE_jimu_core__ = module;
			}
		],
		execute: function() {
			__WEBPACK_DYNAMIC_EXPORT__(
/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./jimu-core/data-source.ts");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./jimu-core/data-source.ts":
/*!**********************************!*\
  !*** ./jimu-core/data-source.ts ***!
  \**********************************/
/*! exports provided: default, JimuCoreDataSourceFactory, AbstractDataSource, AbstractLayerFolderDataSource, AbstractLoadableDataSource, AbstractQueriableDataSource, AbstractSetDataSource, AbstractDataRecord, SimpleDataRecordImpl, SimpleDataRecordSetImpl, DataSourceStatus, DataSourceTypes, SupportedLayerServiceTypes, SupportedServiceTypes, SupportedItemTypes, SupportedLayerTypes, QueryScope, DataSourceError, FeatureDataRecordImpl, CsvDataSourceImpl, FeatureLayerDataSourceImpl, FeatureServiceDataSourceImpl, FeatureSetDataSourceImpl, GroupLayerDataSourceImpl, MapServiceDataSourceImpl, SimpleLocalDataSourceImpl, SceneServiceDataSourceImpl, SceneLayerDataSourceImpl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./lib/data-sources */ \"./jimu-core/lib/data-sources/index.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"JimuCoreDataSourceFactory\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"JimuCoreDataSourceFactory\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AbstractDataSource\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"AbstractDataSource\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AbstractLayerFolderDataSource\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"AbstractLayerFolderDataSource\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AbstractLoadableDataSource\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"AbstractLoadableDataSource\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AbstractQueriableDataSource\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"AbstractQueriableDataSource\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AbstractSetDataSource\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"AbstractSetDataSource\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AbstractDataRecord\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"AbstractDataRecord\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SimpleDataRecordImpl\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"SimpleDataRecordImpl\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SimpleDataRecordSetImpl\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"SimpleDataRecordSetImpl\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DataSourceStatus\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"DataSourceStatus\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DataSourceTypes\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"DataSourceTypes\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SupportedLayerServiceTypes\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"SupportedLayerServiceTypes\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SupportedServiceTypes\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"SupportedServiceTypes\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SupportedItemTypes\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"SupportedItemTypes\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SupportedLayerTypes\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"SupportedLayerTypes\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"QueryScope\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"QueryScope\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DataSourceError\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"DataSourceError\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"FeatureDataRecordImpl\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"FeatureDataRecordImpl\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CsvDataSourceImpl\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"CsvDataSourceImpl\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"FeatureLayerDataSourceImpl\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"FeatureLayerDataSourceImpl\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"FeatureServiceDataSourceImpl\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"FeatureServiceDataSourceImpl\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"FeatureSetDataSourceImpl\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"FeatureSetDataSourceImpl\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"GroupLayerDataSourceImpl\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"GroupLayerDataSourceImpl\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"MapServiceDataSourceImpl\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"MapServiceDataSourceImpl\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SimpleLocalDataSourceImpl\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"SimpleLocalDataSourceImpl\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SceneServiceDataSourceImpl\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"SceneServiceDataSourceImpl\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SceneLayerDataSourceImpl\", function() { return _lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"SceneLayerDataSourceImpl\"]; });\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (_lib_data_sources__WEBPACK_IMPORTED_MODULE_0__[\"JimuCoreDataSourceFactory\"]);\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvZGF0YS1zb3VyY2UudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qaW11LWNvcmUvZGF0YS1zb3VyY2UudHM/YTcxYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBKaW11Q29yZURhdGFTb3VyY2VGYWN0b3J5IH0gZnJvbSAnLi9saWIvZGF0YS1zb3VyY2VzJztcblxuZXhwb3J0IGRlZmF1bHQgSmltdUNvcmVEYXRhU291cmNlRmFjdG9yeTtcblxuZXhwb3J0ICogZnJvbSAnLi9saWIvZGF0YS1zb3VyY2VzJzsiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBRUE7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./jimu-core/data-source.ts\n");

/***/ }),

/***/ "./jimu-core/lib/constants.ts":
/*!************************************!*\
  !*** ./jimu-core/lib/constants.ts ***!
  \************************************/
/*! exports provided: BREAK_POINTS, DEFAULT_VIEWPORT_SIZE, DEFAULT_PAGE_WIDTH, SCREEN_RESOLUTIONS, SHARED_THEME, SELECTION_DATA_VIEW_ID, DATA_VIEW_ID_FOR_NO_SELECTION, REPEAT_CONTEXT_DATA_VIEW_ID, PROVIDE_REPEATED_DATA_SOURCE_CONTEXT_WIDGET_URI, CURRENT_PAGE, DEFAULT_QUERY_PAGE_SIZE, USER_LOCALE_KEY */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BREAK_POINTS\", function() { return BREAK_POINTS; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_VIEWPORT_SIZE\", function() { return DEFAULT_VIEWPORT_SIZE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_PAGE_WIDTH\", function() { return DEFAULT_PAGE_WIDTH; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SCREEN_RESOLUTIONS\", function() { return SCREEN_RESOLUTIONS; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SHARED_THEME\", function() { return SHARED_THEME; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SELECTION_DATA_VIEW_ID\", function() { return SELECTION_DATA_VIEW_ID; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DATA_VIEW_ID_FOR_NO_SELECTION\", function() { return DATA_VIEW_ID_FOR_NO_SELECTION; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"REPEAT_CONTEXT_DATA_VIEW_ID\", function() { return REPEAT_CONTEXT_DATA_VIEW_ID; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PROVIDE_REPEATED_DATA_SOURCE_CONTEXT_WIDGET_URI\", function() { return PROVIDE_REPEATED_DATA_SOURCE_CONTEXT_WIDGET_URI; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CURRENT_PAGE\", function() { return CURRENT_PAGE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEFAULT_QUERY_PAGE_SIZE\", function() { return DEFAULT_QUERY_PAGE_SIZE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"USER_LOCALE_KEY\", function() { return USER_LOCALE_KEY; });\n/* harmony import */ var _types_common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./types/common */ \"./jimu-core/lib/types/common.ts\");\n\nvar BREAK_POINTS = [576, 992];\nvar DEFAULT_VIEWPORT_SIZE = {\n    DESKTOP: {\n        width: 1280,\n        height: 800\n    },\n    PAD: {\n        width: 768,\n        height: 1024\n    },\n    PHONE: {\n        width: 414,\n        height: 896\n    },\n};\nvar DEFAULT_PAGE_WIDTH = 960;\nvar resolutions = {};\nresolutions[_types_common__WEBPACK_IMPORTED_MODULE_0__[\"BrowserSizeMode\"].Large] = [{\n        width: 1024,\n        height: 768,\n    }, {\n        width: 1280,\n        height: 800,\n    }, {\n        width: 1280,\n        height: 1024,\n    }, {\n        width: 1366,\n        height: 768,\n    }, {\n        width: 1440,\n        height: 900,\n    }, {\n        width: 1536,\n        height: 864,\n    }, {\n        width: 1600,\n        height: 900,\n    }, {\n        width: 1920,\n        height: 1080,\n    }];\nresolutions[_types_common__WEBPACK_IMPORTED_MODULE_0__[\"BrowserSizeMode\"].Medium] = [{\n        width: 601,\n        height: 962,\n    }, {\n        width: 600,\n        height: 1024,\n    }, {\n        width: 768,\n        height: 1024,\n    }, {\n        width: 800,\n        height: 1280,\n    }, {\n        width: 834,\n        height: 1112,\n    }];\nresolutions[_types_common__WEBPACK_IMPORTED_MODULE_0__[\"BrowserSizeMode\"].Small] = [{\n        width: 360,\n        height: 640,\n    }, {\n        width: 360,\n        height: 720,\n    }, {\n        width: 360,\n        height: 740,\n    }, {\n        width: 375,\n        height: 667,\n    }, {\n        width: 414,\n        height: 736,\n    }];\nvar SCREEN_RESOLUTIONS = resolutions;\nvar SHARED_THEME = 'themes/shared-theme/';\nvar SELECTION_DATA_VIEW_ID = 'selection';\nvar DATA_VIEW_ID_FOR_NO_SELECTION = 'no_selection';\nvar REPEAT_CONTEXT_DATA_VIEW_ID = 'repeat_context';\nvar PROVIDE_REPEATED_DATA_SOURCE_CONTEXT_WIDGET_URI = ['widgets/common/list/'];\nvar CURRENT_PAGE = 'current_page';\nvar DEFAULT_QUERY_PAGE_SIZE = 100;\nvar USER_LOCALE_KEY = 'exb_user_locale';\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2NvbnN0YW50cy50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtY29yZS9saWIvY29uc3RhbnRzLnRzPzIwZDkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQnJvd3NlclNpemVNb2RlIH0gZnJvbSAnLi90eXBlcy9jb21tb24nO1xuXG5leHBvcnQgY29uc3QgQlJFQUtfUE9JTlRTID0gWzU3NiwgOTkyXTtcblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfVklFV1BPUlRfU0laRSA9IHtcbiAgREVTS1RPUDoge1xuICAgIHdpZHRoOiAxMjgwLFxuICAgIGhlaWdodDogODAwXG4gIH0sXG4gIFBBRDoge1xuICAgIHdpZHRoOiA3NjgsXG4gICAgaGVpZ2h0OiAxMDI0XG4gIH0sXG4gIFBIT05FOiB7XG4gICAgd2lkdGg6IDQxNCxcbiAgICBoZWlnaHQ6IDg5NlxuICB9LFxufVxuXG5leHBvcnQgY29uc3QgREVGQVVMVF9QQUdFX1dJRFRIID0gOTYwO1xuXG5jb25zdCByZXNvbHV0aW9ucyA9IHt9O1xucmVzb2x1dGlvbnNbQnJvd3NlclNpemVNb2RlLkxhcmdlXSA9IFt7XG4gIHdpZHRoOiAxMDI0LFxuICBoZWlnaHQ6IDc2OCxcbn0sIHtcbiAgd2lkdGg6IDEyODAsXG4gIGhlaWdodDogODAwLFxufSwge1xuICB3aWR0aDogMTI4MCxcbiAgaGVpZ2h0OiAxMDI0LFxufSwge1xuICB3aWR0aDogMTM2NixcbiAgaGVpZ2h0OiA3NjgsXG59LCB7XG4gIHdpZHRoOiAxNDQwLFxuICBoZWlnaHQ6IDkwMCxcbn0sIHtcbiAgd2lkdGg6IDE1MzYsXG4gIGhlaWdodDogODY0LFxufSwge1xuICB3aWR0aDogMTYwMCxcbiAgaGVpZ2h0OiA5MDAsXG59LCB7XG4gIHdpZHRoOiAxOTIwLFxuICBoZWlnaHQ6IDEwODAsXG59XTtcblxucmVzb2x1dGlvbnNbQnJvd3NlclNpemVNb2RlLk1lZGl1bV0gPSBbe1xuICB3aWR0aDogNjAxLFxuICBoZWlnaHQ6IDk2Mixcbn0sIHtcbiAgd2lkdGg6IDYwMCxcbiAgaGVpZ2h0OiAxMDI0LFxufSwge1xuICB3aWR0aDogNzY4LFxuICBoZWlnaHQ6IDEwMjQsXG59LCB7XG4gIHdpZHRoOiA4MDAsXG4gIGhlaWdodDogMTI4MCxcbn0sIHtcbiAgd2lkdGg6IDgzNCxcbiAgaGVpZ2h0OiAxMTEyLFxufV07XG5cbnJlc29sdXRpb25zW0Jyb3dzZXJTaXplTW9kZS5TbWFsbF0gPSBbe1xuICB3aWR0aDogMzYwLFxuICBoZWlnaHQ6IDY0MCxcbn0sIHtcbiAgd2lkdGg6IDM2MCxcbiAgaGVpZ2h0OiA3MjAsXG59LCB7XG4gIHdpZHRoOiAzNjAsXG4gIGhlaWdodDogNzQwLFxufSwge1xuICB3aWR0aDogMzc1LFxuICBoZWlnaHQ6IDY2Nyxcbn0sIHtcbiAgd2lkdGg6IDQxNCxcbiAgaGVpZ2h0OiA3MzYsXG59XTtcblxuZXhwb3J0IGNvbnN0IFNDUkVFTl9SRVNPTFVUSU9OUyA9IHJlc29sdXRpb25zO1xuXG5leHBvcnQgY29uc3QgU0hBUkVEX1RIRU1FID0gJ3RoZW1lcy9zaGFyZWQtdGhlbWUvJztcblxuZXhwb3J0IGNvbnN0IFNFTEVDVElPTl9EQVRBX1ZJRVdfSUQgPSAnc2VsZWN0aW9uJztcbmV4cG9ydCBjb25zdCBEQVRBX1ZJRVdfSURfRk9SX05PX1NFTEVDVElPTiA9ICdub19zZWxlY3Rpb24nO1xuZXhwb3J0IGNvbnN0IFJFUEVBVF9DT05URVhUX0RBVEFfVklFV19JRCA9ICdyZXBlYXRfY29udGV4dCc7XG5cbmV4cG9ydCBjb25zdCBQUk9WSURFX1JFUEVBVEVEX0RBVEFfU09VUkNFX0NPTlRFWFRfV0lER0VUX1VSSSA9IFsnd2lkZ2V0cy9jb21tb24vbGlzdC8nXTtcblxuZXhwb3J0IGNvbnN0IENVUlJFTlRfUEFHRSA9ICdjdXJyZW50X3BhZ2UnO1xuXG5leHBvcnQgY29uc3QgREVGQVVMVF9RVUVSWV9QQUdFX1NJWkUgPSAxMDA7XG5cbmV4cG9ydCBjb25zdCBVU0VSX0xPQ0FMRV9LRVkgPSAnZXhiX3VzZXJfbG9jYWxlJzsiXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBRUE7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./jimu-core/lib/constants.ts\n");

/***/ }),

/***/ "./jimu-core/lib/data-sources/data-source-interface.ts":
/*!*************************************************************!*\
  !*** ./jimu-core/lib/data-sources/data-source-interface.ts ***!
  \*************************************************************/
/*! exports provided: DataSourceStatus, DataSourceTypes, SupportedLayerServiceTypes, SupportedServiceTypes, SupportedItemTypes, SupportedLayerTypes, QueryScope, DataSourceError */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DataSourceStatus\", function() { return DataSourceStatus; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DataSourceTypes\", function() { return DataSourceTypes; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SupportedLayerServiceTypes\", function() { return SupportedLayerServiceTypes; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SupportedServiceTypes\", function() { return SupportedServiceTypes; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SupportedItemTypes\", function() { return SupportedItemTypes; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SupportedLayerTypes\", function() { return SupportedLayerTypes; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"QueryScope\", function() { return QueryScope; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DataSourceError\", function() { return DataSourceError; });\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/**\n * All data source status are here, including data source instance status and data status (for QueriableDataSource).\n * * Instance status includes: NotCreated, Created, CreateError. <br/>\n *    When a data source is requested to be created, it is set to `NotCreated` at first.\n *    If a data source has never been used, there is no data source status.\n * * Data status includes: Unloaded, Loading, Loaded, LoadError. <br/>\n *    When a QueriableDataSource is created, it is set as `Unloaded` at first.\n *    If `load()` is invoked, it will be set as `Loading`. If data is returned, it will be set as `Loaded`.\n *    If an error occurs, it will be set as `LoadError`.\n */\nvar DataSourceStatus;\n(function (DataSourceStatus) {\n    // Instance status.\n    DataSourceStatus[\"NotCreated\"] = \"NOT_CREATED\";\n    DataSourceStatus[\"Created\"] = \"CREATED\";\n    DataSourceStatus[\"CreateError\"] = \"CREATE_ERROR\";\n    // Data status.\n    DataSourceStatus[\"Unloaded\"] = \"UNLOADED\";\n    DataSourceStatus[\"Loading\"] = \"LOADING\";\n    DataSourceStatus[\"Loaded\"] = \"LOADED\";\n    DataSourceStatus[\"LoadError\"] = \"LOAD_ERROR\";\n    // Save status.\n    /** @ignore */\n    DataSourceStatus[\"Saving\"] = \"SAVING\";\n    /** @ignore */\n    DataSourceStatus[\"Saved\"] = \"SAVED\";\n    /** @ignore */\n    DataSourceStatus[\"SaveError\"] = \"SAVE_ERROR\";\n    // For remote push data sources.\n    /** @ignore */\n    DataSourceStatus[\"Closed\"] = \"CLOSED\";\n    /** @ignore */\n    DataSourceStatus[\"Connecting\"] = \"CONNECTING\";\n    /** @ignore */\n    DataSourceStatus[\"Connected\"] = \"CONNECTED\";\n    /** @ignore */\n    DataSourceStatus[\"Closing\"] = \"CLOSING\";\n    // For client DS, we don't define status.\n})(DataSourceStatus || (DataSourceStatus = {}));\n/**\n * The data source types that `jimu-core` supports.\n */\nvar DataSourceTypes;\n(function (DataSourceTypes) {\n    /** @ignore */\n    DataSourceTypes[\"SimpleLocal\"] = \"SIMPLE_LOCAL\";\n    /** @ignore */\n    DataSourceTypes[\"CSV\"] = \"CSV\";\n    /**\n     * FeatureLayer data source is a `QueriableDataSource`, which is used to query ArcGIS feature service.\n     * See {@link FeatureLayerDataSource}\n     */\n    DataSourceTypes[\"FeatureLayer\"] = \"FEATURE_LAYER\";\n    /**\n     * See {@link SceneLayerDataSource}\n     */\n    DataSourceTypes[\"SceneLayer\"] = \"SCENE_LAYER\";\n    /** @ignore @deprecated */\n    DataSourceTypes[\"FeatureQuery\"] = \"FEATURE_LAYER\";\n    DataSourceTypes[\"FeatureSet\"] = \"FEATURE_SET\";\n    /**\n     * GroupLayer data source is a data source set that may have child data sources. It is from group layer in a map service or a webmap/webscene.\n     */\n    DataSourceTypes[\"GroupLayer\"] = \"GROUP_LAYER\";\n    /**\n     * FeatureService data source is a data source set that may have child data sources. It is from the feature service.\n     */\n    DataSourceTypes[\"FeatureService\"] = \"FEATURE_SERVICE\";\n    /**\n     * GroupLayer data source is a data source set that may have child data sources. It is from the map service.\n     */\n    DataSourceTypes[\"MapService\"] = \"MAP_SERVICE\";\n    /**\n     * SceneLayer data source is a data source set that may have child data sources. It it from the scene service.\n     */\n    DataSourceTypes[\"SceneService\"] = \"SCENE_SERVICE\";\n})(DataSourceTypes || (DataSourceTypes = {}));\n/**\n * For now, we only support some layer service types.\n */\nvar SupportedLayerServiceTypes;\n(function (SupportedLayerServiceTypes) {\n    // single layer service under map service or feature service\n    SupportedLayerServiceTypes[\"FeatureLayer\"] = \"Feature Layer\";\n    SupportedLayerServiceTypes[\"Table\"] = \"Table\";\n    SupportedLayerServiceTypes[\"GroupLayer\"] = \"Group Layer\";\n    // single layer service under scene service\n    SupportedLayerServiceTypes[\"SceneLayerPoint\"] = \"Point\";\n    SupportedLayerServiceTypes[\"SceneLayer3DObject\"] = \"3DObject\";\n})(SupportedLayerServiceTypes || (SupportedLayerServiceTypes = {}));\n/**\n * For now, we only support some service types.\n */\nvar SupportedServiceTypes;\n(function (SupportedServiceTypes) {\n    // [Feature Service](https://developers.arcgis.com/rest/services-reference/feature-service.htm)\n    SupportedServiceTypes[\"FeatureService\"] = \"FeatureServer\";\n    // [Map Service](https://developers.arcgis.com/rest/services-reference/hosted-map-service.htm)\n    SupportedServiceTypes[\"MapService\"] = \"MapServer\";\n    // [Scene Service](https://developers.arcgis.com/rest/services-reference/scene-service.htm)\n    SupportedServiceTypes[\"SceneService\"] = \"SceneServer\";\n})(SupportedServiceTypes || (SupportedServiceTypes = {}));\n/**\n * For now, we only support some portal item types.\n * Please see [Items and item types](https://developers.arcgis.com/rest/users-groups-and-items/items-and-item-types.htm).\n */\nvar SupportedItemTypes;\n(function (SupportedItemTypes) {\n    SupportedItemTypes[\"WebMap\"] = \"Web Map\";\n    SupportedItemTypes[\"WebScene\"] = \"Web Scene\";\n    SupportedItemTypes[\"FeatureService\"] = \"Feature Service\";\n    SupportedItemTypes[\"MapService\"] = \"Map Service\";\n    SupportedItemTypes[\"SceneService\"] = \"Scene Service\";\n    SupportedItemTypes[\"FeatureCollection\"] = \"Feature Collection\";\n})(SupportedItemTypes || (SupportedItemTypes = {}));\n/**\n * For now, we only support some layer types.\n * Please see [Layer](https://developers.arcgis.com/javascript/latest/api-reference/esri-layers-Layer.html).\n */\nvar SupportedLayerTypes;\n(function (SupportedLayerTypes) {\n    SupportedLayerTypes[\"FeatureLayer\"] = \"feature\";\n    SupportedLayerTypes[\"MapImageLayer\"] = \"map-image\";\n    SupportedLayerTypes[\"TileLayer\"] = \"tile\";\n    SupportedLayerTypes[\"GroupLayer\"] = \"group\";\n    SupportedLayerTypes[\"SceneLayer\"] = \"scene\";\n})(SupportedLayerTypes || (SupportedLayerTypes = {}));\n/**\n * Query scope defines which data is returned when the query is executed in addition to the query parameters.\n */\nvar QueryScope;\n(function (QueryScope) {\n    /** Use the query parameters directly to query. */\n    QueryScope[\"InAllData\"] = \"IN_ALL_DATA\";\n    /** Use the query parameters and the filters configured in exb to query. */\n    QueryScope[\"InRemoteConfigView\"] = \"IN_REMOTE_CONFIG_VIEW\";\n    /** Use the query parameters and the configured filters in data source and filters configured in exb to query. */\n    QueryScope[\"InConfigView\"] = \"IN_CONFIG_VIEW\";\n    /** Use all of the appliyed query parameters to query. */\n    QueryScope[\"InRuntimeView\"] = \"IN_RUNTIME_VIEW\";\n})(QueryScope || (QueryScope = {}));\n/**\n * @ignore\n */\nvar DataSourceError = /** @class */ (function (_super) {\n    __extends(DataSourceError, _super);\n    function DataSourceError(id, message) {\n        var _this = _super.call(this, message) || this;\n        _this.dataSourceId = id;\n        return _this;\n    }\n    return DataSourceError;\n}(Error));\n\n/************************************************************* Data sources ***********************************************/\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9kYXRhLXNvdXJjZS1pbnRlcmZhY2UudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9kYXRhLXNvdXJjZS1pbnRlcmZhY2UudHM/MzgzNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJR2VvbWV0cnksIEdlb21ldHJ5VHlwZSwgSUZlYXR1cmUgfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC10eXBlcyc7XG5pbXBvcnQgeyBJQXR0YWNobWVudEluZm8gfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC1mZWF0dXJlLWxheWVyJztcbi8vIG9ubHkgdXNlZCBhcyB0eXBlc1xuaW1wb3J0IHsgRGF0YVNvdXJjZU1hbmFnZXIsIElNRGF0YVNvdXJjZUpzb24sIElNRGF0YVNvdXJjZVNjaGVtYSwgSU1SZXZlcnNlZERhdGFTb3VyY2VTY2hlbWEsIEludGxTaGFwZSwgSU1EYXRhU291cmNlSW5mbywgU2VydmljZURlZmluaXRpb24sIEltbXV0YWJsZU9iamVjdCB9IGZyb20gJ2ppbXUtY29yZSc7XG5pbXBvcnQgeyBKaW11RmVhdHVyZUxheWVyVmlldyB9IGZyb20gJ2ppbXUtYXJjZ2lzJzsgLy8gb25seSB1c2VkIGFzIHR5cGVcbmltcG9ydCB7IElNRmllbGRTY2hlbWEgfSBmcm9tICcuLi90eXBlcy9hcHAtY29uZmlnJztcbi8qKlxuICogQWxsIGRhdGEgc291cmNlIHN0YXR1cyBhcmUgaGVyZSwgaW5jbHVkaW5nIGRhdGEgc291cmNlIGluc3RhbmNlIHN0YXR1cyBhbmQgZGF0YSBzdGF0dXMgKGZvciBRdWVyaWFibGVEYXRhU291cmNlKS5cbiAqICogSW5zdGFuY2Ugc3RhdHVzIGluY2x1ZGVzOiBOb3RDcmVhdGVkLCBDcmVhdGVkLCBDcmVhdGVFcnJvci4gPGJyLz5cbiAqICAgIFdoZW4gYSBkYXRhIHNvdXJjZSBpcyByZXF1ZXN0ZWQgdG8gYmUgY3JlYXRlZCwgaXQgaXMgc2V0IHRvIGBOb3RDcmVhdGVkYCBhdCBmaXJzdC5cbiAqICAgIElmIGEgZGF0YSBzb3VyY2UgaGFzIG5ldmVyIGJlZW4gdXNlZCwgdGhlcmUgaXMgbm8gZGF0YSBzb3VyY2Ugc3RhdHVzLlxuICogKiBEYXRhIHN0YXR1cyBpbmNsdWRlczogVW5sb2FkZWQsIExvYWRpbmcsIExvYWRlZCwgTG9hZEVycm9yLiA8YnIvPlxuICogICAgV2hlbiBhIFF1ZXJpYWJsZURhdGFTb3VyY2UgaXMgY3JlYXRlZCwgaXQgaXMgc2V0IGFzIGBVbmxvYWRlZGAgYXQgZmlyc3QuXG4gKiAgICBJZiBgbG9hZCgpYCBpcyBpbnZva2VkLCBpdCB3aWxsIGJlIHNldCBhcyBgTG9hZGluZ2AuIElmIGRhdGEgaXMgcmV0dXJuZWQsIGl0IHdpbGwgYmUgc2V0IGFzIGBMb2FkZWRgLlxuICogICAgSWYgYW4gZXJyb3Igb2NjdXJzLCBpdCB3aWxsIGJlIHNldCBhcyBgTG9hZEVycm9yYC5cbiAqL1xuZXhwb3J0IGVudW0gRGF0YVNvdXJjZVN0YXR1cyB7XG4gIC8vIEluc3RhbmNlIHN0YXR1cy5cbiAgTm90Q3JlYXRlZCA9ICdOT1RfQ1JFQVRFRCcsXG4gIENyZWF0ZWQgPSAnQ1JFQVRFRCcsXG4gIENyZWF0ZUVycm9yID0gJ0NSRUFURV9FUlJPUicsXG5cbiAgLy8gRGF0YSBzdGF0dXMuXG4gIFVubG9hZGVkID0gJ1VOTE9BREVEJyxcbiAgTG9hZGluZyA9ICdMT0FESU5HJyxcbiAgTG9hZGVkID0gJ0xPQURFRCcsXG4gIExvYWRFcnJvciA9ICdMT0FEX0VSUk9SJyxcblxuICAvLyBTYXZlIHN0YXR1cy5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgU2F2aW5nID0gJ1NBVklORycsXG4gIC8qKiBAaWdub3JlICovXG4gIFNhdmVkID0gJ1NBVkVEJyxcbiAgLyoqIEBpZ25vcmUgKi9cbiAgU2F2ZUVycm9yID0gJ1NBVkVfRVJST1InLFxuXG4gIC8vIEZvciByZW1vdGUgcHVzaCBkYXRhIHNvdXJjZXMuXG4gIC8qKiBAaWdub3JlICovXG4gIENsb3NlZCA9ICdDTE9TRUQnLFxuICAvKiogQGlnbm9yZSAqL1xuICBDb25uZWN0aW5nID0gJ0NPTk5FQ1RJTkcnLFxuICAvKiogQGlnbm9yZSAqL1xuICBDb25uZWN0ZWQgPSAnQ09OTkVDVEVEJyxcbiAgLyoqIEBpZ25vcmUgKi9cbiAgQ2xvc2luZyA9ICdDTE9TSU5HJyxcblxuICAvLyBGb3IgY2xpZW50IERTLCB3ZSBkb24ndCBkZWZpbmUgc3RhdHVzLlxufVxuXG4vKipcbiAqIFRoZSBkYXRhIHNvdXJjZSB0eXBlcyB0aGF0IGBqaW11LWNvcmVgIHN1cHBvcnRzLlxuICovXG5leHBvcnQgZW51bSBEYXRhU291cmNlVHlwZXMge1xuICAvKiogQGlnbm9yZSAqL1xuICBTaW1wbGVMb2NhbCA9ICdTSU1QTEVfTE9DQUwnLFxuICAvKiogQGlnbm9yZSAqL1xuICBDU1YgPSAnQ1NWJyxcblxuICAvKipcbiAgICogRmVhdHVyZUxheWVyIGRhdGEgc291cmNlIGlzIGEgYFF1ZXJpYWJsZURhdGFTb3VyY2VgLCB3aGljaCBpcyB1c2VkIHRvIHF1ZXJ5IEFyY0dJUyBmZWF0dXJlIHNlcnZpY2UuXG4gICAqIFNlZSB7QGxpbmsgRmVhdHVyZUxheWVyRGF0YVNvdXJjZX1cbiAgICovXG4gIEZlYXR1cmVMYXllciA9ICdGRUFUVVJFX0xBWUVSJyxcbiAgLyoqXG4gICAqIFNlZSB7QGxpbmsgU2NlbmVMYXllckRhdGFTb3VyY2V9XG4gICAqL1xuICBTY2VuZUxheWVyID0gJ1NDRU5FX0xBWUVSJyxcblxuICAvKiogQGlnbm9yZSBAZGVwcmVjYXRlZCAqL1xuICBGZWF0dXJlUXVlcnkgPSAnRkVBVFVSRV9MQVlFUicsXG5cbiAgRmVhdHVyZVNldCA9ICdGRUFUVVJFX1NFVCcsXG5cbiAgLyoqXG4gICAqIEdyb3VwTGF5ZXIgZGF0YSBzb3VyY2UgaXMgYSBkYXRhIHNvdXJjZSBzZXQgdGhhdCBtYXkgaGF2ZSBjaGlsZCBkYXRhIHNvdXJjZXMuIEl0IGlzIGZyb20gZ3JvdXAgbGF5ZXIgaW4gYSBtYXAgc2VydmljZSBvciBhIHdlYm1hcC93ZWJzY2VuZS5cbiAgICovXG4gIEdyb3VwTGF5ZXIgPSAnR1JPVVBfTEFZRVInLFxuXG4gIC8qKlxuICAgKiBGZWF0dXJlU2VydmljZSBkYXRhIHNvdXJjZSBpcyBhIGRhdGEgc291cmNlIHNldCB0aGF0IG1heSBoYXZlIGNoaWxkIGRhdGEgc291cmNlcy4gSXQgaXMgZnJvbSB0aGUgZmVhdHVyZSBzZXJ2aWNlLlxuICAgKi9cbiAgRmVhdHVyZVNlcnZpY2UgPSAnRkVBVFVSRV9TRVJWSUNFJyxcblxuICAvKipcbiAgICogR3JvdXBMYXllciBkYXRhIHNvdXJjZSBpcyBhIGRhdGEgc291cmNlIHNldCB0aGF0IG1heSBoYXZlIGNoaWxkIGRhdGEgc291cmNlcy4gSXQgaXMgZnJvbSB0aGUgbWFwIHNlcnZpY2UuXG4gICAqL1xuICBNYXBTZXJ2aWNlID0gJ01BUF9TRVJWSUNFJyxcbiAgLyoqXG4gICAqIFNjZW5lTGF5ZXIgZGF0YSBzb3VyY2UgaXMgYSBkYXRhIHNvdXJjZSBzZXQgdGhhdCBtYXkgaGF2ZSBjaGlsZCBkYXRhIHNvdXJjZXMuIEl0IGl0IGZyb20gdGhlIHNjZW5lIHNlcnZpY2UuXG4gICAqL1xuICBTY2VuZVNlcnZpY2UgPSAnU0NFTkVfU0VSVklDRSdcbn1cblxuXG4vKipcbiAqIEZvciBub3csIHdlIG9ubHkgc3VwcG9ydCBzb21lIGxheWVyIHNlcnZpY2UgdHlwZXMuXG4gKi9cbmV4cG9ydCBlbnVtIFN1cHBvcnRlZExheWVyU2VydmljZVR5cGVzIHtcbiAgLy8gc2luZ2xlIGxheWVyIHNlcnZpY2UgdW5kZXIgbWFwIHNlcnZpY2Ugb3IgZmVhdHVyZSBzZXJ2aWNlXG4gIEZlYXR1cmVMYXllciA9ICdGZWF0dXJlIExheWVyJyxcbiAgVGFibGUgPSAnVGFibGUnLFxuICBHcm91cExheWVyID0gJ0dyb3VwIExheWVyJyxcblxuICAvLyBzaW5nbGUgbGF5ZXIgc2VydmljZSB1bmRlciBzY2VuZSBzZXJ2aWNlXG4gIFNjZW5lTGF5ZXJQb2ludCA9ICdQb2ludCcsXG4gIFNjZW5lTGF5ZXIzRE9iamVjdCA9ICczRE9iamVjdCdcbn1cblxuLyoqXG4gKiBGb3Igbm93LCB3ZSBvbmx5IHN1cHBvcnQgc29tZSBzZXJ2aWNlIHR5cGVzLlxuICovXG5leHBvcnQgZW51bSBTdXBwb3J0ZWRTZXJ2aWNlVHlwZXMge1xuICAvLyBbRmVhdHVyZSBTZXJ2aWNlXShodHRwczovL2RldmVsb3BlcnMuYXJjZ2lzLmNvbS9yZXN0L3NlcnZpY2VzLXJlZmVyZW5jZS9mZWF0dXJlLXNlcnZpY2UuaHRtKVxuICBGZWF0dXJlU2VydmljZSA9ICdGZWF0dXJlU2VydmVyJyxcbiAgLy8gW01hcCBTZXJ2aWNlXShodHRwczovL2RldmVsb3BlcnMuYXJjZ2lzLmNvbS9yZXN0L3NlcnZpY2VzLXJlZmVyZW5jZS9ob3N0ZWQtbWFwLXNlcnZpY2UuaHRtKVxuICBNYXBTZXJ2aWNlID0gJ01hcFNlcnZlcicsXG4gIC8vIFtTY2VuZSBTZXJ2aWNlXShodHRwczovL2RldmVsb3BlcnMuYXJjZ2lzLmNvbS9yZXN0L3NlcnZpY2VzLXJlZmVyZW5jZS9zY2VuZS1zZXJ2aWNlLmh0bSlcbiAgU2NlbmVTZXJ2aWNlID0gJ1NjZW5lU2VydmVyJ1xufVxuXG4vKipcbiAqIEZvciBub3csIHdlIG9ubHkgc3VwcG9ydCBzb21lIHBvcnRhbCBpdGVtIHR5cGVzLlxuICogUGxlYXNlIHNlZSBbSXRlbXMgYW5kIGl0ZW0gdHlwZXNdKGh0dHBzOi8vZGV2ZWxvcGVycy5hcmNnaXMuY29tL3Jlc3QvdXNlcnMtZ3JvdXBzLWFuZC1pdGVtcy9pdGVtcy1hbmQtaXRlbS10eXBlcy5odG0pLlxuICovXG5leHBvcnQgZW51bSBTdXBwb3J0ZWRJdGVtVHlwZXMge1xuICBXZWJNYXAgPSAnV2ViIE1hcCcsXG4gIFdlYlNjZW5lID0gJ1dlYiBTY2VuZScsXG4gIEZlYXR1cmVTZXJ2aWNlID0gJ0ZlYXR1cmUgU2VydmljZScsXG4gIE1hcFNlcnZpY2UgPSAnTWFwIFNlcnZpY2UnLFxuICBTY2VuZVNlcnZpY2UgPSAnU2NlbmUgU2VydmljZScsXG4gIEZlYXR1cmVDb2xsZWN0aW9uID0gJ0ZlYXR1cmUgQ29sbGVjdGlvbidcbn1cblxuLyoqXG4gKiBGb3Igbm93LCB3ZSBvbmx5IHN1cHBvcnQgc29tZSBsYXllciB0eXBlcy5cbiAqIFBsZWFzZSBzZWUgW0xheWVyXShodHRwczovL2RldmVsb3BlcnMuYXJjZ2lzLmNvbS9qYXZhc2NyaXB0L2xhdGVzdC9hcGktcmVmZXJlbmNlL2VzcmktbGF5ZXJzLUxheWVyLmh0bWwpLlxuICovXG5leHBvcnQgZW51bSBTdXBwb3J0ZWRMYXllclR5cGVzIHtcbiAgRmVhdHVyZUxheWVyID0gJ2ZlYXR1cmUnLFxuICBNYXBJbWFnZUxheWVyID0gJ21hcC1pbWFnZScsXG4gIFRpbGVMYXllciA9ICd0aWxlJyxcbiAgR3JvdXBMYXllciA9ICdncm91cCcsXG4gIFNjZW5lTGF5ZXIgPSAnc2NlbmUnXG59XG5cbi8qKlxuICogRGF0YSBzb3VyY2UgZmFjdG9yeSBpcyB1c2VkIHRvIGNyZWF0ZSBkYXRhIHNvdXJjZS5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBEYXRhU291cmNlRmFjdG9yeSB7XG4gIGNyZWF0ZURhdGFTb3VyY2U6IChvcHRpb25zOiBEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zKSA9PiBEYXRhU291cmNlO1xufVxuXG4vKipcbiAqIEEgZGF0YSByZWNvcmQgcmVwcmVzZW50cyBhIHJlY29yZCBpbiBhIGRhdGEgc291cmNlLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIERhdGFSZWNvcmQge1xuICAvKiogQSByZWZlcmVuY2Ugb2YgdGhlIGRhdGEgc291cmNlIG9iamVjdCB0aGF0IGhhcyB0aGlzIHJlY29yZC4gKi9cbiAgZGF0YVNvdXJjZTogRGF0YVNvdXJjZTtcblxuICAvKipcbiAgICogVGhlIGRhdGEgaXMgYSBwbGFpbiBvYmplY3QuIFRoZSBmb3JtYXQgaXMge2tleTogdmFsdWV9LCBhbmQgdGhlIGtleSBpcyBcImppbXVGaWVsZE5hbWVcIi5cbiAgICpcbiAgICogVGhlIGRhdGEgYmVmb3JlIG1hcHBpbmcgdXNlIHRoaXMgc2NoZW1hOiB7ZmllbGROYW1lOiB2YWx1ZX0uIFdlIG5lZWQgdG8gcmV0dXJuIHRoaXMgc2NoZW1hOiB7amltdUZpZWxkTmFtZTogdmFsdWV9LlxuICAgKi9cbiAgZ2V0RGF0YTogKCkgPT4gYW55O1xuXG4gIC8qKiBAaWdub3JlICovXG4gIGdldERhdGFCZWZvcmVNYXBwaW5nOiAoKSA9PiBhbnk7XG5cbiAgZ2V0Rm9ybWF0dGVkRGF0YTogKGludGw6IEludGxTaGFwZSkgPT4gYW55O1xuXG4gIGdldEZpZWxkVmFsdWU6IChqaW11RmllbGROYW1lOiBzdHJpbmcpID0+IGFueTtcbiAgZ2V0Rm9ybWF0dGVkRmllbGRWYWx1ZTogKGppbXVGaWVsZE5hbWU6IHN0cmluZywgaW50bDogSW50bFNoYXBlKSA9PiBzdHJpbmc7XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgY29udmVydEJlZm9yZU1hcHBpbmdEYXRhVG9EYXRhOiAoYmVmb3JlTWFwcGluZ0RhdGE6IGFueSkgPT4gYW55O1xuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIGRhdGEgaW4gSlNPTiBmb3JtYXQsIHdoaWNoIGlzIHVzZWQgdG8gc2VyaWFsaXplIGRhdGEsIGFuZCB0aGUga2V5IGlzIFwiamltdUZpZWxkTmFtZVwiLlxuICAgKi9cbiAgdG9Kc29uOiAoKSA9PiBhbnk7XG5cbiAgZ2V0SWQ6ICgpID0+IHN0cmluZztcbiAgc2V0SWQ6IChpZDogc3RyaW5nKSA9PiB2b2lkO1xuXG4gIGdldEdlb21ldHJ5OiAoKSA9PiBJR2VvbWV0cnk7XG5cbn1cblxuLyoqIEBpZ25vcmUgKi9cbmV4cG9ydCBpbnRlcmZhY2UgQXR0YWNobWVudEluZm8gZXh0ZW5kcyBJQXR0YWNobWVudEluZm8ge1xuICB1cmw/OiBzdHJpbmc7XG59XG5cbi8qKiBAaWdub3JlICovXG5leHBvcnQgaW50ZXJmYWNlIEF0dGFjaG1lbnRRdWVyeU9wdGlvbnN7XG4gIGF0dGFjaG1lbnRUeXBlczogc3RyaW5nW107XG4gIHVybDogc3RyaW5nO1xuICBmZWF0dXJlSWQ6IG51bWJlciB8IHN0cmluZztcbn1cblxuLy8gUmVmZXIgdG86IGh0dHBzOi8vZGV2ZWxvcGVycy5hcmNnaXMuY29tL2phdmFzY3JpcHQvbGF0ZXN0L2FwaS1yZWZlcmVuY2UvZXNyaS10YXNrcy1zdXBwb3J0LUZlYXR1cmVTZXQuaHRtbFxuZXhwb3J0IGludGVyZmFjZSBEYXRhUmVjb3JkU2V0e1xuICByZWNvcmRzOiBEYXRhUmVjb3JkW107XG4gIC8vIFRoZSBqaW11RmllbGROYW1lLlxuICBmaWVsZHM/OiBzdHJpbmdbXTtcblxuICAvLyBUaGUgZGF0YSBzb3VyY2UgdGhhdCB0aGUgZGF0YSByZWNvcmQgc2V0IGNvbWVzIGZyb20uXG4gIGRhdGFTb3VyY2U/OiBEYXRhU291cmNlO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFF1ZXJ5UmVzdWx0e1xuICAvLyBUaGUgcXVlcnkgcGFyYW1ldGVycyB0aGF0IGdlbmVyYXRlIHRoZSByZXN1bHQuXG4gIHF1ZXJ5UGFyYW1zOiBJTVF1ZXJ5UGFyYW1zO1xuXG4gIHJlY29yZHM/OiBEYXRhUmVjb3JkW107XG4gIC8vIFRoZSBqaW11RmllbGROYW1lLlxuICBmaWVsZHM/OiBzdHJpbmdbXTtcblxuICBjb3VudD86IG51bWJlcjtcbn1cblxuLyoqXG4gKiBRdWVyeSBzY29wZSBkZWZpbmVzIHdoaWNoIGRhdGEgaXMgcmV0dXJuZWQgd2hlbiB0aGUgcXVlcnkgaXMgZXhlY3V0ZWQgaW4gYWRkaXRpb24gdG8gdGhlIHF1ZXJ5IHBhcmFtZXRlcnMuXG4gKi9cbmV4cG9ydCBlbnVtIFF1ZXJ5U2NvcGV7XG4gIC8qKiBVc2UgdGhlIHF1ZXJ5IHBhcmFtZXRlcnMgZGlyZWN0bHkgdG8gcXVlcnkuICovXG4gIEluQWxsRGF0YSA9ICdJTl9BTExfREFUQScsXG5cbiAgLyoqIFVzZSB0aGUgcXVlcnkgcGFyYW1ldGVycyBhbmQgdGhlIGZpbHRlcnMgY29uZmlndXJlZCBpbiBleGIgdG8gcXVlcnkuICovXG4gIEluUmVtb3RlQ29uZmlnVmlldyA9ICdJTl9SRU1PVEVfQ09ORklHX1ZJRVcnLFxuXG4gIC8qKiBVc2UgdGhlIHF1ZXJ5IHBhcmFtZXRlcnMgYW5kIHRoZSBjb25maWd1cmVkIGZpbHRlcnMgaW4gZGF0YSBzb3VyY2UgYW5kIGZpbHRlcnMgY29uZmlndXJlZCBpbiBleGIgdG8gcXVlcnkuICovXG4gIEluQ29uZmlnVmlldyA9ICdJTl9DT05GSUdfVklFVycsXG5cbiAgLyoqIFVzZSBhbGwgb2YgdGhlIGFwcGxpeWVkIHF1ZXJ5IHBhcmFtZXRlcnMgdG8gcXVlcnkuICovXG4gIEluUnVudGltZVZpZXcgPSAnSU5fUlVOVElNRV9WSUVXJ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFF1ZXJ5T3B0aW9uc3tcbiAgc2NvcGU/OiBRdWVyeVNjb3BlO1xuXG4gIC8qKiBGb3IgbG9hZCBvbmx5LlxuICAgKiAgRm9yIGxvY2FsIGRhdGEgc291cmNlLCB5b3UgY2FuIHVzZSBsb2NhbCBpZCBhcyB3aWRnZXQgaWQuXG4gICAqL1xuICB3aWRnZXRJZD86IHN0cmluZztcblxuICAvKiogRm9yY2UgdGhlIHF1ZXJ5IGV2ZW4gaWYgIHRoZSBxdWVyeSBwYXJhbWV0ZXJzIGhhdmUgbm90IGNoYW5nZWQuICovXG4gIHJlZnJlc2g/OiBib29sZWFuO1xuXG4gIC8qKlxuICAgKiBXaGVuIGV4ZWN1dGUgcXVlcnksIHRoZSBtYXRjaGVkIHF1ZXJ5IGlzIGV4Y2x1ZGVkLlxuICAgKiBWYWxpZCBpbiBydW50aW1lIHNjb3BlIG9ubHkuXG4gICAqL1xuICBleGNsdWRlUXVlcnk/OiBXaWRnZXREYXRhU291cmNlUGFpcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBXaWRnZXREYXRhU291cmNlUGFpcntcbiAgZGF0YVNvdXJjZUlkOiBzdHJpbmc7XG4gIHdpZGdldElkOiBzdHJpbmc7XG59XG5cbi8qKiBUaGUgYmFzZSBxdWVyeSBwYXJhbWV0ZXIgaW50ZXJmYWNlLiAqL1xuZXhwb3J0IGludGVyZmFjZSBRdWVyeVBhcmFtc3tcbiAgLy8gVGhlIGZpcnN0IHBhZ2UgaXMgMSwgbm90IDAuXG4gIHBhZ2U/OiBudW1iZXI7XG5cdHBhZ2VTaXplPzogbnVtYmVyO1xufVxuZXhwb3J0IHR5cGUgSU1RdWVyeVBhcmFtcyA9IEltbXV0YWJsZU9iamVjdDxRdWVyeVBhcmFtcz47XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3FsUXVlcnlQYXJhbXMgZXh0ZW5kcyBRdWVyeVBhcmFtc3tcbiAgd2hlcmU/OiBzdHJpbmc7XG5cdG91dEZpZWxkcz86IHN0cmluZ1tdO1xuXHRvcmRlckJ5RmllbGRzPzogc3RyaW5nW107XG5cdGdyb3VwQnlGaWVsZHNGb3JTdGF0aXN0aWNzPzogc3RyaW5nW107XG59XG5leHBvcnQgdHlwZSBJTVNxbFF1ZXJ5UGFyYW1zID0gSW1tdXRhYmxlT2JqZWN0PFNxbFF1ZXJ5UGFyYW1zPjtcblxuLyoqXG4gKiBRdWVyeSBwYXJhbWV0ZXJzIGZvciBmZWF0dWVyIGxheWVyLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zIGV4dGVuZHMgU3FsUXVlcnlQYXJhbXN7XG5cdG9iamVjdElkcz86IG51bWJlcltdO1xuXHRnZW9tZXRyeT86IEdlb21ldHJ5O1xuXHRyZXR1cm5HZW9tZXRyeT86IGJvb2xlYW47XG5cdGdlb21ldHJ5UHJlY2lzaW9uPzogbnVtYmVyO1xuXHRvdXRTdGF0aXN0aWNzPzogU3RhdGlzdGljRGVmaW5pdGlvbltdO1xuXHRyZXR1cm5aPzogYm9vbGVhbjtcbiAgcmV0dXJuTT86IGJvb2xlYW47XG4gIGdkYlZlcnNpb24/OiBzdHJpbmc7XG5cdHNxbEZvcm1hdD86ICdub25lJyB8ICdzdGFuZGFyZCcgfCAnbmF0aXZlJztcbn1cbmV4cG9ydCB0eXBlIElNRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMgPSBJbW11dGFibGVPYmplY3Q8RmVhdHVyZUxheWVyUXVlcnlQYXJhbXM+O1xuXG5leHBvcnQgaW50ZXJmYWNlIFN0YXRpc3RpY0RlZmluaXRpb257XG5cdHN0YXRpc3RpY1R5cGU6ICdjb3VudCcgfCAnc3VtJyB8ICdtaW4nIHwgJ21heCcgfCAnYXZnJyB8ICdzdGRkZXYnIHwgJ3Zhcic7XG5cdG9uU3RhdGlzdGljRmllbGQ6IHN0cmluZztcblx0b3V0U3RhdGlzdGljRmllbGROYW1lOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgR2VvbWV0cnl7XG4gIHNwYXRpYWxSZWZlcmVuY2U6IFNwYXRpYWxSZWZlcmVuY2U7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3BhdGlhbFJlZmVyZW5jZXtcbiAgd2tpZD86IG51bWJlcjtcbiAgd2t0Pzogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgUGFyZW50RGF0YVNvdXJjZXtcbiAgZ2V0Q2hpbGREYXRhU291cmNlcz86ICgpID0+IERhdGFTb3VyY2VbXTtcblxuICAvKipcbiAgICogR2V0IGNoaWxkIGRhdGEgc291cmNlIGJ5IGBqaW11Q2hpbGRJZGAsIHlvdSBjYW4gZ2V0IGBqaW11Q2hpbGRJZGAgYnkgdXNpbmcgYGdldEppbXVDaGlsZElkKClgLlxuICAgKiBAaWdub3JlXG4gICAqL1xuICBnZXRDaGlsZERhdGFTb3VyY2U/OiAoamltdUNoaWxkSWQ6IHN0cmluZykgPT4gRGF0YVNvdXJjZTtcblxuICAvKipcbiAgICogR2V0IHRoZSBhY3R1YWwgZGF0YSBzb3VyY2UgaWQgYnkgYGppbXVDaGlsZElkYC5cbiAgICogQGlnbm9yZVxuICAgKi9cbiAgZ2V0Q2hpbGREYXRhU291cmNlSWQ/OiAoamltdUNoaWxkSWQ6IHN0cmluZykgPT4gc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgamltdSBjaGlsZCBpZCBpcyBzaW1pbGFyIHRvIHRoZSBqaW11RmllbGROYW1lLCBhbmQgd2lkZ2V0cyBzaG91bGQgdXNlIHRoZSBqaW11Q2hpbGRJZCBpbnN0ZWFkIG9mIHRoZSBjaGlsZElkIHRvIG1ha2UgZGF0YSBtYXBwaW5nIHdvcmsuXG4gICAqL1xuICBnZXRKaW11Q2hpbGRJZD86IChjaGlsZElkOiBzdHJpbmcpID0+IHN0cmluZ1tdO1xufVxuXG5pbnRlcmZhY2UgQ2hpbGREYXRhU291cmNle1xuICAvKipcbiAgICogTnVsbCBtZWFucyBpdCdzIHJvb3QgZGF0YSBzb3VyY2UuXG4gICAqL1xuICBwYXJlbnREYXRhU291cmNlOiBEYXRhU291cmNlO1xuXG4gIGppbXVDaGlsZElkOiBzdHJpbmc7XG5cbiAgZ2V0Um9vdERhdGFTb3VyY2U6ICgpID0+IERhdGFTb3VyY2U7XG59XG5cbmludGVyZmFjZSBEYXRhVmlld09wZXJhdGlvbnN7XG4gIC8qKiBSZXR1cm4gYWxsIGRhdGEgdmlld3MgY3JlYXRlZCBmcm9tIGEgbWFpbiBkYXRhIHNvdXJjZS4gKi9cbiAgZ2V0RGF0YVZpZXdzOiAoKSA9PiBEYXRhU291cmNlW107XG4gIGdldERhdGFWaWV3OiAoZGF0YVZpZXdJZDogc3RyaW5nKSA9PiBEYXRhU291cmNlO1xufVxuXG5pbnRlcmZhY2UgTG9jYWxEYXRhU291cmNlT3BlcmF0aW9uc3tcbiAgLyoqIFJldHVybiBhbGwgbG9jYWwgZGF0YSBzb3VyY2VzIGNyZWF0ZWQgZnJvbSBhIG1haW4gZGF0YSBzb3VyY2Ugb3IgZGF0YSB2aWV3LiAqL1xuICBnZXRMb2NhbERhdGFTb3VyY2VzOiAoKSA9PiBEYXRhU291cmNlW107XG4gIGdldExvY2FsRGF0YVNvdXJjZTogKGxvY2FsSWQ6IHN0cmluZykgPT4gRGF0YVNvdXJjZTtcbn1cblxuLyoqXG4gKiBUaGUgZGF0YSB2aWV3cyB3aWxsIHNoYXJlIHRoZSBzY2hlbWEgb2YgdGhlIG1haW4gZGF0YSBzb3VyY2UgaXQgYmVsb25ncyB0by5cbiAqL1xuaW50ZXJmYWNlIERhdGFWaWV3RGF0YVNvdXJjZXtcbiAgYmVsb25nVG9EYXRhU291cmNlPzogRGF0YVNvdXJjZTtcbiAgZ2V0TWFpbkRhdGFTb3VyY2U6ICgpID0+IERhdGFTb3VyY2U7XG5cbiAgLyoqXG4gICAqIFRoZSBkYXRhIHZpZXcgaWQgY29uZmlndXJlZCBpbiBKc29uLlxuICAgKi9cbiAgZGF0YVZpZXdJZD86IHN0cmluZztcbn1cblxuLyoqXG4gKiBUaGUgaW50ZXJmYWNlIGZvciBhbGwgZGF0YSBzb3VyY2VzLlxuICpcbiAqIENvbmNlcHR1YWxseSwgd2UgaGF2ZSBmb3VyIHR5cGVzIG9mIGRhdGEgc291cmNlcyBidXQgYWxsIG9mIHRoZW0gYXJlIGNyZWF0ZWQgYXMgZGF0YSBzb3VyY2Ugb2JqZWN0OlxuICogKiBNYWluIGRhdGEgc291cmNlOiB0aGUgZGF0YSBzb3VyY2UgdXNlciBhZGRlZCBpbiBkYXRhIHBhbmVsLlxuICogKiBEYXRhIHZpZXc6IHRoZSBkYXRhIHZpZXcgdXNlciBjcmVhdGVkIGluIGRhdGEgcGFuZWwuXG4gKiAqIExvY2FsIGRhdGEgc291cmNlOiB3aGVuIG11bHRpcGxlIHdpZGdldHMgY29ubm5lY3QgdG8gYSBtYWluIGRhdGEgc291cmNlIG9yIGEgZGF0YSB2aWV3LCB0aGV5J2xsIHNoYXJlIHRoZSBzYW1lIGRhdGEgcmVjb3Jkcy4gSWYgeW91IG5lZWQgdG9cbiAqICAgIHVzZSBhIGxvY2FsIGRhdGEgY29weSwgeW91IGNhbiBjcmVhdGUgYSBsb2NhbCBkYXRhIHNvdXJjZSBmcm9tIGEgbWFpbiBkYXRhIHNvdXJjZSBieSB1c2luZyBgRGF0YVNvdXJjZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5jcmVhdGVMb2NhbERhdGFTb3VyY2UoKWAuXG4gKiAqIExvY2FsIGRhdGEgdmlldzogYSBsb2NhbCBkYXRhIHNvdXJjZSBjcmVhdGVkIGZyb20gYSBkYXRhIHZpZXcuXG4gKlxuICogRGF0YSB2aWV3LCBsb2NhbCBkYXRhIHNvdXJjZSBvciBsb2NhbCBkYXRhIHZpZXcgZGVyaXZlZCBmcm9tIHRoZSBzYW1lIG1haW4gZGF0YSBzb3VyY2Ugd2lsbCBzaGFyZSB0aGUgc2FtZSBzY2hlbWEsIHNhbWUgc2VsZWN0aW9uIHJlY29yZHMsIGJ1dCBtYXkgaGF2ZSBkaWZmZXJlbnQgZGF0YSByZWNvcmRzLFxuICogdGhlIHNjaGVtYSBpcyBpbiBtYWluIGRhdGEgc291cmNlIG9ubHkuXG4gKlxuICogVG8gc2hhcmUgdGhlIHNlbGVjdGlvbiBiZXR3ZWVuIGRhdGEgc291cmNlIGFuZCB2aWV3LCB3ZSBjcmVhdGUgYSBzZWxlY3Rpb24gZGF0YSB2aWV3IHdoZW4gY3JlYXRlIHRoZSBkYXRhIHNvdXJjZSwgdGhlIHNlbGVjdGlvbiBkYXRhIHNvdXJjZSB2aWV3IGlkIGlzOiBgJHtkYXRhU291cmNlSWR9LXNlbGVjdGlvbmAuXG4gKiBXaGVuIHNlbGVjdCwgdGhlIHNlbGVjdGVkIHJlY29yZHMgYXJlIGNvcGllZCB0byB0aGUgc2VsZWN0aW9uIGRhdGEgdmlldy5cbiAqXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRGF0YVNvdXJjZSBleHRlbmRzIFBhcmVudERhdGFTb3VyY2UsIENoaWxkRGF0YVNvdXJjZSwgRGF0YVZpZXdEYXRhU291cmNlLCBEYXRhVmlld09wZXJhdGlvbnMsIExvY2FsRGF0YVNvdXJjZU9wZXJhdGlvbnMge1xuICAvKipcbiAgICogVGhlc2UgMyBwcm9wZXJ0aWVzIGFyZSBpbiBhcHAgY29uZmlnLlxuICAgKiBQdXQgdGhlbSBoZXJlIGZvciBlYXNlIG9mIHVzZS5cbiAgICovXG4gIGlkOiBzdHJpbmc7XG4gIHR5cGU6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIGRhdGEgc291cmNlIEpTT04gb2JqZWN0IGluIGFwcCBjb25maWcuXG4gICAqL1xuICBnZXREYXRhU291cmNlSnNvbjogKCkgPT4gSU1EYXRhU291cmNlSnNvbjtcbiAgc2V0RGF0YVNvdXJjZUpzb246IChkc0pzb246IElNRGF0YVNvdXJjZUpzb24pID0+IHZvaWQ7XG4gIGdldExhYmVsOiAoKSA9PiBzdHJpbmc7XG5cbiAgZGF0YVNvdXJjZU1hbmFnZXI6IERhdGFTb3VyY2VNYW5hZ2VyO1xuXG4gIC8qKlxuICAgKiBXaGV0aGVyIGEgZGF0YSBzb3VyY2UgY29udGFpbnMgY2hpbGQgZGF0YSBzb3VyY2VzLlxuICAgKiBBIGRhdGFzZXQgZGF0YSBzb3VyY2Ugc2hvdWxkIGNyZWF0ZSBpdHMgYWxsIGNoaWxkIGRhdGEgc291cmNlcyBiZWZvcmUgcGFyc2luZyBgcmVhZHkoKWAuXG4gICAqL1xuICBpc0RhdGFTb3VyY2VTZXQ6IGJvb2xlYW47XG5cbiAgLyoqXG4gICAqIFRydWUgbWVhbnMgdGhlIGRhdGEgc291cmNlIGlzIGEgZGF0YSB2aWV3LlxuICAgKi9cbiAgaXNEYXRhVmlldzogYm9vbGVhbjtcblxuICAvKipcbiAgICogVHJ1ZSBtZWFucyB0aGUgZGF0YSBzb3VyY2UgaXMgYSBsb2NhbCBkYXRhIHNvdXJjZS5cbiAgICovXG4gIGlzTG9jYWw6IGJvb2xlYW47XG5cbiAgbG9jYWxJZD86IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIGRhdGEgc2NoZW1hIGlzIGluIFwiZGF0YVNvdXJjZUpzb25cIixcbiAgICogICAgKiBGb3IgZGF0YSBzb3VyY2UsIHVzZSBcImppbXVOYW1lXCIgYXMga2V5LCBhbmQgc2F2ZSB0aGUgYWN0dWFsIGZpZWxkIG5hbWUgaW4gdGhlIG9iamVjdC5cbiAgICogICAgKiBGb3IgZGF0YSBzb3VyY2Ugc2V0LCB1c2UgXCJqaW11Q2hpbGRJZFwiIGFzIGtleSwgYW5kIHNhdmUgdGhlIGFjdHVhbCBjaGlsZCBpZCBpbiB0aGUgb2JqZWN0LlxuICAgKiBJbiBtYW55IGNhc2VzLCB3ZSBuZWVkIHRvIHVzZSB0aGUgYWN0dWFsIFwiY2hpbGRJZFwiIG9yIFwiZmllbGROYW1lXCIgdG8gYWNjZXNzIGluZm8sIHNvIHdlIGNhbiB1c2UgdGhpcyBtZXRob2QgdG8gZ2V0IGEgcmV2ZXJzZSBzY2hlbWEgZm9yIGVhc2Ugb2YgdXNlLlxuICAgKi9cbiAgLyoqIEBpZ25vcmUgKi9cbiAgZ2V0UmV2ZXJzZWRDb25maWdTY2hlbWE6ICgpID0+IElNUmV2ZXJzZWREYXRhU291cmNlU2NoZW1hO1xuXG4gIGdldFJlY29yZDogKGluZGV4OiBudW1iZXIpID0+IERhdGFSZWNvcmQ7XG4gIGdldFJlY29yZEJ5SWQ6IChpZDogc3RyaW5nKSA9PiBEYXRhUmVjb3JkO1xuICBnZXRSZWNvcmRzOiAoKSA9PiBEYXRhUmVjb3JkW107XG4gIHNldFJlY29yZHM6IChyZWNvcmRzOiBEYXRhUmVjb3JkW10pID0+IHZvaWQ7XG4gIGdldFNlbGVjdGVkUmVjb3Jkcz86ICgpID0+IERhdGFSZWNvcmRbXTtcbiAgZ2V0U2VsZWN0ZWRSZWNvcmRJbmRleGVzPzogKCkgPT4gbnVtYmVyW107XG4gIGdldFNlbGVjdGVkUmVjb3JkSWRzPzogKCkgPT4gc3RyaW5nW107XG4gIG5leHRSZWNvcmQ/OiAoKSA9PiBEYXRhUmVjb3JkO1xuICBwcmV2UmVjb3JkPzogKCkgPT4gRGF0YVJlY29yZDtcblxuICAvKipcbiAgICogU2VsZWN0IHJlY29yZCBieSBpbmRleC5cbiAgICovXG4gIHNlbGVjdFJlY29yZD86IChpbmRleDogbnVtYmVyKSA9PiB2b2lkO1xuICBzZWxlY3RSZWNvcmRzPzogKGluZGV4ZXM6IG51bWJlcltdKSA9PiB2b2lkO1xuXG4gIC8qKiBUaGUgdG90YWwgcmVjb3JkcyBjb3VudCBkZXBlbmRzIG9uIHRoZSBjdXJyZW50IHF1ZXJ5ICovXG4gIGNvdW50PzogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBKc29uRGF0YSBtYXkgY29tZSBmcm9tIFNTUiwgYW5kIHRoZSBkYXRhIHVzZXMgamltdUZpZWxkTmFtZSBhcyBrZXkuXG4gICAqL1xuICAvKiogQGlnbm9yZSAqL1xuICBzZXRKc29uRGF0YTogKGpzb25EYXRhOiBhbnlbXSkgPT4gdm9pZDtcblxuICAvKipcbiAgICogV2hlbiBzZWxlY3QgcmVjb3JkIGJ5IGlkLCB3ZSBjYW4gcGFzcyBpbiB0aGUgcmVjb3Jkcy4gU28gd2hlbiB0aGUgc2VsZWN0ZWQgcmVjb3JkcyBhcmUgbm90IGluIHRoZSBkYXRhIHNvdXJjZSwgd2UgY2FuIGFkZCB0aGVtIGluLlxuICAgKi9cbiAgc2VsZWN0UmVjb3JkQnlJZD86IChpZDogc3RyaW5nLCByZWNvcmQ/OiBEYXRhUmVjb3JkKSA9PiB2b2lkO1xuICBzZWxlY3RSZWNvcmRzQnlJZHM/OiAoaWRzOiBzdHJpbmdbXSwgcmVjb3Jkcz86IERhdGFSZWNvcmRbXSkgPT4gdm9pZDtcblxuICBjbGVhckRhdGE/OiAoKSA9PiB2b2lkO1xuICBjbGVhclNlbGVjdGlvbj86ICgpID0+IHZvaWQ7XG5cbiAgLyoqXG4gICAqIFRoZSBzY2hlbWEgcmV0dXJuZWQgaGVyZSBpcyB0aGUgbWVyZ2VkIHJlc3VsdCBvZiB0aGUgY29uZmlndXJlZCBzY2hlbWEgYW5kIHRoZSBmZXRjaGVkIHNjaGVtYS5cbiAgICovXG4gIGdldFNjaGVtYTogKCkgPT4gSU1EYXRhU291cmNlU2NoZW1hO1xuICBzZXRTY2hlbWE6IChzY2hlbWE6IElNRGF0YVNvdXJjZVNjaGVtYSkgPT4gdm9pZDtcblxuICAvKipcbiAgICogVGhlIHNjaGVtYSBjb250YWlucyBhbGwgZmllbGRzIGRlZmluZWQgaW4gdGhlIGFjdHVhbCBzZXJ2aWNlLCB0aGlzIG1ldGhvZCB3aWxsIHJldHVybiB0aGUgZmllbGRzXG4gICAqIHVzZXIgY29uZmlndXJlZCBpbiB0aGUgZGF0YSBzb3VyY2UvZGF0YSB2aWV3LlxuICAgKi9cbiAgZ2V0U2VsZWN0ZWRGaWVsZHM6ICgpID0+IHsgW2ppbXVOYW1lOiBzdHJpbmddOiBJTUZpZWxkU2NoZW1hIH07XG5cbiAgLyoqXG4gICAqIEZldGNoIGRhdGEgc2NoZW1hIGZyb20gYW4gYWN0dWFsIGRhdGEgc291cmNlLiBJZiBpdCdzIGEgc3RhdGlzdGljIGRhdGEgc291cmNlLCB3ZSB3b24ndCBmZXRjaCBzY2hlbWEuXG4gICAqL1xuICBmZXRjaFNjaGVtYTogKCkgPT4gUHJvbWlzZTxJTURhdGFTb3VyY2VTY2hlbWE+O1xuXG4gIGdldEZldGNoZWRTY2hlbWE6ICgpID0+IElNRGF0YVNvdXJjZVNjaGVtYTtcbiAgc2V0RmV0Y2hlZFNjaGVtYTogKHNjaGVtYTogSU1EYXRhU291cmNlU2NoZW1hKSA9PiB2b2lkO1xuXG4gIGdldFN0YXR1czogKCkgPT4gRGF0YVNvdXJjZVN0YXR1cztcbiAgc2V0U3RhdHVzPzogKHN0YXR1czogRGF0YVNvdXJjZVN0YXR1cykgPT4gdm9pZDtcblxuICBnZXRDb3VudFN0YXR1czogKCkgPT4gRGF0YVNvdXJjZVN0YXR1cztcbiAgc2V0Q291bnRTdGF0dXM/OiAoc3RhdHVzOiBEYXRhU291cmNlU3RhdHVzKSA9PiB2b2lkO1xuXG4gIGdldFZlcnNpb246ICgpID0+IG51bWJlcjtcbiAgYWRkVmVyc2lvbj86ICgpID0+IHZvaWQ7XG5cbiAgZ2V0SWRGaWVsZDogKCkgPT4gc3RyaW5nO1xuXG4gIGRlc3Ryb3k6ICgpID0+IHZvaWQ7XG5cbiAgLyoqXG4gICAqIFJlYWR5IGlzIHJlc29sdmVkIG1lYW5zIHRoZSBkYXRhIHNvdXJjZSBpbnN0YW5jZSBpcyByZWFkeSBmb3IgdXNlLlxuICAgKi9cbiAgcmVhZHk6ICgpID0+IFByb21pc2U8dm9pZCB8IGFueT47XG5cbiAgZ2V0SW5mbzogKCkgPT4gSU1EYXRhU291cmNlSW5mbztcblxuICAvKipcbiAgICogUmV0dXJuIG51bGwgbWVhbnMgdGhlIGRhdGEgc291cmNlIGlzIGEgbm9uLXNwYXRpYWwgZGF0YSBzb3VyY2UuXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIGdldEdlb21ldHJ5VHlwZTogKCkgPT4gR2VvbWV0cnlUeXBlO1xuXG4gIC8qKlxuICAgKiBGb3IgbW9zdCBvZiB0aGUgd2lkZ2V0IG91dHB1dCBkYXRhIHNvdXJjZSwgaXQgaGFzIGFuIG9yaWdpbmFsIGRhdGEgc291cmNlIGZyb20gd2hpY2ggaXQncyBnZW5lcmF0ZWQuXG4gICAqIEZvciB0aGUgY29uZmlndXJlZCBkYXRhIHNvdXJjZSwgcmV0dXJuIG51bGwuXG4gICAqIEBpZ25vcmVcbiAgICovXG4gIGdldE9yaWdpbkRhdGFTb3VyY2VzPzogKCkgPT4gRGF0YVNvdXJjZVtdO1xuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIGRlcml2ZWQgZGF0YSB2aWV3cyBhbmQgbG9jYWwgZGF0YSBzb3VyY2VzLlxuICAgKi9cbiAgZ2V0QWxsRGVyaXZlZERhdGFTb3VyY2VzOiAoKSA9PiBEYXRhU291cmNlW107XG59XG5cbi8qKlxuICogYFF1ZXJpYWJsZURhdGFTb3VyY2VgIGV4dGVuZHMgYERhdGFTb3VyY2VgIGFuZCBhZGQgcXVlcnkgY2FwYWJpbGl0eS4gQSBxdWVyaWFibGUgZGF0YSBzb3VyY2UgbXVzdFxuICogaGF2ZSBhbiBgVVJMYCB0byBleGVjdXRlIHRoZSBxdWVyeS5cbiAqXG4gKiBUaGUgY3VycmVudCBkZWZhdWx0IHF1ZXJ5IGltcGxlbWVudGF0aW9uIHN1cHBvcnRzIHBhZ2luYXRpb24uIEl0IGFsbG93cyBtdWxpdHBsZSB3aWRnZXRzIHRvIGFwcGx5IHF1ZXJpZXMgb24gdGhlIHNhbWUgZGF0YSBzb3VyY2UsXG4gKiBhbGwgb2Ygd2hpY2ggYXJlIG1lcmdlZCBieSB1c2luZyB0aGUgYEFORGAgbG9naWMgb3BlcmF0b3IuXG4gKlxuICogV2hlbiBleGVjdXRlIGEgcXVlcnksIGluIGFkZGl0aW9uIHRvIHRoZSBwYXNzZWQgaW4gcXVlcnkgcGFyYW1ldGVycywgYWxsIGNvbmZpZ3VyZWQgcXVlcmllcyBhbmRcbiAqIGFsbCBvdGhlciB3aWRnZXRzIGFwcGxpZWQgcXVlcmllcyBhcmUgbWVyZ2VkIGJ5IHVzaW5nIHRoZSBgQU5EYCBsb2dpYyBvcGVyYXRvci5cbiAqXG4gKiBXaGVuIGEgcXVlcnkgaXMgZXhlY3V0ZWQgYWdhaW5zdCBhIGRhdGEgdmlldywgdGhlIHF1ZXJ5IGZyb20gaXRzIG1haW4gZGF0YSBzb3VyY2UgaXMgdXNlZCBhcyB3ZWxsLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIFF1ZXJpYWJsZURhdGFTb3VyY2UgZXh0ZW5kcyBEYXRhU291cmNlIHtcbiAgdXJsOiBzdHJpbmc7XG4gIGxhc3RVcGRhdGVUaW1lOiBEYXRlO1xuXG4gIC8qKlxuICAgKiBFeGVjdXRlIHRoZSBxdWVyeSBhZ2FpbnN0IHRoZSBzZXJ2aWNlIGFuZCB1cGRhdGUgdGhlIGludGVybmFsIGRhdGEgcmVjb3JkcywgcGFnaW5hdGlvbiBpcyBzdXBwb3J0ZWQuXG4gICAqIFdoZW4gY2FsbCB0aGlzIG1ldGhvZCwgdGhlIHJlYWwgcXVlcnkgaXMgcmV0dXJuZCBieSBgZ2V0UmVhbFF1ZXJ5UGFyYW1zYC5cbiAgICpcbiAgICogUGFnaW5hdGlvbjpcbiAgICogVGhlIHBhZ2luYXRpb24gcHJvcGVydGllcyBpbiB0aGUgcGFzc2VkIGluIHF1ZXJ5IHBhcmFtZXRlciBtYXkgYmUgbm90IHRoZSBzYW1lIGFzIHRoZSByZWFsIHF1ZXJ5IHBhZ2luYXRpb24gdGhhdCBpcyBzZW50IHRvIHRoZSBzZXJ2aWNlLlxuICAgKiBUaGUgcmVhbCBxdWVyeSBwYWdpbmF0aW9uIGlzIGRlZmluZWQgaW4gdGhlIGRhdGEgc291cmNlIHNldHRpbmcuXG4gICAqXG4gICAqIEBwYXJhbSBxdWVyeSBpcyB0aGUgd2lkZ2V0J3MgcXVlcnkuXG4gICAqL1xuICBsb2FkKHF1ZXJ5OiBRdWVyeVBhcmFtcywgb3B0aW9ucz86IFF1ZXJ5T3B0aW9ucyk6IFByb21pc2U8RGF0YVJlY29yZFtdPjtcblxuICAvKipcbiAgICogTG9hZCByZWNvcmQgYnkgaWQsIGRvIG5vdCBjb25zaWRlciBvdGhlciBxdWVyaWVzLlxuICAgKiBAcGFyYW0gaWRcbiAgICovXG4gIGxvYWRCeUlkKGlkOiBzdHJpbmcsIHJlZnJlc2g/OiBib29sZWFuKTogUHJvbWlzZTxEYXRhUmVjb3JkPjtcblxuICAvKiogTG9hZCB0aGUgcmVjb3JkcyBjb3VudC4gKi9cbiAgbG9hZENvdW50KHF1ZXJ5OiBRdWVyeVBhcmFtcywgb3B0aW9ucz86IFF1ZXJ5T3B0aW9ucyk6IFByb21pc2U8bnVtYmVyPjtcblxuICAvKipcbiAgICogVXBkYXRlIHRoZSBkYXRhIHNvdXJjZSBxdWVyeSB3aXRob3V0IGV4ZWN1dGluZyB0aGUgYWN0dWFsIHF1ZXJ5LlxuICAgKi9cbiAgdXBkYXRlUXVlcnlQYXJhbXMocXVlcnk6IFF1ZXJ5UGFyYW1zLCB3aWRnZXRJZDogc3RyaW5nKTogdm9pZDtcblxuICAvKipcbiAgICogR2V0IHRoZSBjdXJyZW50IHF1ZXJ5IHBhcmFtZXRlcnMuIFRoZSBjdXJyZW50IHF1ZXJ5IHBhcmFtZXRlcnMgY29udGFpbiBhbGwgYXBwbGllZCBxdWVyaWVzLlxuICAgKi9cbiAgZ2V0Q3VycmVudFF1ZXJ5UGFyYW1zKGV4Y2x1ZGVPcHRpb24/OiBXaWRnZXREYXRhU291cmNlUGFpcik6IFF1ZXJ5UGFyYW1zO1xuICBnZXRDdXJyZW50UXVlcnlJZCgpOiBzdHJpbmc7XG5cbiAgLyoqIEdldCB0aGUgcXVlcmllcyBhcHBsaWVkIGluIHJ1bnRpbWUuIElmIHRoZSBleGNsdWRlV2lkZ2V0SWQgaXMgcGFzc2VkIGluLCB0aGUgcXVlcmllcyBvZiB0aGlzIHdpZGdldCB3aWxsIGJlIGV4Y2x1ZGVkLiovXG4gIGdldFJ1bnRpbWVRdWVyeVBhcmFtcyhleGNsdWRlV2lkZ2V0SWQ/OiBzdHJpbmcpOiBRdWVyeVBhcmFtcztcbiAgLyoqXG4gICAqIEdldCB0aGUgdXNlciBjb25maWcgcXVlcnkgcGFyYW1ldGVycy5cbiAgICovXG4gIGdldENvbmZpZ1F1ZXJ5UGFyYW1zKCk6IFF1ZXJ5UGFyYW1zO1xuXG4gIC8qKiBHZXQgdGhlIHF1ZXJ5IHBhcmFtZXRlcnMgY29uZmlndXJlZCBpbiByZW1vdGUgKG5vdCBpbiBleGIpLiAqL1xuICBnZXRSZW1vdGVRdWVyeVBhcmFtcygpOiBRdWVyeVBhcmFtcztcblxuICAvKipcbiAgICogTWVyZ2UgdGhlIG5ldyBxdWVyeSB0byBiYXNlIHF1ZXJ5IGJ5IHVzaW5nIGBBTkRgLCBhbmQgcmV0dXJuIHRoZSBtZXJnZWQgcmVzdWx0LlxuICAgKiBJZiBhbnkgcXVlcnkgaXMgdW5kZWZpbmVkL251bGwsIGl0IHdpbGwgYmUgaWdub3JlZC5cbiAgICogQHBhcmFtIGJhc2VRdWVyeVxuICAgKiBAcGFyYW0gbmV3UXVlcnlcbiAgICovXG4gIG1lcmdlUXVlcnlQYXJhbXMoYmFzZVF1ZXJ5OiBRdWVyeVBhcmFtcywgbmV3UXVlcnk6IFF1ZXJ5UGFyYW1zKTogUXVlcnlQYXJhbXM7XG5cbiAgLyoqXG4gICAqIFdoZW4gZG8gcXVlcnkvbG9hZCwgd2UgZG8gbm90IGZpcmUgdGhlIHF1ZXJ5IHJlcXVlc3QgZGlyZWN0bHkuIEluc3RlYWQsIHdlJ2xsIGNvbnNpZGVyIHRoZSBkYXRhIHNvdXJjZSdzIGNvbmZpZy9jdXJyZW50IHF1ZXJ5IHBhcmFtZXRlci5cbiAgICogICogRm9yIGxvYWQ6IHdlJ2xsIG1lcmdlIHRoZSBjb25maWd1cmVkIHF1ZXJ5IHBhcmFtZXRlciBpZiBpdCBoYXMsIGFuZCBhbGwgd2lkZ2V0IGFwcGxpZWQgcXVlcmllcy5cbiAgICogICogRm9yIHF1ZXJ5LCB3ZSdsbCBtZXJnZSB0aGUgY3VycmVudCBxdWVyeSBwYXJhbWV0ZXIgYW5kIHRoZSBjb25maWd1cmVkIHF1ZXJ5IHBhcmFtZXRlciBpdCBoYXMuXG4gICAqXG4gICAqIEBwYXJhbSBxdWVyeVxuICAgKiBAcGFyYW0gZmxhZ1xuICAgKiBAcGFyYW0gb3B0aW9uc1xuICAgKi9cbiAgZ2V0UmVhbFF1ZXJ5UGFyYW1zKHF1ZXJ5OiBRdWVyeVBhcmFtcywgZmxhZzogJ3F1ZXJ5JyB8ICdsb2FkJywgb3B0aW9ucz86IFF1ZXJ5T3B0aW9ucyk6IFF1ZXJ5UGFyYW1zO1xuXG4gIC8qKlxuICAgKiBFeGVjdXRlIHF1ZXJ5IGFnYWluc3QgdGhlIHNlcnZpY2Ugb25seSwgZG8gTk9UIHVwZGF0ZSB0aGUgaW50ZXJuYWwgZGF0YSByZWNvcmRzLlxuICAgKiBUaGUgYWN0dXJhbCBxdWVyeSBwYXJhbWV0ZXJzIGFyZSBnZW5lcmF0ZWQgYnkgYGdldFJlYWxRdWVyeVBhcmFtc2AuXG4gICAqXG4gICAqIFRvIHF1ZXJ5IGNvdW50LCBwbGVhc2UgdXNlIGBxdWVyeUNvdW50YC5cbiAgICogQHBhcmFtIHF1ZXJ5XG4gICAqL1xuICBxdWVyeShxdWVyeTogUXVlcnlQYXJhbXMsIG9wdGlvbnM/OiBRdWVyeU9wdGlvbnMpOiBQcm9taXNlPFF1ZXJ5UmVzdWx0PjtcblxuICBxdWVyeUJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8RGF0YVJlY29yZD47XG5cbiAgcXVlcnlDb3VudChxdWVyeTogUXVlcnlQYXJhbXMsIG9wdGlvbnM/OiBRdWVyeU9wdGlvbnMpOiBQcm9taXNlPFF1ZXJ5UmVzdWx0PjtcblxuICAvKipcbiAgICogVGhlIHBhZ2Ugc2l6ZSBoZXJlIGRlZmluZXMgdGhlIHJlY29yZHMgdGhpcyBtZXRob2QgcmV0dXJucywgd2hpY2ggYXJlIG5vdCB0aGUgYWN0dWFsIHF1ZXJ5IHBhZ2VTaXplLiBXaWxsIHVzZSBhIGZpeGVkIHBhZ2VTaXplIHRvIHF1ZXJ5IGFuZCBjYWNoZSBkYXRhLlxuICAgKi9cbiAgZ2V0UmVjb3Jkc0J5UGFnZShwYWdlOiBudW1iZXIsIHBhZ2VTaXplOiBudW1iZXIpOiBEYXRhUmVjb3JkW107XG5cbiAgZ2V0UGFnZXNEYXRhKCk6IHtbcGFnZTogbnVtYmVyXTogRGF0YVJlY29yZFtdfTtcbiAgc2V0UGFnZXNEYXRhKHBhZ2VzOiB7W3BhZ2U6IG51bWJlcl06IERhdGFSZWNvcmRbXX0pOiB2b2lkO1xuXG4gIC8qKlxuICAgKiBHZXQgcmVhbCBxdWVyeSBwYWdlIGRlcGVuZHMgb24gdGhlIHdpZGdldCdzIHJlcXVlc3QgcGFnZS5cbiAgICovXG4gIGdldFJlYWxRdWVyeVBhZ2VzKHBhZ2VTaXplOiBudW1iZXIsIHBhZ2U6IG51bWJlcik6IG51bWJlcltdO1xuXG4gIGdldFF1ZXJ5UGFnZVNpemUoKTogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBOdWxsIG1lYW5zIHRoZXJlIGlzIG5vIHJlY29yZCBjb3VudCBsaW1pdCwgYW5kIHdpbGwgcmV0dXJuIGFsbCByZWNvcmRzIGZyb20gdGhlIHNlcnZpY2UuXG4gICAqL1xuICBnZXRNYXhSZWNvcmRDb3VudCgpOiBudW1iZXI7XG5cbiAgYWRkUmVjb3JkPzogKHJlY29yZDogRGF0YVJlY29yZCkgPT4gUHJvbWlzZTxEYXRhUmVjb3JkPjtcbiAgdXBkYXRlUmVjb3JkPzogKHJlY29yZDogRGF0YVJlY29yZCkgPT4gUHJvbWlzZTxEYXRhUmVjb3JkPjtcbiAgZGVsZXRlUmVjb3JkPzogKGluZGV4OiBudW1iZXIpID0+IFByb21pc2U8dm9pZD47XG5cbiAgLy8gVE9ETyBhZGQvdXBkYXRlL2RlbGV0ZSBtdWx0aXBsZSByZWNvcmRzXG4gIC8qKiBAaWdub3JlICovXG4gIGdldFNhdmVTdGF0dXM6ICgpID0+IERhdGFTb3VyY2VTdGF0dXM7XG4gIC8qKiBAaWdub3JlICovXG4gIHNldFNhdmVTdGF0dXM/OiAoc3RhdHVzOiBEYXRhU291cmNlU3RhdHVzKSA9PiB2b2lkO1xuXG4gIC8qKiBPdmVycmlkZSBwYXJlbnQgaW50ZXJmYWNlIHRvIGdldCBjb3JyZWN0IHR5cGUuICovXG4gIGdldERhdGFWaWV3czogKCkgPT4gUXVlcmlhYmxlRGF0YVNvdXJjZVtdO1xuICBnZXREYXRhVmlldzogKGRhdGFWaWV3SWQ6IHN0cmluZykgPT4gUXVlcmlhYmxlRGF0YVNvdXJjZTtcbiAgZ2V0TWFpbkRhdGFTb3VyY2U6ICgpID0+IFF1ZXJpYWJsZURhdGFTb3VyY2U7XG5cbiAgLyoqIElmIHRoZSByZXR1cm4gdmFsdWUgPiAwLCBhdXRvIHJlZnJlc2ggaXMgZW5hYmxlZC4gKi9cbiAgZ2V0QXV0b1JlZnJlc2hJbnRlcnZhbDogKCkgPT4gbnVtYmVyO1xuICBnZXRMYXN0UmVmcmVzaFRpbWU6ICgpID0+IERhdGU7XG4gIHN0YXJ0QXV0b1JlZnJlc2g6ICgpID0+IHZvaWQ7XG4gIHN0b3BBdXRvUmVmcmVzaDogKCkgPT4gdm9pZDtcbn1cblxuLyoqIEBpZ25vcmUgKi9cbmV4cG9ydCBpbnRlcmZhY2UgTG9hZGFibGVEYXRhU291cmNlIGV4dGVuZHMgRGF0YVNvdXJjZSB7XG4gIHVybDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBMb2FkIGFsbCBkYXRhIHJlY29yZHMuXG4gICAqL1xuICBsb2FkKCk6IFByb21pc2U8RGF0YVJlY29yZFtdPjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIHtcbiAgLyoqIFRoZSBkYXRhIHNvdXJjZSBpZC4gKi9cbiAgaWQ6IHN0cmluZztcblxuICAvKipcbiAgICogZGF0YVNvdXJjZUpzb24gb3IgYmVsb25nVG9EYXRhU291cmNlIGlzIGVpdGhlci1vciBvcHRpb24uXG4gICAqIFBhc3MgZGF0YVNvdXJjZUpzb24gd2lsbCBjcmVhdGUgYSBtYWluIGRhdGEgc291cmNlLlxuICAgKiBQYXNzIGJlbG9uZ1RvRGF0YVNvdXJjZSB3aWxsIGNyZWF0ZSBkYXRhIHZpZXcgb3IgbG9jYWwgZGF0YSBzb3VyY2UuXG4gICAqL1xuICBkYXRhU291cmNlSnNvbj86IElNRGF0YVNvdXJjZUpzb247XG5cbiAgLyoqIERhdGEgc291cmNlIHRoYXQgdGhlIHRvLWJlLWNyZWF0ZWQgZGF0YSBzb3VyY2UgYmVsb25ncyB0by4gKi9cbiAgYmVsb25nVG9EYXRhU291cmNlPzogRGF0YVNvdXJjZTtcblxuICAvKipcbiAgICogSWYgZGF0YVZpZXdJZCBleGlzdHMsIGEgZGF0YSB2aWV3IHdpbGwgYmUgY3JlYXRlZC5cbiAgICovXG4gIGRhdGFWaWV3SWQ/OiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIGlmIGxvY2FsSWQgZXhpc3RzLCBhIGxvY2FsIGRhdGEgc291cmNlIHdpbGwgYmUgY3JlYXRlZC5cbiAgICovXG4gIGxvY2FsSWQ/OiBzdHJpbmc7XG5cbiAgZGF0YVNvdXJjZU1hbmFnZXI/OiBEYXRhU291cmNlTWFuYWdlcjtcblxuICBwYXJlbnREYXRhU291cmNlPzogRGF0YVNvdXJjZTtcbiAgamltdUNoaWxkSWQ/OiBzdHJpbmc7XG59XG5cbi8qKlxuICogQGlnbm9yZVxuICovXG5leHBvcnQgY2xhc3MgRGF0YVNvdXJjZUVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBkYXRhU291cmNlSWQ6IHN0cmluZztcbiAgY29uc3RydWN0b3IoaWQsIG1lc3NhZ2Upe1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgIHRoaXMuZGF0YVNvdXJjZUlkID0gaWQ7XG4gIH1cbn1cblxuLyoqIEBpZ25vcmUgKi9cbmV4cG9ydCBpbnRlcmZhY2UgQ29kZWRWYWx1ZXtcbiAgdmFsdWU6IHN0cmluZyB8IG51bWJlcjtcbiAgbGFiZWw6IHN0cmluZztcbn1cblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogRGF0YSBzb3VyY2VzICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG5leHBvcnQgaW50ZXJmYWNlIEZlYXR1cmVEYXRhUmVjb3JkIGV4dGVuZHMgRGF0YVJlY29yZHtcbiAgZmVhdHVyZTogSUZlYXR1cmUgfCBfX2VzcmkuR3JhcGhpYztcbiAgZGF0YVNvdXJjZTogRmVhdHVyZUxheWVyRGF0YVNvdXJjZSB8IEZlYXR1cmVTZXREYXRhU291cmNlO1xuICBhdHRhY2htZW50SW5mb3M6IEF0dGFjaG1lbnRJbmZvW107XG4gIHF1ZXJ5QXR0YWNobWVudHM6IChhdHRhY2htZW50VHlwZXM/OiBzdHJpbmdbXSkgPT4gUHJvbWlzZTxBdHRhY2htZW50SW5mb1tdPjtcbiAgZ2V0U3ltYm9sUHJldmlld0hUTUw6ICgpID0+IFByb21pc2U8SFRNTEVsZW1lbnQ+O1xuICBnZXREYXRhOiAoKSA9PiB7W2tleTogc3RyaW5nXTogYW55fTtcbiAgZ2V0Rm9ybWF0dGVkRmllbGRWYWx1ZTogKGppbXVGaWVsZE5hbWU6IHN0cmluZywgaW50bDogSW50bFNoYXBlKSA9PiBzdHJpbmc7XG4gIGdldERhdGFCZWZvcmVNYXBwaW5nOiAoKSA9PiB7W2tleTogc3RyaW5nXTogYW55fTtcbiAgZ2V0T3JpZ2luRGF0YTogKCkgPT4ge1trZXk6IHN0cmluZ106IGFueX07XG4gIHRvSnNvbjogKCkgPT4gSUZlYXR1cmUgfCBfX2VzcmkuR3JhcGhpYztcbiAgZ2V0SWQ6ICgpID0+IHN0cmluZztcbiAgc2V0SWQ6IChpZDogc3RyaW5nKSA9PiB2b2lkO1xuICBnZXRHZW9tZXRyeTogKCkgPT4gR2VvbWV0cnk7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2ltcGxlTG9jYWxEYXRhU291cmNlIGV4dGVuZHMgRGF0YVNvdXJjZXtcbiAgdHlwZTogRGF0YVNvdXJjZVR5cGVzLlNpbXBsZUxvY2FsO1xuICB1cGRhdGVBbGxSZWNvcmVkczogKHJlY29yZHM6IERhdGFSZWNvcmRbXSkgPT4gdm9pZDtcbiAgYWRkUmVjb3JkOiAocmVjb3JkOiBEYXRhUmVjb3JkKSA9PiBEYXRhUmVjb3JkO1xuICB1cGRhdGVSZWNvcmQ6IChyZWNvcmQ6IERhdGFSZWNvcmQpID0+IHZvaWQ7XG4gIGRlbGV0ZVJlY29yZDogKGluZGV4OiBudW1iZXIpID0+IHZvaWQ7XG59XG5leHBvcnQgaW50ZXJmYWNlIENzdkRhdGFTb3VyY2UgZXh0ZW5kcyBMb2FkYWJsZURhdGFTb3VyY2V7XG4gIHR5cGU6IERhdGFTb3VyY2VUeXBlcy5DU1Y7XG4gIGRvTG9hZDogKCkgPT4gUHJvbWlzZTxEYXRhUmVjb3JkW10+O1xufVxuXG5pbnRlcmZhY2UgRmVhdHVyZUxheWVyR0RCVmVyc2lvbntcbiAgZ2V0R0RCVmVyc2lvbjogKCkgPT4gc3RyaW5nO1xuICBjaGFuZ2VHREJWZXJzaW9uOiAoZ2RiVmVyc2lvbjogc3RyaW5nKSA9PiB2b2lkO1xufVxuZXhwb3J0IGludGVyZmFjZSBGZWF0dXJlTGF5ZXJEYXRhU291cmNlIGV4dGVuZHMgUXVlcmlhYmxlRGF0YVNvdXJjZSwgRmVhdHVyZUxheWVyR0RCVmVyc2lvbntcbiAgdHlwZTogRGF0YVNvdXJjZVR5cGVzLkZlYXR1cmVMYXllcjtcbiAgdXJsOiBzdHJpbmc7XG4gIGppbXVGZWF0dXJlTGF5ZXJWaWV3cz86IHtbamltdUZlYXR1cmVMYXllclZpZXdJZDogc3RyaW5nXTogSmltdUZlYXR1cmVMYXllclZpZXd9O1xuICBwb3J0YWxVcmw/OiBzdHJpbmc7XG4gIGl0ZW1JZD86IHN0cmluZztcbiAgbGF5ZXJJZD86IHN0cmluZztcbiAgbGF5ZXI/OiBfX2VzcmkuRmVhdHVyZUxheWVyO1xuICBsb2FkKHF1ZXJ5OiBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcywgb3B0aW9ucz86IFF1ZXJ5T3B0aW9ucyk6IFByb21pc2U8RGF0YVJlY29yZFtdPjtcbiAgbG9hZENvdW50KHF1ZXJ5OiBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcywgb3B0aW9ucz86IFF1ZXJ5T3B0aW9ucyk6IFByb21pc2U8bnVtYmVyPjtcbiAgcXVlcnk6IChxdWVyeVByb3BlcnRpZXM6IEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zKSA9PiBQcm9taXNlPFF1ZXJ5UmVzdWx0PjtcbiAgcXVlcnlDb3VudDogKHF1ZXJ5UHJvcGVydGllczogRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMpID0+IFByb21pc2U8UXVlcnlSZXN1bHQ+O1xuICBxdWVyeUJ5SWQ6IChpZDogc3RyaW5nKSA9PiBQcm9taXNlPEZlYXR1cmVEYXRhUmVjb3JkPjtcbiAgc2VsZWN0UmVjb3JkQnlJZDogKGlkOiBzdHJpbmcsIHJlY29yZD86IEZlYXR1cmVEYXRhUmVjb3JkKSA9PiB2b2lkO1xuICBzZWxlY3RSZWNvcmRzQnlJZHM6IChpZHM6IHN0cmluZ1tdLCByZWNvcmRzPzogRmVhdHVyZURhdGFSZWNvcmRbXSkgPT4gdm9pZDtcbiAgZ2V0SWRGaWVsZDogKCkgPT4gc3RyaW5nO1xuICBnZXRHZW9tZXRyeVR5cGU6ICgpID0+IEdlb21ldHJ5VHlwZTtcbiAgc2V0SnNvbkRhdGE6IChkYXRhOiAoSUZlYXR1cmUgfCBfX2VzcmkuR3JhcGhpYylbXSkgPT4gdm9pZDtcbiAgZ2V0Q29uZmlnUXVlcnlQYXJhbXM6ICgpID0+IEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zO1xuICBtZXJnZVF1ZXJ5UGFyYW1zOiAoYmFzZVF1ZXJ5OiBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcywgbmV3UXVlcnk6IEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zKSA9PiBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcztcbiAgZ2V0UmVhbFF1ZXJ5UGFyYW1zOiAocXVlcnksIGZsYWc6ICdxdWVyeScgfCAnbG9hZCcsIG9wdGlvbnM/OiBRdWVyeU9wdGlvbnMpID0+IEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zO1xuICBhZGRSZWNvcmQ6IChyZWNvcmQ6IEZlYXR1cmVEYXRhUmVjb3JkKSA9PiBQcm9taXNlPEZlYXR1cmVEYXRhUmVjb3JkPjtcbiAgZmV0Y2hTY2hlbWE6ICgpID0+IFByb21pc2U8SU1EYXRhU291cmNlU2NoZW1hPjtcbiAgZ2V0TGF5ZXJEZWZpbml0aW9uOiAoKSA9PiBTZXJ2aWNlRGVmaW5pdGlvbjtcbiAgZ2V0RmllbGRDb2RlZFZhbHVlTGlzdDogKGppbXVGaWVsZE5hbWU6IHN0cmluZywgcmVjb3JkPzogRmVhdHVyZURhdGFSZWNvcmQpID0+IENvZGVkVmFsdWVbXTtcbiAgZ2V0Um9vdExheWVyRGF0YVNvdXJjZTogKCkgPT4gRGF0YVNvdXJjZTtcbiAgZ2V0T3JpZ2luYWxEYXRhSWQ6ICgpID0+IHN0cmluZyB8IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGZWF0dXJlU2V0RGF0YVNvdXJjZSBleHRlbmRzIERhdGFTb3VyY2V7XG4gIHR5cGU6IERhdGFTb3VyY2VUeXBlcy5GZWF0dXJlU2V0O1xuICBnZXRJZEZpZWxkOiAoKSA9PiBzdHJpbmc7XG4gIHNldEpzb25EYXRhOiAoZGF0YTogKElGZWF0dXJlIHwgX19lc3JpLkdyYXBoaWMpW10pID0+IHZvaWQ7XG4gIGFkZFJlY29yZDogKHJlY29yZDogRmVhdHVyZURhdGFSZWNvcmQpID0+IHZvaWQ7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgR3JvdXBMYXllckRhdGFTb3VyY2UgZXh0ZW5kcyBEYXRhU291cmNle1xuICB0eXBlOiBEYXRhU291cmNlVHlwZXMuR3JvdXBMYXllcjtcbiAgbGF5ZXI/OiBfX2VzcmkuR3JvdXBMYXllciB8IF9fZXNyaS5TdWJsYXllcjtcbiAgZ2V0U2VydmljZURlZmluaXRpb246ICgpID0+IFNlcnZpY2VEZWZpbml0aW9uO1xuICBnZXRPcmlnaW5hbERhdGFJZDogKCkgPT4gc3RyaW5nIHwgbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZlYXR1cmVTZXJ2aWNlRGF0YVNvdXJjZSBleHRlbmRzIERhdGFTb3VyY2V7XG4gIHR5cGU6IERhdGFTb3VyY2VUeXBlcy5GZWF0dXJlU2VydmljZTtcbiAgZ2V0U2VydmljZURlZmluaXRpb246ICgpID0+IFNlcnZpY2VEZWZpbml0aW9uO1xuICBnZXRPcmlnaW5hbERhdGFJZDogKCkgPT4gc3RyaW5nIHwgbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIE1hcFNlcnZpY2VEYXRhU291cmNlIGV4dGVuZHMgRGF0YVNvdXJjZXtcbiAgdHlwZTogRGF0YVNvdXJjZVR5cGVzLk1hcFNlcnZpY2U7XG4gIGxheWVyPzogX19lc3JpLk1hcEltYWdlTGF5ZXIgfCBfX2VzcmkuVGlsZUxheWVyO1xuICBnZXRTZXJ2aWNlRGVmaW5pdGlvbjogKCkgPT4gU2VydmljZURlZmluaXRpb247XG4gIGdldE9yaWdpbmFsRGF0YUlkOiAoKSA9PiBzdHJpbmcgfCBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2NlbmVTZXJ2aWNlRGF0YVNvdXJjZSBleHRlbmRzIERhdGFTb3VyY2V7XG4gIHR5cGU6IERhdGFTb3VyY2VUeXBlcy5TY2VuZVNlcnZpY2U7XG4gIGdldFNlcnZpY2VEZWZpbml0aW9uOiAoKSA9PiBTZXJ2aWNlRGVmaW5pdGlvbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTY2VuZUxheWVyRGF0YVNvdXJjZSBleHRlbmRzIE9taXQ8RmVhdHVyZUxheWVyRGF0YVNvdXJjZSwgJ3R5cGUnIHwgJ2xheWVyJyB8ICdnZXRSb290TGF5ZXJEYXRhU291cmNlJyB8ICdnZXRPcmlnaW5hbERhdGFJZCc+e1xuICB0eXBlOiBEYXRhU291cmNlVHlwZXMuU2NlbmVMYXllcjtcbiAgbGF5ZXI/OiBfX2VzcmkuU2NlbmVMYXllcjtcbn1cblxuLyoqXG4gKiBAaWdub3JlXG4gKiBAZGVwcmVjYXRlZFxuICovXG5leHBvcnQgaW50ZXJmYWNlIEZlYXR1cmVRdWVyeURhdGFTb3VyY2UgZXh0ZW5kcyBGZWF0dXJlTGF5ZXJEYXRhU291cmNle31cblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogRGF0YSBzb3VyY2VzICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBTUE7Ozs7Ozs7OztBQVNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7OztBQUdBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBRUE7O0FBRUE7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBR0E7O0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7OztBQUdBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7OztBQUdBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQStFQTs7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUF1Y0E7O0FBRUE7QUFDQTtBQUFBO0FBRUE7QUFBQTtBQUVBOztBQUNBO0FBQ0E7QUFBQTs7QUFrSEE7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./jimu-core/lib/data-sources/data-source-interface.ts\n");

/***/ }),

/***/ "./jimu-core/lib/data-sources/ds-base-types/abstract-data-source.ts":
/*!**************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/ds-base-types/abstract-data-source.ts ***!
  \**************************************************************************/
/*! exports provided: AbstractDataSource */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AbstractDataSource\", function() { return AbstractDataSource; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var jimu_core_lib_constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jimu-core/lib/constants */ \"./jimu-core/lib/constants.ts\");\n\n\n/**\n * Include the common implementations for datasource.\n */\nvar AbstractDataSource = /** @class */ (function () {\n    function AbstractDataSource(options) {\n        this.isDataSourceSet = false;\n        this.records = [];\n        Object.assign(this, options);\n        if (options.dataSourceJson) { // main data source\n            this.isDataView = false;\n            this.isLocal = false;\n        }\n        else {\n            if (!options.belongToDataSource) {\n                console.error('bad DataSourceConstructorOptions.');\n                return;\n            }\n            if (options.localId) {\n                this.isLocal = true;\n                this.isDataView = false;\n            }\n            else {\n                this.isLocal = false;\n                this.isDataView = true;\n            }\n        }\n    }\n    AbstractDataSource.prototype.getLabel = function () {\n        var mainDataSourceLabel = this.getDataSourceJson().label || this.getSchema().label;\n        if (this.isLocal) {\n            return this.belongToDataSource.getLabel();\n        }\n        if (this.isDataView) {\n            var mainDsJson = this.getMainDataSource().getDataSourceJson();\n            var dataViewJson = (mainDsJson === null || mainDsJson === void 0 ? void 0 : mainDsJson.dataViews) && mainDsJson.dataViews[this.dataViewId];\n            return (dataViewJson === null || dataViewJson === void 0 ? void 0 : dataViewJson.label) || mainDataSourceLabel;\n        }\n        return mainDataSourceLabel;\n    };\n    AbstractDataSource.prototype.getDataSourceJson = function () {\n        if (this.isDataView || this.isLocal) {\n            return this.getMainDataSource().getDataSourceJson();\n        }\n        return this.dataSourceJson;\n    };\n    AbstractDataSource.prototype.setDataSourceJson = function (dsJson) {\n        if (!dsJson) {\n            return;\n        }\n        if (this.dataSourceJson) {\n            this.dataSourceJson = this.dataSourceJson.merge(dsJson.asMutable({ deep: true }));\n        }\n        else {\n            this.dataSourceJson = dsJson;\n        }\n    };\n    AbstractDataSource.prototype.getSchema = function () {\n        // data view does not have schema\n        if (this.isDataView || this.isLocal) {\n            return this.getMainDataSource().getSchema();\n        }\n        return this.schema || {};\n    };\n    AbstractDataSource.prototype.getSelectedFields = function () {\n        var _a;\n        var _b, _c;\n        var outFields;\n        if (this.isLocal) {\n            return this.belongToDataSource.getSelectedFields();\n        }\n        if (this.isDataView) {\n            outFields = (_b = this.getDataSourceJson().dataViews[this.dataViewId]) === null || _b === void 0 ? void 0 : _b.outFields;\n        }\n        else {\n            outFields = (_c = this.getDataSourceJson().query) === null || _c === void 0 ? void 0 : _c.outFields;\n        }\n        if (!outFields) {\n            return this.getSchema().fields;\n        }\n        var toBeRemoved = Object.keys(this.getSchema().fields).filter(function (fName) { return outFields.indexOf(fName) < 0; });\n        return (_a = this.getSchema().fields).without.apply(_a, toBeRemoved);\n    };\n    AbstractDataSource.prototype.setSchema = function (schema) {\n        this.schema = schema;\n    };\n    AbstractDataSource.prototype.fetchSchema = function () {\n        return Promise.resolve(Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])({}));\n    };\n    AbstractDataSource.prototype.getFetchedSchema = function () {\n        if (this.isDataView || this.isLocal) {\n            return this.getMainDataSource().getFetchedSchema();\n        }\n        return this.fetchedSchema;\n    };\n    AbstractDataSource.prototype.setFetchedSchema = function (fetchedSchema) {\n        this.fetchedSchema = fetchedSchema;\n    };\n    AbstractDataSource.prototype.getGeometryType = function () {\n        return null;\n    };\n    /** @ignore */\n    AbstractDataSource.prototype.getReversedConfigSchema = function () {\n        var _this = this;\n        if (this.isDataView || this.isLocal) {\n            return this.getMainDataSource().getReversedConfigSchema();\n        }\n        if (this.reverseSchema) {\n            return this.reverseSchema;\n        }\n        if (this.isDataSourceSet) {\n            var schema_1 = this.getDataSourceJson().schema;\n            var rSchema_1 = { childSchemas: {} };\n            if (!schema_1) {\n                return Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])({});\n            }\n            if (!schema_1.childSchemas) {\n                return Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])({\n                    label: schema_1.label,\n                    childId: schema_1.childId,\n                    jimuChildId: schema_1.jimuChildId,\n                });\n            }\n            Object.keys(schema_1.childSchemas).forEach(function (jimuChildId) {\n                var actualChildId = schema_1.childSchemas[jimuChildId].childId;\n                if (rSchema_1.childSchemas[actualChildId]) {\n                    rSchema_1.childSchemas[actualChildId].push(_this.getOneReversedConfigSchema(schema_1.childSchemas[jimuChildId]));\n                }\n                else {\n                    rSchema_1.childSchemas[actualChildId] = [_this.getOneReversedConfigSchema(schema_1.childSchemas[jimuChildId])];\n                }\n            });\n            this.reverseSchema = Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])(rSchema_1);\n        }\n        else {\n            this.reverseSchema = this.getOneReversedConfigSchema(this.getDataSourceJson().schema);\n        }\n        return this.reverseSchema;\n    };\n    AbstractDataSource.prototype.setRecords = function (records) {\n        this.records = records;\n        this.addVersion();\n    };\n    AbstractDataSource.prototype.setJsonData = function (data) {\n        console.error('please implement this. setJsonData');\n    };\n    /**\n     * @param schema\n     */\n    AbstractDataSource.prototype.getOneReversedConfigSchema = function (schema) {\n        var reversedSchema = {};\n        if (!schema) {\n            return Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])(reversedSchema);\n        }\n        reversedSchema.fields = {};\n        Object.keys(schema.fields).forEach(function (jimuName) {\n            var field = schema.fields[jimuName].asMutable({ deep: true });\n            if (reversedSchema.fields[field.name]) {\n                (reversedSchema.fields[field.name]).push(field);\n            }\n            else {\n                (reversedSchema.fields[field.name]) = [field];\n            }\n        });\n        schema.childId && (reversedSchema.childId = schema.childId);\n        schema.jimuChildId && (reversedSchema.jimuChildId = schema.jimuChildId);\n        return Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])(reversedSchema);\n    };\n    AbstractDataSource.prototype.getStatus = function () {\n        return Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[this.id] && Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[this.id].status;\n    };\n    AbstractDataSource.prototype.setStatus = function (status) {\n        Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].dataSourceStatusChanged(this.id, status));\n    };\n    AbstractDataSource.prototype.getCountStatus = function () {\n        return Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[this.id] && Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[this.id].countStatus;\n    };\n    AbstractDataSource.prototype.setCountStatus = function (status) {\n        Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].dataSourceCountStatusChanged(this.id, status));\n    };\n    AbstractDataSource.prototype.getVersion = function () {\n        var _a;\n        return (_a = Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[this.id]) === null || _a === void 0 ? void 0 : _a.version;\n    };\n    AbstractDataSource.prototype.addVersion = function () {\n        Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].dataSourceVersionAdded(this.id));\n    };\n    AbstractDataSource.prototype.getRecords = function () {\n        return this.records;\n    };\n    AbstractDataSource.prototype.getSelectionDataView = function () {\n        var mainDsId = (this.isDataView || this.isLocal) ? this.getMainDataSource().id : this.id;\n        var selectionDv = this.dataSourceManager.getDataViewDataSource(mainDsId, jimu_core_lib_constants__WEBPACK_IMPORTED_MODULE_1__[\"SELECTION_DATA_VIEW_ID\"]);\n        return selectionDv;\n    };\n    AbstractDataSource.prototype.getSelectedRecords = function () {\n        var selectionDv = this.getSelectionDataView();\n        return selectionDv ? selectionDv.getRecords() : [];\n        // const dsInfo = getAppStore().getState().dataSourcesInfo[this.id];\n        // if (dsInfo.selectedIndexes) { // select by index, get records from main ds.\n        //   //we use .asMutable() here, because the .map() in SeamlessImmutable will remove mutable properties.\n        //   return dsInfo.selectedIndexes.asMutable().map(index => this.getRecords()[index]).filter(r => r);\n        // } else if (dsInfo.selectedIds) { // select by id, get records from selection dv\n        //   return dsInfo.selectedIds.asMutable().map(id => this.getRecordById(id)).filter(r => r);\n        // } else {\n        //   return [];\n        // }\n    };\n    AbstractDataSource.prototype.getSelectedRecordIndexes = function () {\n        var _this = this;\n        if (!Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[this.id]) {\n            return [];\n        }\n        var dsId = (this.isDataView || this.isLocal) ? this.getMainDataSource().id : this.id;\n        if (Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[dsId].selectedIndexes) {\n            //we use .asMutable() here, because the .map() in SeamlessImmutable will remove mutable properties.\n            return Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[dsId].selectedIndexes.asMutable();\n        }\n        else if (Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[dsId].selectedIds) {\n            return Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[dsId].selectedIds.asMutable().map(function (id) {\n                //we don't care the type here\n                return _this.getRecords().findIndex(function (record) { return record.getId() == id; });\n            });\n        }\n        else {\n            return [];\n        }\n    };\n    AbstractDataSource.prototype.getSelectedRecordIds = function () {\n        var _this = this;\n        var dsId = (this.isDataView || this.isLocal) ? this.getMainDataSource().id : this.id;\n        if (!Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[dsId]) {\n            return [];\n        }\n        if (Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[dsId].selectedIds) {\n            return Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[dsId].selectedIds.asMutable();\n        }\n        else if (Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[dsId].selectedIndexes) {\n            return Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[dsId].selectedIndexes.asMutable().map(function (index) { return _this.getRecords()[index].getId(); });\n        }\n        else {\n            return [];\n        }\n    };\n    AbstractDataSource.prototype.nextRecord = function () {\n        if (this.getSelectedRecordIndexes().length > 1) {\n            console.warn('method \"nextRecord\" only works when single record is selected');\n            return null;\n        }\n        if (this.getSelectedRecordIndexes().indexOf(this.getRecords().length - 1)) {\n            throw Error('Reach the end of data.');\n        }\n        Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].dataSourceSelectedIndexesChanged(this.id, [this.getSelectedRecordIndexes()[0]++]));\n        return this.getSelectedRecords()[0];\n    };\n    AbstractDataSource.prototype.prevRecord = function () {\n        if (this.getSelectedRecordIndexes().length > 1) {\n            console.warn('method \"prevRecord\" only works when single record is selected');\n            return null;\n        }\n        if (this.getSelectedRecordIndexes().indexOf(0)) {\n            throw Error('Reach the start of data.');\n        }\n        Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].dataSourceSelectedIndexesChanged(this.id, [this.getSelectedRecordIndexes()[0]--]));\n        return this.getSelectedRecords()[0];\n    };\n    AbstractDataSource.prototype.getRecord = function (index) {\n        return this.getRecords()[index];\n    };\n    AbstractDataSource.prototype.getRecordById = function (id) {\n        return this.getRecords().filter(function (record) { return record && record.getId() === id; })[0];\n    };\n    AbstractDataSource.prototype.clearSelection = function () {\n        var _this = this;\n        this.clearOneDsSelection(this.getMainDataSource());\n        this.getMainDataSource().getAllDerivedDataSources().forEach(function (ds) { return _this.clearOneDsSelection(ds); });\n    };\n    AbstractDataSource.prototype.clearOneDsSelection = function (ds) {\n        Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].dataSourceSelectedIndexesChanged(ds.id, null));\n        Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].dataSourceSelectedIdsChanged(ds.id, null));\n        if (ds === this.getMainDataSource()) {\n            jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"jimuHistory\"].changeQueryObjectByDataRecordIds(ds.id, null);\n            jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"jimuHistory\"].changeQueryObjectByDataRecordIndexes(ds.id, null);\n            this.copySelectionToDataView([]);\n        }\n    };\n    AbstractDataSource.prototype.updateSelectionStateAndChangeUrl = function (selectionType, values) {\n        var _this = this;\n        var mainDs = this.getMainDataSource();\n        if (selectionType === 'byIndex') {\n            Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].dataSourceSelectedIndexesChanged(this.id, values));\n            mainDs.getAllDerivedDataSources().forEach(function (ds) {\n                if (ds.id === _this.dataSourceManager.getDataViewDataSourceId(mainDs.id, jimu_core_lib_constants__WEBPACK_IMPORTED_MODULE_1__[\"SELECTION_DATA_VIEW_ID\"]) ||\n                    ds.id === _this.dataSourceManager.getDataViewDataSourceId(mainDs.id, jimu_core_lib_constants__WEBPACK_IMPORTED_MODULE_1__[\"DATA_VIEW_ID_FOR_NO_SELECTION\"])) {\n                    return;\n                }\n                if (ds.id !== _this.id) { // for other dv/local, change index to id\n                    var ids = values.map(function (i) { return _this.getRecord(i) && _this.getRecord(i).getId(); });\n                    Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].dataSourceSelectedIdsChanged(ds.id, ids));\n                }\n            });\n            if (this === mainDs) {\n                jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"jimuHistory\"].changeQueryObjectByDataRecordIndexes(this.id, values);\n            }\n            else {\n                var ids = values.map(function (i) { return _this.getRecord(i) && _this.getRecord(i).getId(); });\n                Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].dataSourceSelectedIdsChanged(mainDs.id, ids));\n                jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"jimuHistory\"].changeQueryObjectByDataRecordIds(mainDs.id, ids);\n            }\n        }\n        else if (selectionType === 'byId') {\n            mainDs.getAllDerivedDataSources().forEach(function (ds) {\n                if (ds.id === _this.dataSourceManager.getDataViewDataSourceId(mainDs.id, jimu_core_lib_constants__WEBPACK_IMPORTED_MODULE_1__[\"SELECTION_DATA_VIEW_ID\"]) ||\n                    ds.id === _this.dataSourceManager.getDataViewDataSourceId(mainDs.id, jimu_core_lib_constants__WEBPACK_IMPORTED_MODULE_1__[\"DATA_VIEW_ID_FOR_NO_SELECTION\"])) {\n                    return;\n                }\n                Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].dataSourceSelectedIdsChanged(ds.id, values));\n            });\n            Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].dataSourceSelectedIdsChanged(mainDs.id, values));\n            jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"jimuHistory\"].changeQueryObjectByDataRecordIds(mainDs.id, values);\n        }\n    };\n    AbstractDataSource.prototype.selectRecord = function (index) {\n        this.copySelectionToDataView([this.getRecord(index)]);\n        this.updateSelectionStateAndChangeUrl('byIndex', [index]);\n    };\n    AbstractDataSource.prototype.selectRecords = function (indexes) {\n        var _this = this;\n        this.copySelectionToDataView(indexes.map(function (i) { return _this.getRecord(i); }));\n        this.updateSelectionStateAndChangeUrl('byIndex', indexes);\n    };\n    AbstractDataSource.prototype.selectRecordById = function (id, record) {\n        if (this.getSelectedRecordIds().find(function (_id) { return _id === id; })) {\n            return;\n        }\n        var selectRecord = record || id && this.getRecordById(id);\n        this.copySelectionToDataView([selectRecord]);\n        this.updateSelectionStateAndChangeUrl('byId', [id]);\n    };\n    AbstractDataSource.prototype.selectRecordsByIds = function (ids, records) {\n        var _this = this;\n        var selectRecords = records || ids.map(function (id) { return _this.getRecordById(id); });\n        this.copySelectionToDataView(selectRecords);\n        this.updateSelectionStateAndChangeUrl('byId', ids);\n    };\n    /**\n     *\n     * @param selection\n     */\n    AbstractDataSource.prototype.copySelectionToDataView = function (selection) {\n        var selectionDv = this.getSelectionDataView();\n        if (!selectionDv) {\n            return;\n        }\n        selectionDv.setRecords(selection.filter(function (r) { return !!r; }));\n    };\n    AbstractDataSource.prototype.getInfo = function () {\n        return Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[this.id] || {};\n    };\n    AbstractDataSource.prototype.clearData = function () {\n        this.selectRecords([]);\n        this.records = [];\n        this.addVersion();\n    };\n    AbstractDataSource.prototype.getIdField = function () {\n        return this.getSchema() && this.getSchema().idField || 'id';\n    };\n    AbstractDataSource.prototype.getRootDataSource = function () {\n        if (this.isDataView || this.isLocal) {\n            return this.getMainDataSource().getRootDataSource();\n        }\n        var rootDs = this.parentDataSource;\n        while (rootDs && rootDs.parentDataSource) {\n            rootDs = rootDs.parentDataSource;\n        }\n        return rootDs;\n    };\n    AbstractDataSource.prototype.ready = function () {\n        return Promise.resolve({});\n    };\n    AbstractDataSource.prototype.getOriginDataSources = function () {\n        var _this = this;\n        if (this.isDataView || this.isLocal) {\n            return this.getMainDataSource().getOriginDataSources();\n        }\n        if (!this.getDataSourceJson().originDataSources || this.getDataSourceJson().originDataSources.length === 0) {\n            return [];\n        }\n        return this.getDataSourceJson().originDataSources.asMutable().map(function (useDs) { return _this.dataSourceManager.getDataSource(useDs.dataSourceId); });\n    };\n    AbstractDataSource.prototype.getMainDataSource = function () {\n        var _a;\n        if (this.belongToDataSource) {\n            return (_a = this.belongToDataSource.belongToDataSource) !== null && _a !== void 0 ? _a : this.belongToDataSource;\n        }\n        else {\n            return this;\n        }\n    };\n    AbstractDataSource.prototype.getDataViews = function () {\n        var _this = this;\n        if (this.getMainDataSource() !== this) {\n            return [];\n        }\n        else {\n            return this.dataSourceManager.getDataSourcesAsArray().filter(function (ds) { return ds.belongToDataSource === _this && ds.isDataView; });\n        }\n    };\n    AbstractDataSource.prototype.getDataView = function (dataViewId) {\n        return this.getDataViews().find(function (dv) { return dv.dataViewId === dataViewId; });\n    };\n    AbstractDataSource.prototype.getLocalDataSources = function () {\n        var _this = this;\n        if (this.isLocal) {\n            return [];\n        }\n        else {\n            return this.dataSourceManager.getDataSourcesAsArray().filter(function (ds) { return ds.belongToDataSource === _this && ds.isLocal; });\n        }\n    };\n    AbstractDataSource.prototype.getLocalDataSource = function (localId) {\n        return this.getLocalDataSources().find(function (dv) { return dv.localId === localId; });\n    };\n    AbstractDataSource.prototype.getAllDerivedDataSources = function () {\n        var dss = [];\n        var dvs = this.getDataViews();\n        var locals = this.getLocalDataSources();\n        dss = dvs.concat(locals);\n        dvs.forEach(function (dv) {\n            dss = dss.concat(dv.getLocalDataSources());\n        });\n        return dss;\n    };\n    AbstractDataSource.prototype.destroy = function () { };\n    return AbstractDataSource;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9kcy1iYXNlLXR5cGVzL2Fic3RyYWN0LWRhdGEtc291cmNlLnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vamltdS1jb3JlL2xpYi9kYXRhLXNvdXJjZXMvZHMtYmFzZS10eXBlcy9hYnN0cmFjdC1kYXRhLXNvdXJjZS50cz9lZjBjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERhdGFTb3VyY2VNYW5hZ2VyLCBnZXRBcHBTdG9yZSwgamltdUhpc3RvcnksIElNRGF0YVNvdXJjZUpzb24sIElNRGF0YVNvdXJjZVNjaGVtYSwgSU1SZXZlcnNlZERhdGFTb3VyY2VTY2hlbWEsIFJldmVyc2VkRGF0YVNvdXJjZVNjaGVtYSwgSU1EYXRhU291cmNlSW5mbywgSW1tdXRhYmxlLFxuICBhcHBBY3Rpb25zLCBJTUZpZWxkU2NoZW1hIH0gZnJvbSAnamltdS1jb3JlJztcbmltcG9ydCB7IEdlb21ldHJ5VHlwZSB9IGZyb20gJ0Blc3JpL2FyY2dpcy1yZXN0LXR5cGVzJztcbmltcG9ydCB7IERhdGFTb3VyY2UsIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMsIERhdGFSZWNvcmQsIERhdGFTb3VyY2VTdGF0dXMgfSBmcm9tICcuLi9kYXRhLXNvdXJjZS1pbnRlcmZhY2UnO1xuaW1wb3J0IHsgU0VMRUNUSU9OX0RBVEFfVklFV19JRCwgREFUQV9WSUVXX0lEX0ZPUl9OT19TRUxFQ1RJT04gfSBmcm9tICdqaW11LWNvcmUvbGliL2NvbnN0YW50cyc7XG5cbi8qKlxuICogSW5jbHVkZSB0aGUgY29tbW9uIGltcGxlbWVudGF0aW9ucyBmb3IgZGF0YXNvdXJjZS5cbiAqL1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEFic3RyYWN0RGF0YVNvdXJjZSBpbXBsZW1lbnRzIERhdGFTb3VyY2Uge1xuICBpZDogc3RyaW5nO1xuICB0eXBlOiBzdHJpbmc7XG4gIGRhdGFWaWV3SWQ6IHN0cmluZztcbiAgbG9jYWxJZDogc3RyaW5nO1xuXG4gIHByaXZhdGUgZmV0Y2hlZFNjaGVtYTogSU1EYXRhU291cmNlU2NoZW1hO1xuICBwcml2YXRlIHNjaGVtYTogSU1EYXRhU291cmNlU2NoZW1hO1xuICBwcml2YXRlIHJldmVyc2VTY2hlbWE6IElNUmV2ZXJzZWREYXRhU291cmNlU2NoZW1hO1xuXG4gIHByaXZhdGUgZGF0YVNvdXJjZUpzb246IElNRGF0YVNvdXJjZUpzb247XG5cbiAgaXNEYXRhVmlldzogYm9vbGVhbjtcbiAgYmVsb25nVG9EYXRhU291cmNlOiBEYXRhU291cmNlO1xuICBpc0xvY2FsOiBib29sZWFuO1xuXG4gIGRhdGFTb3VyY2VNYW5hZ2VyOiBEYXRhU291cmNlTWFuYWdlcjtcbiAgaXNEYXRhU291cmNlU2V0OiBib29sZWFuID0gZmFsc2U7XG5cbiAgcGFyZW50RGF0YVNvdXJjZTogRGF0YVNvdXJjZTtcbiAgamltdUNoaWxkSWQ6IHN0cmluZztcblxuICBwcm90ZWN0ZWQgcmVjb3JkczogRGF0YVJlY29yZFtdID0gW107XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucykge1xuICAgIE9iamVjdC5hc3NpZ24odGhpcywgb3B0aW9ucyk7XG5cbiAgICBpZihvcHRpb25zLmRhdGFTb3VyY2VKc29uKXsgLy8gbWFpbiBkYXRhIHNvdXJjZVxuICAgICAgdGhpcy5pc0RhdGFWaWV3ID0gZmFsc2U7XG4gICAgICB0aGlzLmlzTG9jYWwgPSBmYWxzZTtcbiAgICB9ZWxzZXtcbiAgICAgIGlmKCFvcHRpb25zLmJlbG9uZ1RvRGF0YVNvdXJjZSl7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ2JhZCBEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zLicpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmKG9wdGlvbnMubG9jYWxJZCl7XG4gICAgICAgIHRoaXMuaXNMb2NhbCA9IHRydWU7XG4gICAgICAgIHRoaXMuaXNEYXRhVmlldyA9IGZhbHNlO1xuICAgICAgfWVsc2V7XG4gICAgICAgIHRoaXMuaXNMb2NhbCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmlzRGF0YVZpZXcgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGdldExhYmVsKCk6IHN0cmluZ3tcbiAgICBjb25zdCBtYWluRGF0YVNvdXJjZUxhYmVsID0gdGhpcy5nZXREYXRhU291cmNlSnNvbigpLmxhYmVsIHx8IHRoaXMuZ2V0U2NoZW1hKCkubGFiZWw7XG4gICAgaWYodGhpcy5pc0xvY2FsKXtcbiAgICAgIHJldHVybiB0aGlzLmJlbG9uZ1RvRGF0YVNvdXJjZS5nZXRMYWJlbCgpO1xuICAgIH1cblxuICAgIGlmKHRoaXMuaXNEYXRhVmlldyl7XG4gICAgICBjb25zdCBtYWluRHNKc29uID0gdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldERhdGFTb3VyY2VKc29uKCk7XG4gICAgICBjb25zdCBkYXRhVmlld0pzb24gPSBtYWluRHNKc29uPy5kYXRhVmlld3MgJiYgbWFpbkRzSnNvbi5kYXRhVmlld3NbdGhpcy5kYXRhVmlld0lkXTtcbiAgICAgIHJldHVybiBkYXRhVmlld0pzb24/LmxhYmVsIHx8IG1haW5EYXRhU291cmNlTGFiZWw7XG4gICAgfVxuICAgIHJldHVybiBtYWluRGF0YVNvdXJjZUxhYmVsO1xuICB9XG5cbiAgZ2V0RGF0YVNvdXJjZUpzb24oKTogSU1EYXRhU291cmNlSnNvbntcbiAgICBpZih0aGlzLmlzRGF0YVZpZXcgfHwgdGhpcy5pc0xvY2FsKXtcbiAgICAgIHJldHVybiB0aGlzLmdldE1haW5EYXRhU291cmNlKCkuZ2V0RGF0YVNvdXJjZUpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuZGF0YVNvdXJjZUpzb247XG4gIH1cblxuICBzZXREYXRhU291cmNlSnNvbihkc0pzb246IElNRGF0YVNvdXJjZUpzb24pe1xuICAgIGlmKCFkc0pzb24pe1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZih0aGlzLmRhdGFTb3VyY2VKc29uKXtcbiAgICAgIHRoaXMuZGF0YVNvdXJjZUpzb24gPSB0aGlzLmRhdGFTb3VyY2VKc29uLm1lcmdlKGRzSnNvbi5hc011dGFibGUoe2RlZXA6IHRydWV9KSk7XG4gICAgfWVsc2V7XG4gICAgICB0aGlzLmRhdGFTb3VyY2VKc29uID0gZHNKc29uO1xuICAgIH1cbiAgfVxuXG4gIGdldFNjaGVtYSgpOiBJTURhdGFTb3VyY2VTY2hlbWEge1xuICAgIC8vIGRhdGEgdmlldyBkb2VzIG5vdCBoYXZlIHNjaGVtYVxuICAgIGlmKHRoaXMuaXNEYXRhVmlldyB8fCB0aGlzLmlzTG9jYWwpe1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5nZXRTY2hlbWEoKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuc2NoZW1hIHx8IHt9IGFzIGFueTtcbiAgfVxuXG4gIGdldFNlbGVjdGVkRmllbGRzKCk6IHsgW2ppbXVOYW1lOiBzdHJpbmddOiBJTUZpZWxkU2NoZW1hIH17XG4gICAgbGV0IG91dEZpZWxkcztcbiAgICBpZih0aGlzLmlzTG9jYWwpe1xuICAgICAgcmV0dXJuIHRoaXMuYmVsb25nVG9EYXRhU291cmNlLmdldFNlbGVjdGVkRmllbGRzKCk7XG4gICAgfVxuXG4gICAgaWYodGhpcy5pc0RhdGFWaWV3KXtcbiAgICAgIG91dEZpZWxkcyA9IHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5kYXRhVmlld3NbdGhpcy5kYXRhVmlld0lkXT8ub3V0RmllbGRzXG4gICAgfWVsc2V7XG4gICAgICBvdXRGaWVsZHMgPSB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkucXVlcnk/Lm91dEZpZWxkcztcbiAgICB9XG4gICAgaWYoIW91dEZpZWxkcyl7XG4gICAgICByZXR1cm4gdGhpcy5nZXRTY2hlbWEoKS5maWVsZHM7XG4gICAgfVxuXG4gICAgY29uc3QgdG9CZVJlbW92ZWQgPSBPYmplY3Qua2V5cyh0aGlzLmdldFNjaGVtYSgpLmZpZWxkcykuZmlsdGVyKGZOYW1lID0+IG91dEZpZWxkcy5pbmRleE9mKGZOYW1lKSA8IDApO1xuICAgIHJldHVybiB0aGlzLmdldFNjaGVtYSgpLmZpZWxkcy53aXRob3V0KC4uLnRvQmVSZW1vdmVkKTtcbiAgfVxuXG4gIHNldFNjaGVtYShzY2hlbWE6IElNRGF0YVNvdXJjZVNjaGVtYSkge1xuICAgIHRoaXMuc2NoZW1hID0gc2NoZW1hO1xuICB9XG5cbiAgZmV0Y2hTY2hlbWEoKTogUHJvbWlzZTxJTURhdGFTb3VyY2VTY2hlbWE+IHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKEltbXV0YWJsZSh7fSkpO1xuICB9XG5cbiAgZ2V0RmV0Y2hlZFNjaGVtYSgpOiBJTURhdGFTb3VyY2VTY2hlbWEge1xuICAgIGlmKHRoaXMuaXNEYXRhVmlldyB8fCB0aGlzLmlzTG9jYWwpe1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5nZXRGZXRjaGVkU2NoZW1hKCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmZldGNoZWRTY2hlbWE7XG4gIH1cbiAgc2V0RmV0Y2hlZFNjaGVtYShmZXRjaGVkU2NoZW1hOiBJTURhdGFTb3VyY2VTY2hlbWEpIHtcbiAgICB0aGlzLmZldGNoZWRTY2hlbWEgPSBmZXRjaGVkU2NoZW1hO1xuICB9XG5cbiAgZ2V0R2VvbWV0cnlUeXBlKCk6IEdlb21ldHJ5VHlwZXtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIC8qKiBAaWdub3JlICovXG4gIGdldFJldmVyc2VkQ29uZmlnU2NoZW1hKCk6IElNUmV2ZXJzZWREYXRhU291cmNlU2NoZW1hIHtcbiAgICBpZih0aGlzLmlzRGF0YVZpZXcgfHwgdGhpcy5pc0xvY2FsKXtcbiAgICAgIHJldHVybiB0aGlzLmdldE1haW5EYXRhU291cmNlKCkuZ2V0UmV2ZXJzZWRDb25maWdTY2hlbWEoKTtcbiAgICB9XG4gICAgaWYgKHRoaXMucmV2ZXJzZVNjaGVtYSkge1xuICAgICAgcmV0dXJuIHRoaXMucmV2ZXJzZVNjaGVtYTtcbiAgICB9XG4gICAgaWYgKHRoaXMuaXNEYXRhU291cmNlU2V0KSB7XG4gICAgICBjb25zdCBzY2hlbWEgPSB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkuc2NoZW1hO1xuICAgICAgY29uc3QgclNjaGVtYSA9IHtjaGlsZFNjaGVtYXM6IHt9IGFzIGFueX07XG4gICAgICBpZiAoIXNjaGVtYSkge1xuICAgICAgICByZXR1cm4gSW1tdXRhYmxlKHt9KTtcbiAgICAgIH1cbiAgICAgIGlmKCFzY2hlbWEuY2hpbGRTY2hlbWFzKXtcbiAgICAgICAgcmV0dXJuIEltbXV0YWJsZSh7XG4gICAgICAgICAgbGFiZWw6IHNjaGVtYS5sYWJlbCxcbiAgICAgICAgICBjaGlsZElkOiBzY2hlbWEuY2hpbGRJZCxcbiAgICAgICAgICBqaW11Q2hpbGRJZDogc2NoZW1hLmppbXVDaGlsZElkLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIE9iamVjdC5rZXlzKHNjaGVtYS5jaGlsZFNjaGVtYXMpLmZvckVhY2goamltdUNoaWxkSWQgPT4ge1xuICAgICAgICBjb25zdCBhY3R1YWxDaGlsZElkID0gc2NoZW1hLmNoaWxkU2NoZW1hc1tqaW11Q2hpbGRJZF0uY2hpbGRJZDtcbiAgICAgICAgaWYoclNjaGVtYS5jaGlsZFNjaGVtYXNbYWN0dWFsQ2hpbGRJZF0pe1xuICAgICAgICAgIHJTY2hlbWEuY2hpbGRTY2hlbWFzW2FjdHVhbENoaWxkSWRdLnB1c2godGhpcy5nZXRPbmVSZXZlcnNlZENvbmZpZ1NjaGVtYShzY2hlbWEuY2hpbGRTY2hlbWFzW2ppbXVDaGlsZElkXSkpXG4gICAgICAgIH1lbHNle1xuICAgICAgICAgIHJTY2hlbWEuY2hpbGRTY2hlbWFzW2FjdHVhbENoaWxkSWRdID0gW3RoaXMuZ2V0T25lUmV2ZXJzZWRDb25maWdTY2hlbWEoc2NoZW1hLmNoaWxkU2NoZW1hc1tqaW11Q2hpbGRJZF0pXTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICB0aGlzLnJldmVyc2VTY2hlbWEgPSBJbW11dGFibGUoclNjaGVtYSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucmV2ZXJzZVNjaGVtYSA9IHRoaXMuZ2V0T25lUmV2ZXJzZWRDb25maWdTY2hlbWEodGhpcy5nZXREYXRhU291cmNlSnNvbigpLnNjaGVtYSk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnJldmVyc2VTY2hlbWE7XG4gIH1cblxuICBzZXRSZWNvcmRzKHJlY29yZHM6IERhdGFSZWNvcmRbXSkge1xuICAgIHRoaXMucmVjb3JkcyA9IHJlY29yZHM7XG4gICAgdGhpcy5hZGRWZXJzaW9uKCk7XG4gIH1cblxuICBzZXRKc29uRGF0YShkYXRhOiBhbnlbXSkge1xuICAgIGNvbnNvbGUuZXJyb3IoJ3BsZWFzZSBpbXBsZW1lbnQgdGhpcy4gc2V0SnNvbkRhdGEnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0gc2NoZW1hXG4gICAqL1xuICBwcml2YXRlIGdldE9uZVJldmVyc2VkQ29uZmlnU2NoZW1hKHNjaGVtYTogSU1EYXRhU291cmNlU2NoZW1hKTogSU1SZXZlcnNlZERhdGFTb3VyY2VTY2hlbWEge1xuICAgIGNvbnN0IHJldmVyc2VkU2NoZW1hOiBSZXZlcnNlZERhdGFTb3VyY2VTY2hlbWEgPSB7fTtcbiAgICBpZiAoIXNjaGVtYSkge1xuICAgICAgcmV0dXJuIEltbXV0YWJsZShyZXZlcnNlZFNjaGVtYSk7XG4gICAgfVxuICAgIHJldmVyc2VkU2NoZW1hLmZpZWxkcyA9IHt9IGFzIGFueTtcbiAgICBPYmplY3Qua2V5cyhzY2hlbWEuZmllbGRzKS5mb3JFYWNoKGppbXVOYW1lID0+IHtcbiAgICAgIGNvbnN0IGZpZWxkID0gc2NoZW1hLmZpZWxkc1tqaW11TmFtZV0uYXNNdXRhYmxlKHtkZWVwOiB0cnVlfSk7XG4gICAgICBpZihyZXZlcnNlZFNjaGVtYS5maWVsZHNbZmllbGQubmFtZV0pe1xuICAgICAgICAocmV2ZXJzZWRTY2hlbWEuZmllbGRzW2ZpZWxkLm5hbWVdKS5wdXNoKGZpZWxkKTtcbiAgICAgIH1lbHNle1xuICAgICAgICAocmV2ZXJzZWRTY2hlbWEuZmllbGRzW2ZpZWxkLm5hbWVdKSA9IFtmaWVsZF07XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBzY2hlbWEuY2hpbGRJZCAmJiAocmV2ZXJzZWRTY2hlbWEuY2hpbGRJZCA9IHNjaGVtYS5jaGlsZElkKTtcbiAgICBzY2hlbWEuamltdUNoaWxkSWQgJiYgKHJldmVyc2VkU2NoZW1hLmppbXVDaGlsZElkID0gc2NoZW1hLmppbXVDaGlsZElkKTtcbiAgICByZXR1cm4gSW1tdXRhYmxlKHJldmVyc2VkU2NoZW1hKTtcbiAgfVxuXG4gIGdldFN0YXR1cygpOiBEYXRhU291cmNlU3RhdHVzIHtcbiAgICByZXR1cm4gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmRhdGFTb3VyY2VzSW5mb1t0aGlzLmlkXSAmJiBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuZGF0YVNvdXJjZXNJbmZvW3RoaXMuaWRdLnN0YXR1cztcbiAgfVxuICBzZXRTdGF0dXMoc3RhdHVzOiBEYXRhU291cmNlU3RhdHVzKSB7XG4gICAgZ2V0QXBwU3RvcmUoKS5kaXNwYXRjaChhcHBBY3Rpb25zLmRhdGFTb3VyY2VTdGF0dXNDaGFuZ2VkKHRoaXMuaWQsIHN0YXR1cykpO1xuICB9XG5cbiAgZ2V0Q291bnRTdGF0dXMoKTogRGF0YVNvdXJjZVN0YXR1cyB7XG4gICAgcmV0dXJuIGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5kYXRhU291cmNlc0luZm9bdGhpcy5pZF0gJiYgZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmRhdGFTb3VyY2VzSW5mb1t0aGlzLmlkXS5jb3VudFN0YXR1cztcbiAgfVxuICBzZXRDb3VudFN0YXR1cyhzdGF0dXM6IERhdGFTb3VyY2VTdGF0dXMpIHtcbiAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcEFjdGlvbnMuZGF0YVNvdXJjZUNvdW50U3RhdHVzQ2hhbmdlZCh0aGlzLmlkLCBzdGF0dXMpKTtcbiAgfVxuXG4gIGdldFZlcnNpb24oKTogbnVtYmVyIHtcbiAgICByZXR1cm4gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmRhdGFTb3VyY2VzSW5mb1t0aGlzLmlkXT8udmVyc2lvbjtcbiAgfVxuICBhZGRWZXJzaW9uKCkge1xuICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYXBwQWN0aW9ucy5kYXRhU291cmNlVmVyc2lvbkFkZGVkKHRoaXMuaWQpKTtcbiAgfVxuXG4gIGdldFJlY29yZHMoKTogRGF0YVJlY29yZFtdIHtcbiAgICByZXR1cm4gdGhpcy5yZWNvcmRzO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRTZWxlY3Rpb25EYXRhVmlldygpOiBEYXRhU291cmNle1xuICAgIGNvbnN0IG1haW5Ec0lkID0gKHRoaXMuaXNEYXRhVmlldyB8fCB0aGlzLmlzTG9jYWwpID8gdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmlkIDogdGhpcy5pZDtcbiAgICBjb25zdCBzZWxlY3Rpb25EdiA9IHRoaXMuZGF0YVNvdXJjZU1hbmFnZXIuZ2V0RGF0YVZpZXdEYXRhU291cmNlKG1haW5Ec0lkLCBTRUxFQ1RJT05fREFUQV9WSUVXX0lEKTtcbiAgICByZXR1cm4gc2VsZWN0aW9uRHY7XG4gIH1cblxuICBnZXRTZWxlY3RlZFJlY29yZHMoKTogRGF0YVJlY29yZFtdIHtcbiAgICBjb25zdCBzZWxlY3Rpb25EdiA9IHRoaXMuZ2V0U2VsZWN0aW9uRGF0YVZpZXcoKTtcbiAgICByZXR1cm4gc2VsZWN0aW9uRHYgPyBzZWxlY3Rpb25Edi5nZXRSZWNvcmRzKCkgOiBbXTtcblxuICAgIC8vIGNvbnN0IGRzSW5mbyA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5kYXRhU291cmNlc0luZm9bdGhpcy5pZF07XG4gICAgLy8gaWYgKGRzSW5mby5zZWxlY3RlZEluZGV4ZXMpIHsgLy8gc2VsZWN0IGJ5IGluZGV4LCBnZXQgcmVjb3JkcyBmcm9tIG1haW4gZHMuXG4gICAgLy8gICAvL3dlIHVzZSAuYXNNdXRhYmxlKCkgaGVyZSwgYmVjYXVzZSB0aGUgLm1hcCgpIGluIFNlYW1sZXNzSW1tdXRhYmxlIHdpbGwgcmVtb3ZlIG11dGFibGUgcHJvcGVydGllcy5cbiAgICAvLyAgIHJldHVybiBkc0luZm8uc2VsZWN0ZWRJbmRleGVzLmFzTXV0YWJsZSgpLm1hcChpbmRleCA9PiB0aGlzLmdldFJlY29yZHMoKVtpbmRleF0pLmZpbHRlcihyID0+IHIpO1xuICAgIC8vIH0gZWxzZSBpZiAoZHNJbmZvLnNlbGVjdGVkSWRzKSB7IC8vIHNlbGVjdCBieSBpZCwgZ2V0IHJlY29yZHMgZnJvbSBzZWxlY3Rpb24gZHZcbiAgICAvLyAgIHJldHVybiBkc0luZm8uc2VsZWN0ZWRJZHMuYXNNdXRhYmxlKCkubWFwKGlkID0+IHRoaXMuZ2V0UmVjb3JkQnlJZChpZCkpLmZpbHRlcihyID0+IHIpO1xuICAgIC8vIH0gZWxzZSB7XG4gICAgLy8gICByZXR1cm4gW107XG4gICAgLy8gfVxuICB9XG5cbiAgZ2V0U2VsZWN0ZWRSZWNvcmRJbmRleGVzKCk6IG51bWJlcltdIHtcbiAgICBpZiAoIWdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5kYXRhU291cmNlc0luZm9bdGhpcy5pZF0pIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBjb25zdCBkc0lkID0gKHRoaXMuaXNEYXRhVmlldyB8fCB0aGlzLmlzTG9jYWwpID8gdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmlkIDogdGhpcy5pZDtcblxuICAgIGlmIChnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuZGF0YVNvdXJjZXNJbmZvW2RzSWRdLnNlbGVjdGVkSW5kZXhlcykge1xuICAgICAgLy93ZSB1c2UgLmFzTXV0YWJsZSgpIGhlcmUsIGJlY2F1c2UgdGhlIC5tYXAoKSBpbiBTZWFtbGVzc0ltbXV0YWJsZSB3aWxsIHJlbW92ZSBtdXRhYmxlIHByb3BlcnRpZXMuXG4gICAgICByZXR1cm4gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmRhdGFTb3VyY2VzSW5mb1tkc0lkXS5zZWxlY3RlZEluZGV4ZXMuYXNNdXRhYmxlKCk7XG4gICAgfSBlbHNlIGlmIChnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuZGF0YVNvdXJjZXNJbmZvW2RzSWRdLnNlbGVjdGVkSWRzKSB7XG4gICAgICByZXR1cm4gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmRhdGFTb3VyY2VzSW5mb1tkc0lkXS5zZWxlY3RlZElkcy5hc011dGFibGUoKS5tYXAoaWQgPT4ge1xuICAgICAgICAvL3dlIGRvbid0IGNhcmUgdGhlIHR5cGUgaGVyZVxuICAgICAgICByZXR1cm4gdGhpcy5nZXRSZWNvcmRzKCkuZmluZEluZGV4KHJlY29yZCA9PiByZWNvcmQuZ2V0SWQoKSA9PSBpZCk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgfVxuXG4gIGdldFNlbGVjdGVkUmVjb3JkSWRzKCk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBkc0lkID0gKHRoaXMuaXNEYXRhVmlldyB8fCB0aGlzLmlzTG9jYWwpID8gdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmlkIDogdGhpcy5pZDtcbiAgICBpZiAoIWdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5kYXRhU291cmNlc0luZm9bZHNJZF0pIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBpZiAoZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmRhdGFTb3VyY2VzSW5mb1tkc0lkXS5zZWxlY3RlZElkcykge1xuICAgICAgcmV0dXJuIGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5kYXRhU291cmNlc0luZm9bZHNJZF0uc2VsZWN0ZWRJZHMuYXNNdXRhYmxlKCk7XG4gICAgfSBlbHNlIGlmIChnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuZGF0YVNvdXJjZXNJbmZvW2RzSWRdLnNlbGVjdGVkSW5kZXhlcykge1xuICAgICAgcmV0dXJuIGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5kYXRhU291cmNlc0luZm9bZHNJZF0uc2VsZWN0ZWRJbmRleGVzLmFzTXV0YWJsZSgpLm1hcChpbmRleCA9PiB0aGlzLmdldFJlY29yZHMoKVtpbmRleF0uZ2V0SWQoKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gIH1cblxuICBuZXh0UmVjb3JkKCk6IERhdGFSZWNvcmQge1xuICAgIGlmICh0aGlzLmdldFNlbGVjdGVkUmVjb3JkSW5kZXhlcygpLmxlbmd0aCA+IDEpIHtcbiAgICAgIGNvbnNvbGUud2FybignbWV0aG9kIFwibmV4dFJlY29yZFwiIG9ubHkgd29ya3Mgd2hlbiBzaW5nbGUgcmVjb3JkIGlzIHNlbGVjdGVkJyk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5nZXRTZWxlY3RlZFJlY29yZEluZGV4ZXMoKS5pbmRleE9mKHRoaXMuZ2V0UmVjb3JkcygpLmxlbmd0aCAtIDEpKSB7XG4gICAgICB0aHJvdyBFcnJvcignUmVhY2ggdGhlIGVuZCBvZiBkYXRhLicpO1xuICAgIH1cblxuICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYXBwQWN0aW9ucy5kYXRhU291cmNlU2VsZWN0ZWRJbmRleGVzQ2hhbmdlZCh0aGlzLmlkLCBbdGhpcy5nZXRTZWxlY3RlZFJlY29yZEluZGV4ZXMoKVswXSsrXSkpO1xuICAgIHJldHVybiB0aGlzLmdldFNlbGVjdGVkUmVjb3JkcygpWzBdO1xuICB9XG5cbiAgcHJldlJlY29yZCgpOiBEYXRhUmVjb3JkIHtcbiAgICBpZiAodGhpcy5nZXRTZWxlY3RlZFJlY29yZEluZGV4ZXMoKS5sZW5ndGggPiAxKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ21ldGhvZCBcInByZXZSZWNvcmRcIiBvbmx5IHdvcmtzIHdoZW4gc2luZ2xlIHJlY29yZCBpcyBzZWxlY3RlZCcpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZ2V0U2VsZWN0ZWRSZWNvcmRJbmRleGVzKCkuaW5kZXhPZigwKSkge1xuICAgICAgdGhyb3cgRXJyb3IoJ1JlYWNoIHRoZSBzdGFydCBvZiBkYXRhLicpO1xuICAgIH1cblxuICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYXBwQWN0aW9ucy5kYXRhU291cmNlU2VsZWN0ZWRJbmRleGVzQ2hhbmdlZCh0aGlzLmlkLCBbdGhpcy5nZXRTZWxlY3RlZFJlY29yZEluZGV4ZXMoKVswXS0tXSkpO1xuICAgIHJldHVybiB0aGlzLmdldFNlbGVjdGVkUmVjb3JkcygpWzBdO1xuICB9XG5cbiAgZ2V0UmVjb3JkKGluZGV4OiBudW1iZXIpOiBEYXRhUmVjb3JkIHtcbiAgICByZXR1cm4gdGhpcy5nZXRSZWNvcmRzKClbaW5kZXhdO1xuICB9XG5cbiAgZ2V0UmVjb3JkQnlJZChpZDogc3RyaW5nKTogRGF0YVJlY29yZCB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0UmVjb3JkcygpLmZpbHRlcihyZWNvcmQgPT4gcmVjb3JkICYmIHJlY29yZC5nZXRJZCgpID09PSBpZClbMF07XG4gIH1cblxuICBjbGVhclNlbGVjdGlvbigpe1xuICAgIHRoaXMuY2xlYXJPbmVEc1NlbGVjdGlvbih0aGlzLmdldE1haW5EYXRhU291cmNlKCkpO1xuICAgIHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5nZXRBbGxEZXJpdmVkRGF0YVNvdXJjZXMoKS5mb3JFYWNoKGRzID0+IHRoaXMuY2xlYXJPbmVEc1NlbGVjdGlvbihkcykpO1xuICB9XG5cbiAgcHJpdmF0ZSBjbGVhck9uZURzU2VsZWN0aW9uKGRzOiBEYXRhU291cmNlKXtcbiAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcEFjdGlvbnMuZGF0YVNvdXJjZVNlbGVjdGVkSW5kZXhlc0NoYW5nZWQoZHMuaWQsIG51bGwpKTtcbiAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcEFjdGlvbnMuZGF0YVNvdXJjZVNlbGVjdGVkSWRzQ2hhbmdlZChkcy5pZCwgbnVsbCkpO1xuICAgIGlmKGRzID09PSB0aGlzLmdldE1haW5EYXRhU291cmNlKCkpe1xuICAgICAgamltdUhpc3RvcnkuY2hhbmdlUXVlcnlPYmplY3RCeURhdGFSZWNvcmRJZHMoZHMuaWQsIG51bGwpO1xuICAgICAgamltdUhpc3RvcnkuY2hhbmdlUXVlcnlPYmplY3RCeURhdGFSZWNvcmRJbmRleGVzKGRzLmlkLCBudWxsKTtcbiAgICAgIHRoaXMuY29weVNlbGVjdGlvblRvRGF0YVZpZXcoW10pO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlU2VsZWN0aW9uU3RhdGVBbmRDaGFuZ2VVcmwoc2VsZWN0aW9uVHlwZTogJ2J5SWQnIHwgJ2J5SW5kZXgnLCB2YWx1ZXM6IChzdHJpbmcgfCBudW1iZXIpW10pe1xuICAgIGNvbnN0IG1haW5EcyA9IHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKTtcblxuICAgIGlmKHNlbGVjdGlvblR5cGUgPT09ICdieUluZGV4Jyl7XG4gICAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcEFjdGlvbnMuZGF0YVNvdXJjZVNlbGVjdGVkSW5kZXhlc0NoYW5nZWQodGhpcy5pZCwgdmFsdWVzIGFzIG51bWJlcltdKSk7XG5cbiAgICAgIG1haW5Ecy5nZXRBbGxEZXJpdmVkRGF0YVNvdXJjZXMoKS5mb3JFYWNoKGRzID0+IHtcbiAgICAgICAgaWYoZHMuaWQgPT09IHRoaXMuZGF0YVNvdXJjZU1hbmFnZXIuZ2V0RGF0YVZpZXdEYXRhU291cmNlSWQobWFpbkRzLmlkLCBTRUxFQ1RJT05fREFUQV9WSUVXX0lEKSB8fFxuICAgICAgICAgIGRzLmlkID09PSB0aGlzLmRhdGFTb3VyY2VNYW5hZ2VyLmdldERhdGFWaWV3RGF0YVNvdXJjZUlkKG1haW5Ecy5pZCwgREFUQV9WSUVXX0lEX0ZPUl9OT19TRUxFQ1RJT04pKXtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYoZHMuaWQgIT09IHRoaXMuaWQpeyAvLyBmb3Igb3RoZXIgZHYvbG9jYWwsIGNoYW5nZSBpbmRleCB0byBpZFxuICAgICAgICAgIGNvbnN0IGlkcyA9ICh2YWx1ZXMgYXMgbnVtYmVyW10pLm1hcChpID0+IHRoaXMuZ2V0UmVjb3JkKGkpICYmIHRoaXMuZ2V0UmVjb3JkKGkpLmdldElkKCkpO1xuICAgICAgICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYXBwQWN0aW9ucy5kYXRhU291cmNlU2VsZWN0ZWRJZHNDaGFuZ2VkKGRzLmlkLCBpZHMpKTtcbiAgICAgICAgfVxuICAgICAgfSlcblxuICAgICAgaWYodGhpcyA9PT0gbWFpbkRzKXtcbiAgICAgICAgamltdUhpc3RvcnkuY2hhbmdlUXVlcnlPYmplY3RCeURhdGFSZWNvcmRJbmRleGVzKHRoaXMuaWQsIHZhbHVlcyBhcyBudW1iZXJbXSk7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgY29uc3QgaWRzID0gKHZhbHVlcyBhcyBudW1iZXJbXSkubWFwKGkgPT4gdGhpcy5nZXRSZWNvcmQoaSkgJiYgdGhpcy5nZXRSZWNvcmQoaSkuZ2V0SWQoKSk7XG4gICAgICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYXBwQWN0aW9ucy5kYXRhU291cmNlU2VsZWN0ZWRJZHNDaGFuZ2VkKG1haW5Ecy5pZCwgaWRzKSk7XG4gICAgICAgIGppbXVIaXN0b3J5LmNoYW5nZVF1ZXJ5T2JqZWN0QnlEYXRhUmVjb3JkSWRzKG1haW5Ecy5pZCwgaWRzKTtcbiAgICAgIH1cbiAgICB9ZWxzZSBpZihzZWxlY3Rpb25UeXBlID09PSAnYnlJZCcpe1xuICAgICAgbWFpbkRzLmdldEFsbERlcml2ZWREYXRhU291cmNlcygpLmZvckVhY2goZHMgPT4ge1xuICAgICAgICBpZihkcy5pZCA9PT0gdGhpcy5kYXRhU291cmNlTWFuYWdlci5nZXREYXRhVmlld0RhdGFTb3VyY2VJZChtYWluRHMuaWQsIFNFTEVDVElPTl9EQVRBX1ZJRVdfSUQpIHx8XG4gICAgICAgICAgZHMuaWQgPT09IHRoaXMuZGF0YVNvdXJjZU1hbmFnZXIuZ2V0RGF0YVZpZXdEYXRhU291cmNlSWQobWFpbkRzLmlkLCBEQVRBX1ZJRVdfSURfRk9SX05PX1NFTEVDVElPTikpe1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcEFjdGlvbnMuZGF0YVNvdXJjZVNlbGVjdGVkSWRzQ2hhbmdlZChkcy5pZCwgdmFsdWVzIGFzIHN0cmluZ1tdKSk7XG4gICAgICB9KTtcblxuICAgICAgZ2V0QXBwU3RvcmUoKS5kaXNwYXRjaChhcHBBY3Rpb25zLmRhdGFTb3VyY2VTZWxlY3RlZElkc0NoYW5nZWQobWFpbkRzLmlkLCB2YWx1ZXMgYXMgc3RyaW5nW10pKTtcblxuICAgICAgamltdUhpc3RvcnkuY2hhbmdlUXVlcnlPYmplY3RCeURhdGFSZWNvcmRJZHMobWFpbkRzLmlkLCB2YWx1ZXMgYXMgc3RyaW5nW10pO1xuICAgIH1cbiAgfVxuXG4gIHNlbGVjdFJlY29yZChpbmRleDogbnVtYmVyKSB7XG4gICAgdGhpcy5jb3B5U2VsZWN0aW9uVG9EYXRhVmlldyhbdGhpcy5nZXRSZWNvcmQoaW5kZXgpXSk7XG4gICAgdGhpcy51cGRhdGVTZWxlY3Rpb25TdGF0ZUFuZENoYW5nZVVybCgnYnlJbmRleCcsIFtpbmRleF0pO1xuICB9XG5cbiAgc2VsZWN0UmVjb3JkcyhpbmRleGVzOiBudW1iZXJbXSkge1xuICAgIHRoaXMuY29weVNlbGVjdGlvblRvRGF0YVZpZXcoaW5kZXhlcy5tYXAoaSA9PiB0aGlzLmdldFJlY29yZChpKSkpO1xuICAgIHRoaXMudXBkYXRlU2VsZWN0aW9uU3RhdGVBbmRDaGFuZ2VVcmwoJ2J5SW5kZXgnLCBpbmRleGVzKTtcbiAgfVxuXG4gIHNlbGVjdFJlY29yZEJ5SWQoaWQ6IHN0cmluZywgcmVjb3JkPzogRGF0YVJlY29yZCkge1xuICAgIGlmKHRoaXMuZ2V0U2VsZWN0ZWRSZWNvcmRJZHMoKS5maW5kKF9pZCA9PiBfaWQgPT09IGlkKSl7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3Qgc2VsZWN0UmVjb3JkID0gcmVjb3JkIHx8IGlkICYmIHRoaXMuZ2V0UmVjb3JkQnlJZChpZCk7XG5cbiAgICB0aGlzLmNvcHlTZWxlY3Rpb25Ub0RhdGFWaWV3KFtzZWxlY3RSZWNvcmRdKTtcbiAgICB0aGlzLnVwZGF0ZVNlbGVjdGlvblN0YXRlQW5kQ2hhbmdlVXJsKCdieUlkJywgW2lkXSk7XG4gIH1cblxuICBzZWxlY3RSZWNvcmRzQnlJZHMoaWRzOiBzdHJpbmdbXSwgcmVjb3Jkcz86IERhdGFSZWNvcmRbXSkge1xuICAgIGNvbnN0IHNlbGVjdFJlY29yZHMgPSByZWNvcmRzIHx8IGlkcy5tYXAoaWQgPT4gdGhpcy5nZXRSZWNvcmRCeUlkKGlkKSk7XG5cbiAgICB0aGlzLmNvcHlTZWxlY3Rpb25Ub0RhdGFWaWV3KHNlbGVjdFJlY29yZHMpO1xuICAgIHRoaXMudXBkYXRlU2VsZWN0aW9uU3RhdGVBbmRDaGFuZ2VVcmwoJ2J5SWQnLCBpZHMpO1xuICB9XG5cbiAgLyoqXG4gICAqXG4gICAqIEBwYXJhbSBzZWxlY3Rpb25cbiAgICovXG4gIHByb3RlY3RlZCBjb3B5U2VsZWN0aW9uVG9EYXRhVmlldyhzZWxlY3Rpb246IERhdGFSZWNvcmRbXSl7XG4gICAgY29uc3Qgc2VsZWN0aW9uRHYgPSB0aGlzLmdldFNlbGVjdGlvbkRhdGFWaWV3KCk7XG5cbiAgICBpZighc2VsZWN0aW9uRHYpe1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHNlbGVjdGlvbkR2LnNldFJlY29yZHMoc2VsZWN0aW9uLmZpbHRlcihyID0+ICEhcikpO1xuICB9XG5cbiAgZ2V0SW5mbygpOiBJTURhdGFTb3VyY2VJbmZvIHtcbiAgICByZXR1cm4gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmRhdGFTb3VyY2VzSW5mb1t0aGlzLmlkXSB8fCB7fSBhcyBhbnk7XG4gIH1cblxuICBjbGVhckRhdGEoKTogdm9pZCB7XG4gICAgdGhpcy5zZWxlY3RSZWNvcmRzKFtdKTtcbiAgICB0aGlzLnJlY29yZHMgPSBbXTtcbiAgICB0aGlzLmFkZFZlcnNpb24oKTtcbiAgfVxuXG4gIGdldElkRmllbGQoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5nZXRTY2hlbWEoKSAmJiB0aGlzLmdldFNjaGVtYSgpLmlkRmllbGQgfHwgJ2lkJztcbiAgfVxuXG4gIGdldFJvb3REYXRhU291cmNlKCk6IERhdGFTb3VyY2Uge1xuICAgIGlmKHRoaXMuaXNEYXRhVmlldyB8fCB0aGlzLmlzTG9jYWwpe1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKS5nZXRSb290RGF0YVNvdXJjZSgpO1xuICAgIH1cbiAgICBsZXQgcm9vdERzID0gdGhpcy5wYXJlbnREYXRhU291cmNlO1xuICAgIHdoaWxlIChyb290RHMgJiYgcm9vdERzLnBhcmVudERhdGFTb3VyY2UpIHtcbiAgICAgIHJvb3REcyA9IHJvb3REcy5wYXJlbnREYXRhU291cmNlO1xuICAgIH1cbiAgICByZXR1cm4gcm9vdERzO1xuICB9XG5cbiAgcmVhZHkoKTogUHJvbWlzZTx2b2lkIHwgYW55PiB7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7fSk7XG4gIH1cblxuICBnZXRPcmlnaW5EYXRhU291cmNlcygpOiBEYXRhU291cmNlW117XG4gICAgaWYodGhpcy5pc0RhdGFWaWV3IHx8IHRoaXMuaXNMb2NhbCl7XG4gICAgICByZXR1cm4gdGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldE9yaWdpbkRhdGFTb3VyY2VzKCk7XG4gICAgfVxuICAgIGlmKCF0aGlzLmdldERhdGFTb3VyY2VKc29uKCkub3JpZ2luRGF0YVNvdXJjZXMgfHwgdGhpcy5nZXREYXRhU291cmNlSnNvbigpLm9yaWdpbkRhdGFTb3VyY2VzLmxlbmd0aCA9PT0gMCl7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5vcmlnaW5EYXRhU291cmNlcy5hc011dGFibGUoKS5tYXAodXNlRHMgPT4gdGhpcy5kYXRhU291cmNlTWFuYWdlci5nZXREYXRhU291cmNlKHVzZURzLmRhdGFTb3VyY2VJZCkpO1xuICB9XG5cbiAgZ2V0TWFpbkRhdGFTb3VyY2UoKTogRGF0YVNvdXJjZXtcbiAgICBpZih0aGlzLmJlbG9uZ1RvRGF0YVNvdXJjZSl7XG4gICAgICByZXR1cm4gdGhpcy5iZWxvbmdUb0RhdGFTb3VyY2UuYmVsb25nVG9EYXRhU291cmNlID8/IHRoaXMuYmVsb25nVG9EYXRhU291cmNlO1xuICAgIH1lbHNle1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9XG5cbiAgZ2V0RGF0YVZpZXdzKCk6IERhdGFTb3VyY2VbXXtcbiAgICBpZih0aGlzLmdldE1haW5EYXRhU291cmNlKCkgIT09IHRoaXMpe1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1lbHNle1xuICAgICAgcmV0dXJuIHRoaXMuZGF0YVNvdXJjZU1hbmFnZXIuZ2V0RGF0YVNvdXJjZXNBc0FycmF5KCkuZmlsdGVyKGRzID0+IGRzLmJlbG9uZ1RvRGF0YVNvdXJjZSA9PT0gdGhpcyAmJiBkcy5pc0RhdGFWaWV3KTtcbiAgICB9XG4gIH1cblxuICBnZXREYXRhVmlldyhkYXRhVmlld0lkOiBzdHJpbmcpOiBEYXRhU291cmNle1xuICAgIHJldHVybiB0aGlzLmdldERhdGFWaWV3cygpLmZpbmQoZHYgPT4gZHYuZGF0YVZpZXdJZCA9PT0gZGF0YVZpZXdJZCk7XG4gIH1cblxuICBnZXRMb2NhbERhdGFTb3VyY2VzKCk6IERhdGFTb3VyY2VbXXtcbiAgICBpZih0aGlzLmlzTG9jYWwpe1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1lbHNle1xuICAgICAgcmV0dXJuIHRoaXMuZGF0YVNvdXJjZU1hbmFnZXIuZ2V0RGF0YVNvdXJjZXNBc0FycmF5KCkuZmlsdGVyKGRzID0+IGRzLmJlbG9uZ1RvRGF0YVNvdXJjZSA9PT0gdGhpcyAmJiBkcy5pc0xvY2FsKTtcbiAgICB9XG4gIH1cblxuICBnZXRMb2NhbERhdGFTb3VyY2UobG9jYWxJZDogc3RyaW5nKTogRGF0YVNvdXJjZXtcbiAgICByZXR1cm4gdGhpcy5nZXRMb2NhbERhdGFTb3VyY2VzKCkuZmluZChkdiA9PiBkdi5sb2NhbElkID09PSBsb2NhbElkKTtcbiAgfVxuXG4gIGdldEFsbERlcml2ZWREYXRhU291cmNlcygpOiBEYXRhU291cmNlW117XG4gICAgbGV0IGRzcyA9IFtdO1xuICAgIGNvbnN0IGR2cyA9IHRoaXMuZ2V0RGF0YVZpZXdzKCk7XG4gICAgY29uc3QgbG9jYWxzID0gdGhpcy5nZXRMb2NhbERhdGFTb3VyY2VzKCk7XG5cbiAgICBkc3MgPSBkdnMuY29uY2F0KGxvY2Fscyk7XG4gICAgZHZzLmZvckVhY2goZHYgPT4ge1xuICAgICAgZHNzID0gZHNzLmNvbmNhdChkdi5nZXRMb2NhbERhdGFTb3VyY2VzKCkpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGRzcztcbiAgfVxuXG4gIGRlc3Ryb3koKSB7IH1cbn0iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUlBO0FBRUE7O0FBRUE7QUFDQTtBQXdCQTtBQVBBO0FBS0E7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7OztBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7OyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./jimu-core/lib/data-sources/ds-base-types/abstract-data-source.ts\n");

/***/ }),

/***/ "./jimu-core/lib/data-sources/ds-base-types/abstract-layer-folder-data-source.ts":
/*!***************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/ds-base-types/abstract-layer-folder-data-source.ts ***!
  \***************************************************************************************/
/*! exports provided: AbstractLayerFolderDataSource */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AbstractLayerFolderDataSource\", function() { return AbstractLayerFolderDataSource; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _data_source_interface__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../data-source-interface */ \"./jimu-core/lib/data-sources/data-source-interface.ts\");\n/* harmony import */ var _abstract_set_data_source__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./abstract-set-data-source */ \"./jimu-core/lib/data-sources/ds-base-types/abstract-set-data-source.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (undefined && undefined.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\n\n\n\n/**\n * Data source which contains multiple layers, like a layer folder,\n * please see {@link SupportedLayerServiceTypes} to find supported layer service types.\n */\nvar AbstractLayerFolderDataSource = /** @class */ (function (_super) {\n    __extends(AbstractLayerFolderDataSource, _super);\n    function AbstractLayerFolderDataSource(options) {\n        var _this = _super.call(this, options) || this;\n        if (options.layer) {\n            _this.layer = options.layer;\n        }\n        return _this;\n    }\n    AbstractLayerFolderDataSource.prototype.ready = function () {\n        var _this = this;\n        return this.fetchServiceDefinition().then(function () { return _super.prototype.ready.call(_this); });\n    };\n    AbstractLayerFolderDataSource.prototype.getServiceDefinition = function () {\n        if (this.isDataView || this.isLocal) {\n            return this.getMainDataSource().getServiceDefinition();\n        }\n        return this.serviceDefinition;\n    };\n    AbstractLayerFolderDataSource.prototype._createChildDataSources = function () {\n        var _this = this;\n        var _a, _b;\n        var supportedLayerDefinitionsPromises;\n        if (this.layer) { // from map\n            supportedLayerDefinitionsPromises = new Promise(function (resolve) {\n                if (_this.layer.type === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"SupportedLayerTypes\"].GroupLayer) {\n                    return _this.layer.loadAll().then(function () { return resolve(); });\n                }\n                else {\n                    return _this.layer.load().then(function () { return resolve(); });\n                }\n            }).then(function () {\n                var subLayers = _this.getSubLayers();\n                // __esri.Sublayer dosen't contain `type`, so, we need to fetch layer definition to know whether the layer is supported.\n                // And then, filter to get supported data sources.\n                return Promise.all(subLayers.map(function (layer) { return _this._fetchLayerDefinitionFromSubLayer(layer); }))\n                    .then(function (layerDefinitions) {\n                    var sceneLayerDefinitions = {};\n                    var otherLayerDefinitions = {};\n                    layerDefinitions.forEach(function (def, i) {\n                        var isSceneLayer = (def === null || def === void 0 ? void 0 : def.layerType) === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"SupportedLayerServiceTypes\"].SceneLayer3DObject || (def === null || def === void 0 ? void 0 : def.layerType) === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"SupportedLayerServiceTypes\"].SceneLayerPoint;\n                        if (isSceneLayer) {\n                            sceneLayerDefinitions[i] = def;\n                        }\n                        else {\n                            otherLayerDefinitions[i] = def;\n                        }\n                    });\n                    var checkedSceneLayerPromise = Promise.all(Object.keys(sceneLayerDefinitions)\n                        .map(function (i) {\n                        var _a, _b, _c;\n                        var layerIndex = i;\n                        if ((_a = subLayers[layerIndex]) === null || _a === void 0 ? void 0 : _a.associatedLayer) {\n                            return { layerIndex: layerIndex, associatedLayerUrl: jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getUrlByLayer((_b = subLayers[layerIndex]) === null || _b === void 0 ? void 0 : _b.associatedLayer) };\n                        }\n                        return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].fetchAssociatedFeatureLayerUrl(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getUrlByLayer(subLayers[layerIndex]), (_c = subLayers[layerIndex]) === null || _c === void 0 ? void 0 : _c.layerId, null, null)\n                            .then(function (associatedLayerUrl) { return ({ layerIndex: layerIndex, associatedLayerUrl: associatedLayerUrl }); });\n                    })).then(function (res) {\n                        var supportedSceneLayerRes = [];\n                        res.forEach(function (r) {\n                            if (r.associatedLayerUrl) {\n                                supportedSceneLayerRes.push({ def: layerDefinitions[r.layerIndex], layer: subLayers[r.layerIndex] });\n                            }\n                        });\n                        return supportedSceneLayerRes;\n                    });\n                    var checkedOtherLayerPromise = new Promise(function (resolve) {\n                        resolve(Object.keys(otherLayerDefinitions).map(function (i) { return ({ def: otherLayerDefinitions[i], layer: subLayers[i] }); })\n                            .filter(function (res) {\n                            return _this._getWhetherLayerIsSupported(res.layer, res.def);\n                        }));\n                    });\n                    return Promise.all([checkedSceneLayerPromise, checkedOtherLayerPromise]).then(function (res) { return res[0].concat(res[1]); });\n                });\n            });\n        }\n        else if ((_a = this.getDataSourceJson()) === null || _a === void 0 ? void 0 : _a.url) { // from map service item or map service url\n            supportedLayerDefinitionsPromises = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].fetchSupportedLayerDefinitions(this.getDataSourceJson().url, this.getServiceDefinition())\n                .then(function (res) { return Object.keys(res).map(function (url) { return ({ def: res[url], url: url }); }); });\n        }\n        else if ((_b = this.getDataSourceJson()) === null || _b === void 0 ? void 0 : _b.itemId) { // from feature collection which contains multiple feature layers\n            supportedLayerDefinitionsPromises = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"requestUtils\"].requestWrapper(this.getDataSourceJson().portalUrl, function (session) {\n                var _a;\n                return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"esri\"].restPortal.getItemData((_a = _this.getDataSourceJson()) === null || _a === void 0 ? void 0 : _a.itemId, {\n                    portal: jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"portalUrlUtils\"].getPortalRestUrl(_this.getDataSourceJson().portalUrl),\n                    authentication: session\n                }).then(function (itemData) {\n                    var _a;\n                    var subLayers = ((_a = itemData === null || itemData === void 0 ? void 0 : itemData.layers) === null || _a === void 0 ? void 0 : _a.map(function (l) { return l.layerDefinition; })) || [];\n                    var res = subLayers.filter(function (l) { return l.type === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"SupportedLayerServiceTypes\"].FeatureLayer; }).map(function (l) { return ({ def: l }); });\n                    return res;\n                });\n            });\n        }\n        if (supportedLayerDefinitionsPromises) {\n            this._childDataSourcesPromise = supportedLayerDefinitionsPromises.then(function (res) {\n                return _this._getDsJsonsFromSupportedLayers(res && res.map(function (r) { var _a; return (__assign(__assign({}, r), { url: (_a = _this.getDataSourceJson()) === null || _a === void 0 ? void 0 : _a.url })); }), _this.getDataSourceJson());\n            }).then(function (res) {\n                var promises = [];\n                res.forEach(function (r) {\n                    var options = {\n                        id: r.dsJson.id,\n                        dataSourceJson: r.dsJson.without('jimuChildId'),\n                        parentDataSource: _this,\n                        jimuChildId: r.dsJson.jimuChildId\n                    };\n                    if (_this.layer) {\n                        options.layer = r.layer;\n                    }\n                    promises.push(_this.dataSourceManager.createDataSource(options));\n                });\n                return Promise.all(promises);\n            });\n        }\n        return this._childDataSourcesPromise;\n    };\n    AbstractLayerFolderDataSource.prototype.fetchSchema = function () {\n        var _a, _b;\n        var dss = this.getChildDataSources();\n        var schema = Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])({ childSchemas: {}, label: ((_a = this.layer) === null || _a === void 0 ? void 0 : _a.title) || ((_b = this.getServiceDefinition()) === null || _b === void 0 ? void 0 : _b.name) });\n        dss.map(function (ds, i) {\n            var layerSchema = ds.getFetchedSchema();\n            var definition = ds.getServiceDefinition ? ds.getServiceDefinition()\n                : ds.getLayerDefinition && ds.getLayerDefinition();\n            schema = schema.setIn(['childSchemas', jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].fixLayerId((definition === null || definition === void 0 ? void 0 : definition.name) || \"\" + (definition === null || definition === void 0 ? void 0 : definition.id))], layerSchema);\n        });\n        return Promise.resolve(schema);\n    };\n    AbstractLayerFolderDataSource.prototype.fetchServiceDefinition = function () {\n        var _this = this;\n        var _a, _b, _c;\n        if (this.getServiceDefinition()) {\n            return Promise.resolve(this.getServiceDefinition());\n        }\n        if ((_a = this.getDataSourceJson()) === null || _a === void 0 ? void 0 : _a.url) { // from map service url or map service item\n            return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"ServiceManager\"].getInstance().fetchServiceInfo((_b = this.getDataSourceJson()) === null || _b === void 0 ? void 0 : _b.url).then(function (res) { return res.definition; })\n                .then(function (definition) {\n                if (!definition) {\n                    return null;\n                }\n                _this.serviceDefinition = definition;\n                return _this.serviceDefinition;\n            });\n        }\n        else if (this.layer) { // from map\n            this.serviceDefinition = {\n                name: this.layer.title\n            };\n            return Promise.resolve(this.serviceDefinition);\n        }\n        else if ((_c = this.getDataSourceJson()) === null || _c === void 0 ? void 0 : _c.itemId) { // from feature collection which contains multiple feature layers\n            return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"requestUtils\"].requestWrapper(this.getDataSourceJson().portalUrl, function (session) {\n                var _a;\n                return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"esri\"].restPortal.getItem((_a = _this.getDataSourceJson()) === null || _a === void 0 ? void 0 : _a.itemId, {\n                    portal: jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"portalUrlUtils\"].getPortalRestUrl(_this.getDataSourceJson().portalUrl),\n                    authentication: session\n                }).then(function (item) {\n                    _this.serviceDefinition = {\n                        name: item.title\n                    };\n                    return _this.serviceDefinition;\n                });\n            });\n        }\n        return Promise.resolve(null);\n    };\n    AbstractLayerFolderDataSource.prototype.getSubLayers = function () {\n        if (!this.layer) {\n            return [];\n        }\n        var subLayersCollection = this.layer.sublayers || this.layer.layers;\n        var subLayers = subLayersCollection ? subLayersCollection.toArray() : [];\n        return subLayers;\n    };\n    AbstractLayerFolderDataSource.prototype.getOriginalDataId = function () {\n        var _a, _b;\n        return ((_a = this.layer) === null || _a === void 0 ? void 0 : _a.id) || ((_b = this.serviceDefinition) === null || _b === void 0 ? void 0 : _b.id);\n    };\n    AbstractLayerFolderDataSource.prototype._getWhetherLayerIsSupported = function (layer, layerDefinition) {\n        var _a, _b, _c, _d, _e, _f;\n        var isFeatureLayer = ((_a = layer) === null || _a === void 0 ? void 0 : _a.type) === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"SupportedLayerTypes\"].FeatureLayer || (layerDefinition === null || layerDefinition === void 0 ? void 0 : layerDefinition.type) === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"SupportedLayerServiceTypes\"].FeatureLayer;\n        if (isFeatureLayer) {\n            // can not be used if do not have fields\n            return !!((_b = layer) === null || _b === void 0 ? void 0 : _b.fields) || !!(layerDefinition === null || layerDefinition === void 0 ? void 0 : layerDefinition.fields);\n        }\n        else {\n            var url = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getUrlByLayer(layer);\n            // some layer (e.g. group layer in map) may not have url but is still supported\n            var isSupported = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].isSupportedSingleLayerService(url)\n                || jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].isSupportedWholeService(url)\n                || ((_c = layer) === null || _c === void 0 ? void 0 : _c.type) === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"SupportedLayerTypes\"].GroupLayer\n                || ((_d = layer) === null || _d === void 0 ? void 0 : _d.type) === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"SupportedLayerTypes\"].MapImageLayer\n                || ((_e = layer) === null || _e === void 0 ? void 0 : _e.type) === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"SupportedLayerTypes\"].TileLayer\n                || ((_f = layer) === null || _f === void 0 ? void 0 : _f.type) === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"SupportedLayerTypes\"].SceneLayer;\n            return isSupported;\n        }\n    };\n    AbstractLayerFolderDataSource.prototype._fetchLayerDefinitionFromSubLayer = function (subLayer) {\n        var url = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getUrlByLayer(subLayer);\n        if (!url || !jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].isSupportedService(url)) {\n            return Promise.resolve(null);\n        }\n        return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"ServiceManager\"].getInstance().fetchServiceInfo(url).then(function (res) { return res.definition; });\n    };\n    AbstractLayerFolderDataSource.prototype._getDsJsonsFromSupportedLayers = function (res, dsJsonInConfig) {\n        var _this = this;\n        if (!res) {\n            return [];\n        }\n        var results = [];\n        res.forEach(function (r) {\n            var url = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getUrlByLayer(r.layer) || jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getFullServiceUrl(r.url, true, r.def);\n            var dsJsons = r.def ? _this._getDsJsonsFromSingleLayerDefinition(url, r.def, dsJsonInConfig) : _this._getDsJsonsFromSingleLayer(r.layer, dsJsonInConfig);\n            dsJsons.forEach(function (dsJson) {\n                results = results.concat({\n                    dsJson: dsJson,\n                    layer: r.layer\n                });\n            });\n        });\n        return results;\n    };\n    AbstractLayerFolderDataSource.prototype._getDsJsonsFromSingleLayerDefinition = function (url, layerDefinition, dsJsonInConfig) {\n        var _this = this;\n        if (!layerDefinition) {\n            return [];\n        }\n        var dsJsons = [];\n        var singleDsJson;\n        var jimuChildIds = this.getJimuChildId(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].fixLayerId(layerDefinition.name || \"\" + layerDefinition.id));\n        jimuChildIds.forEach(function (jimuChildId) {\n            var _a, _b;\n            var schema = _this.getDataSourceJson().schema ? _this.getDataSourceJson().schema.childSchemas[jimuChildId] : null;\n            var dsId = _this.getChildDataSourceId(jimuChildId);\n            if (jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].isSupportedSingleLayerService(url)) {\n                singleDsJson = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getSingleDsJsonFromLayerDefinition(dsId, url, layerDefinition, (dsJsonInConfig === null || dsJsonInConfig === void 0 ? void 0 : dsJsonInConfig.childDataSourceJsons) && dsJsonInConfig.childDataSourceJsons[jimuChildId] ? dsJsonInConfig.childDataSourceJsons[jimuChildId] : null);\n            }\n            else if (jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].isSupportedWholeService(url)) {\n                singleDsJson = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getSingleDsJsonFromWholeServiceDefinition(dsId, url, layerDefinition, (dsJsonInConfig === null || dsJsonInConfig === void 0 ? void 0 : dsJsonInConfig.childDataSourceJsons) && dsJsonInConfig.childDataSourceJsons[jimuChildId] ? dsJsonInConfig.childDataSourceJsons[jimuChildId] : null);\n            }\n            else if (!url && layerDefinition.type === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"SupportedLayerServiceTypes\"].FeatureLayer) { // is feature collection\n                singleDsJson = Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])({\n                    id: dsId,\n                    type: _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceTypes\"].FeatureLayer,\n                    layerId: \"\" + layerDefinition.id\n                });\n            }\n            if (singleDsJson) {\n                if ((_a = _this.getDataSourceJson()) === null || _a === void 0 ? void 0 : _a.portalUrl) {\n                    singleDsJson = singleDsJson.set('portalUrl', _this.getDataSourceJson().portalUrl);\n                }\n                if ((_b = _this.getDataSourceJson()) === null || _b === void 0 ? void 0 : _b.itemId) {\n                    singleDsJson = singleDsJson.set('itemId', _this.getDataSourceJson().itemId);\n                }\n                if (schema) {\n                    singleDsJson = singleDsJson.set('schema', schema);\n                }\n                dsJsons.push(singleDsJson.set('jimuChildId', jimuChildId));\n            }\n        });\n        return dsJsons;\n    };\n    AbstractLayerFolderDataSource.prototype._getDsJsonsFromSingleLayer = function (layer, dsJsonInConfig) {\n        var _this = this;\n        if (!layer) {\n            return [];\n        }\n        var dsJsons = [];\n        var singleDsJson;\n        var jimuChildIds = this.getJimuChildId(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getFixedLayerIdByLayer(layer));\n        jimuChildIds.forEach(function (jimuChildId) {\n            var _a, _b;\n            var schema = _this.getDataSourceJson().schema ? _this.getDataSourceJson().schema.childSchemas[jimuChildId] : null;\n            var dsId = _this.getChildDataSourceId(jimuChildId);\n            var childDataSourceJsonInConfig = (dsJsonInConfig === null || dsJsonInConfig === void 0 ? void 0 : dsJsonInConfig.childDataSourceJsons) && dsJsonInConfig.childDataSourceJsons[jimuChildId] ? dsJsonInConfig.childDataSourceJsons[jimuChildId] : null;\n            if (layer.type === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"SupportedLayerTypes\"].GroupLayer) {\n                singleDsJson = Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])({\n                    id: dsId,\n                    type: _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceTypes\"].GroupLayer\n                });\n            }\n            else if (layer.type === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"SupportedLayerTypes\"].FeatureLayer) {\n                singleDsJson = Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])({\n                    id: dsId,\n                    type: _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceTypes\"].FeatureLayer,\n                    layerId: \"\" + layer.layerId\n                });\n            }\n            if (singleDsJson) {\n                if ((_a = _this.getDataSourceJson()) === null || _a === void 0 ? void 0 : _a.portalUrl) {\n                    singleDsJson = singleDsJson.set('portalUrl', _this.getDataSourceJson().portalUrl);\n                }\n                if ((_b = _this.getDataSourceJson()) === null || _b === void 0 ? void 0 : _b.itemId) {\n                    singleDsJson = singleDsJson.set('itemId', _this.getDataSourceJson().itemId);\n                }\n                if (schema) {\n                    singleDsJson = singleDsJson.set('schema', schema);\n                }\n                singleDsJson = childDataSourceJsonInConfig ? singleDsJson.merge(childDataSourceJsonInConfig.asMutable({ deep: true })) : singleDsJson;\n                dsJsons.push(singleDsJson.set('jimuChildId', jimuChildId));\n            }\n        });\n        return dsJsons;\n    };\n    return AbstractLayerFolderDataSource;\n}(_abstract_set_data_source__WEBPACK_IMPORTED_MODULE_2__[\"AbstractSetDataSource\"]));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9kcy1iYXNlLXR5cGVzL2Fic3RyYWN0LWxheWVyLWZvbGRlci1kYXRhLXNvdXJjZS50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2RzLWJhc2UtdHlwZXMvYWJzdHJhY3QtbGF5ZXItZm9sZGVyLWRhdGEtc291cmNlLnRzPzA2MDgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSU1EYXRhU291cmNlSnNvbiwgSU1EYXRhU291cmNlU2NoZW1hLCBJbW11dGFibGUsIFNlcnZpY2VEZWZpbml0aW9uLCBkYXRhU291cmNlVXRpbHMsIFNlcnZpY2VNYW5hZ2VyLCBlc3JpLCByZXF1ZXN0VXRpbHMsIHBvcnRhbFVybFV0aWxzIH0gZnJvbSAnamltdS1jb3JlJztcbmltcG9ydCB7IERhdGFTb3VyY2UsIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMsIFN1cHBvcnRlZExheWVyVHlwZXMsIFN1cHBvcnRlZExheWVyU2VydmljZVR5cGVzLCBEYXRhU291cmNlVHlwZXMgfSBmcm9tICcuLi9kYXRhLXNvdXJjZS1pbnRlcmZhY2UnO1xuLy8gb25seSB1c2VkIGFzIHR5cGVzXG5pbXBvcnQgeyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlSW1wbCwgRmVhdHVyZUxheWVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyB9IGZyb20gJy4uL2ltcGxlbWVudGF0aW9ucy9mZWF0dXJlLWxheWVyLWRhdGEtc291cmNlLWltcGwnO1xuaW1wb3J0IHsgQWJzdHJhY3RTZXREYXRhU291cmNlIH0gZnJvbSAnLi9hYnN0cmFjdC1zZXQtZGF0YS1zb3VyY2UnO1xuaW1wb3J0IHsgU2NlbmVMYXllckRhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMgfSBmcm9tICcuLi9pbXBsZW1lbnRhdGlvbnMvc2NlbmUtbGF5ZXItZGF0YS1zb3VyY2UtaW1wbCc7XG5cbi8qKlxuICogTGF5ZXIgZnJvbSBBcmNHSVMgSlMgQVBJLCB3aGljaCBtYXkgY29udGFpbiBzdWJsYXllcnMuXG4gKi9cbmV4cG9ydCB0eXBlIEZvbGRlckxheWVyID0gX19lc3JpLk1hcEltYWdlTGF5ZXIgfCBfX2VzcmkuVGlsZUxheWVyIHwgX19lc3JpLkdyb3VwTGF5ZXIgfCBfX2VzcmkuU3VibGF5ZXI7XG5leHBvcnQgaW50ZXJmYWNlIExheWVyRm9sZGVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyBleHRlbmRzIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMge1xuICBsYXllcj86IEZvbGRlckxheWVyO1xufVxuXG4vKipcbiAqIERhdGEgc291cmNlIHdoaWNoIGNvbnRhaW5zIG11bHRpcGxlIGxheWVycywgbGlrZSBhIGxheWVyIGZvbGRlcixcbiAqIHBsZWFzZSBzZWUge0BsaW5rIFN1cHBvcnRlZExheWVyU2VydmljZVR5cGVzfSB0byBmaW5kIHN1cHBvcnRlZCBsYXllciBzZXJ2aWNlIHR5cGVzLlxuICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3RMYXllckZvbGRlckRhdGFTb3VyY2UgZXh0ZW5kcyBBYnN0cmFjdFNldERhdGFTb3VyY2Uge1xuICBwcml2YXRlIHNlcnZpY2VEZWZpbml0aW9uOiBTZXJ2aWNlRGVmaW5pdGlvbjtcbiAgbGF5ZXI/OiBGb2xkZXJMYXllcjtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBMYXllckZvbGRlckRhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMpe1xuICAgIHN1cGVyKG9wdGlvbnMpO1xuICAgIGlmKG9wdGlvbnMubGF5ZXIpe1xuICAgICAgdGhpcy5sYXllciA9IG9wdGlvbnMubGF5ZXI7XG4gICAgfVxuICB9XG5cbiAgcmVhZHkoKXtcbiAgICByZXR1cm4gdGhpcy5mZXRjaFNlcnZpY2VEZWZpbml0aW9uKCkudGhlbigoKSA9PiBzdXBlci5yZWFkeSgpKTtcbiAgfVxuXG4gIGdldFNlcnZpY2VEZWZpbml0aW9uKCk6IFNlcnZpY2VEZWZpbml0aW9ue1xuICAgIGlmKHRoaXMuaXNEYXRhVmlldyB8fCB0aGlzLmlzTG9jYWwpe1xuICAgICAgcmV0dXJuICh0aGlzLmdldE1haW5EYXRhU291cmNlKCkgYXMgQWJzdHJhY3RMYXllckZvbGRlckRhdGFTb3VyY2UpLmdldFNlcnZpY2VEZWZpbml0aW9uKCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLnNlcnZpY2VEZWZpbml0aW9uO1xuICB9XG5cbiAgcHJvdGVjdGVkIF9jcmVhdGVDaGlsZERhdGFTb3VyY2VzKCk6IFByb21pc2U8RGF0YVNvdXJjZVtdPntcbiAgICBsZXQgc3VwcG9ydGVkTGF5ZXJEZWZpbml0aW9uc1Byb21pc2VzOiBQcm9taXNlPHtkZWY6IFNlcnZpY2VEZWZpbml0aW9uLCB1cmw/OiBzdHJpbmcsIGxheWVyPzogX19lc3JpLkxheWVyIHwgX19lc3JpLlN1YmxheWVyfVtdPjtcbiAgICBpZih0aGlzLmxheWVyKXsgLy8gZnJvbSBtYXBcbiAgICAgIHN1cHBvcnRlZExheWVyRGVmaW5pdGlvbnNQcm9taXNlcyA9IG5ldyBQcm9taXNlKHJlc29sdmUgPT4ge1xuICAgICAgICBpZigodGhpcy5sYXllciBhcyBfX2VzcmkuTGF5ZXIpLnR5cGUgPT09IFN1cHBvcnRlZExheWVyVHlwZXMuR3JvdXBMYXllcil7XG4gICAgICAgICAgcmV0dXJuICh0aGlzLmxheWVyIGFzIF9fZXNyaS5Hcm91cExheWVyKS5sb2FkQWxsKCkudGhlbigoKSA9PiByZXNvbHZlKCkpO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICByZXR1cm4gdGhpcy5sYXllci5sb2FkKCkudGhlbigoKSA9PiByZXNvbHZlKCkpO1xuICAgICAgICB9XG4gICAgICB9KS50aGVuKCgpID0+IHtcbiAgICAgICAgY29uc3Qgc3ViTGF5ZXJzID0gdGhpcy5nZXRTdWJMYXllcnMoKTtcbiAgICAgICAgLy8gX19lc3JpLlN1YmxheWVyIGRvc2VuJ3QgY29udGFpbiBgdHlwZWAsIHNvLCB3ZSBuZWVkIHRvIGZldGNoIGxheWVyIGRlZmluaXRpb24gdG8ga25vdyB3aGV0aGVyIHRoZSBsYXllciBpcyBzdXBwb3J0ZWQuXG4gICAgICAgIC8vIEFuZCB0aGVuLCBmaWx0ZXIgdG8gZ2V0IHN1cHBvcnRlZCBkYXRhIHNvdXJjZXMuXG4gICAgICAgIHJldHVybiBQcm9taXNlLmFsbChzdWJMYXllcnMubWFwKGxheWVyID0+IHRoaXMuX2ZldGNoTGF5ZXJEZWZpbml0aW9uRnJvbVN1YkxheWVyKGxheWVyKSkpXG4gICAgICAgICAgLnRoZW4obGF5ZXJEZWZpbml0aW9ucyA9PiB7XG4gICAgICAgICAgICBjb25zdCBzY2VuZUxheWVyRGVmaW5pdGlvbnM6IHtbaTogbnVtYmVyXTogU2VydmljZURlZmluaXRpb259ID0ge307XG4gICAgICAgICAgICBjb25zdCBvdGhlckxheWVyRGVmaW5pdGlvbnM6IHtbaTogbnVtYmVyXTogU2VydmljZURlZmluaXRpb259ID0ge307XG4gICAgICAgICAgICBsYXllckRlZmluaXRpb25zLmZvckVhY2goKGRlZiwgaSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCBpc1NjZW5lTGF5ZXIgPSBkZWY/LmxheWVyVHlwZSA9PT0gU3VwcG9ydGVkTGF5ZXJTZXJ2aWNlVHlwZXMuU2NlbmVMYXllcjNET2JqZWN0IHx8IGRlZj8ubGF5ZXJUeXBlID09PSBTdXBwb3J0ZWRMYXllclNlcnZpY2VUeXBlcy5TY2VuZUxheWVyUG9pbnQ7XG4gICAgICAgICAgICAgIGlmKGlzU2NlbmVMYXllcil7XG4gICAgICAgICAgICAgICAgc2NlbmVMYXllckRlZmluaXRpb25zW2ldID0gZGVmO1xuICAgICAgICAgICAgICB9ZWxzZXtcbiAgICAgICAgICAgICAgICBvdGhlckxheWVyRGVmaW5pdGlvbnNbaV0gPSBkZWY7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBjb25zdCBjaGVja2VkU2NlbmVMYXllclByb21pc2U6IFByb21pc2U8e2RlZjogU2VydmljZURlZmluaXRpb24sIHVybD86IHN0cmluZywgbGF5ZXI/OiBfX2VzcmkuTGF5ZXIgfCBfX2VzcmkuU3VibGF5ZXJ9W10+ID0gUHJvbWlzZS5hbGwoXG4gICAgICAgICAgICAgIE9iamVjdC5rZXlzKHNjZW5lTGF5ZXJEZWZpbml0aW9ucylcbiAgICAgICAgICAgICAgICAubWFwKGkgPT4ge1xuICAgICAgICAgICAgICAgICAgY29uc3QgbGF5ZXJJbmRleCA9IGk7XG4gICAgICAgICAgICAgICAgICBpZihzdWJMYXllcnNbbGF5ZXJJbmRleF0/LmFzc29jaWF0ZWRMYXllcil7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7bGF5ZXJJbmRleCwgYXNzb2NpYXRlZExheWVyVXJsOiBkYXRhU291cmNlVXRpbHMuZ2V0VXJsQnlMYXllcihzdWJMYXllcnNbbGF5ZXJJbmRleF0/LmFzc29jaWF0ZWRMYXllcil9O1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgcmV0dXJuIGRhdGFTb3VyY2VVdGlscy5mZXRjaEFzc29jaWF0ZWRGZWF0dXJlTGF5ZXJVcmwoZGF0YVNvdXJjZVV0aWxzLmdldFVybEJ5TGF5ZXIoc3ViTGF5ZXJzW2xheWVySW5kZXhdKSwgc3ViTGF5ZXJzW2xheWVySW5kZXhdPy5sYXllcklkLCBudWxsLCBudWxsKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihhc3NvY2lhdGVkTGF5ZXJVcmwgPT4gKHtsYXllckluZGV4LCBhc3NvY2lhdGVkTGF5ZXJVcmx9KSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IHN1cHBvcnRlZFNjZW5lTGF5ZXJSZXM6IHtkZWY6IFNlcnZpY2VEZWZpbml0aW9uLCB1cmw/OiBzdHJpbmcsIGxheWVyPzogX19lc3JpLkxheWVyIHwgX19lc3JpLlN1YmxheWVyfVtdID0gW107XG4gICAgICAgICAgICAgIHJlcy5mb3JFYWNoKHIgPT4ge1xuICAgICAgICAgICAgICAgIGlmKHIuYXNzb2NpYXRlZExheWVyVXJsKXtcbiAgICAgICAgICAgICAgICAgIHN1cHBvcnRlZFNjZW5lTGF5ZXJSZXMucHVzaCh7ZGVmOiBsYXllckRlZmluaXRpb25zW3IubGF5ZXJJbmRleF0sIGxheWVyOiBzdWJMYXllcnNbci5sYXllckluZGV4XX0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIHJldHVybiBzdXBwb3J0ZWRTY2VuZUxheWVyUmVzO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGNvbnN0IGNoZWNrZWRPdGhlckxheWVyUHJvbWlzZTogUHJvbWlzZTx7ZGVmOiBTZXJ2aWNlRGVmaW5pdGlvbiwgdXJsPzogc3RyaW5nLCBsYXllcj86IF9fZXNyaS5MYXllciB8IF9fZXNyaS5TdWJsYXllcn1bXT4gPSBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgICAgICAgICAgcmVzb2x2ZShPYmplY3Qua2V5cyhvdGhlckxheWVyRGVmaW5pdGlvbnMpLm1hcChpID0+ICh7ZGVmOiBvdGhlckxheWVyRGVmaW5pdGlvbnNbaV0sIGxheWVyOiBzdWJMYXllcnNbaV19KSlcbiAgICAgICAgICAgICAgICAuZmlsdGVyKHJlcyA9PiB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fZ2V0V2hldGhlckxheWVySXNTdXBwb3J0ZWQocmVzLmxheWVyLCByZXMuZGVmKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoW2NoZWNrZWRTY2VuZUxheWVyUHJvbWlzZSwgY2hlY2tlZE90aGVyTGF5ZXJQcm9taXNlXSkudGhlbihyZXMgPT4gcmVzWzBdLmNvbmNhdChyZXNbMV0pKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1lbHNlIGlmKHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKT8udXJsKXsgLy8gZnJvbSBtYXAgc2VydmljZSBpdGVtIG9yIG1hcCBzZXJ2aWNlIHVybFxuICAgICAgc3VwcG9ydGVkTGF5ZXJEZWZpbml0aW9uc1Byb21pc2VzID0gZGF0YVNvdXJjZVV0aWxzLmZldGNoU3VwcG9ydGVkTGF5ZXJEZWZpbml0aW9ucyh0aGlzLmdldERhdGFTb3VyY2VKc29uKCkudXJsLCB0aGlzLmdldFNlcnZpY2VEZWZpbml0aW9uKCkpXG4gICAgICAgIC50aGVuKHJlcyA9PiBPYmplY3Qua2V5cyhyZXMpLm1hcCh1cmwgPT4gKHtkZWY6IHJlc1t1cmxdLCB1cmx9KSkpO1xuICAgIH1lbHNlIGlmKHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKT8uaXRlbUlkKXsgLy8gZnJvbSBmZWF0dXJlIGNvbGxlY3Rpb24gd2hpY2ggY29udGFpbnMgbXVsdGlwbGUgZmVhdHVyZSBsYXllcnNcbiAgICAgIHN1cHBvcnRlZExheWVyRGVmaW5pdGlvbnNQcm9taXNlcyA9IHJlcXVlc3RVdGlscy5yZXF1ZXN0V3JhcHBlcih0aGlzLmdldERhdGFTb3VyY2VKc29uKCkucG9ydGFsVXJsLCAoc2Vzc2lvbikgPT4ge1xuICAgICAgICByZXR1cm4gZXNyaS5yZXN0UG9ydGFsLmdldEl0ZW1EYXRhKHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKT8uaXRlbUlkLCB7XG4gICAgICAgICAgcG9ydGFsOiBwb3J0YWxVcmxVdGlscy5nZXRQb3J0YWxSZXN0VXJsKHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5wb3J0YWxVcmwpLFxuICAgICAgICAgIGF1dGhlbnRpY2F0aW9uOiBzZXNzaW9uXG4gICAgICAgIH0pLnRoZW4oaXRlbURhdGEgPT4ge1xuICAgICAgICAgIGNvbnN0IHN1YkxheWVyczogU2VydmljZURlZmluaXRpb25bXSA9IGl0ZW1EYXRhPy5sYXllcnM/Lm1hcChsID0+IGwubGF5ZXJEZWZpbml0aW9uKSB8fCBbXTtcbiAgICAgICAgICBjb25zdCByZXM6IHtkZWY6IFNlcnZpY2VEZWZpbml0aW9uLCB1cmw/OiBzdHJpbmcsIGxheWVyPzogX19lc3JpLkxheWVyIHwgX19lc3JpLlN1YmxheWVyfVtdID0gc3ViTGF5ZXJzLmZpbHRlcihsID0+IGwudHlwZSA9PT0gU3VwcG9ydGVkTGF5ZXJTZXJ2aWNlVHlwZXMuRmVhdHVyZUxheWVyKS5tYXAobCA9PiAoe2RlZjogbH0pKTtcbiAgICAgICAgICByZXR1cm4gcmVzO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmKHN1cHBvcnRlZExheWVyRGVmaW5pdGlvbnNQcm9taXNlcyl7XG4gICAgICB0aGlzLl9jaGlsZERhdGFTb3VyY2VzUHJvbWlzZSA9IHN1cHBvcnRlZExheWVyRGVmaW5pdGlvbnNQcm9taXNlcy50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXREc0pzb25zRnJvbVN1cHBvcnRlZExheWVycyhcbiAgICAgICAgICByZXMgJiYgcmVzLm1hcChyID0+ICh7Li4uciwgdXJsOiB0aGlzLmdldERhdGFTb3VyY2VKc29uKCk/LnVybH0pKSxcbiAgICAgICAgICB0aGlzLmdldERhdGFTb3VyY2VKc29uKClcbiAgICAgICAgKTtcbiAgICAgIH0pLnRoZW4ocmVzID0+IHtcbiAgICAgICAgY29uc3QgcHJvbWlzZXM6IFByb21pc2U8RGF0YVNvdXJjZT5bXSA9IFtdO1xuICAgICAgICByZXMuZm9yRWFjaChyID0+IHtcbiAgICAgICAgICBjb25zdCBvcHRpb25zXG4gICAgICAgICAgICA6IExheWVyRm9sZGVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyB8IEZlYXR1cmVMYXllckRhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMgfCBTY2VuZUxheWVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9uc1xuICAgICAgICAgICAgPSB7XG4gICAgICAgICAgICAgIGlkOiByLmRzSnNvbi5pZCxcbiAgICAgICAgICAgICAgZGF0YVNvdXJjZUpzb246IChyLmRzSnNvbiBhcyBhbnkpLndpdGhvdXQoJ2ppbXVDaGlsZElkJyksIC8vIHdlIGRvIG5vdCBzYXZlIGppbXVDaGlsZElkIGluIGNvbmZpZ1xuICAgICAgICAgICAgICBwYXJlbnREYXRhU291cmNlOiB0aGlzLFxuICAgICAgICAgICAgICBqaW11Q2hpbGRJZDogKHIuZHNKc29uIGFzIGFueSkuamltdUNoaWxkSWRcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICBpZih0aGlzLmxheWVyKXtcbiAgICAgICAgICAgIG9wdGlvbnMubGF5ZXIgPSByLmxheWVyIGFzIEZvbGRlckxheWVyIHwgIF9fZXNyaS5GZWF0dXJlTGF5ZXIgfCBfX2VzcmkuU2NlbmVMYXllcjtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBwcm9taXNlcy5wdXNoKHRoaXMuZGF0YVNvdXJjZU1hbmFnZXIuY3JlYXRlRGF0YVNvdXJjZShvcHRpb25zKSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuX2NoaWxkRGF0YVNvdXJjZXNQcm9taXNlO1xuICB9XG5cbiAgZmV0Y2hTY2hlbWEoKXtcbiAgICBjb25zdCBkc3MgPSB0aGlzLmdldENoaWxkRGF0YVNvdXJjZXMoKSBhcyBEYXRhU291cmNlW107XG5cbiAgICBsZXQgc2NoZW1hOiBJTURhdGFTb3VyY2VTY2hlbWEgPSBJbW11dGFibGUoe2NoaWxkU2NoZW1hczoge30sIGxhYmVsOiB0aGlzLmxheWVyPy50aXRsZSB8fCB0aGlzLmdldFNlcnZpY2VEZWZpbml0aW9uKCk/Lm5hbWV9KSBhcyBJTURhdGFTb3VyY2VTY2hlbWE7XG4gICAgZHNzLm1hcCgoZHM6IEZlYXR1cmVMYXllckRhdGFTb3VyY2VJbXBsIHwgQWJzdHJhY3RMYXllckZvbGRlckRhdGFTb3VyY2UsIGkpID0+IHtcbiAgICAgIGNvbnN0IGxheWVyU2NoZW1hID0gZHMuZ2V0RmV0Y2hlZFNjaGVtYSgpO1xuICAgICAgY29uc3QgZGVmaW5pdGlvbiA9IChkcyBhcyBBYnN0cmFjdExheWVyRm9sZGVyRGF0YVNvdXJjZSkuZ2V0U2VydmljZURlZmluaXRpb24gPyAoZHMgYXMgQWJzdHJhY3RMYXllckZvbGRlckRhdGFTb3VyY2UpLmdldFNlcnZpY2VEZWZpbml0aW9uKClcbiAgICAgICAgOiAoZHMgYXMgRmVhdHVyZUxheWVyRGF0YVNvdXJjZUltcGwpLmdldExheWVyRGVmaW5pdGlvbiAmJiAoZHMgYXMgRmVhdHVyZUxheWVyRGF0YVNvdXJjZUltcGwpLmdldExheWVyRGVmaW5pdGlvbigpO1xuXG4gICAgICBzY2hlbWEgPSBzY2hlbWEuc2V0SW4oWydjaGlsZFNjaGVtYXMnLCBkYXRhU291cmNlVXRpbHMuZml4TGF5ZXJJZChkZWZpbml0aW9uPy5uYW1lIHx8IGAke2RlZmluaXRpb24/LmlkfWApXSwgbGF5ZXJTY2hlbWEpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShzY2hlbWEpO1xuICB9XG5cbiAgZmV0Y2hTZXJ2aWNlRGVmaW5pdGlvbigpOiBQcm9taXNlPFNlcnZpY2VEZWZpbml0aW9uPiB7XG4gICAgaWYodGhpcy5nZXRTZXJ2aWNlRGVmaW5pdGlvbigpKXtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5nZXRTZXJ2aWNlRGVmaW5pdGlvbigpKTtcbiAgICB9XG5cbiAgICBpZih0aGlzLmdldERhdGFTb3VyY2VKc29uKCk/LnVybCl7IC8vIGZyb20gbWFwIHNlcnZpY2UgdXJsIG9yIG1hcCBzZXJ2aWNlIGl0ZW1cbiAgICAgIHJldHVybiBTZXJ2aWNlTWFuYWdlci5nZXRJbnN0YW5jZSgpLmZldGNoU2VydmljZUluZm8odGhpcy5nZXREYXRhU291cmNlSnNvbigpPy51cmwpLnRoZW4ocmVzID0+IHJlcy5kZWZpbml0aW9uKVxuICAgICAgICAudGhlbihkZWZpbml0aW9uID0+IHtcbiAgICAgICAgICBpZighZGVmaW5pdGlvbil7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5zZXJ2aWNlRGVmaW5pdGlvbiA9IGRlZmluaXRpb247XG4gICAgICAgICAgcmV0dXJuIHRoaXMuc2VydmljZURlZmluaXRpb247XG4gICAgICAgIH0pO1xuICAgIH1lbHNlIGlmKHRoaXMubGF5ZXIpeyAvLyBmcm9tIG1hcFxuICAgICAgdGhpcy5zZXJ2aWNlRGVmaW5pdGlvbiA9IHtcbiAgICAgICAgbmFtZTogdGhpcy5sYXllci50aXRsZVxuICAgICAgfVxuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLnNlcnZpY2VEZWZpbml0aW9uKTtcbiAgICB9ZWxzZSBpZih0aGlzLmdldERhdGFTb3VyY2VKc29uKCk/Lml0ZW1JZCl7IC8vIGZyb20gZmVhdHVyZSBjb2xsZWN0aW9uIHdoaWNoIGNvbnRhaW5zIG11bHRpcGxlIGZlYXR1cmUgbGF5ZXJzXG4gICAgICByZXR1cm4gcmVxdWVzdFV0aWxzLnJlcXVlc3RXcmFwcGVyKHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5wb3J0YWxVcmwsIChzZXNzaW9uKSA9PiB7XG4gICAgICAgIHJldHVybiBlc3JpLnJlc3RQb3J0YWwuZ2V0SXRlbSh0aGlzLmdldERhdGFTb3VyY2VKc29uKCk/Lml0ZW1JZCwge1xuICAgICAgICAgIHBvcnRhbDogcG9ydGFsVXJsVXRpbHMuZ2V0UG9ydGFsUmVzdFVybCh0aGlzLmdldERhdGFTb3VyY2VKc29uKCkucG9ydGFsVXJsKSxcbiAgICAgICAgICBhdXRoZW50aWNhdGlvbjogc2Vzc2lvblxuICAgICAgICB9KS50aGVuKGl0ZW0gPT4ge1xuICAgICAgICAgIHRoaXMuc2VydmljZURlZmluaXRpb24gPSB7XG4gICAgICAgICAgICBuYW1lOiBpdGVtLnRpdGxlXG4gICAgICAgICAgfTtcbiAgICAgICAgICByZXR1cm4gdGhpcy5zZXJ2aWNlRGVmaW5pdGlvbjtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xuICB9XG5cbiAgZ2V0U3ViTGF5ZXJzKCk6IChfX2VzcmkuU3VibGF5ZXIgfCBfX2VzcmkuTGF5ZXIpW117XG4gICAgaWYoIXRoaXMubGF5ZXIpe1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBjb25zdCBzdWJMYXllcnNDb2xsZWN0aW9uID0gKHRoaXMubGF5ZXIgYXMgX19lc3JpLk1hcEltYWdlTGF5ZXIgfCBfX2VzcmkuVGlsZUxheWVyKS5zdWJsYXllcnMgfHwgKHRoaXMubGF5ZXIgYXMgX19lc3JpLkdyb3VwTGF5ZXIpLmxheWVycztcbiAgICBjb25zdCBzdWJMYXllcnM6IChfX2VzcmkuU3VibGF5ZXIgfCBfX2VzcmkuTGF5ZXIpW10gPSBzdWJMYXllcnNDb2xsZWN0aW9uID8gc3ViTGF5ZXJzQ29sbGVjdGlvbi50b0FycmF5KCkgOiBbXTtcbiAgICByZXR1cm4gc3ViTGF5ZXJzO1xuICB9XG5cbiAgZ2V0T3JpZ2luYWxEYXRhSWQoKTogc3RyaW5nIHwgbnVtYmVye1xuICAgIHJldHVybiB0aGlzLmxheWVyPy5pZCB8fCB0aGlzLnNlcnZpY2VEZWZpbml0aW9uPy5pZDtcbiAgfVxuXG4gIHByb3RlY3RlZCBfZ2V0V2hldGhlckxheWVySXNTdXBwb3J0ZWQobGF5ZXI6IF9fZXNyaS5MYXllciB8IF9fZXNyaS5TdWJsYXllciwgbGF5ZXJEZWZpbml0aW9uOiBTZXJ2aWNlRGVmaW5pdGlvbik6IGJvb2xlYW57XG5cbiAgICBjb25zdCBpc0ZlYXR1cmVMYXllciA9IChsYXllciBhcyBfX2VzcmkuRmVhdHVyZUxheWVyKT8udHlwZSA9PT0gU3VwcG9ydGVkTGF5ZXJUeXBlcy5GZWF0dXJlTGF5ZXIgfHwgbGF5ZXJEZWZpbml0aW9uPy50eXBlID09PSBTdXBwb3J0ZWRMYXllclNlcnZpY2VUeXBlcy5GZWF0dXJlTGF5ZXI7XG5cbiAgICBpZihpc0ZlYXR1cmVMYXllcil7XG4gICAgICAvLyBjYW4gbm90IGJlIHVzZWQgaWYgZG8gbm90IGhhdmUgZmllbGRzXG4gICAgICByZXR1cm4gISEobGF5ZXIgYXMgX19lc3JpLkZlYXR1cmVMYXllcik/LmZpZWxkcyB8fCAhIWxheWVyRGVmaW5pdGlvbj8uZmllbGRzO1xuICAgIH1lbHNle1xuICAgICAgY29uc3QgdXJsID0gZGF0YVNvdXJjZVV0aWxzLmdldFVybEJ5TGF5ZXIobGF5ZXIpO1xuICAgICAgLy8gc29tZSBsYXllciAoZS5nLiBncm91cCBsYXllciBpbiBtYXApIG1heSBub3QgaGF2ZSB1cmwgYnV0IGlzIHN0aWxsIHN1cHBvcnRlZFxuICAgICAgY29uc3QgaXNTdXBwb3J0ZWQgPSBkYXRhU291cmNlVXRpbHMuaXNTdXBwb3J0ZWRTaW5nbGVMYXllclNlcnZpY2UodXJsKVxuICAgICAgICB8fCBkYXRhU291cmNlVXRpbHMuaXNTdXBwb3J0ZWRXaG9sZVNlcnZpY2UodXJsKVxuICAgICAgICB8fCAobGF5ZXIgYXMgX19lc3JpLkxheWVyKT8udHlwZSA9PT0gU3VwcG9ydGVkTGF5ZXJUeXBlcy5Hcm91cExheWVyXG4gICAgICAgIHx8IChsYXllciBhcyBfX2VzcmkuTGF5ZXIpPy50eXBlID09PSBTdXBwb3J0ZWRMYXllclR5cGVzLk1hcEltYWdlTGF5ZXJcbiAgICAgICAgfHwgKGxheWVyIGFzIF9fZXNyaS5MYXllcik/LnR5cGUgPT09IFN1cHBvcnRlZExheWVyVHlwZXMuVGlsZUxheWVyXG4gICAgICAgIHx8IChsYXllciBhcyBfX2VzcmkuTGF5ZXIpPy50eXBlID09PSBTdXBwb3J0ZWRMYXllclR5cGVzLlNjZW5lTGF5ZXI7XG4gICAgICByZXR1cm4gaXNTdXBwb3J0ZWQ7XG4gICAgfVxuICB9XG5cbiAgcHJvdGVjdGVkIF9mZXRjaExheWVyRGVmaW5pdGlvbkZyb21TdWJMYXllcihzdWJMYXllcjogX19lc3JpLlN1YmxheWVyIHwgX19lc3JpLkxheWVyKTogUHJvbWlzZTxTZXJ2aWNlRGVmaW5pdGlvbj57XG4gICAgY29uc3QgdXJsID0gZGF0YVNvdXJjZVV0aWxzLmdldFVybEJ5TGF5ZXIoc3ViTGF5ZXIpO1xuICAgIGlmKCF1cmwgfHwgIWRhdGFTb3VyY2VVdGlscy5pc1N1cHBvcnRlZFNlcnZpY2UodXJsKSl7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xuICAgIH1cbiAgICByZXR1cm4gU2VydmljZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5mZXRjaFNlcnZpY2VJbmZvKHVybCkudGhlbihyZXMgPT4gcmVzLmRlZmluaXRpb24pO1xuICB9XG5cbiAgcHJvdGVjdGVkIF9nZXREc0pzb25zRnJvbVN1cHBvcnRlZExheWVycyhyZXM6IHtkZWY6IFNlcnZpY2VEZWZpbml0aW9uLCB1cmw/OiBzdHJpbmcsIGxheWVyPzogX19lc3JpLkxheWVyIHwgX19lc3JpLlN1YmxheWVyfVtdLCBkc0pzb25JbkNvbmZpZzogSU1EYXRhU291cmNlSnNvbik6XG4gICAge2RzSnNvbjogSU1EYXRhU291cmNlSnNvbiwgbGF5ZXI/OiBfX2VzcmkuU3VibGF5ZXIgfCBfX2VzcmkuTGF5ZXJ9W117XG4gICAgaWYoIXJlcyl7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIGxldCByZXN1bHRzOiB7ZHNKc29uOiBJTURhdGFTb3VyY2VKc29uLCBsYXllcj86IF9fZXNyaS5TdWJsYXllciB8IF9fZXNyaS5MYXllcn1bXSA9IFtdO1xuICAgIHJlcy5mb3JFYWNoKHIgPT4ge1xuICAgICAgY29uc3QgdXJsID0gZGF0YVNvdXJjZVV0aWxzLmdldFVybEJ5TGF5ZXIoci5sYXllcikgfHwgZGF0YVNvdXJjZVV0aWxzLmdldEZ1bGxTZXJ2aWNlVXJsKHIudXJsLCB0cnVlLCByLmRlZik7XG4gICAgICBjb25zdCBkc0pzb25zID0gci5kZWYgPyB0aGlzLl9nZXREc0pzb25zRnJvbVNpbmdsZUxheWVyRGVmaW5pdGlvbih1cmwsIHIuZGVmLCBkc0pzb25JbkNvbmZpZykgOiB0aGlzLl9nZXREc0pzb25zRnJvbVNpbmdsZUxheWVyKHIubGF5ZXIsIGRzSnNvbkluQ29uZmlnKTtcbiAgICAgIGRzSnNvbnMuZm9yRWFjaChkc0pzb24gPT4ge1xuICAgICAgICByZXN1bHRzID0gcmVzdWx0cy5jb25jYXQoe1xuICAgICAgICAgIGRzSnNvbjogZHNKc29uLFxuICAgICAgICAgIGxheWVyOiByLmxheWVyXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdHM7XG4gIH1cblxuICBwcm90ZWN0ZWQgX2dldERzSnNvbnNGcm9tU2luZ2xlTGF5ZXJEZWZpbml0aW9uKHVybDogc3RyaW5nLCBsYXllckRlZmluaXRpb246IFNlcnZpY2VEZWZpbml0aW9uLCBkc0pzb25JbkNvbmZpZzogSU1EYXRhU291cmNlSnNvbik6IElNRGF0YVNvdXJjZUpzb25bXXtcbiAgICBpZighbGF5ZXJEZWZpbml0aW9uKXtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgY29uc3QgZHNKc29ucyA9IFtdO1xuICAgIGxldCBzaW5nbGVEc0pzb246IElNRGF0YVNvdXJjZUpzb247XG4gICAgY29uc3QgamltdUNoaWxkSWRzID0gdGhpcy5nZXRKaW11Q2hpbGRJZChkYXRhU291cmNlVXRpbHMuZml4TGF5ZXJJZChsYXllckRlZmluaXRpb24ubmFtZSB8fCBgJHtsYXllckRlZmluaXRpb24uaWR9YCkpO1xuICAgIGppbXVDaGlsZElkcy5mb3JFYWNoKGppbXVDaGlsZElkID0+IHtcbiAgICAgIGNvbnN0IHNjaGVtYSA9IHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5zY2hlbWEgPyB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkuc2NoZW1hLmNoaWxkU2NoZW1hc1tqaW11Q2hpbGRJZF0gOiBudWxsO1xuICAgICAgY29uc3QgZHNJZCA9IHRoaXMuZ2V0Q2hpbGREYXRhU291cmNlSWQoamltdUNoaWxkSWQpO1xuXG4gICAgICBpZihkYXRhU291cmNlVXRpbHMuaXNTdXBwb3J0ZWRTaW5nbGVMYXllclNlcnZpY2UodXJsKSl7XG4gICAgICAgIHNpbmdsZURzSnNvbiA9IGRhdGFTb3VyY2VVdGlscy5nZXRTaW5nbGVEc0pzb25Gcm9tTGF5ZXJEZWZpbml0aW9uKFxuICAgICAgICAgIGRzSWQsXG4gICAgICAgICAgdXJsLFxuICAgICAgICAgIGxheWVyRGVmaW5pdGlvbixcbiAgICAgICAgICBkc0pzb25JbkNvbmZpZz8uY2hpbGREYXRhU291cmNlSnNvbnMgJiYgZHNKc29uSW5Db25maWcuY2hpbGREYXRhU291cmNlSnNvbnNbamltdUNoaWxkSWRdID8gZHNKc29uSW5Db25maWcuY2hpbGREYXRhU291cmNlSnNvbnNbamltdUNoaWxkSWRdIDogbnVsbFxuICAgICAgICApO1xuICAgICAgfWVsc2UgaWYoZGF0YVNvdXJjZVV0aWxzLmlzU3VwcG9ydGVkV2hvbGVTZXJ2aWNlKHVybCkpe1xuICAgICAgICBzaW5nbGVEc0pzb24gPSBkYXRhU291cmNlVXRpbHMuZ2V0U2luZ2xlRHNKc29uRnJvbVdob2xlU2VydmljZURlZmluaXRpb24oXG4gICAgICAgICAgZHNJZCxcbiAgICAgICAgICB1cmwsXG4gICAgICAgICAgbGF5ZXJEZWZpbml0aW9uLFxuICAgICAgICAgIGRzSnNvbkluQ29uZmlnPy5jaGlsZERhdGFTb3VyY2VKc29ucyAmJiBkc0pzb25JbkNvbmZpZy5jaGlsZERhdGFTb3VyY2VKc29uc1tqaW11Q2hpbGRJZF0gPyBkc0pzb25JbkNvbmZpZy5jaGlsZERhdGFTb3VyY2VKc29uc1tqaW11Q2hpbGRJZF0gOiBudWxsXG4gICAgICAgICk7XG4gICAgICB9ZWxzZSBpZighdXJsICYmIGxheWVyRGVmaW5pdGlvbi50eXBlID09PSBTdXBwb3J0ZWRMYXllclNlcnZpY2VUeXBlcy5GZWF0dXJlTGF5ZXIpeyAvLyBpcyBmZWF0dXJlIGNvbGxlY3Rpb25cbiAgICAgICAgc2luZ2xlRHNKc29uID0gSW1tdXRhYmxlKHtcbiAgICAgICAgICBpZDogZHNJZCxcbiAgICAgICAgICB0eXBlOiBEYXRhU291cmNlVHlwZXMuRmVhdHVyZUxheWVyLFxuICAgICAgICAgIGxheWVySWQ6IGAke2xheWVyRGVmaW5pdGlvbi5pZH1gXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZihzaW5nbGVEc0pzb24pe1xuICAgICAgICBpZih0aGlzLmdldERhdGFTb3VyY2VKc29uKCk/LnBvcnRhbFVybCl7XG4gICAgICAgICAgc2luZ2xlRHNKc29uID0gc2luZ2xlRHNKc29uLnNldCgncG9ydGFsVXJsJywgdGhpcy5nZXREYXRhU291cmNlSnNvbigpLnBvcnRhbFVybCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYodGhpcy5nZXREYXRhU291cmNlSnNvbigpPy5pdGVtSWQpe1xuICAgICAgICAgIHNpbmdsZURzSnNvbiA9IHNpbmdsZURzSnNvbi5zZXQoJ2l0ZW1JZCcsIHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5pdGVtSWQpO1xuICAgICAgICB9XG4gICAgICAgIGlmKHNjaGVtYSl7XG4gICAgICAgICAgc2luZ2xlRHNKc29uID0gc2luZ2xlRHNKc29uLnNldCgnc2NoZW1hJywgc2NoZW1hKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRzSnNvbnMucHVzaChzaW5nbGVEc0pzb24uc2V0KCdqaW11Q2hpbGRJZCcsIGppbXVDaGlsZElkKSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGRzSnNvbnM7XG4gIH1cblxuICBwcm90ZWN0ZWQgX2dldERzSnNvbnNGcm9tU2luZ2xlTGF5ZXIobGF5ZXI6IF9fZXNyaS5MYXllciB8IF9fZXNyaS5TdWJsYXllciwgZHNKc29uSW5Db25maWc6IElNRGF0YVNvdXJjZUpzb24pOiBJTURhdGFTb3VyY2VKc29uW117XG4gICAgaWYoIWxheWVyKXtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgY29uc3QgZHNKc29ucyA9IFtdO1xuICAgIGxldCBzaW5nbGVEc0pzb246IElNRGF0YVNvdXJjZUpzb247XG4gICAgY29uc3QgamltdUNoaWxkSWRzID0gdGhpcy5nZXRKaW11Q2hpbGRJZChkYXRhU291cmNlVXRpbHMuZ2V0Rml4ZWRMYXllcklkQnlMYXllcihsYXllcikpO1xuICAgIGppbXVDaGlsZElkcy5mb3JFYWNoKGppbXVDaGlsZElkID0+IHtcbiAgICAgIGNvbnN0IHNjaGVtYSA9IHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5zY2hlbWEgPyB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkuc2NoZW1hLmNoaWxkU2NoZW1hc1tqaW11Q2hpbGRJZF0gOiBudWxsO1xuICAgICAgY29uc3QgZHNJZCA9IHRoaXMuZ2V0Q2hpbGREYXRhU291cmNlSWQoamltdUNoaWxkSWQpO1xuICAgICAgY29uc3QgY2hpbGREYXRhU291cmNlSnNvbkluQ29uZmlnID0gZHNKc29uSW5Db25maWc/LmNoaWxkRGF0YVNvdXJjZUpzb25zICYmIGRzSnNvbkluQ29uZmlnLmNoaWxkRGF0YVNvdXJjZUpzb25zW2ppbXVDaGlsZElkXSA/IGRzSnNvbkluQ29uZmlnLmNoaWxkRGF0YVNvdXJjZUpzb25zW2ppbXVDaGlsZElkXSA6IG51bGw7XG5cbiAgICAgIGlmKChsYXllciBhcyBfX2VzcmkuR3JvdXBMYXllcikudHlwZSA9PT0gU3VwcG9ydGVkTGF5ZXJUeXBlcy5Hcm91cExheWVyKXtcbiAgICAgICAgc2luZ2xlRHNKc29uID0gSW1tdXRhYmxlKHtcbiAgICAgICAgICBpZDogZHNJZCxcbiAgICAgICAgICB0eXBlOiBEYXRhU291cmNlVHlwZXMuR3JvdXBMYXllclxuICAgICAgICB9KTtcbiAgICAgIH1lbHNlIGlmKChsYXllciBhcyBfX2VzcmkuRmVhdHVyZUxheWVyKS50eXBlID09PSBTdXBwb3J0ZWRMYXllclR5cGVzLkZlYXR1cmVMYXllcil7XG4gICAgICAgIHNpbmdsZURzSnNvbiA9IEltbXV0YWJsZSh7XG4gICAgICAgICAgaWQ6IGRzSWQsXG4gICAgICAgICAgdHlwZTogRGF0YVNvdXJjZVR5cGVzLkZlYXR1cmVMYXllcixcbiAgICAgICAgICBsYXllcklkOiBgJHsobGF5ZXIgYXMgX19lc3JpLkZlYXR1cmVMYXllcikubGF5ZXJJZH1gXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZihzaW5nbGVEc0pzb24pe1xuICAgICAgICBpZih0aGlzLmdldERhdGFTb3VyY2VKc29uKCk/LnBvcnRhbFVybCl7XG4gICAgICAgICAgc2luZ2xlRHNKc29uID0gc2luZ2xlRHNKc29uLnNldCgncG9ydGFsVXJsJywgdGhpcy5nZXREYXRhU291cmNlSnNvbigpLnBvcnRhbFVybCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYodGhpcy5nZXREYXRhU291cmNlSnNvbigpPy5pdGVtSWQpe1xuICAgICAgICAgIHNpbmdsZURzSnNvbiA9IHNpbmdsZURzSnNvbi5zZXQoJ2l0ZW1JZCcsIHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5pdGVtSWQpO1xuICAgICAgICB9XG4gICAgICAgIGlmKHNjaGVtYSl7XG4gICAgICAgICAgc2luZ2xlRHNKc29uID0gc2luZ2xlRHNKc29uLnNldCgnc2NoZW1hJywgc2NoZW1hKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNpbmdsZURzSnNvbiA9IGNoaWxkRGF0YVNvdXJjZUpzb25JbkNvbmZpZyA/IHNpbmdsZURzSnNvbi5tZXJnZShjaGlsZERhdGFTb3VyY2VKc29uSW5Db25maWcuYXNNdXRhYmxlKHtkZWVwOiB0cnVlfSkpIDogc2luZ2xlRHNKc29uO1xuXG4gICAgICAgIGRzSnNvbnMucHVzaChzaW5nbGVEc0pzb24uc2V0KCdqaW11Q2hpbGRJZCcsIGppbXVDaGlsZElkKSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGRzSnNvbnM7XG4gIH1cblxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBR0E7QUFXQTs7O0FBR0E7QUFDQTtBQUFBO0FBSUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTs7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBOztBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFBQTs7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQU1BO0FBQUE7QUFDQTtBQU1BO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7OyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./jimu-core/lib/data-sources/ds-base-types/abstract-layer-folder-data-source.ts\n");

/***/ }),

/***/ "./jimu-core/lib/data-sources/ds-base-types/abstract-loadable-data-source.ts":
/*!***********************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/ds-base-types/abstract-loadable-data-source.ts ***!
  \***********************************************************************************/
/*! exports provided: AbstractLoadableDataSource */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AbstractLoadableDataSource\", function() { return AbstractLoadableDataSource; });\n/* harmony import */ var _abstract_data_source__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./abstract-data-source */ \"./jimu-core/lib/data-sources/ds-base-types/abstract-data-source.ts\");\n/* harmony import */ var _data_source_interface__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../data-source-interface */ \"./jimu-core/lib/data-sources/data-source-interface.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n/** @ignore */\nvar AbstractLoadableDataSource = /** @class */ (function (_super) {\n    __extends(AbstractLoadableDataSource, _super);\n    function AbstractLoadableDataSource() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    AbstractLoadableDataSource.prototype.load = function () {\n        var _this = this;\n        this.setStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceStatus\"].Loading);\n        return this.doLoad().then(function (records) {\n            _this.records = records;\n            _this.setStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceStatus\"].Loaded);\n            return _this.records;\n        });\n    };\n    return AbstractLoadableDataSource;\n}(_abstract_data_source__WEBPACK_IMPORTED_MODULE_0__[\"AbstractDataSource\"]));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9kcy1iYXNlLXR5cGVzL2Fic3RyYWN0LWxvYWRhYmxlLWRhdGEtc291cmNlLnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vamltdS1jb3JlL2xpYi9kYXRhLXNvdXJjZXMvZHMtYmFzZS10eXBlcy9hYnN0cmFjdC1sb2FkYWJsZS1kYXRhLXNvdXJjZS50cz9hMjU4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFic3RyYWN0RGF0YVNvdXJjZSB9IGZyb20gJy4vYWJzdHJhY3QtZGF0YS1zb3VyY2UnO1xuaW1wb3J0IHsgTG9hZGFibGVEYXRhU291cmNlLCBEYXRhUmVjb3JkLCBEYXRhU291cmNlU3RhdHVzIH0gZnJvbSAnLi4vZGF0YS1zb3VyY2UtaW50ZXJmYWNlJztcblxuLyoqIEBpZ25vcmUgKi9cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdExvYWRhYmxlRGF0YVNvdXJjZSBleHRlbmRzIEFic3RyYWN0RGF0YVNvdXJjZSBpbXBsZW1lbnRzIExvYWRhYmxlRGF0YVNvdXJjZSB7XG4gIHVybDogc3RyaW5nO1xuXG4gIGxvYWQoKTogUHJvbWlzZTxEYXRhUmVjb3JkW10+IHtcbiAgICB0aGlzLnNldFN0YXR1cyhEYXRhU291cmNlU3RhdHVzLkxvYWRpbmcpO1xuICAgIHJldHVybiB0aGlzLmRvTG9hZCgpLnRoZW4ocmVjb3JkcyA9PiB7XG4gICAgICB0aGlzLnJlY29yZHMgPSByZWNvcmRzO1xuICAgICAgdGhpcy5zZXRTdGF0dXMoRGF0YVNvdXJjZVN0YXR1cy5Mb2FkZWQpO1xuICAgICAgcmV0dXJuIHRoaXMucmVjb3JkcztcbiAgICB9KTtcbiAgfVxuXG4gIGFic3RyYWN0IGRvTG9hZCgpOiBQcm9taXNlPERhdGFSZWNvcmRbXT47XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBOztBQWFBO0FBVkE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFBQTs7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./jimu-core/lib/data-sources/ds-base-types/abstract-loadable-data-source.ts\n");

/***/ }),

/***/ "./jimu-core/lib/data-sources/ds-base-types/abstract-queriable-data-source.ts":
/*!************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/ds-base-types/abstract-queriable-data-source.ts ***!
  \************************************************************************************/
/*! exports provided: AbstractQueriableDataSource */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AbstractQueriableDataSource\", function() { return AbstractQueriableDataSource; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _abstract_data_source__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./abstract-data-source */ \"./jimu-core/lib/data-sources/ds-base-types/abstract-data-source.ts\");\n/* harmony import */ var _data_source_interface__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../data-source-interface */ \"./jimu-core/lib/data-sources/data-source-interface.ts\");\n/* harmony import */ var jimu_core_lib_constants__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! jimu-core/lib/constants */ \"./jimu-core/lib/constants.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (undefined && undefined.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (undefined && undefined.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\n\n\n\n\nvar AbstractQueriableDataSource = /** @class */ (function (_super) {\n    __extends(AbstractQueriableDataSource, _super);\n    function AbstractQueriableDataSource(options) {\n        var _this = _super.call(this, options) || this;\n        _this.count = null;\n        /**\n         * data will be cached here, not this.records.\n         *\n         * When selectRecordById, some selected records may be put in this.records, so they are not in the pages.\n         */\n        _this.pages = {};\n        _this.pagePromises = {};\n        _this.url = _this.getDataSourceJson().url;\n        _this.setStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceStatus\"].Unloaded);\n        _this.setCountStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceStatus\"].Unloaded);\n        return _this;\n    }\n    AbstractQueriableDataSource.prototype.getCurrentQueryParams = function (excludeOption) {\n        var runtimeQuery = this.getRuntimeQueryParams(excludeOption && excludeOption.dataSourceId === this.id ? excludeOption === null || excludeOption === void 0 ? void 0 : excludeOption.widgetId : null);\n        return this.getCurrentQueryParamsByQuery(runtimeQuery, excludeOption);\n    };\n    AbstractQueriableDataSource.prototype.getRuntimeQueryParams = function (excludeWidgetId) {\n        var widgetQueries = excludeWidgetId ? this.getInfo().widgetQueries.without(excludeWidgetId) : this.getInfo().widgetQueries;\n        return this.getMergedWidgetQueries(widgetQueries);\n    };\n    AbstractQueriableDataSource.prototype.getCurrentQueryParamsByQuery = function (runtimeQuery, excludeOption) {\n        var query;\n        if (this.isLocal) { // local ds has no config query\n            query = this.mergeQueryParams(this.belongToDataSource.getCurrentQueryParams(excludeOption), runtimeQuery);\n        }\n        else if (this.isDataView) {\n            query = this.mergeQueryParams(this.getConfigQueryParams(), runtimeQuery);\n            query = this.mergeQueryParams(this.getMainDataSource().getCurrentQueryParams(excludeOption), query);\n        }\n        else {\n            query = this.mergeQueryParams(this.getConfigQueryParams(), runtimeQuery);\n            query = this.mergeQueryParams(this.getRemoteQueryParams(), query);\n        }\n        return query;\n    };\n    AbstractQueriableDataSource.prototype.getMergedWidgetQueries = function (widgetQueries) {\n        var _this = this;\n        var widgetIds = widgetQueries && Object.keys(widgetQueries) || [];\n        widgetIds = widgetIds.sort(function (a, b) { return a.localeCompare(b); });\n        var query;\n        widgetIds.forEach(function (widgetId) {\n            query = _this.mergeQueryParams(query, widgetQueries[widgetId]);\n        });\n        return query;\n    };\n    AbstractQueriableDataSource.prototype.getCurrentQueryId = function () {\n        return this.lastQueryId;\n    };\n    AbstractQueriableDataSource.prototype.getRealQueryParams = function (query, flag, options) {\n        var _this = this;\n        var realQuery;\n        if (flag === 'query') {\n            if (options && options.scope) {\n                if (options.scope === _data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"QueryScope\"].InAllData) {\n                    realQuery = query;\n                }\n                else if (options.scope === _data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"QueryScope\"].InRemoteConfigView) {\n                    realQuery = this.mergeQueryParams(this.getRemoteQueryParams(), query);\n                }\n                else if (options.scope === _data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"QueryScope\"].InConfigView) {\n                    realQuery = this.mergeQueryWithConfigQuery(query);\n                    realQuery = this.mergeQueryParams(this.getRemoteQueryParams(), realQuery);\n                }\n                else if (options.scope === _data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"QueryScope\"].InRuntimeView) {\n                    realQuery = this.mergeQueryParams(this.getCurrentQueryParams(options.excludeQuery), query);\n                }\n                else {\n                    realQuery = query;\n                }\n            }\n            else { // no scope, same as InRuntimeView\n                realQuery = this.mergeQueryParams(this.getCurrentQueryParams(options === null || options === void 0 ? void 0 : options.excludeQuery), query);\n            }\n        }\n        else { // for load\n            if (!options || !options.widgetId) {\n                console.error('Please pass widget id for load.');\n                return null;\n            }\n            var getQueryForLoadRuntime = function () {\n                var newQuery;\n                var widgetQueries = _this.getInfo().widgetQueries || Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])({});\n                if (options === null || options === void 0 ? void 0 : options.excludeQuery) {\n                    widgetQueries = widgetQueries.without(options.excludeQuery.widgetId);\n                }\n                widgetQueries = widgetQueries.set(options.widgetId, query);\n                newQuery = _this.getMergedWidgetQueries(widgetQueries);\n                newQuery = _this.getCurrentQueryParamsByQuery(newQuery, options === null || options === void 0 ? void 0 : options.excludeQuery);\n                return newQuery;\n            };\n            if (options && options.scope) {\n                if (options.scope === _data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"QueryScope\"].InAllData) {\n                    realQuery = query;\n                }\n                else if (options.scope === _data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"QueryScope\"].InRemoteConfigView) {\n                    realQuery = this.mergeQueryParams(this.getRemoteQueryParams(), query);\n                }\n                else if (options.scope === _data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"QueryScope\"].InConfigView) {\n                    realQuery = this.mergeQueryWithConfigQuery(query);\n                    realQuery = this.mergeQueryParams(this.getRemoteQueryParams(), realQuery);\n                }\n                else if (options.scope === _data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"QueryScope\"].InRuntimeView) {\n                    realQuery = getQueryForLoadRuntime();\n                }\n                else {\n                    realQuery = query;\n                }\n            }\n            else {\n                realQuery = getQueryForLoadRuntime();\n            }\n        }\n        return realQuery;\n    };\n    /**\n     * the data source's query is a data view config as well.\n     *  */\n    AbstractQueriableDataSource.prototype.getDataViewConfig = function () {\n        if (this.isLocal) {\n            return this.belongToDataSource.getDataViewConfig();\n        }\n        if (this.isDataView) {\n            return this.getDataSourceJson().dataViews && this.getDataSourceJson().dataViews[this.dataViewId];\n        }\n        else {\n            return this.getDataSourceJson().query;\n        }\n    };\n    AbstractQueriableDataSource.prototype.mergeQueryWithConfigQuery = function (query) {\n        var newQuery;\n        if (this.isLocal) {\n            if (this.belongToDataSource.isDataView) {\n                newQuery = this.mergeQueryParams(this.belongToDataSource.getConfigQueryParams(), query);\n                newQuery = this.mergeQueryParams(this.getMainDataSource().getConfigQueryParams(), newQuery);\n            }\n            else {\n                newQuery = this.mergeQueryParams(this.getConfigQueryParams(), query);\n            }\n        }\n        else if (this.isDataView) {\n            newQuery = this.mergeQueryParams(this.getConfigQueryParams(), query);\n            newQuery = this.mergeQueryParams(this.getMainDataSource().getConfigQueryParams(), newQuery);\n        }\n        else {\n            newQuery = this.mergeQueryParams(this.getConfigQueryParams(), query);\n        }\n        return newQuery;\n    };\n    AbstractQueriableDataSource.prototype.updateQueryParams = function (query, widgetId) {\n        query = this.getQueryWithoutPage(query);\n        if (!jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"utils\"].isDeepEqual(query, this.getInfo().widgetQueries && this.getInfo().widgetQueries[widgetId])) {\n            Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].updateWidgetQuery(this.id, widgetId, query));\n        }\n    };\n    AbstractQueriableDataSource.prototype.getQueryPageSize = function () {\n        var _a;\n        return ((_a = this.getDataViewConfig()) === null || _a === void 0 ? void 0 : _a.pageSize) || jimu_core_lib_constants__WEBPACK_IMPORTED_MODULE_3__[\"DEFAULT_QUERY_PAGE_SIZE\"];\n    };\n    AbstractQueriableDataSource.prototype.getMaxRecordCount = function () {\n        var _a;\n        return ((_a = this.getDataViewConfig()) === null || _a === void 0 ? void 0 : _a.maximum) || null;\n    };\n    AbstractQueriableDataSource.prototype.getQueryWithoutPage = function (query) {\n        if (!query) {\n            return null;\n        }\n        var pageSize = query.pageSize, page = query.page, q = __rest(query, [\"pageSize\", \"page\"]);\n        return q;\n    };\n    AbstractQueriableDataSource.prototype.checkClearLocalCache = function (query, lastQuery, options) {\n        var queryWithoutPage = this.getQueryWithoutPage(query);\n        var realQueryWithoutPage = this.getRealQueryParams(queryWithoutPage, 'load', options);\n        var refresh = options.refresh || this.getInfo().needRefresh;\n        if (jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"utils\"].isDeepEqual(realQueryWithoutPage, lastQuery) && !refresh) {\n            return false;\n        }\n        else {\n            return true;\n        }\n    };\n    AbstractQueriableDataSource.prototype.getRecordsByPage = function (page, pageSize) {\n        var pages = __assign({}, this.pages);\n        var maxPage = Object.keys(pages).map(function (p) { return parseInt(p); }).sort(function (a, b) { return b - a; })[0];\n        var records = [];\n        for (var i = 1; i <= maxPage; i++) {\n            if (pages[i]) {\n                records = records.concat(pages[i]);\n            }\n            else {\n                records = records.concat(Array(this.getQueryPageSize()).fill(null));\n            }\n        }\n        var start = pageSize * (page - 1);\n        var end = start + pageSize;\n        var maxCount = this.getMaxRecordCount();\n        if (maxCount !== null) {\n            start = Math.min(start, maxCount);\n            end = Math.min(end, maxCount);\n        }\n        return records.slice(start, end).filter(function (r) { return !!r; });\n    };\n    AbstractQueriableDataSource.prototype.getPagesData = function () {\n        return this.pages;\n    };\n    AbstractQueriableDataSource.prototype.setPagesData = function (pages) {\n        this.pages = pages;\n    };\n    AbstractQueriableDataSource.prototype.clearDataNotAddVersion = function () {\n        if (this.getSelectedRecords().length > 0) {\n            this.copySelectionToDataView([]);\n        }\n        this.pages = {};\n        this.pagePromises = {};\n        this.count = null;\n        this.countPromise = null;\n    };\n    AbstractQueriableDataSource.prototype.clearData = function () {\n        this.clearDataNotAddVersion();\n        this.addVersion();\n    };\n    /**\n     * get continuious page records\n     */\n    AbstractQueriableDataSource.prototype.getRecords = function () {\n        var _this = this;\n        var records = [];\n        var pages = []; // continuious pages\n        for (var i = 1; i <= Object.keys(this.pages).length; i++) {\n            if (!this.pages[i]) {\n                break;\n            }\n            pages.push(i);\n        }\n        pages.forEach(function (page) {\n            records = records.concat(_this.pages[page]);\n        });\n        if (this.getMaxRecordCount() !== null && this.getMaxRecordCount() < records.length) {\n            return records.slice(0, this.getMaxRecordCount());\n        }\n        return records;\n    };\n    AbstractQueriableDataSource.prototype.getRealQueryPages = function (page, pageSize) {\n        // the record index starts from 0\n        var start = pageSize * (page - 1);\n        var end = start + pageSize - 1;\n        if (this.getMaxRecordCount() !== null) {\n            end = Math.min(end, this.getMaxRecordCount() - 1);\n        }\n        var startPage = Math.floor(start / this.getQueryPageSize()) + 1;\n        var endPage = Math.floor(end / this.getQueryPageSize()) + 1;\n        var pages = [];\n        for (var i = startPage; i <= endPage; i++) {\n            pages.push(i);\n        }\n        return pages;\n    };\n    /**\n     * the page/pageSize in query will not be used in the actual query\n     */\n    AbstractQueriableDataSource.prototype.load = function (query, options) {\n        var _this = this;\n        if (options === void 0) { options = {}; }\n        query = __assign({}, query);\n        if (!query.page) {\n            query.page = 1;\n        }\n        if (!query.pageSize) {\n            query.pageSize = this.getQueryPageSize();\n        }\n        var queryPages = this.getRealQueryPages(query.page, query.pageSize);\n        if (this.checkClearLocalCache(query, this.lastQueryParams, options)) {\n            Object.keys(this.pages).forEach(function (p) {\n                if (queryPages.indexOf(parseInt(p)) < 0) {\n                    delete _this.pages[p];\n                }\n            });\n            this.pagePromises = {};\n            this.count = null;\n            this.countPromise = null;\n        }\n        this.updateQueryParams(query, options.widgetId);\n        var queryWithoutPage = this.getQueryWithoutPage(query);\n        var realQuery = this.getRealQueryParams(queryWithoutPage, 'load', options);\n        var pagePromises = queryPages.filter(function (page) { return _this.pagePromises[page]; }).map(function (page) { return _this.pagePromises[page]; });\n        if (pagePromises.length === queryPages.length) {\n            return Promise.all(pagePromises).then(function () {\n                return _this.getRecordsByPage(query.page, query.pageSize);\n            });\n        }\n        this.lastQueryParams = realQuery;\n        this.setStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceStatus\"].Loading);\n        Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].setDataNeedRefresh(this.id, false));\n        return Promise.all(queryPages.map(function (page) { return _this.loadByPage(realQuery, page); })).then(function (results) {\n            var isUseful = results.find(function (r) { return r; });\n            if (!isUseful) {\n                return [];\n            }\n            // keep selection\n            var records = _this.getRecords();\n            var selectedRecords = [];\n            if (_this.getSelectedRecordIds().length > 0) {\n                selectedRecords = _this.getSelectedRecordIds().map(function (id) { return records.filter(function (record) { return record && record.getId() === id; })[0]; });\n            }\n            else if (_this.getSelectedRecordIndexes().length > 0) {\n                selectedRecords = _this.getSelectedRecordIndexes().map(function (i) { return records[i]; });\n            }\n            if (selectedRecords.length > 0) { // TODO handle data views\n                _this.copySelectionToDataView(selectedRecords);\n            }\n            _this.lastRefreshTime = new Date();\n            _this.setStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceStatus\"].Loaded);\n            if (!(window.jimuConfig.isInBuilder && Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().appRuntimeInfo.appMode === jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"AppMode\"].Design)) {\n                _this.startAutoRefresh();\n            }\n            return _this.getRecordsByPage(query.page, query.pageSize);\n        }, function (err) {\n            console.error(err);\n            _this.setStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceStatus\"].LoadError);\n            return [];\n        });\n    };\n    /**\n     * the resolved boolean means whether the query result is used (only the last query update records)\n     * @param realQuery\n     * @param page\n     */\n    AbstractQueriableDataSource.prototype.loadByPage = function (realQuery, page) {\n        var _this = this;\n        if (this.pagePromises[page]) {\n            return this.pagePromises[page];\n        }\n        var realQueryWithPage = __assign(__assign({}, realQuery), { page: page, pageSize: this.getQueryPageSize() });\n        this.pagePromises[page] = this.doQuery(Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])(realQueryWithPage)).then(function (result) {\n            // make sure the last query take effect.\n            var resultQueryWithoutPage = _this.getQueryWithoutPage(result.queryParams);\n            if (!jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"utils\"].isDeepEqual(resultQueryWithoutPage, _this.lastQueryParams)) {\n                return false;\n            }\n            _this.pages[result.queryParams.page] = result.records;\n            return true;\n        });\n        return this.pagePromises[page];\n    };\n    AbstractQueriableDataSource.prototype.loadCount = function (query, options) {\n        var _this = this;\n        if (options === void 0) { options = {}; }\n        if (!this.checkClearLocalCache(query, this.lastCountQueryParams, options) && this.countPromise) {\n            return this.countPromise;\n        }\n        var realQuery = this.getRealQueryParams(this.getQueryWithoutPage(query), 'load', options);\n        this.lastCountQueryParams = realQuery;\n        this.setCountStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceStatus\"].Loading);\n        this.countPromise = this.doQueryCount(Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])(realQuery)).then(function (result) {\n            if (!jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"utils\"].isDeepEqual(result.queryParams, _this.lastCountQueryParams)) {\n                return null;\n            }\n            if (_this.getMaxRecordCount() === null) {\n                _this.count = result.count;\n            }\n            else {\n                _this.count = Math.min(result.count, _this.getMaxRecordCount());\n            }\n            _this.setCountStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceStatus\"].Loaded);\n            return _this.count;\n        }, function (err) {\n            console.error(err);\n            _this.setCountStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceStatus\"].LoadError);\n            return;\n        });\n        return this.countPromise;\n    };\n    AbstractQueriableDataSource.prototype.query = function (query, options) {\n        var _this = this;\n        var realQuery = this.getRealQueryParams(query, 'query', options);\n        return this.doQuery(Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])(realQuery)).then(function (result) {\n            var maxCount = _this.getMaxRecordCount();\n            if (maxCount === null) {\n                return result;\n            }\n            var page = result.queryParams.page || 1;\n            var pageSize = result.queryParams.pageSize;\n            if (page === 1 || !pageSize) {\n                if (result.records.length > maxCount) {\n                    result.records = result.records.slice(0, maxCount);\n                }\n            }\n            else {\n                if (((page - 1) * pageSize) > maxCount) {\n                    result.records = [];\n                }\n                else if ((page - 1) * pageSize + result.records.length > maxCount) {\n                    result.records = result.records.slice(0, (page - 1) * pageSize + result.records.length - maxCount);\n                }\n            }\n            return result;\n        });\n    };\n    AbstractQueriableDataSource.prototype.queryCount = function (query, options) {\n        var _this = this;\n        var realQuery = this.getRealQueryParams(query, 'query', options);\n        return this.doQueryCount(Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])(realQuery)).then(function (result) {\n            if (_this.getMaxRecordCount() === null) {\n                return result;\n            }\n            else {\n                result.count = Math.min(result.count, _this.getMaxRecordCount());\n                return result;\n            }\n        });\n    };\n    AbstractQueriableDataSource.prototype.loadById = function (id, refresh) {\n        var _this = this;\n        if (id === this.lastQueryId && !refresh && this.byIdPromise) {\n            return this.byIdPromise;\n        }\n        this.lastQueryId = id;\n        this.setStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceStatus\"].Loading);\n        this.byIdPromise = this.doQueryById(id).then(function (record) {\n            _this.setStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceStatus\"].Loaded);\n            return record;\n        }, function (err) {\n            console.error(err);\n            _this.setStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceStatus\"].LoadError);\n            return null;\n        });\n        return this.byIdPromise;\n    };\n    AbstractQueriableDataSource.prototype.queryById = function (id) {\n        return this.doQueryById(id);\n    };\n    AbstractQueriableDataSource.prototype.getAutoRefreshInterval = function () {\n        var ds = this.getMainDataSource();\n        var interval = ds.getDataViewConfig() && ds.getDataViewConfig().refreshInterval;\n        if (interval === 0) { // 0 means do not auto refresh.\n            return 0;\n        }\n        if (interval === null || typeof interval === 'undefined') { // means user layer/map's setting\n            interval = ds.getSchema().refreshInterval;\n        }\n        return interval;\n    };\n    AbstractQueriableDataSource.prototype.getLastRefreshTime = function () {\n        return this.lastRefreshTime;\n    };\n    AbstractQueriableDataSource.prototype.startAutoRefresh = function () {\n        var _this = this;\n        var interval = this.getAutoRefreshInterval();\n        if (!interval) {\n            return;\n        }\n        if (this.autoRefreshHandle) {\n            return;\n        }\n        Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].setDataNeedRefresh(this.id, false));\n        this.autoRefreshHandle = setTimeout(function () {\n            Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].setDataNeedRefresh(_this.id, true));\n            _this.stopAutoRefresh();\n        }, interval * 1000);\n    };\n    AbstractQueriableDataSource.prototype.stopAutoRefresh = function () {\n        if (this.autoRefreshHandle) {\n            clearTimeout(this.autoRefreshHandle);\n            this.autoRefreshHandle = null;\n        }\n    };\n    /**\n     * Not ready yet.\n     * @param record\n     */\n    AbstractQueriableDataSource.prototype.addRecord = function (record) {\n        var _this = this;\n        this.setSaveStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceStatus\"].Saving);\n        return this.doAdd(record).then(function (record) {\n            _this.records.push(record);\n            _this.setSaveStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceStatus\"].Saved);\n            return record;\n        });\n    };\n    /**\n     * Not ready yet.\n     * @param record\n     */\n    AbstractQueriableDataSource.prototype.updateRecord = function (record) {\n        var _this = this;\n        this.setSaveStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceStatus\"].Saving);\n        return this.doUpdateRecord(record).then(function (record) {\n            var i = _this.records.findIndex(function (r) { return r.getId() === record.getId(); });\n            _this.records.splice(i, 1, record);\n            _this.setSaveStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceStatus\"].Saved);\n            return record;\n        });\n    };\n    /**\n     * Not ready yet.\n     * @param record\n     */\n    AbstractQueriableDataSource.prototype.deleteRecord = function (index) {\n        var _this = this;\n        this.setSaveStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceStatus\"].Saving);\n        return this.doDeleteRecord(index).then(function () {\n            _this.records.splice(index, 1);\n            _this.setSaveStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceStatus\"].Saved);\n            return;\n        });\n    };\n    AbstractQueriableDataSource.prototype.getSaveStatus = function () {\n        var _a;\n        return (_a = Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().getState().dataSourcesInfo[this.id]) === null || _a === void 0 ? void 0 : _a.saveStatus;\n    };\n    AbstractQueriableDataSource.prototype.setSaveStatus = function (status) {\n        Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].dataSourceSaveStatusChanged(this.id, status));\n    };\n    AbstractQueriableDataSource.prototype.getMainDataSource = function () {\n        return _super.prototype.getMainDataSource.call(this);\n    };\n    AbstractQueriableDataSource.prototype.getDataViews = function () {\n        return _super.prototype.getDataViews.call(this);\n    };\n    AbstractQueriableDataSource.prototype.getDataView = function (dataViewId) {\n        return _super.prototype.getDataView.call(this, dataViewId);\n    };\n    return AbstractQueriableDataSource;\n}(_abstract_data_source__WEBPACK_IMPORTED_MODULE_1__[\"AbstractDataSource\"]));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9kcy1iYXNlLXR5cGVzL2Fic3RyYWN0LXF1ZXJpYWJsZS1kYXRhLXNvdXJjZS50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2RzLWJhc2UtdHlwZXMvYWJzdHJhY3QtcXVlcmlhYmxlLWRhdGEtc291cmNlLnRzPzY0YTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0QXBwU3RvcmUsIHV0aWxzLCBhcHBBY3Rpb25zLCBJTURhdGFWaWV3SnNvbiwgSW1tdXRhYmxlLCBBcHBNb2RlIH0gZnJvbSAnamltdS1jb3JlJztcbmltcG9ydCB7IEFic3RyYWN0RGF0YVNvdXJjZSB9IGZyb20gJy4vYWJzdHJhY3QtZGF0YS1zb3VyY2UnO1xuaW1wb3J0IHtcbiAgUXVlcmlhYmxlRGF0YVNvdXJjZSwgRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucywgRGF0YVNvdXJjZVN0YXR1cywgUXVlcnlPcHRpb25zLCBRdWVyeVNjb3BlLCBRdWVyeVJlc3VsdCwgRGF0YVJlY29yZCwgUXVlcnlQYXJhbXMsIElNUXVlcnlQYXJhbXMsIFdpZGdldERhdGFTb3VyY2VQYWlyXG59IGZyb20gJy4uL2RhdGEtc291cmNlLWludGVyZmFjZSc7XG5pbXBvcnQgeyBERUZBVUxUX1FVRVJZX1BBR0VfU0laRSB9IGZyb20gJ2ppbXUtY29yZS9saWIvY29uc3RhbnRzJztcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEFic3RyYWN0UXVlcmlhYmxlRGF0YVNvdXJjZSBleHRlbmRzIEFic3RyYWN0RGF0YVNvdXJjZSBpbXBsZW1lbnRzIFF1ZXJpYWJsZURhdGFTb3VyY2Uge1xuICB1cmw6IHN0cmluZztcbiAgY291bnQ6IG51bWJlciA9IG51bGw7XG4gIGxhc3RVcGRhdGVUaW1lOiBEYXRlO1xuXG4gIHByaXZhdGUgbGFzdFF1ZXJ5SWQ6IHN0cmluZztcbiAgcHJpdmF0ZSBsYXN0UXVlcnlQYXJhbXM6IFF1ZXJ5UGFyYW1zO1xuICBwcml2YXRlIGxhc3RDb3VudFF1ZXJ5UGFyYW1zOiBRdWVyeVBhcmFtcztcbiAgcHJpdmF0ZSBsYXN0UmVmcmVzaFRpbWU6IERhdGU7XG5cbiAgLyoqXG4gICAqIGRhdGEgd2lsbCBiZSBjYWNoZWQgaGVyZSwgbm90IHRoaXMucmVjb3Jkcy5cbiAgICpcbiAgICogV2hlbiBzZWxlY3RSZWNvcmRCeUlkLCBzb21lIHNlbGVjdGVkIHJlY29yZHMgbWF5IGJlIHB1dCBpbiB0aGlzLnJlY29yZHMsIHNvIHRoZXkgYXJlIG5vdCBpbiB0aGUgcGFnZXMuXG4gICAqL1xuICBwcml2YXRlIHBhZ2VzOiB7W3BhZ2VJZDogbnVtYmVyXTogRGF0YVJlY29yZFtdfSA9IHt9O1xuXG4gIHByaXZhdGUgcGFnZVByb21pc2VzOiB7W3BhZ2VJZDogbnVtYmVyXTogUHJvbWlzZTxib29sZWFuPn0gPSB7fTtcbiAgcHJpdmF0ZSBjb3VudFByb21pc2U7XG4gIHByaXZhdGUgYnlJZFByb21pc2U7XG5cbiAgcHJpdmF0ZSBhdXRvUmVmcmVzaEhhbmRsZTtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zKSB7XG4gICAgc3VwZXIob3B0aW9ucyk7XG4gICAgdGhpcy51cmwgPSB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkudXJsO1xuICAgIHRoaXMuc2V0U3RhdHVzKERhdGFTb3VyY2VTdGF0dXMuVW5sb2FkZWQpO1xuICAgIHRoaXMuc2V0Q291bnRTdGF0dXMoRGF0YVNvdXJjZVN0YXR1cy5VbmxvYWRlZCk7XG4gIH1cblxuICBnZXRDdXJyZW50UXVlcnlQYXJhbXMoZXhjbHVkZU9wdGlvbj86IFdpZGdldERhdGFTb3VyY2VQYWlyKXtcbiAgICBjb25zdCBydW50aW1lUXVlcnkgPSB0aGlzLmdldFJ1bnRpbWVRdWVyeVBhcmFtcyhleGNsdWRlT3B0aW9uICYmIGV4Y2x1ZGVPcHRpb24uZGF0YVNvdXJjZUlkID09PSB0aGlzLmlkID8gZXhjbHVkZU9wdGlvbj8ud2lkZ2V0SWQgOiBudWxsKTtcbiAgICByZXR1cm4gdGhpcy5nZXRDdXJyZW50UXVlcnlQYXJhbXNCeVF1ZXJ5KHJ1bnRpbWVRdWVyeSwgZXhjbHVkZU9wdGlvbik7XG4gIH1cblxuICBnZXRSdW50aW1lUXVlcnlQYXJhbXMoZXhjbHVkZVdpZGdldElkPzogc3RyaW5nKXtcbiAgICBjb25zdCB3aWRnZXRRdWVyaWVzID0gZXhjbHVkZVdpZGdldElkID8gdGhpcy5nZXRJbmZvKCkud2lkZ2V0UXVlcmllcy53aXRob3V0KGV4Y2x1ZGVXaWRnZXRJZCkgOiB0aGlzLmdldEluZm8oKS53aWRnZXRRdWVyaWVzO1xuICAgIHJldHVybiB0aGlzLmdldE1lcmdlZFdpZGdldFF1ZXJpZXMod2lkZ2V0UXVlcmllcyk7XG4gIH1cblxuICBwcml2YXRlIGdldEN1cnJlbnRRdWVyeVBhcmFtc0J5UXVlcnkocnVudGltZVF1ZXJ5OiBRdWVyeVBhcmFtcywgZXhjbHVkZU9wdGlvbj86IFdpZGdldERhdGFTb3VyY2VQYWlyKXtcbiAgICBsZXQgcXVlcnk7XG4gICAgaWYodGhpcy5pc0xvY2FsKXsgLy8gbG9jYWwgZHMgaGFzIG5vIGNvbmZpZyBxdWVyeVxuICAgICAgcXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXMoKHRoaXMuYmVsb25nVG9EYXRhU291cmNlIGFzIFF1ZXJpYWJsZURhdGFTb3VyY2UpLmdldEN1cnJlbnRRdWVyeVBhcmFtcyhleGNsdWRlT3B0aW9uKSwgcnVudGltZVF1ZXJ5KTtcbiAgICB9ZWxzZSBpZih0aGlzLmlzRGF0YVZpZXcpe1xuICAgICAgcXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXModGhpcy5nZXRDb25maWdRdWVyeVBhcmFtcygpLCBydW50aW1lUXVlcnkpO1xuICAgICAgcXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXModGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldEN1cnJlbnRRdWVyeVBhcmFtcyhleGNsdWRlT3B0aW9uKSwgcXVlcnkpO1xuICAgIH1lbHNle1xuICAgICAgcXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXModGhpcy5nZXRDb25maWdRdWVyeVBhcmFtcygpLCBydW50aW1lUXVlcnkpO1xuICAgICAgcXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXModGhpcy5nZXRSZW1vdGVRdWVyeVBhcmFtcygpLCBxdWVyeSk7XG4gICAgfVxuICAgIHJldHVybiBxdWVyeTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0TWVyZ2VkV2lkZ2V0UXVlcmllcyh3aWRnZXRRdWVyaWVzOiB7W3dpZGdldElkOiBzdHJpbmddOiBRdWVyeVBhcmFtc30pOiBRdWVyeVBhcmFtc3tcbiAgICBsZXQgd2lkZ2V0SWRzID0gd2lkZ2V0UXVlcmllcyAmJiBPYmplY3Qua2V5cyh3aWRnZXRRdWVyaWVzKSB8fCBbXTtcbiAgICB3aWRnZXRJZHMgPSB3aWRnZXRJZHMuc29ydCgoYSwgYikgPT4gYS5sb2NhbGVDb21wYXJlKGIpKTtcblxuICAgIGxldCBxdWVyeTtcbiAgICB3aWRnZXRJZHMuZm9yRWFjaCh3aWRnZXRJZCA9PiB7XG4gICAgICBxdWVyeSA9IHRoaXMubWVyZ2VRdWVyeVBhcmFtcyhxdWVyeSwgd2lkZ2V0UXVlcmllc1t3aWRnZXRJZF0pO1xuICAgIH0pO1xuICAgIHJldHVybiBxdWVyeTtcbiAgfVxuXG4gIGdldEN1cnJlbnRRdWVyeUlkKCl7XG4gICAgcmV0dXJuIHRoaXMubGFzdFF1ZXJ5SWQ7XG4gIH1cblxuICBnZXRSZWFsUXVlcnlQYXJhbXMocXVlcnk6IFF1ZXJ5UGFyYW1zLCBmbGFnOiAncXVlcnknIHwgJ2xvYWQnLCBvcHRpb25zPzogUXVlcnlPcHRpb25zKTogUXVlcnlQYXJhbXN7XG4gICAgbGV0IHJlYWxRdWVyeTtcbiAgICBpZihmbGFnID09PSAncXVlcnknKXtcbiAgICAgIGlmKG9wdGlvbnMgJiYgb3B0aW9ucy5zY29wZSl7XG4gICAgICAgIGlmKG9wdGlvbnMuc2NvcGUgPT09IFF1ZXJ5U2NvcGUuSW5BbGxEYXRhKXtcbiAgICAgICAgICByZWFsUXVlcnkgPSBxdWVyeTtcbiAgICAgICAgfWVsc2UgaWYob3B0aW9ucy5zY29wZSA9PT0gUXVlcnlTY29wZS5JblJlbW90ZUNvbmZpZ1ZpZXcpe1xuICAgICAgICAgIHJlYWxRdWVyeSA9IHRoaXMubWVyZ2VRdWVyeVBhcmFtcyh0aGlzLmdldFJlbW90ZVF1ZXJ5UGFyYW1zKCksIHF1ZXJ5KTtcbiAgICAgICAgfWVsc2UgaWYob3B0aW9ucy5zY29wZSA9PT0gUXVlcnlTY29wZS5JbkNvbmZpZ1ZpZXcpe1xuICAgICAgICAgIHJlYWxRdWVyeSA9IHRoaXMubWVyZ2VRdWVyeVdpdGhDb25maWdRdWVyeShxdWVyeSk7XG4gICAgICAgICAgcmVhbFF1ZXJ5ID0gdGhpcy5tZXJnZVF1ZXJ5UGFyYW1zKHRoaXMuZ2V0UmVtb3RlUXVlcnlQYXJhbXMoKSwgcmVhbFF1ZXJ5KTtcbiAgICAgICAgfWVsc2UgaWYob3B0aW9ucy5zY29wZSA9PT0gUXVlcnlTY29wZS5JblJ1bnRpbWVWaWV3KXtcbiAgICAgICAgICByZWFsUXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXModGhpcy5nZXRDdXJyZW50UXVlcnlQYXJhbXMob3B0aW9ucy5leGNsdWRlUXVlcnkpLCBxdWVyeSk7XG4gICAgICAgIH1lbHNle1xuICAgICAgICAgIHJlYWxRdWVyeSA9IHF1ZXJ5O1xuICAgICAgICB9XG4gICAgICB9ZWxzZXsgLy8gbm8gc2NvcGUsIHNhbWUgYXMgSW5SdW50aW1lVmlld1xuICAgICAgICByZWFsUXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXModGhpcy5nZXRDdXJyZW50UXVlcnlQYXJhbXMob3B0aW9ucz8uZXhjbHVkZVF1ZXJ5KSwgcXVlcnkpO1xuICAgICAgfVxuICAgIH1lbHNleyAvLyBmb3IgbG9hZFxuICAgICAgaWYoIW9wdGlvbnMgfHwgIW9wdGlvbnMud2lkZ2V0SWQpe1xuICAgICAgICBjb25zb2xlLmVycm9yKCdQbGVhc2UgcGFzcyB3aWRnZXQgaWQgZm9yIGxvYWQuJyk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBnZXRRdWVyeUZvckxvYWRSdW50aW1lID0gKCkgPT4ge1xuICAgICAgICBsZXQgbmV3UXVlcnk7XG4gICAgICAgIGxldCB3aWRnZXRRdWVyaWVzID0gdGhpcy5nZXRJbmZvKCkud2lkZ2V0UXVlcmllcyB8fCBJbW11dGFibGUoe30gYXMgYW55KTtcbiAgICAgICAgaWYob3B0aW9ucz8uZXhjbHVkZVF1ZXJ5KXtcbiAgICAgICAgICB3aWRnZXRRdWVyaWVzID0gd2lkZ2V0UXVlcmllcy53aXRob3V0KG9wdGlvbnMuZXhjbHVkZVF1ZXJ5LndpZGdldElkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHdpZGdldFF1ZXJpZXMgPSB3aWRnZXRRdWVyaWVzLnNldChvcHRpb25zLndpZGdldElkLCBxdWVyeSk7XG5cbiAgICAgICAgbmV3UXVlcnkgPSB0aGlzLmdldE1lcmdlZFdpZGdldFF1ZXJpZXMod2lkZ2V0UXVlcmllcyk7XG4gICAgICAgIG5ld1F1ZXJ5ID0gdGhpcy5nZXRDdXJyZW50UXVlcnlQYXJhbXNCeVF1ZXJ5KG5ld1F1ZXJ5LCBvcHRpb25zPy5leGNsdWRlUXVlcnkpO1xuICAgICAgICByZXR1cm4gbmV3UXVlcnk7XG4gICAgICB9O1xuXG4gICAgICBpZihvcHRpb25zICYmIG9wdGlvbnMuc2NvcGUpe1xuICAgICAgICBpZihvcHRpb25zLnNjb3BlID09PSBRdWVyeVNjb3BlLkluQWxsRGF0YSl7XG4gICAgICAgICAgcmVhbFF1ZXJ5ID0gcXVlcnk7XG4gICAgICAgIH1lbHNlIGlmKG9wdGlvbnMuc2NvcGUgPT09IFF1ZXJ5U2NvcGUuSW5SZW1vdGVDb25maWdWaWV3KXtcbiAgICAgICAgICByZWFsUXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXModGhpcy5nZXRSZW1vdGVRdWVyeVBhcmFtcygpLCBxdWVyeSk7XG4gICAgICAgIH1lbHNlIGlmKG9wdGlvbnMuc2NvcGUgPT09IFF1ZXJ5U2NvcGUuSW5Db25maWdWaWV3KXtcbiAgICAgICAgICByZWFsUXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlXaXRoQ29uZmlnUXVlcnkocXVlcnkpO1xuICAgICAgICAgIHJlYWxRdWVyeSA9IHRoaXMubWVyZ2VRdWVyeVBhcmFtcyh0aGlzLmdldFJlbW90ZVF1ZXJ5UGFyYW1zKCksIHJlYWxRdWVyeSk7XG4gICAgICAgIH1lbHNlIGlmKG9wdGlvbnMuc2NvcGUgPT09IFF1ZXJ5U2NvcGUuSW5SdW50aW1lVmlldyl7XG4gICAgICAgICAgcmVhbFF1ZXJ5ID0gZ2V0UXVlcnlGb3JMb2FkUnVudGltZSgpO1xuICAgICAgICB9ZWxzZXtcbiAgICAgICAgICByZWFsUXVlcnkgPSBxdWVyeTtcbiAgICAgICAgfVxuICAgICAgfWVsc2V7XG4gICAgICAgIHJlYWxRdWVyeSA9IGdldFF1ZXJ5Rm9yTG9hZFJ1bnRpbWUoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcmVhbFF1ZXJ5O1xuICB9XG5cbiAgLyoqXG4gICAqIHRoZSBkYXRhIHNvdXJjZSdzIHF1ZXJ5IGlzIGEgZGF0YSB2aWV3IGNvbmZpZyBhcyB3ZWxsLlxuICAgKiAgKi9cbiAgcHJvdGVjdGVkIGdldERhdGFWaWV3Q29uZmlnKCk6IElNRGF0YVZpZXdKc29ue1xuICAgIGlmKHRoaXMuaXNMb2NhbCl7XG4gICAgICByZXR1cm4gKHRoaXMuYmVsb25nVG9EYXRhU291cmNlIGFzIEFic3RyYWN0UXVlcmlhYmxlRGF0YVNvdXJjZSkuZ2V0RGF0YVZpZXdDb25maWcoKTtcbiAgICB9XG4gICAgaWYodGhpcy5pc0RhdGFWaWV3KXtcbiAgICAgIHJldHVybiB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkuZGF0YVZpZXdzICYmIHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5kYXRhVmlld3NbdGhpcy5kYXRhVmlld0lkXTtcbiAgICB9ZWxzZXtcbiAgICAgIHJldHVybiB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkucXVlcnk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBtZXJnZVF1ZXJ5V2l0aENvbmZpZ1F1ZXJ5KHF1ZXJ5OiBRdWVyeVBhcmFtcyl7XG4gICAgbGV0IG5ld1F1ZXJ5O1xuICAgIGlmKHRoaXMuaXNMb2NhbCl7XG4gICAgICBpZih0aGlzLmJlbG9uZ1RvRGF0YVNvdXJjZS5pc0RhdGFWaWV3KXtcbiAgICAgICAgbmV3UXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXMoKHRoaXMuYmVsb25nVG9EYXRhU291cmNlIGFzIFF1ZXJpYWJsZURhdGFTb3VyY2UpLmdldENvbmZpZ1F1ZXJ5UGFyYW1zKCksIHF1ZXJ5KTtcbiAgICAgICAgbmV3UXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXModGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpLmdldENvbmZpZ1F1ZXJ5UGFyYW1zKCksIG5ld1F1ZXJ5KTtcbiAgICAgIH1lbHNle1xuICAgICAgICBuZXdRdWVyeSA9IHRoaXMubWVyZ2VRdWVyeVBhcmFtcyh0aGlzLmdldENvbmZpZ1F1ZXJ5UGFyYW1zKCksIHF1ZXJ5KTtcbiAgICAgIH1cbiAgICB9ZWxzZSBpZih0aGlzLmlzRGF0YVZpZXcpe1xuICAgICAgbmV3UXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXModGhpcy5nZXRDb25maWdRdWVyeVBhcmFtcygpLCBxdWVyeSk7XG4gICAgICBuZXdRdWVyeSA9IHRoaXMubWVyZ2VRdWVyeVBhcmFtcyh0aGlzLmdldE1haW5EYXRhU291cmNlKCkuZ2V0Q29uZmlnUXVlcnlQYXJhbXMoKSwgbmV3UXVlcnkpO1xuICAgIH1lbHNle1xuICAgICAgbmV3UXVlcnkgPSB0aGlzLm1lcmdlUXVlcnlQYXJhbXModGhpcy5nZXRDb25maWdRdWVyeVBhcmFtcygpLCBxdWVyeSk7XG4gICAgfVxuICAgIHJldHVybiBuZXdRdWVyeTtcbiAgfVxuXG4gIHVwZGF0ZVF1ZXJ5UGFyYW1zKHF1ZXJ5OiBRdWVyeVBhcmFtcywgd2lkZ2V0SWQ6IHN0cmluZyl7XG4gICAgcXVlcnkgPSB0aGlzLmdldFF1ZXJ5V2l0aG91dFBhZ2UocXVlcnkpO1xuICAgIGlmKCF1dGlscy5pc0RlZXBFcXVhbChxdWVyeSwgdGhpcy5nZXRJbmZvKCkud2lkZ2V0UXVlcmllcyAmJiB0aGlzLmdldEluZm8oKS53aWRnZXRRdWVyaWVzW3dpZGdldElkXSkpe1xuICAgICAgZ2V0QXBwU3RvcmUoKS5kaXNwYXRjaChhcHBBY3Rpb25zLnVwZGF0ZVdpZGdldFF1ZXJ5KHRoaXMuaWQsIHdpZGdldElkLCBxdWVyeSkpO1xuICAgIH1cbiAgfVxuXG4gIGdldFF1ZXJ5UGFnZVNpemUoKTogbnVtYmVye1xuICAgIHJldHVybiB0aGlzLmdldERhdGFWaWV3Q29uZmlnKCk/LnBhZ2VTaXplIHx8IERFRkFVTFRfUVVFUllfUEFHRV9TSVpFO1xuICB9XG5cbiAgZ2V0TWF4UmVjb3JkQ291bnQoKTogbnVtYmVye1xuICAgIHJldHVybiB0aGlzLmdldERhdGFWaWV3Q29uZmlnKCk/Lm1heGltdW0gfHwgbnVsbDtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0UXVlcnlXaXRob3V0UGFnZShxdWVyeTogUXVlcnlQYXJhbXMpOiBRdWVyeVBhcmFtc3tcbiAgICBpZighcXVlcnkpe1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IHtwYWdlU2l6ZSwgcGFnZSwgLi4ucX0gPSBxdWVyeTtcbiAgICByZXR1cm4gcTtcbiAgfVxuXG4gIHByaXZhdGUgY2hlY2tDbGVhckxvY2FsQ2FjaGUocXVlcnk6IFF1ZXJ5UGFyYW1zLCBsYXN0UXVlcnk6IFF1ZXJ5UGFyYW1zLCBvcHRpb25zPzogUXVlcnlPcHRpb25zKTogYm9vbGVhbntcbiAgICBjb25zdCBxdWVyeVdpdGhvdXRQYWdlID0gdGhpcy5nZXRRdWVyeVdpdGhvdXRQYWdlKHF1ZXJ5KTtcbiAgICBjb25zdCByZWFsUXVlcnlXaXRob3V0UGFnZSA9IHRoaXMuZ2V0UmVhbFF1ZXJ5UGFyYW1zKHF1ZXJ5V2l0aG91dFBhZ2UsICdsb2FkJywgb3B0aW9ucyk7XG5cbiAgICBjb25zdCByZWZyZXNoID0gb3B0aW9ucy5yZWZyZXNoIHx8IHRoaXMuZ2V0SW5mbygpLm5lZWRSZWZyZXNoO1xuICAgIGlmKHV0aWxzLmlzRGVlcEVxdWFsKHJlYWxRdWVyeVdpdGhvdXRQYWdlLCBsYXN0UXVlcnkpICYmICFyZWZyZXNoKXtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9ZWxzZXtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIGdldFJlY29yZHNCeVBhZ2UocGFnZTogbnVtYmVyLCBwYWdlU2l6ZTogbnVtYmVyKTogRGF0YVJlY29yZFtde1xuICAgIGNvbnN0IHBhZ2VzID0gey4uLnRoaXMucGFnZXN9O1xuICAgIGNvbnN0IG1heFBhZ2UgPSBPYmplY3Qua2V5cyhwYWdlcykubWFwKHAgPT4gcGFyc2VJbnQocCkpLnNvcnQoKGEsIGIpID0+IGIgLSBhKVswXTtcblxuICAgIGxldCByZWNvcmRzID0gW107XG4gICAgZm9yKGxldCBpID0gMTsgaSA8PSBtYXhQYWdlOyBpKyspe1xuICAgICAgaWYocGFnZXNbaV0pe1xuICAgICAgICByZWNvcmRzID0gcmVjb3Jkcy5jb25jYXQocGFnZXNbaV0pO1xuICAgICAgfWVsc2V7XG4gICAgICAgIHJlY29yZHMgPSByZWNvcmRzLmNvbmNhdChBcnJheSh0aGlzLmdldFF1ZXJ5UGFnZVNpemUoKSkuZmlsbChudWxsKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbGV0IHN0YXJ0ID0gcGFnZVNpemUgKiAocGFnZSAtIDEpO1xuICAgIGxldCBlbmQgPSBzdGFydCArIHBhZ2VTaXplO1xuXG4gICAgY29uc3QgbWF4Q291bnQgPSB0aGlzLmdldE1heFJlY29yZENvdW50KCk7XG4gICAgaWYobWF4Q291bnQgIT09IG51bGwpe1xuICAgICAgc3RhcnQgPSBNYXRoLm1pbihzdGFydCwgbWF4Q291bnQpO1xuICAgICAgZW5kID0gTWF0aC5taW4oZW5kLCBtYXhDb3VudCk7XG4gICAgfVxuICAgIHJldHVybiByZWNvcmRzLnNsaWNlKHN0YXJ0LCBlbmQpLmZpbHRlcihyID0+ICEhcik7XG4gIH1cblxuICBnZXRQYWdlc0RhdGEoKToge1twYWdlOiBudW1iZXJdOiBEYXRhUmVjb3JkW119e1xuICAgIHJldHVybiB0aGlzLnBhZ2VzO1xuICB9XG5cbiAgc2V0UGFnZXNEYXRhKHBhZ2VzOiB7W3BhZ2U6IG51bWJlcl06IERhdGFSZWNvcmRbXX0pe1xuICAgIHRoaXMucGFnZXMgPSBwYWdlcztcbiAgfVxuXG4gIHByaXZhdGUgY2xlYXJEYXRhTm90QWRkVmVyc2lvbigpe1xuICAgIGlmKHRoaXMuZ2V0U2VsZWN0ZWRSZWNvcmRzKCkubGVuZ3RoID4gMCl7XG4gICAgICB0aGlzLmNvcHlTZWxlY3Rpb25Ub0RhdGFWaWV3KFtdKTtcbiAgICB9XG4gICAgdGhpcy5wYWdlcyA9IHt9O1xuICAgIHRoaXMucGFnZVByb21pc2VzID0ge307XG4gICAgdGhpcy5jb3VudCA9IG51bGw7XG4gICAgdGhpcy5jb3VudFByb21pc2UgPSBudWxsO1xuICB9XG5cbiAgY2xlYXJEYXRhKCl7XG4gICAgdGhpcy5jbGVhckRhdGFOb3RBZGRWZXJzaW9uKCk7XG4gICAgdGhpcy5hZGRWZXJzaW9uKCk7XG4gIH1cblxuICAvKipcbiAgICogZ2V0IGNvbnRpbnVpb3VzIHBhZ2UgcmVjb3Jkc1xuICAgKi9cbiAgZ2V0UmVjb3JkcygpOiBEYXRhUmVjb3JkW117XG4gICAgbGV0IHJlY29yZHMgPSBbXTtcbiAgICBjb25zdCBwYWdlcyA9IFtdOyAvLyBjb250aW51aW91cyBwYWdlc1xuICAgIGZvcihsZXQgaSA9IDE7IGkgPD0gT2JqZWN0LmtleXModGhpcy5wYWdlcykubGVuZ3RoOyBpKyspe1xuICAgICAgaWYoIXRoaXMucGFnZXNbaV0pe1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHBhZ2VzLnB1c2goaSk7XG4gICAgfVxuICAgIHBhZ2VzLmZvckVhY2gocGFnZSA9PiB7XG4gICAgICByZWNvcmRzID0gcmVjb3Jkcy5jb25jYXQodGhpcy5wYWdlc1twYWdlXSk7XG4gICAgfSk7XG4gICAgaWYodGhpcy5nZXRNYXhSZWNvcmRDb3VudCgpICE9PSBudWxsICYmIHRoaXMuZ2V0TWF4UmVjb3JkQ291bnQoKSA8IHJlY29yZHMubGVuZ3RoKXtcbiAgICAgIHJldHVybiByZWNvcmRzLnNsaWNlKDAsIHRoaXMuZ2V0TWF4UmVjb3JkQ291bnQoKSk7XG4gICAgfVxuICAgIHJldHVybiByZWNvcmRzO1xuICB9XG5cbiAgZ2V0UmVhbFF1ZXJ5UGFnZXMocGFnZTogbnVtYmVyLCBwYWdlU2l6ZTogbnVtYmVyKTogbnVtYmVyW117XG4gICAgLy8gdGhlIHJlY29yZCBpbmRleCBzdGFydHMgZnJvbSAwXG4gICAgY29uc3Qgc3RhcnQgPSBwYWdlU2l6ZSAqIChwYWdlIC0gMSk7XG4gICAgbGV0IGVuZCA9IHN0YXJ0ICsgcGFnZVNpemUgLSAxO1xuICAgIGlmKHRoaXMuZ2V0TWF4UmVjb3JkQ291bnQoKSAhPT0gbnVsbCl7XG4gICAgICBlbmQgPSBNYXRoLm1pbihlbmQsIHRoaXMuZ2V0TWF4UmVjb3JkQ291bnQoKSAtIDEpO1xuICAgIH1cbiAgICBjb25zdCBzdGFydFBhZ2UgPSBNYXRoLmZsb29yKHN0YXJ0IC8gdGhpcy5nZXRRdWVyeVBhZ2VTaXplKCkpICsgMTtcbiAgICBjb25zdCBlbmRQYWdlID0gTWF0aC5mbG9vcihlbmQgLyB0aGlzLmdldFF1ZXJ5UGFnZVNpemUoKSkgKyAxO1xuICAgIGNvbnN0IHBhZ2VzID0gW107XG4gICAgZm9yKGxldCBpID0gc3RhcnRQYWdlOyBpIDw9IGVuZFBhZ2U7IGkrKyl7XG4gICAgICBwYWdlcy5wdXNoKGkpO1xuICAgIH1cbiAgICByZXR1cm4gcGFnZXM7XG4gIH1cblxuICAvKipcbiAgICogdGhlIHBhZ2UvcGFnZVNpemUgaW4gcXVlcnkgd2lsbCBub3QgYmUgdXNlZCBpbiB0aGUgYWN0dWFsIHF1ZXJ5XG4gICAqL1xuICBsb2FkKHF1ZXJ5OiBRdWVyeVBhcmFtcywgb3B0aW9uczogUXVlcnlPcHRpb25zID0ge30pOiBQcm9taXNlPERhdGFSZWNvcmRbXT4ge1xuICAgIHF1ZXJ5ID0gey4uLnF1ZXJ5fTtcbiAgICBpZighcXVlcnkucGFnZSl7XG4gICAgICBxdWVyeS5wYWdlID0gMTtcbiAgICB9XG4gICAgaWYoIXF1ZXJ5LnBhZ2VTaXplKXtcbiAgICAgIHF1ZXJ5LnBhZ2VTaXplID0gdGhpcy5nZXRRdWVyeVBhZ2VTaXplKCk7XG4gICAgfVxuXG4gICAgY29uc3QgcXVlcnlQYWdlcyA9IHRoaXMuZ2V0UmVhbFF1ZXJ5UGFnZXMocXVlcnkucGFnZSwgcXVlcnkucGFnZVNpemUpO1xuICAgIGlmKHRoaXMuY2hlY2tDbGVhckxvY2FsQ2FjaGUocXVlcnksIHRoaXMubGFzdFF1ZXJ5UGFyYW1zLCBvcHRpb25zKSl7XG4gICAgICBPYmplY3Qua2V5cyh0aGlzLnBhZ2VzKS5mb3JFYWNoKChwKSA9PiB7XG4gICAgICAgIGlmKHF1ZXJ5UGFnZXMuaW5kZXhPZihwYXJzZUludChwKSkgPCAwKXtcbiAgICAgICAgICBkZWxldGUgdGhpcy5wYWdlc1twXTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIHRoaXMucGFnZVByb21pc2VzID0ge307XG4gICAgICB0aGlzLmNvdW50ID0gbnVsbDtcbiAgICAgIHRoaXMuY291bnRQcm9taXNlID0gbnVsbDtcbiAgICB9XG5cbiAgICB0aGlzLnVwZGF0ZVF1ZXJ5UGFyYW1zKHF1ZXJ5LCBvcHRpb25zLndpZGdldElkKTtcbiAgICBjb25zdCBxdWVyeVdpdGhvdXRQYWdlID0gdGhpcy5nZXRRdWVyeVdpdGhvdXRQYWdlKHF1ZXJ5KTtcbiAgICBjb25zdCByZWFsUXVlcnkgPSB0aGlzLmdldFJlYWxRdWVyeVBhcmFtcyhxdWVyeVdpdGhvdXRQYWdlLCAnbG9hZCcsIG9wdGlvbnMpO1xuXG4gICAgY29uc3QgcGFnZVByb21pc2VzID0gcXVlcnlQYWdlcy5maWx0ZXIocGFnZSA9PiB0aGlzLnBhZ2VQcm9taXNlc1twYWdlXSkubWFwKHBhZ2UgPT4gdGhpcy5wYWdlUHJvbWlzZXNbcGFnZV0pO1xuICAgIGlmKHBhZ2VQcm9taXNlcy5sZW5ndGggPT09IHF1ZXJ5UGFnZXMubGVuZ3RoKXtcbiAgICAgIHJldHVybiBQcm9taXNlLmFsbChwYWdlUHJvbWlzZXMpLnRoZW4oKCkgPT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRSZWNvcmRzQnlQYWdlKHF1ZXJ5LnBhZ2UsIHF1ZXJ5LnBhZ2VTaXplKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHRoaXMubGFzdFF1ZXJ5UGFyYW1zID0gcmVhbFF1ZXJ5O1xuXG4gICAgdGhpcy5zZXRTdGF0dXMoRGF0YVNvdXJjZVN0YXR1cy5Mb2FkaW5nKTtcbiAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcEFjdGlvbnMuc2V0RGF0YU5lZWRSZWZyZXNoKHRoaXMuaWQsIGZhbHNlKSk7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKHF1ZXJ5UGFnZXMubWFwKHBhZ2UgPT4gdGhpcy5sb2FkQnlQYWdlKHJlYWxRdWVyeSwgcGFnZSkpKS50aGVuKChyZXN1bHRzKSA9PiB7XG4gICAgICBjb25zdCBpc1VzZWZ1bCA9IHJlc3VsdHMuZmluZChyID0+IHIpO1xuICAgICAgaWYoIWlzVXNlZnVsKXtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgfVxuXG4gICAgICAvLyBrZWVwIHNlbGVjdGlvblxuICAgICAgY29uc3QgcmVjb3JkcyA9IHRoaXMuZ2V0UmVjb3JkcygpO1xuICAgICAgbGV0IHNlbGVjdGVkUmVjb3JkcyA9IFtdO1xuICAgICAgaWYodGhpcy5nZXRTZWxlY3RlZFJlY29yZElkcygpLmxlbmd0aCA+IDApe1xuICAgICAgICBzZWxlY3RlZFJlY29yZHMgPSB0aGlzLmdldFNlbGVjdGVkUmVjb3JkSWRzKCkubWFwKGlkID0+IHJlY29yZHMuZmlsdGVyKHJlY29yZCA9PiByZWNvcmQgJiYgcmVjb3JkLmdldElkKCkgPT09IGlkKVswXSk7XG4gICAgICB9ZWxzZSBpZih0aGlzLmdldFNlbGVjdGVkUmVjb3JkSW5kZXhlcygpLmxlbmd0aCA+IDApe1xuICAgICAgICBzZWxlY3RlZFJlY29yZHMgPSB0aGlzLmdldFNlbGVjdGVkUmVjb3JkSW5kZXhlcygpLm1hcChpID0+IHJlY29yZHNbaV0pO1xuICAgICAgfVxuXG4gICAgICBpZihzZWxlY3RlZFJlY29yZHMubGVuZ3RoID4gMCl7IC8vIFRPRE8gaGFuZGxlIGRhdGEgdmlld3NcbiAgICAgICAgdGhpcy5jb3B5U2VsZWN0aW9uVG9EYXRhVmlldyhzZWxlY3RlZFJlY29yZHMpO1xuICAgICAgfVxuXG5cbiAgICAgIHRoaXMubGFzdFJlZnJlc2hUaW1lID0gbmV3IERhdGUoKTtcblxuICAgICAgdGhpcy5zZXRTdGF0dXMoRGF0YVNvdXJjZVN0YXR1cy5Mb2FkZWQpO1xuXG4gICAgICBpZighKHdpbmRvdy5qaW11Q29uZmlnLmlzSW5CdWlsZGVyICYmIGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5hcHBSdW50aW1lSW5mby5hcHBNb2RlID09PSBBcHBNb2RlLkRlc2lnbikpe1xuICAgICAgICB0aGlzLnN0YXJ0QXV0b1JlZnJlc2goKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHRoaXMuZ2V0UmVjb3Jkc0J5UGFnZShxdWVyeS5wYWdlLCBxdWVyeS5wYWdlU2l6ZSk7XG4gICAgfSwgZXJyID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIHRoaXMuc2V0U3RhdHVzKERhdGFTb3VyY2VTdGF0dXMuTG9hZEVycm9yKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiB0aGUgcmVzb2x2ZWQgYm9vbGVhbiBtZWFucyB3aGV0aGVyIHRoZSBxdWVyeSByZXN1bHQgaXMgdXNlZCAob25seSB0aGUgbGFzdCBxdWVyeSB1cGRhdGUgcmVjb3JkcylcbiAgICogQHBhcmFtIHJlYWxRdWVyeVxuICAgKiBAcGFyYW0gcGFnZVxuICAgKi9cbiAgcHJpdmF0ZSBsb2FkQnlQYWdlKHJlYWxRdWVyeTogUXVlcnlQYXJhbXMsIHBhZ2U6IG51bWJlcik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGlmKHRoaXMucGFnZVByb21pc2VzW3BhZ2VdKXtcbiAgICAgIHJldHVybiB0aGlzLnBhZ2VQcm9taXNlc1twYWdlXTtcbiAgICB9XG5cbiAgICBjb25zdCByZWFsUXVlcnlXaXRoUGFnZSA9IHsuLi5yZWFsUXVlcnksIC4uLntwYWdlLCBwYWdlU2l6ZTogdGhpcy5nZXRRdWVyeVBhZ2VTaXplKCl9fTtcbiAgICB0aGlzLnBhZ2VQcm9taXNlc1twYWdlXSA9IHRoaXMuZG9RdWVyeShJbW11dGFibGUocmVhbFF1ZXJ5V2l0aFBhZ2UpKS50aGVuKHJlc3VsdCA9PiB7XG4gICAgICAvLyBtYWtlIHN1cmUgdGhlIGxhc3QgcXVlcnkgdGFrZSBlZmZlY3QuXG4gICAgICBjb25zdCByZXN1bHRRdWVyeVdpdGhvdXRQYWdlID0gdGhpcy5nZXRRdWVyeVdpdGhvdXRQYWdlKHJlc3VsdC5xdWVyeVBhcmFtcyk7XG4gICAgICBpZighdXRpbHMuaXNEZWVwRXF1YWwocmVzdWx0UXVlcnlXaXRob3V0UGFnZSwgdGhpcy5sYXN0UXVlcnlQYXJhbXMpKXtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdGhpcy5wYWdlc1tyZXN1bHQucXVlcnlQYXJhbXMucGFnZV0gPSByZXN1bHQucmVjb3JkcztcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHRoaXMucGFnZVByb21pc2VzW3BhZ2VdO1xuICB9XG5cbiAgbG9hZENvdW50KHF1ZXJ5OiBRdWVyeVBhcmFtcywgb3B0aW9uczogUXVlcnlPcHRpb25zID0ge30pOiBQcm9taXNlPG51bWJlcj57XG4gICAgaWYoIXRoaXMuY2hlY2tDbGVhckxvY2FsQ2FjaGUocXVlcnksIHRoaXMubGFzdENvdW50UXVlcnlQYXJhbXMsIG9wdGlvbnMpICYmIHRoaXMuY291bnRQcm9taXNlKXtcbiAgICAgIHJldHVybiB0aGlzLmNvdW50UHJvbWlzZTtcbiAgICB9XG5cbiAgICBjb25zdCByZWFsUXVlcnkgPSB0aGlzLmdldFJlYWxRdWVyeVBhcmFtcyh0aGlzLmdldFF1ZXJ5V2l0aG91dFBhZ2UocXVlcnkpLCAnbG9hZCcsIG9wdGlvbnMpO1xuXG4gICAgdGhpcy5sYXN0Q291bnRRdWVyeVBhcmFtcyA9IHJlYWxRdWVyeTtcblxuICAgIHRoaXMuc2V0Q291bnRTdGF0dXMoRGF0YVNvdXJjZVN0YXR1cy5Mb2FkaW5nKTtcbiAgICB0aGlzLmNvdW50UHJvbWlzZSA9IHRoaXMuZG9RdWVyeUNvdW50KEltbXV0YWJsZShyZWFsUXVlcnkpKS50aGVuKHJlc3VsdCA9PiB7XG4gICAgICBpZighdXRpbHMuaXNEZWVwRXF1YWwocmVzdWx0LnF1ZXJ5UGFyYW1zLCB0aGlzLmxhc3RDb3VudFF1ZXJ5UGFyYW1zKSl7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgaWYodGhpcy5nZXRNYXhSZWNvcmRDb3VudCgpID09PSBudWxsKXtcbiAgICAgICAgdGhpcy5jb3VudCA9IHJlc3VsdC5jb3VudDtcbiAgICAgIH1lbHNle1xuICAgICAgICB0aGlzLmNvdW50ID0gTWF0aC5taW4ocmVzdWx0LmNvdW50LCB0aGlzLmdldE1heFJlY29yZENvdW50KCkpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnNldENvdW50U3RhdHVzKERhdGFTb3VyY2VTdGF0dXMuTG9hZGVkKTtcbiAgICAgIHJldHVybiB0aGlzLmNvdW50O1xuICAgIH0sIGVyciA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICB0aGlzLnNldENvdW50U3RhdHVzKERhdGFTb3VyY2VTdGF0dXMuTG9hZEVycm9yKTtcbiAgICAgIHJldHVybjtcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy5jb3VudFByb21pc2U7XG4gIH1cblxuICBxdWVyeShxdWVyeTogUXVlcnlQYXJhbXMsIG9wdGlvbnM/OiBRdWVyeU9wdGlvbnMpOiBQcm9taXNlPFF1ZXJ5UmVzdWx0PntcbiAgICBjb25zdCByZWFsUXVlcnkgPSB0aGlzLmdldFJlYWxRdWVyeVBhcmFtcyhxdWVyeSwgJ3F1ZXJ5Jywgb3B0aW9ucyk7XG4gICAgcmV0dXJuIHRoaXMuZG9RdWVyeShJbW11dGFibGUocmVhbFF1ZXJ5KSkudGhlbihyZXN1bHQgPT4ge1xuICAgICAgY29uc3QgbWF4Q291bnQgPSB0aGlzLmdldE1heFJlY29yZENvdW50KCk7XG4gICAgICBpZihtYXhDb3VudCA9PT0gbnVsbCl7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHBhZ2UgPSByZXN1bHQucXVlcnlQYXJhbXMucGFnZSB8fCAxO1xuICAgICAgY29uc3QgcGFnZVNpemUgPSByZXN1bHQucXVlcnlQYXJhbXMucGFnZVNpemU7XG5cbiAgICAgIGlmKHBhZ2UgPT09IDEgfHwgIXBhZ2VTaXplKXtcbiAgICAgICAgaWYocmVzdWx0LnJlY29yZHMubGVuZ3RoID4gbWF4Q291bnQpe1xuICAgICAgICAgIHJlc3VsdC5yZWNvcmRzID0gcmVzdWx0LnJlY29yZHMuc2xpY2UoMCwgbWF4Q291bnQpO1xuICAgICAgICB9XG4gICAgICB9ZWxzZXtcbiAgICAgICAgaWYoKChwYWdlIC0gMSkgKiBwYWdlU2l6ZSkgPiBtYXhDb3VudCl7XG4gICAgICAgICAgcmVzdWx0LnJlY29yZHMgPSBbXTtcbiAgICAgICAgfWVsc2UgaWYoKHBhZ2UgLSAxKSAqIHBhZ2VTaXplICsgcmVzdWx0LnJlY29yZHMubGVuZ3RoID4gbWF4Q291bnQpe1xuICAgICAgICAgIHJlc3VsdC5yZWNvcmRzID0gcmVzdWx0LnJlY29yZHMuc2xpY2UoMCwgKHBhZ2UgLSAxKSAqIHBhZ2VTaXplICsgcmVzdWx0LnJlY29yZHMubGVuZ3RoIC0gbWF4Q291bnQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0pO1xuICB9XG5cbiAgcXVlcnlDb3VudChxdWVyeTogUXVlcnlQYXJhbXMsIG9wdGlvbnM/OiBRdWVyeU9wdGlvbnMpOiBQcm9taXNlPFF1ZXJ5UmVzdWx0PntcbiAgICBjb25zdCByZWFsUXVlcnkgPSB0aGlzLmdldFJlYWxRdWVyeVBhcmFtcyhxdWVyeSwgJ3F1ZXJ5Jywgb3B0aW9ucyk7XG5cbiAgICByZXR1cm4gdGhpcy5kb1F1ZXJ5Q291bnQoSW1tdXRhYmxlKHJlYWxRdWVyeSkpLnRoZW4ocmVzdWx0ID0+IHtcbiAgICAgIGlmKHRoaXMuZ2V0TWF4UmVjb3JkQ291bnQoKSA9PT0gbnVsbCl7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgcmVzdWx0LmNvdW50ID0gTWF0aC5taW4ocmVzdWx0LmNvdW50LCB0aGlzLmdldE1heFJlY29yZENvdW50KCkpO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgbG9hZEJ5SWQoaWQ6IHN0cmluZywgcmVmcmVzaD86IGJvb2xlYW4pOiBQcm9taXNlPERhdGFSZWNvcmQ+IHtcbiAgICBpZihpZCA9PT0gdGhpcy5sYXN0UXVlcnlJZCAmJiAhcmVmcmVzaCAmJiB0aGlzLmJ5SWRQcm9taXNlKXtcbiAgICAgIHJldHVybiB0aGlzLmJ5SWRQcm9taXNlO1xuICAgIH1cblxuICAgIHRoaXMubGFzdFF1ZXJ5SWQgPSBpZDtcblxuICAgIHRoaXMuc2V0U3RhdHVzKERhdGFTb3VyY2VTdGF0dXMuTG9hZGluZyk7XG4gICAgdGhpcy5ieUlkUHJvbWlzZSA9IHRoaXMuZG9RdWVyeUJ5SWQoaWQpLnRoZW4ocmVjb3JkID0+IHtcbiAgICAgIHRoaXMuc2V0U3RhdHVzKERhdGFTb3VyY2VTdGF0dXMuTG9hZGVkKTtcbiAgICAgIHJldHVybiByZWNvcmQ7XG4gICAgfSwgZXJyID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIHRoaXMuc2V0U3RhdHVzKERhdGFTb3VyY2VTdGF0dXMuTG9hZEVycm9yKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0pO1xuICAgIHJldHVybiB0aGlzLmJ5SWRQcm9taXNlXG4gIH1cblxuICBxdWVyeUJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8RGF0YVJlY29yZD57XG4gICAgcmV0dXJuIHRoaXMuZG9RdWVyeUJ5SWQoaWQpO1xuICB9XG5cbiAgZ2V0QXV0b1JlZnJlc2hJbnRlcnZhbCgpOiBudW1iZXJ7XG4gICAgY29uc3QgZHM6IEFic3RyYWN0UXVlcmlhYmxlRGF0YVNvdXJjZSA9IHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKSBhcyBBYnN0cmFjdFF1ZXJpYWJsZURhdGFTb3VyY2U7XG4gICAgbGV0IGludGVydmFsID0gZHMuZ2V0RGF0YVZpZXdDb25maWcoKSAmJiBkcy5nZXREYXRhVmlld0NvbmZpZygpLnJlZnJlc2hJbnRlcnZhbDtcbiAgICBpZihpbnRlcnZhbCA9PT0gMCl7IC8vIDAgbWVhbnMgZG8gbm90IGF1dG8gcmVmcmVzaC5cbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBpZihpbnRlcnZhbCA9PT0gbnVsbCB8fCB0eXBlb2YgaW50ZXJ2YWwgPT09ICd1bmRlZmluZWQnKXsgLy8gbWVhbnMgdXNlciBsYXllci9tYXAncyBzZXR0aW5nXG4gICAgICBpbnRlcnZhbCA9IGRzLmdldFNjaGVtYSgpLnJlZnJlc2hJbnRlcnZhbDtcbiAgICB9XG4gICAgcmV0dXJuIGludGVydmFsO1xuICB9XG5cbiAgZ2V0TGFzdFJlZnJlc2hUaW1lKCk6IERhdGV7XG4gICAgcmV0dXJuIHRoaXMubGFzdFJlZnJlc2hUaW1lO1xuICB9XG5cbiAgc3RhcnRBdXRvUmVmcmVzaCgpe1xuICAgIGNvbnN0IGludGVydmFsID0gdGhpcy5nZXRBdXRvUmVmcmVzaEludGVydmFsKCk7XG5cbiAgICBpZighaW50ZXJ2YWwpe1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmKHRoaXMuYXV0b1JlZnJlc2hIYW5kbGUpe1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGdldEFwcFN0b3JlKCkuZGlzcGF0Y2goYXBwQWN0aW9ucy5zZXREYXRhTmVlZFJlZnJlc2godGhpcy5pZCwgZmFsc2UpKTtcbiAgICB0aGlzLmF1dG9SZWZyZXNoSGFuZGxlID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcEFjdGlvbnMuc2V0RGF0YU5lZWRSZWZyZXNoKHRoaXMuaWQsIHRydWUpKTtcblxuICAgICAgdGhpcy5zdG9wQXV0b1JlZnJlc2goKTtcbiAgICB9LCBpbnRlcnZhbCAqIDEwMDApO1xuICB9XG5cbiAgc3RvcEF1dG9SZWZyZXNoKCl7XG4gICAgaWYodGhpcy5hdXRvUmVmcmVzaEhhbmRsZSl7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy5hdXRvUmVmcmVzaEhhbmRsZSk7XG4gICAgICB0aGlzLmF1dG9SZWZyZXNoSGFuZGxlID0gbnVsbDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTm90IHJlYWR5IHlldC5cbiAgICogQHBhcmFtIHJlY29yZFxuICAgKi9cbiAgYWRkUmVjb3JkPyhyZWNvcmQ6IERhdGFSZWNvcmQpOiBQcm9taXNlPERhdGFSZWNvcmQ+IHtcbiAgICB0aGlzLnNldFNhdmVTdGF0dXMoRGF0YVNvdXJjZVN0YXR1cy5TYXZpbmcpO1xuICAgIHJldHVybiB0aGlzLmRvQWRkKHJlY29yZCkudGhlbihyZWNvcmQgPT4ge1xuICAgICAgdGhpcy5yZWNvcmRzLnB1c2gocmVjb3JkKTtcbiAgICAgIHRoaXMuc2V0U2F2ZVN0YXR1cyhEYXRhU291cmNlU3RhdHVzLlNhdmVkKTtcbiAgICAgIHJldHVybiByZWNvcmQ7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogTm90IHJlYWR5IHlldC5cbiAgICogQHBhcmFtIHJlY29yZFxuICAgKi9cbiAgdXBkYXRlUmVjb3JkPyhyZWNvcmQ6IERhdGFSZWNvcmQpOiBQcm9taXNlPERhdGFSZWNvcmQ+IHtcbiAgICB0aGlzLnNldFNhdmVTdGF0dXMoRGF0YVNvdXJjZVN0YXR1cy5TYXZpbmcpO1xuICAgIHJldHVybiB0aGlzLmRvVXBkYXRlUmVjb3JkKHJlY29yZCkudGhlbihyZWNvcmQgPT4ge1xuICAgICAgY29uc3QgaSA9IHRoaXMucmVjb3Jkcy5maW5kSW5kZXgociA9PiByLmdldElkKCkgPT09IHJlY29yZC5nZXRJZCgpKTtcbiAgICAgIHRoaXMucmVjb3Jkcy5zcGxpY2UoaSwgMSwgcmVjb3JkKTtcbiAgICAgIHRoaXMuc2V0U2F2ZVN0YXR1cyhEYXRhU291cmNlU3RhdHVzLlNhdmVkKTtcbiAgICAgIHJldHVybiByZWNvcmQ7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogTm90IHJlYWR5IHlldC5cbiAgICogQHBhcmFtIHJlY29yZFxuICAgKi9cbiAgZGVsZXRlUmVjb3JkPyhpbmRleDogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdGhpcy5zZXRTYXZlU3RhdHVzKERhdGFTb3VyY2VTdGF0dXMuU2F2aW5nKTtcbiAgICByZXR1cm4gdGhpcy5kb0RlbGV0ZVJlY29yZChpbmRleCkudGhlbigoKSA9PiB7XG4gICAgICB0aGlzLnJlY29yZHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgIHRoaXMuc2V0U2F2ZVN0YXR1cyhEYXRhU291cmNlU3RhdHVzLlNhdmVkKTtcbiAgICAgIHJldHVybjtcbiAgICB9KTtcbiAgfVxuXG4gIGdldFNhdmVTdGF0dXMoKTogRGF0YVNvdXJjZVN0YXR1cyB7XG4gICAgcmV0dXJuIGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5kYXRhU291cmNlc0luZm9bdGhpcy5pZF0/LnNhdmVTdGF0dXM7XG4gIH1cbiAgc2V0U2F2ZVN0YXR1cyhzdGF0dXM6IERhdGFTb3VyY2VTdGF0dXMpIHtcbiAgICBnZXRBcHBTdG9yZSgpLmRpc3BhdGNoKGFwcEFjdGlvbnMuZGF0YVNvdXJjZVNhdmVTdGF0dXNDaGFuZ2VkKHRoaXMuaWQsIHN0YXR1cykpO1xuICB9XG5cbiAgZ2V0TWFpbkRhdGFTb3VyY2UoKTogUXVlcmlhYmxlRGF0YVNvdXJjZXtcbiAgICByZXR1cm4gc3VwZXIuZ2V0TWFpbkRhdGFTb3VyY2UoKSBhcyBRdWVyaWFibGVEYXRhU291cmNlO1xuICB9XG5cbiAgZ2V0RGF0YVZpZXdzKCk6IFF1ZXJpYWJsZURhdGFTb3VyY2VbXXtcbiAgICByZXR1cm4gc3VwZXIuZ2V0RGF0YVZpZXdzKCkgYXMgUXVlcmlhYmxlRGF0YVNvdXJjZVtdO1xuICB9XG5cbiAgZ2V0RGF0YVZpZXcoZGF0YVZpZXdJZDogc3RyaW5nKTogUXVlcmlhYmxlRGF0YVNvdXJjZXtcbiAgICByZXR1cm4gc3VwZXIuZ2V0RGF0YVZpZXcoZGF0YVZpZXdJZCkgYXMgUXVlcmlhYmxlRGF0YVNvdXJjZTtcbiAgfVxuXG4gIGFic3RyYWN0IGdldENvbmZpZ1F1ZXJ5UGFyYW1zKCk6IFF1ZXJ5UGFyYW1zO1xuICBhYnN0cmFjdCBnZXRSZW1vdGVRdWVyeVBhcmFtcygpOiBRdWVyeVBhcmFtcztcbiAgYWJzdHJhY3QgbWVyZ2VRdWVyeVBhcmFtcyhiYXNlUXVlcnk6IFF1ZXJ5UGFyYW1zLCBuZXdRdWVyeTogUXVlcnlQYXJhbXMpOiBRdWVyeVBhcmFtcztcblxuICBwcm90ZWN0ZWQgZG9BZGQ/KHJlY29yZDogRGF0YVJlY29yZCk6IFByb21pc2U8RGF0YVJlY29yZD47XG4gIHByb3RlY3RlZCBkb1VwZGF0ZVJlY29yZD8ocmVjb3JkOiBEYXRhUmVjb3JkKTogUHJvbWlzZTxEYXRhUmVjb3JkPjtcbiAgcHJvdGVjdGVkIGRvRGVsZXRlUmVjb3JkPyhpbmRleDogbnVtYmVyKTogUHJvbWlzZTx2b2lkPjtcblxuICBwcm90ZWN0ZWQgYWJzdHJhY3QgZG9RdWVyeShxdWVyeTogSU1RdWVyeVBhcmFtcyk6IFByb21pc2U8UXVlcnlSZXN1bHQ+O1xuICBwcm90ZWN0ZWQgYWJzdHJhY3QgZG9RdWVyeUNvdW50KHF1ZXJ5OiBJTVF1ZXJ5UGFyYW1zKTogUHJvbWlzZTxRdWVyeVJlc3VsdD47XG4gIHByb3RlY3RlZCBhYnN0cmFjdCBkb1F1ZXJ5QnlJZChpZDogc3RyaW5nKTogUHJvbWlzZTxEYXRhUmVjb3JkPjtcbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBR0E7QUFFQTtBQUFBO0FBdUJBO0FBQUE7QUFyQkE7QUFRQTs7OztBQUlBO0FBQ0E7QUFFQTtBQVFBO0FBQ0E7QUFDQTs7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7OztBQUlBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7O0FBR0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7O0FBR0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7QUFHQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFhQTtBQUFBOzsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./jimu-core/lib/data-sources/ds-base-types/abstract-queriable-data-source.ts\n");

/***/ }),

/***/ "./jimu-core/lib/data-sources/ds-base-types/abstract-set-data-source.ts":
/*!******************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/ds-base-types/abstract-set-data-source.ts ***!
  \******************************************************************************/
/*! exports provided: AbstractSetDataSource */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AbstractSetDataSource\", function() { return AbstractSetDataSource; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _abstract_data_source__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./abstract-data-source */ \"./jimu-core/lib/data-sources/ds-base-types/abstract-data-source.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n/**\n * @ignore\n */\nvar AbstractSetDataSource = /** @class */ (function (_super) {\n    __extends(AbstractSetDataSource, _super);\n    function AbstractSetDataSource() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.isDataSourceSet = true;\n        return _this;\n    }\n    AbstractSetDataSource.prototype.ready = function () {\n        return this._createChildDataSources();\n    };\n    AbstractSetDataSource.prototype.destroy = function () {\n        var _this = this;\n        this.getChildDataSources().forEach(function (ds) {\n            if (ds) {\n                _this.dataSourceManager.destroyDataSource(ds.id);\n            }\n        });\n    };\n    AbstractSetDataSource.prototype.getChildDataSourceId = function (jimuChildId) {\n        return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getChildDataSourceId(this.id, jimuChildId);\n    };\n    AbstractSetDataSource.prototype.getChildDataSources = function () {\n        var _this = this;\n        return Object.keys(this.dataSourceManager.getDataSources())\n            .filter(function (dsId) { return _this.dataSourceManager.getDataSource(dsId).parentDataSource === _this; })\n            .map(function (dsId) { return _this.dataSourceManager.getDataSource(dsId); });\n    };\n    AbstractSetDataSource.prototype.getChildDataSource = function (jimuChildId) {\n        return this.dataSourceManager.getDataSource(this.getChildDataSourceId(jimuChildId));\n    };\n    AbstractSetDataSource.prototype.getJimuChildId = function (childId) {\n        var rschema = this.getReversedConfigSchema();\n        if (rschema && rschema.childSchemas && rschema.childSchemas[childId]) {\n            return (rschema.childSchemas[childId]).map(function (schema) { return schema.jimuChildId; }).asMutable();\n        }\n        else {\n            return [childId];\n        }\n    };\n    return AbstractSetDataSource;\n}(_abstract_data_source__WEBPACK_IMPORTED_MODULE_1__[\"AbstractDataSource\"]));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9kcy1iYXNlLXR5cGVzL2Fic3RyYWN0LXNldC1kYXRhLXNvdXJjZS50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2RzLWJhc2UtdHlwZXMvYWJzdHJhY3Qtc2V0LWRhdGEtc291cmNlLnRzPzQ1NmMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGF0YVNvdXJjZVV0aWxzIH0gZnJvbSAnamltdS1jb3JlJztcbmltcG9ydCB7IEFic3RyYWN0RGF0YVNvdXJjZSB9IGZyb20gJy4vYWJzdHJhY3QtZGF0YS1zb3VyY2UnO1xuaW1wb3J0IHsgRGF0YVNvdXJjZSB9IGZyb20gJy4uL2RhdGEtc291cmNlLWludGVyZmFjZSc7XG5cbi8qKlxuICogQGlnbm9yZVxuICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3RTZXREYXRhU291cmNlIGV4dGVuZHMgQWJzdHJhY3REYXRhU291cmNlIGltcGxlbWVudHMgRGF0YVNvdXJjZSB7XG4gIGlzRGF0YVNvdXJjZVNldDogYm9vbGVhbiA9IHRydWU7XG4gIHByb3RlY3RlZCBfY2hpbGREYXRhU291cmNlc1Byb21pc2U6IFByb21pc2U8RGF0YVNvdXJjZVtdPjtcbiAgcHJvdGVjdGVkIGFic3RyYWN0IF9jcmVhdGVDaGlsZERhdGFTb3VyY2VzICgpOiBQcm9taXNlPERhdGFTb3VyY2VbXT47XG4gIHJlYWR5KCl7XG4gICAgcmV0dXJuIHRoaXMuX2NyZWF0ZUNoaWxkRGF0YVNvdXJjZXMoKTtcbiAgfVxuXG4gIGRlc3Ryb3koKXtcbiAgICB0aGlzLmdldENoaWxkRGF0YVNvdXJjZXMoKS5mb3JFYWNoKGRzID0+IHtcbiAgICAgIGlmKGRzKXtcbiAgICAgICAgdGhpcy5kYXRhU291cmNlTWFuYWdlci5kZXN0cm95RGF0YVNvdXJjZShkcy5pZCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBnZXRDaGlsZERhdGFTb3VyY2VJZChqaW11Q2hpbGRJZDogc3RyaW5nKTogc3RyaW5ne1xuICAgIHJldHVybiBkYXRhU291cmNlVXRpbHMuZ2V0Q2hpbGREYXRhU291cmNlSWQodGhpcy5pZCwgamltdUNoaWxkSWQpO1xuICB9XG5cbiAgZ2V0Q2hpbGREYXRhU291cmNlcygpOiBEYXRhU291cmNlW117XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuZGF0YVNvdXJjZU1hbmFnZXIuZ2V0RGF0YVNvdXJjZXMoKSlcbiAgICAgIC5maWx0ZXIoZHNJZCA9PiB0aGlzLmRhdGFTb3VyY2VNYW5hZ2VyLmdldERhdGFTb3VyY2UoZHNJZCkucGFyZW50RGF0YVNvdXJjZSA9PT0gdGhpcylcbiAgICAgIC5tYXAoZHNJZCA9PiB0aGlzLmRhdGFTb3VyY2VNYW5hZ2VyLmdldERhdGFTb3VyY2UoZHNJZCkpO1xuICB9XG5cbiAgZ2V0Q2hpbGREYXRhU291cmNlKGppbXVDaGlsZElkOiBzdHJpbmcpOiBEYXRhU291cmNlIHtcbiAgICByZXR1cm4gdGhpcy5kYXRhU291cmNlTWFuYWdlci5nZXREYXRhU291cmNlKHRoaXMuZ2V0Q2hpbGREYXRhU291cmNlSWQoamltdUNoaWxkSWQpKTtcbiAgfVxuXG4gIGdldEppbXVDaGlsZElkKGNoaWxkSWQ6IHN0cmluZyk6IHN0cmluZ1tde1xuICAgIGNvbnN0IHJzY2hlbWEgPSB0aGlzLmdldFJldmVyc2VkQ29uZmlnU2NoZW1hKCk7XG4gICAgaWYgKHJzY2hlbWEgJiYgcnNjaGVtYS5jaGlsZFNjaGVtYXMgJiYgcnNjaGVtYS5jaGlsZFNjaGVtYXNbY2hpbGRJZF0pIHtcbiAgICAgIHJldHVybiAocnNjaGVtYS5jaGlsZFNjaGVtYXNbY2hpbGRJZF0pLm1hcChzY2hlbWEgPT4gc2NoZW1hLmppbXVDaGlsZElkKS5hc011dGFibGUoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFtjaGlsZElkXTtcbiAgICB9XG4gIH1cbn0iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFHQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7O0FBcUNBO0FBbENBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBOzsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./jimu-core/lib/data-sources/ds-base-types/abstract-set-data-source.ts\n");

/***/ }),

/***/ "./jimu-core/lib/data-sources/ds-base-types/data-record.ts":
/*!*****************************************************************!*\
  !*** ./jimu-core/lib/data-sources/ds-base-types/data-record.ts ***!
  \*****************************************************************/
/*! exports provided: AbstractDataRecord, SimpleDataRecordImpl, SimpleDataRecordSetImpl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AbstractDataRecord\", function() { return AbstractDataRecord; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SimpleDataRecordImpl\", function() { return SimpleDataRecordImpl; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SimpleDataRecordSetImpl\", function() { return SimpleDataRecordSetImpl; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n/**\n * Include the common implementations for data record.\n */\nvar AbstractDataRecord = /** @class */ (function () {\n    function AbstractDataRecord() {\n    }\n    AbstractDataRecord.prototype.getFieldValue = function (jimuFieldName) {\n        return this.getData()[jimuFieldName];\n    };\n    AbstractDataRecord.prototype.getFormattedFieldValue = function (jimuFieldName, intl) {\n        var field = this.dataSource.getSchema().fields[jimuFieldName];\n        if (field) {\n            if (field.format) {\n                switch (field.type) {\n                    case jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"JimuFieldType\"].Date:\n                        return this.formatDateField(this.getFieldValue(jimuFieldName), field.format.dateFormat, intl);\n                    case jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"JimuFieldType\"].Number:\n                        return this.formatNumberField(this.getFieldValue(jimuFieldName), field.format.places, field.format.digitSeparator, intl);\n                    default:\n                        return this.getFieldValue(jimuFieldName);\n                }\n            }\n            else {\n                switch (field.type) {\n                    case jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"JimuFieldType\"].Date:\n                        return this.getFieldValue(jimuFieldName) !== null && this.getFieldValue(jimuFieldName) !== undefined ?\n                            intl.formatDate(this.getFieldValue(jimuFieldName)) : null;\n                    case jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"JimuFieldType\"].Number:\n                        return this.getFieldValue(jimuFieldName) !== null && this.getFieldValue(jimuFieldName) !== undefined ?\n                            intl.formatNumber(this.getFieldValue(jimuFieldName)) : null;\n                    default:\n                        return this.getFieldValue(jimuFieldName);\n                }\n            }\n        }\n        else {\n            return this.getFieldValue(jimuFieldName);\n        }\n    };\n    /** @ignore */\n    AbstractDataRecord.prototype.convertBeforeMappingDataToData = function (dataBeforeMapping) {\n        var reversedData = {};\n        var reversedSchema = this.dataSource.getReversedConfigSchema();\n        Object.keys(dataBeforeMapping).forEach(function (fieldName) {\n            var fields = reversedSchema && reversedSchema.fields && reversedSchema.fields[fieldName];\n            if (fields) {\n                fields.forEach(function (f) {\n                    reversedData[f.jimuName] = dataBeforeMapping[fieldName];\n                });\n            }\n            else {\n                reversedData[fieldName] = dataBeforeMapping[fieldName];\n            }\n        });\n        return reversedData;\n    };\n    /** @ignore */\n    AbstractDataRecord.prototype.convertDataToDataBeforeMapping = function (data) {\n        var dataBeforeMapping = {};\n        var schema = this.dataSource.getSchema();\n        Object.keys(data).forEach(function (jimuFieldName) {\n            var fieldName = schema && schema.fields && schema.fields[jimuFieldName] ? schema.fields[jimuFieldName].name : jimuFieldName;\n            dataBeforeMapping[fieldName] = data[jimuFieldName];\n        });\n        return dataBeforeMapping;\n    };\n    AbstractDataRecord.prototype.getFormattedData = function (intl) {\n        var _this = this;\n        var ret = {};\n        Object.keys(this.getData()).forEach(function (fieldName) {\n            ret[fieldName] = _this.getFormattedFieldValue(fieldName, intl);\n        });\n        return ret;\n    };\n    AbstractDataRecord.prototype.formatDateField = function (value, esriDateFormat, intl) {\n        if (!value) {\n            return null;\n        }\n        if (typeof value === 'number') {\n            //TODO handle time zone\n            value = new Date(value);\n        }\n        var dataTimeFormat = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dateUtils\"].ESRI_DATE_FORMAT_MAP[esriDateFormat];\n        if (!dataTimeFormat) {\n            console.warn(\"Invalid data format \" + esriDateFormat);\n            return null;\n        }\n        var date = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dateUtils\"].formatDate(value, dataTimeFormat.datePattern, intl);\n        if (dataTimeFormat.selector === 'date and time') {\n            var time = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dateUtils\"].formatTime(value, dataTimeFormat.timePattern, intl);\n            var locale = intl.locale || 'en';\n            var connector = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dateUtils\"].DATE_TIME_CONNECTOR[locale] || jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dateUtils\"].DATE_TIME_CONNECTOR.common;\n            date = date + connector + time;\n        }\n        return date;\n    };\n    AbstractDataRecord.prototype.formatNumberField = function (value, places, digitSeparator, intl) {\n        if (value === null || typeof value === undefined) {\n            return null;\n        }\n        var num = new Number(value);\n        if (digitSeparator) {\n            return intl.formatNumber(value, { maximumFractionDigits: places, minimumFractionDigits: places });\n        }\n        else {\n            return num.toFixed(places);\n        }\n    };\n    return AbstractDataRecord;\n}());\n\n/**\n * @ignore\n */\nvar SimpleDataRecordImpl = /** @class */ (function (_super) {\n    __extends(SimpleDataRecordImpl, _super);\n    /**\n     * beforeMappingData: is the data from the real data source, such as query from remote service/database.\n     * data is the data used in Exb.\n     *\n     * The beforeMappingData uses this schema: {fieldName: value}, we'll reverse it to {jimuFieldName: value}, which is called data and will be used in exb.\n     *\n     */\n    function SimpleDataRecordImpl(data, dataSource, isBeforeMappingData) {\n        if (isBeforeMappingData === void 0) { isBeforeMappingData = true; }\n        var _this = _super.call(this) || this;\n        _this.dataSource = dataSource;\n        if (isBeforeMappingData) {\n            _this.data = _this.convertBeforeMappingDataToData(data);\n        }\n        else {\n            _this.data = data;\n        }\n        return _this;\n    }\n    SimpleDataRecordImpl.prototype.getData = function () {\n        return this.data;\n    };\n    SimpleDataRecordImpl.prototype.getDataBeforeMapping = function () {\n        return this.convertDataToDataBeforeMapping(this.data);\n    };\n    SimpleDataRecordImpl.prototype.toJson = function () {\n        return this.data;\n    };\n    SimpleDataRecordImpl.prototype.getId = function () {\n        return this.data.id;\n    };\n    SimpleDataRecordImpl.prototype.setId = function () {\n    };\n    SimpleDataRecordImpl.prototype.getGeometry = function () {\n        return null;\n    };\n    return SimpleDataRecordImpl;\n}(AbstractDataRecord));\n\n/**\n * @ignore\n */\nvar SimpleDataRecordSetImpl = /** @class */ (function () {\n    function SimpleDataRecordSetImpl(options) {\n        Object.assign(this, options);\n    }\n    return SimpleDataRecordSetImpl;\n}());\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9kcy1iYXNlLXR5cGVzL2RhdGEtcmVjb3JkLnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vamltdS1jb3JlL2xpYi9kYXRhLXNvdXJjZXMvZHMtYmFzZS10eXBlcy9kYXRhLXJlY29yZC50cz84MjEyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElNRGF0YVNvdXJjZVNjaGVtYSwgSU1SZXZlcnNlZERhdGFTb3VyY2VTY2hlbWEsIEludGxTaGFwZSwgSmltdUZpZWxkVHlwZSwgRXNyaURhdGVGb3JtYXRzLCBFc3JpRGF0ZUZvcm1hdCwgZGF0ZVV0aWxzIH0gZnJvbSAnamltdS1jb3JlJztcbmltcG9ydCB7IElHZW9tZXRyeSB9IGZyb20gJ0Blc3JpL2FyY2dpcy1yZXN0LXR5cGVzJztcbmltcG9ydCB7IERhdGFTb3VyY2UsIERhdGFSZWNvcmRTZXQsIERhdGFSZWNvcmQgfSBmcm9tICcuLi9kYXRhLXNvdXJjZS1pbnRlcmZhY2UnO1xuXG4vKipcbiAqIEluY2x1ZGUgdGhlIGNvbW1vbiBpbXBsZW1lbnRhdGlvbnMgZm9yIGRhdGEgcmVjb3JkLlxuICovXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQWJzdHJhY3REYXRhUmVjb3JkIGltcGxlbWVudHMgRGF0YVJlY29yZCB7XG4gIGRhdGFTb3VyY2U6IERhdGFTb3VyY2U7XG5cbiAgYWJzdHJhY3QgZ2V0RGF0YSgpOiBhbnk7XG4gIC8qKiBAaWdub3JlICovXG4gIGFic3RyYWN0IGdldERhdGFCZWZvcmVNYXBwaW5nKCk6IGFueTtcbiAgYWJzdHJhY3QgdG9Kc29uKCk6IGFueTtcblxuICBhYnN0cmFjdCBnZXRJZCgpOiBzdHJpbmc7XG4gIGFic3RyYWN0IHNldElkKGlkOiBzdHJpbmcpOiB2b2lkO1xuXG4gIGFic3RyYWN0IGdldEdlb21ldHJ5KCk6IElHZW9tZXRyeTtcblxuICBnZXRGaWVsZFZhbHVlKGppbXVGaWVsZE5hbWU6IHN0cmluZyl7XG4gICAgcmV0dXJuIHRoaXMuZ2V0RGF0YSgpW2ppbXVGaWVsZE5hbWVdO1xuICB9XG5cbiAgZ2V0Rm9ybWF0dGVkRmllbGRWYWx1ZShqaW11RmllbGROYW1lOiBzdHJpbmcsIGludGw6IEludGxTaGFwZSk6IHN0cmluZ3tcbiAgICBjb25zdCBmaWVsZCA9IHRoaXMuZGF0YVNvdXJjZS5nZXRTY2hlbWEoKS5maWVsZHNbamltdUZpZWxkTmFtZV07XG4gICAgaWYgKGZpZWxkKSB7XG4gICAgICBpZiAoZmllbGQuZm9ybWF0KSB7XG4gICAgICAgIHN3aXRjaCAoZmllbGQudHlwZSkge1xuICAgICAgICAgIGNhc2UgSmltdUZpZWxkVHlwZS5EYXRlOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0RGF0ZUZpZWxkKHRoaXMuZ2V0RmllbGRWYWx1ZShqaW11RmllbGROYW1lKSwgZmllbGQuZm9ybWF0LmRhdGVGb3JtYXQsIGludGwpO1xuICAgICAgICAgIGNhc2UgSmltdUZpZWxkVHlwZS5OdW1iZXI6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXROdW1iZXJGaWVsZCh0aGlzLmdldEZpZWxkVmFsdWUoamltdUZpZWxkTmFtZSksIGZpZWxkLmZvcm1hdC5wbGFjZXMsIGZpZWxkLmZvcm1hdC5kaWdpdFNlcGFyYXRvciwgaW50bCk7XG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldEZpZWxkVmFsdWUoamltdUZpZWxkTmFtZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHN3aXRjaCAoZmllbGQudHlwZSkge1xuICAgICAgICAgIGNhc2UgSmltdUZpZWxkVHlwZS5EYXRlOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RmllbGRWYWx1ZShqaW11RmllbGROYW1lKSAhPT0gbnVsbCAmJiB0aGlzLmdldEZpZWxkVmFsdWUoamltdUZpZWxkTmFtZSkgIT09IHVuZGVmaW5lZCA/XG4gICAgICAgICAgICAgIGludGwuZm9ybWF0RGF0ZSh0aGlzLmdldEZpZWxkVmFsdWUoamltdUZpZWxkTmFtZSkpIDogbnVsbDtcbiAgICAgICAgICBjYXNlIEppbXVGaWVsZFR5cGUuTnVtYmVyOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RmllbGRWYWx1ZShqaW11RmllbGROYW1lKSAhPT0gbnVsbCAmJiB0aGlzLmdldEZpZWxkVmFsdWUoamltdUZpZWxkTmFtZSkgIT09IHVuZGVmaW5lZCA/XG4gICAgICAgICAgICAgIGludGwuZm9ybWF0TnVtYmVyKHRoaXMuZ2V0RmllbGRWYWx1ZShqaW11RmllbGROYW1lKSkgOiBudWxsO1xuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRGaWVsZFZhbHVlKGppbXVGaWVsZE5hbWUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmdldEZpZWxkVmFsdWUoamltdUZpZWxkTmFtZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgY29udmVydEJlZm9yZU1hcHBpbmdEYXRhVG9EYXRhKGRhdGFCZWZvcmVNYXBwaW5nKSB7XG4gICAgY29uc3QgcmV2ZXJzZWREYXRhID0ge307XG4gICAgY29uc3QgcmV2ZXJzZWRTY2hlbWE6IElNUmV2ZXJzZWREYXRhU291cmNlU2NoZW1hID0gdGhpcy5kYXRhU291cmNlLmdldFJldmVyc2VkQ29uZmlnU2NoZW1hKCk7XG4gICAgT2JqZWN0LmtleXMoZGF0YUJlZm9yZU1hcHBpbmcpLmZvckVhY2goZmllbGROYW1lID0+IHtcbiAgICAgIGNvbnN0IGZpZWxkcyA9IHJldmVyc2VkU2NoZW1hICYmIHJldmVyc2VkU2NoZW1hLmZpZWxkcyAmJiByZXZlcnNlZFNjaGVtYS5maWVsZHNbZmllbGROYW1lXTtcbiAgICAgIGlmKGZpZWxkcyl7XG4gICAgICAgIGZpZWxkcy5mb3JFYWNoKGYgPT4ge1xuICAgICAgICAgIHJldmVyc2VkRGF0YVtmLmppbXVOYW1lXSA9IGRhdGFCZWZvcmVNYXBwaW5nW2ZpZWxkTmFtZV07XG4gICAgICAgIH0pO1xuICAgICAgfWVsc2V7XG4gICAgICAgIHJldmVyc2VkRGF0YVtmaWVsZE5hbWVdID0gZGF0YUJlZm9yZU1hcHBpbmdbZmllbGROYW1lXTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcmV2ZXJzZWREYXRhO1xuICB9XG5cbiAgLyoqIEBpZ25vcmUgKi9cbiAgY29udmVydERhdGFUb0RhdGFCZWZvcmVNYXBwaW5nKGRhdGEpIHtcbiAgICBjb25zdCBkYXRhQmVmb3JlTWFwcGluZyA9IHt9O1xuICAgIGNvbnN0IHNjaGVtYTogSU1EYXRhU291cmNlU2NoZW1hID0gdGhpcy5kYXRhU291cmNlLmdldFNjaGVtYSgpO1xuICAgIE9iamVjdC5rZXlzKGRhdGEpLmZvckVhY2goamltdUZpZWxkTmFtZSA9PiB7XG4gICAgICBjb25zdCBmaWVsZE5hbWUgPSBzY2hlbWEgJiYgc2NoZW1hLmZpZWxkcyAmJiBzY2hlbWEuZmllbGRzW2ppbXVGaWVsZE5hbWVdID8gc2NoZW1hLmZpZWxkc1tqaW11RmllbGROYW1lXS5uYW1lIDogamltdUZpZWxkTmFtZTtcbiAgICAgIGRhdGFCZWZvcmVNYXBwaW5nW2ZpZWxkTmFtZV0gPSBkYXRhW2ppbXVGaWVsZE5hbWVdO1xuICAgIH0pO1xuICAgIHJldHVybiBkYXRhQmVmb3JlTWFwcGluZztcbiAgfVxuXG4gIGdldEZvcm1hdHRlZERhdGEoaW50bDogSW50bFNoYXBlKSB7XG4gICAgY29uc3QgcmV0ID0ge307XG4gICAgT2JqZWN0LmtleXModGhpcy5nZXREYXRhKCkpLmZvckVhY2goZmllbGROYW1lID0+IHtcbiAgICAgIHJldFtmaWVsZE5hbWVdID0gdGhpcy5nZXRGb3JtYXR0ZWRGaWVsZFZhbHVlKGZpZWxkTmFtZSwgaW50bCk7XG4gICAgfSlcbiAgICByZXR1cm4gcmV0O1xuICB9XG5cbiAgZm9ybWF0RGF0ZUZpZWxkKHZhbHVlLCBlc3JpRGF0ZUZvcm1hdDogRXNyaURhdGVGb3JtYXRzLCBpbnRsOiBJbnRsU2hhcGUpOiBzdHJpbmcge1xuICAgIGlmKCF2YWx1ZSl7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgIC8vVE9ETyBoYW5kbGUgdGltZSB6b25lXG4gICAgICB2YWx1ZSA9IG5ldyBEYXRlKHZhbHVlKTtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRhVGltZUZvcm1hdDogRXNyaURhdGVGb3JtYXQgPSBkYXRlVXRpbHMuRVNSSV9EQVRFX0ZPUk1BVF9NQVBbZXNyaURhdGVGb3JtYXRdO1xuICAgIGlmICghZGF0YVRpbWVGb3JtYXQpIHtcbiAgICAgIGNvbnNvbGUud2FybihgSW52YWxpZCBkYXRhIGZvcm1hdCAke2VzcmlEYXRlRm9ybWF0fWApO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGxldCBkYXRlID0gZGF0ZVV0aWxzLmZvcm1hdERhdGUodmFsdWUsIGRhdGFUaW1lRm9ybWF0LmRhdGVQYXR0ZXJuLCBpbnRsKTtcbiAgICBpZiAoZGF0YVRpbWVGb3JtYXQuc2VsZWN0b3IgPT09ICdkYXRlIGFuZCB0aW1lJykge1xuICAgICAgY29uc3QgdGltZSA9IGRhdGVVdGlscy5mb3JtYXRUaW1lKHZhbHVlLCBkYXRhVGltZUZvcm1hdC50aW1lUGF0dGVybiwgaW50bCk7XG4gICAgICBjb25zdCBsb2NhbGUgPSBpbnRsLmxvY2FsZSB8fCAnZW4nO1xuICAgICAgY29uc3QgY29ubmVjdG9yID0gZGF0ZVV0aWxzLkRBVEVfVElNRV9DT05ORUNUT1JbbG9jYWxlXSB8fCBkYXRlVXRpbHMuREFURV9USU1FX0NPTk5FQ1RPUi5jb21tb247XG4gICAgICBkYXRlID0gZGF0ZSArIGNvbm5lY3RvciArIHRpbWU7XG4gICAgfVxuICAgIHJldHVybiBkYXRlO1xuICB9XG5cbiAgZm9ybWF0TnVtYmVyRmllbGQodmFsdWU6IG51bWJlciwgcGxhY2VzOiBudW1iZXIsIGRpZ2l0U2VwYXJhdG9yOiBib29sZWFuLCBpbnRsOiBJbnRsU2hhcGUpOiBzdHJpbmcge1xuICAgIGlmKHZhbHVlID09PSBudWxsIHx8IHR5cGVvZiB2YWx1ZSA9PT0gdW5kZWZpbmVkKXtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IG51bSA9IG5ldyBOdW1iZXIodmFsdWUpO1xuICAgIGlmKGRpZ2l0U2VwYXJhdG9yKXtcbiAgICAgIHJldHVybiBpbnRsLmZvcm1hdE51bWJlcih2YWx1ZSwge21heGltdW1GcmFjdGlvbkRpZ2l0czogcGxhY2VzLCBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IHBsYWNlc30pO1xuICAgIH1lbHNle1xuICAgICAgcmV0dXJuIG51bS50b0ZpeGVkKHBsYWNlcyk7XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogQGlnbm9yZVxuICovXG5leHBvcnQgY2xhc3MgU2ltcGxlRGF0YVJlY29yZEltcGwgZXh0ZW5kcyBBYnN0cmFjdERhdGFSZWNvcmQge1xuICBwcml2YXRlIGRhdGE6IGFueTtcbiAgZGF0YVNvdXJjZTogRGF0YVNvdXJjZTtcblxuICAvKipcbiAgICogYmVmb3JlTWFwcGluZ0RhdGE6IGlzIHRoZSBkYXRhIGZyb20gdGhlIHJlYWwgZGF0YSBzb3VyY2UsIHN1Y2ggYXMgcXVlcnkgZnJvbSByZW1vdGUgc2VydmljZS9kYXRhYmFzZS5cbiAgICogZGF0YSBpcyB0aGUgZGF0YSB1c2VkIGluIEV4Yi5cbiAgICpcbiAgICogVGhlIGJlZm9yZU1hcHBpbmdEYXRhIHVzZXMgdGhpcyBzY2hlbWE6IHtmaWVsZE5hbWU6IHZhbHVlfSwgd2UnbGwgcmV2ZXJzZSBpdCB0byB7amltdUZpZWxkTmFtZTogdmFsdWV9LCB3aGljaCBpcyBjYWxsZWQgZGF0YSBhbmQgd2lsbCBiZSB1c2VkIGluIGV4Yi5cbiAgICpcbiAgICovXG4gIGNvbnN0cnVjdG9yKGRhdGE6IGFueSwgZGF0YVNvdXJjZTogRGF0YVNvdXJjZSwgaXNCZWZvcmVNYXBwaW5nRGF0YSA9IHRydWUpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuZGF0YVNvdXJjZSA9IGRhdGFTb3VyY2U7XG5cbiAgICBpZiAoaXNCZWZvcmVNYXBwaW5nRGF0YSkge1xuICAgICAgdGhpcy5kYXRhID0gdGhpcy5jb252ZXJ0QmVmb3JlTWFwcGluZ0RhdGFUb0RhdGEoZGF0YSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gICAgfVxuICB9XG5cbiAgZ2V0RGF0YSgpIHtcbiAgICByZXR1cm4gdGhpcy5kYXRhO1xuICB9XG5cbiAgZ2V0RGF0YUJlZm9yZU1hcHBpbmcoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29udmVydERhdGFUb0RhdGFCZWZvcmVNYXBwaW5nKHRoaXMuZGF0YSk7XG4gIH1cblxuICB0b0pzb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YTtcbiAgfVxuXG4gIGdldElkKCkge1xuICAgIHJldHVybiB0aGlzLmRhdGEuaWQ7XG4gIH1cblxuICBzZXRJZCgpIHtcblxuICB9XG5cbiAgZ2V0R2VvbWV0cnkoKXtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG4vKipcbiAqIEBpZ25vcmVcbiAqL1xuZXhwb3J0IGNsYXNzIFNpbXBsZURhdGFSZWNvcmRTZXRJbXBsIGltcGxlbWVudHMgRGF0YVJlY29yZFNldHtcbiAgcmVjb3JkczogRGF0YVJlY29yZFtdO1xuICBmaWVsZHM/OiBzdHJpbmdbXTtcbiAgZGF0YVNvdXJjZT86IERhdGFTb3VyY2U7XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogRGF0YVJlY29yZFNldCl7XG4gICAgT2JqZWN0LmFzc2lnbih0aGlzLCBvcHRpb25zKTtcbiAgfVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFJQTs7QUFFQTtBQUNBO0FBQUE7QUFzSEE7QUF6R0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTs7QUFFQTs7QUFFQTtBQUNBO0FBQUE7QUFJQTs7Ozs7O0FBTUE7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTs7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBOztBQUVBOztBQUVBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUFBOzsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./jimu-core/lib/data-sources/ds-base-types/data-record.ts\n");

/***/ }),

/***/ "./jimu-core/lib/data-sources/ds-base-types/index.ts":
/*!***********************************************************!*\
  !*** ./jimu-core/lib/data-sources/ds-base-types/index.ts ***!
  \***********************************************************/
/*! exports provided: AbstractDataSource, AbstractLayerFolderDataSource, AbstractLoadableDataSource, AbstractQueriableDataSource, AbstractSetDataSource, AbstractDataRecord, SimpleDataRecordImpl, SimpleDataRecordSetImpl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _abstract_data_source__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./abstract-data-source */ \"./jimu-core/lib/data-sources/ds-base-types/abstract-data-source.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AbstractDataSource\", function() { return _abstract_data_source__WEBPACK_IMPORTED_MODULE_0__[\"AbstractDataSource\"]; });\n\n/* harmony import */ var _abstract_layer_folder_data_source__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./abstract-layer-folder-data-source */ \"./jimu-core/lib/data-sources/ds-base-types/abstract-layer-folder-data-source.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AbstractLayerFolderDataSource\", function() { return _abstract_layer_folder_data_source__WEBPACK_IMPORTED_MODULE_1__[\"AbstractLayerFolderDataSource\"]; });\n\n/* harmony import */ var _abstract_loadable_data_source__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./abstract-loadable-data-source */ \"./jimu-core/lib/data-sources/ds-base-types/abstract-loadable-data-source.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AbstractLoadableDataSource\", function() { return _abstract_loadable_data_source__WEBPACK_IMPORTED_MODULE_2__[\"AbstractLoadableDataSource\"]; });\n\n/* harmony import */ var _abstract_queriable_data_source__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./abstract-queriable-data-source */ \"./jimu-core/lib/data-sources/ds-base-types/abstract-queriable-data-source.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AbstractQueriableDataSource\", function() { return _abstract_queriable_data_source__WEBPACK_IMPORTED_MODULE_3__[\"AbstractQueriableDataSource\"]; });\n\n/* harmony import */ var _abstract_set_data_source__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./abstract-set-data-source */ \"./jimu-core/lib/data-sources/ds-base-types/abstract-set-data-source.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AbstractSetDataSource\", function() { return _abstract_set_data_source__WEBPACK_IMPORTED_MODULE_4__[\"AbstractSetDataSource\"]; });\n\n/* harmony import */ var _data_record__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./data-record */ \"./jimu-core/lib/data-sources/ds-base-types/data-record.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AbstractDataRecord\", function() { return _data_record__WEBPACK_IMPORTED_MODULE_5__[\"AbstractDataRecord\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SimpleDataRecordImpl\", function() { return _data_record__WEBPACK_IMPORTED_MODULE_5__[\"SimpleDataRecordImpl\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SimpleDataRecordSetImpl\", function() { return _data_record__WEBPACK_IMPORTED_MODULE_5__[\"SimpleDataRecordSetImpl\"]; });\n\n\n\n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9kcy1iYXNlLXR5cGVzL2luZGV4LnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vamltdS1jb3JlL2xpYi9kYXRhLXNvdXJjZXMvZHMtYmFzZS10eXBlcy9pbmRleC50cz84ODgzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCAqIGZyb20gJy4vYWJzdHJhY3QtZGF0YS1zb3VyY2UnO1xuZXhwb3J0ICogZnJvbSAnLi9hYnN0cmFjdC1sYXllci1mb2xkZXItZGF0YS1zb3VyY2UnO1xuZXhwb3J0ICogZnJvbSAnLi9hYnN0cmFjdC1sb2FkYWJsZS1kYXRhLXNvdXJjZSc7XG5leHBvcnQgKiBmcm9tICcuL2Fic3RyYWN0LXF1ZXJpYWJsZS1kYXRhLXNvdXJjZSc7XG5leHBvcnQgKiBmcm9tICcuL2Fic3RyYWN0LXNldC1kYXRhLXNvdXJjZSc7XG5leHBvcnQgKiBmcm9tICcuL2RhdGEtcmVjb3JkJztcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./jimu-core/lib/data-sources/ds-base-types/index.ts\n");

/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/csv-data-source-impl.ts":
/*!****************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/csv-data-source-impl.ts ***!
  \****************************************************************************/
/*! exports provided: CsvDataSourceImpl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CsvDataSourceImpl\", function() { return CsvDataSourceImpl; });\n/* harmony import */ var _data_source_interface__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../data-source-interface */ \"./jimu-core/lib/data-sources/data-source-interface.ts\");\n/* harmony import */ var _ds_base_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ds-base-types */ \"./jimu-core/lib/data-sources/ds-base-types/index.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n/**\n * @ignore\n */\nvar CsvDataSourceImpl = /** @class */ (function (_super) {\n    __extends(CsvDataSourceImpl, _super);\n    function CsvDataSourceImpl(options) {\n        var _this = _super.call(this, options) || this;\n        _this.type = _data_source_interface__WEBPACK_IMPORTED_MODULE_0__[\"DataSourceTypes\"].CSV;\n        if (options.dataSourceJson.data) {\n            _this.records = options.dataSourceJson.data.asMutable().map(function (d) { return new _ds_base_types__WEBPACK_IMPORTED_MODULE_1__[\"SimpleDataRecordImpl\"](d, _this); });\n            _this.setStatus(_data_source_interface__WEBPACK_IMPORTED_MODULE_0__[\"DataSourceStatus\"].Loaded);\n        }\n        else {\n            _this.url = options.dataSourceJson.url;\n        }\n        return _this;\n    }\n    CsvDataSourceImpl.prototype.doLoad = function () {\n        var _this = this;\n        return fetch(this.url).then(function (res) { return res.json(); }).then(function (data) {\n            return data.map(function (d) { return new _ds_base_types__WEBPACK_IMPORTED_MODULE_1__[\"SimpleDataRecordImpl\"](d, _this); });\n        });\n    };\n    return CsvDataSourceImpl;\n}(_ds_base_types__WEBPACK_IMPORTED_MODULE_1__[\"AbstractLoadableDataSource\"]));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvY3N2LWRhdGEtc291cmNlLWltcGwudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvY3N2LWRhdGEtc291cmNlLWltcGwudHM/NTc3OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEYXRhU291cmNlVHlwZXMsIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMsIERhdGFTb3VyY2VTdGF0dXMsIERhdGFSZWNvcmQsIENzdkRhdGFTb3VyY2UgfSBmcm9tICcuLi9kYXRhLXNvdXJjZS1pbnRlcmZhY2UnO1xuaW1wb3J0IHsgQWJzdHJhY3RMb2FkYWJsZURhdGFTb3VyY2UsIFNpbXBsZURhdGFSZWNvcmRJbXBsIH0gZnJvbSAnLi4vZHMtYmFzZS10eXBlcyc7XG5cbi8qKlxuICogQGlnbm9yZVxuICovXG5leHBvcnQgY2xhc3MgQ3N2RGF0YVNvdXJjZUltcGwgZXh0ZW5kcyBBYnN0cmFjdExvYWRhYmxlRGF0YVNvdXJjZSBpbXBsZW1lbnRzIENzdkRhdGFTb3VyY2Uge1xuICB0eXBlOiBEYXRhU291cmNlVHlwZXMuQ1NWID0gRGF0YVNvdXJjZVR5cGVzLkNTVjtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zKSB7XG4gICAgc3VwZXIob3B0aW9ucyk7XG4gICAgaWYgKG9wdGlvbnMuZGF0YVNvdXJjZUpzb24uZGF0YSkge1xuICAgICAgdGhpcy5yZWNvcmRzID0gb3B0aW9ucy5kYXRhU291cmNlSnNvbi5kYXRhLmFzTXV0YWJsZSgpLm1hcChkID0+IG5ldyBTaW1wbGVEYXRhUmVjb3JkSW1wbChkLCB0aGlzKSk7XG4gICAgICB0aGlzLnNldFN0YXR1cyhEYXRhU291cmNlU3RhdHVzLkxvYWRlZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudXJsID0gb3B0aW9ucy5kYXRhU291cmNlSnNvbi51cmw7XG4gICAgfVxuICB9XG5cbiAgZG9Mb2FkKCk6IFByb21pc2U8RGF0YVJlY29yZFtdPiB7XG4gICAgcmV0dXJuIGZldGNoKHRoaXMudXJsKS50aGVuKHJlcyA9PiByZXMuanNvbigpKS50aGVuKChkYXRhOiBhbnlbXSkgPT4ge1xuICAgICAgcmV0dXJuIGRhdGEubWFwKGQgPT4gbmV3IFNpbXBsZURhdGFSZWNvcmRJbXBsKGQsIHRoaXMpKTtcbiAgICB9KTtcbiAgfVxufSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUFBO0FBR0E7QUFBQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7O0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBOzsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./jimu-core/lib/data-sources/implementations/csv-data-source-impl.ts\n");

/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/feature-layer-data-source-impl.ts":
/*!**************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/feature-layer-data-source-impl.ts ***!
  \**************************************************************************************/
/*! exports provided: FeatureLayerDataSourceImpl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FeatureLayerDataSourceImpl\", function() { return FeatureLayerDataSourceImpl; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _feature_record_impl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./feature-record-impl */ \"./jimu-core/lib/data-sources/implementations/feature-record-impl.ts\");\n/* harmony import */ var _ds_base_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../ds-base-types */ \"./jimu-core/lib/data-sources/ds-base-types/index.ts\");\n/* harmony import */ var _data_source_interface__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../data-source-interface */ \"./jimu-core/lib/data-sources/data-source-interface.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (undefined && undefined.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\n\n\n\n\nvar FeatureLayerDataSourceImpl = /** @class */ (function (_super) {\n    __extends(FeatureLayerDataSourceImpl, _super);\n    function FeatureLayerDataSourceImpl(options) {\n        var _this = _super.call(this, options) || this;\n        _this.type = _data_source_interface__WEBPACK_IMPORTED_MODULE_3__[\"DataSourceTypes\"].FeatureLayer;\n        var dsJson = _this.getDataSourceJson();\n        _this.portalUrl = dsJson.portalUrl;\n        _this.itemId = dsJson.itemId;\n        _this.layerId = dsJson.layerId;\n        if (options.layer) {\n            _this.layer = options.layer;\n        }\n        if (options.belongToDataSource && options.belongToDataSource.layer) {\n            _this.layer = options.belongToDataSource.layer;\n        }\n        return _this;\n    }\n    FeatureLayerDataSourceImpl.prototype.getIdField = function () {\n        var layerDefinition = this.getLayerDefinition();\n        var objectIdField = layerDefinition.objectIdField;\n        if (!objectIdField) {\n            var f = layerDefinition.fields.find(function (f) { return f.type === 'esriFieldTypeOID'; });\n            if (f) {\n                objectIdField = f.name;\n            }\n        }\n        if (!objectIdField) {\n            objectIdField = 'OBJECTID';\n        }\n        return objectIdField;\n    };\n    FeatureLayerDataSourceImpl.prototype.getGeometryType = function () {\n        return this.getLayerDefinition().geometryType;\n    };\n    FeatureLayerDataSourceImpl.prototype.setJsonData = function (data) {\n        var _this = this;\n        this.records = data.map(function (d) { return new _feature_record_impl__WEBPACK_IMPORTED_MODULE_1__[\"FeatureDataRecordImpl\"](d, _this, false); });\n    };\n    FeatureLayerDataSourceImpl.prototype.doQuery = function (queryProperties) {\n        var _this = this;\n        // the reason of use layer.query when has layer is: features returned from layer.query() have symbol object.\n        if (this.layer) {\n            return this._doQueryByLayer(queryProperties);\n        }\n        else if (this.getDataSourceJson().url) {\n            return this._doQueryByUrl(queryProperties);\n        }\n        else {\n            return this.createFeatureLayer().then(function () { return _this._doQueryByLayer(queryProperties); });\n        }\n    };\n    FeatureLayerDataSourceImpl.prototype.doQueryCount = function (queryProperties) {\n        var _this = this;\n        // The reason of use layer.query when has layer is: some layer does not have url:\n        // 1. features are uploaded and saved to the layer directly.\n        // 2. if save the layer to an item, it will be a feature collection item.\n        if (this.layer) {\n            return this._doQueryCountByLayer(queryProperties);\n        }\n        else if (this.getDataSourceJson().url) {\n            return this._doQueryCountByUrl(queryProperties);\n        }\n        else {\n            return this.createFeatureLayer().then(function () { return _this._doQueryCountByLayer(queryProperties); });\n        }\n    };\n    FeatureLayerDataSourceImpl.prototype._doQueryCountByLayer = function (_queryProperties) {\n        var fixedQuery = this.fixQueryParam(_queryProperties);\n        var query = fixedQuery.asMutable({ deep: true });\n        return this.layer.queryFeatureCount(query).then(function (count) {\n            return {\n                queryParams: _queryProperties,\n                count: count\n            };\n        });\n    };\n    FeatureLayerDataSourceImpl.prototype._doQueryCountByUrl = function (_queryProperties) {\n        var query = this._changeQueryPropertiesFormat(_queryProperties);\n        delete query.resultRecordCount;\n        delete query.resultOffset;\n        if (!query.returnCountOnly) {\n            query.returnCountOnly = true;\n        }\n        return this._q(query).then(function (queryResponse) {\n            return {\n                queryParams: _queryProperties,\n                count: queryResponse.count\n            };\n        });\n    };\n    FeatureLayerDataSourceImpl.prototype.doQueryById = function (id) {\n        return this.doQuery(Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])({ objectIds: [parseInt(id)], returnGeometry: true })).then(function (result) { return result.records[0]; });\n    };\n    FeatureLayerDataSourceImpl.prototype.queryById = function (id) {\n        return _super.prototype.queryById.call(this, id);\n    };\n    FeatureLayerDataSourceImpl.prototype.getConfigQueryParams = function () {\n        var query = this.getDataViewConfig();\n        if (!query) {\n            return null;\n        }\n        var configQuery = {\n            where: jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getArcGISSQL(query.where, this).sql,\n            orderByFields: this._getOrderByArray(query.orderBy)\n        };\n        return configQuery;\n    };\n    FeatureLayerDataSourceImpl.prototype.mergeQueryParams = function (baseQuery, newQuery) {\n        var where = '';\n        var baseQueryWhere = baseQuery && baseQuery.where;\n        var newQueryWhere = newQuery && newQuery.where;\n        where = [baseQueryWhere, newQueryWhere].filter(function (item) { return item; }).join(' and ');\n        return __assign(__assign(__assign({}, baseQuery), newQuery), { where: where });\n    };\n    FeatureLayerDataSourceImpl.prototype.getCurrentQueryParams = function (excludeOption) {\n        var query = _super.prototype.getCurrentQueryParams.call(this, excludeOption);\n        return this.applyGDBVersionAndFix(query);\n    };\n    FeatureLayerDataSourceImpl.prototype.getRealQueryParams = function (query, flag, options) {\n        var rq = _super.prototype.getRealQueryParams.call(this, query, flag, options);\n        return this.applyGDBVersionAndFix(rq);\n    };\n    FeatureLayerDataSourceImpl.prototype.getRemoteQueryParams = function () {\n        if (this.getSchema().filter) {\n            return { where: this.getSchema().filter };\n        }\n        return null;\n    };\n    FeatureLayerDataSourceImpl.prototype.applyGDBVersionAndFix = function (query) {\n        if (this.getGDBVersion()) {\n            query.gdbVersion = this.getGDBVersion();\n        }\n        query = this.fixQueryParam(Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])(query)).asMutable({ deep: true });\n        return query;\n    };\n    /**\n     * some query params are not supported according to the feature service capability, we'll fix it here.\n     */\n    FeatureLayerDataSourceImpl.prototype.fixQueryParam = function (q) {\n        // fix for statiscs: https://developers.arcgis.com/rest/services-reference/query-feature-service-layer-.htm\n        // Seems the 'orderByFields' is supported only when it's groupByFields. Because we don't support groupby for now,\n        // so we remove the 'orderByFields' for now.\n        // do not remove geometry, this may not work on some services. TODO\n        var fixedQuery = q;\n        if (q.outStatistics) {\n            Object.keys(q).forEach(function (k) {\n                if (['groupByFieldsForStatistics', 'time', 'where', 'outStatistics', 'geometry'].indexOf(k) < 0) {\n                    fixedQuery = fixedQuery.without(k);\n                }\n            });\n        }\n        return fixedQuery;\n    };\n    FeatureLayerDataSourceImpl.prototype.addRecord = function (record) {\n        var _this = this;\n        var attributes = record.getData();\n        var feature = {\n            attributes: attributes\n        };\n        var options = {\n            url: this.url,\n            features: [feature]\n        };\n        return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"requestUtils\"].requestWrapper(this.url, function (session) {\n            options.authentication = session;\n            return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"esri\"].restFeatureLayer.addFeatures(options)\n                .then(function (response) {\n                // return a new record with the OBJECTID\n                var objectId = response.addResults[0].objectId;\n                attributes.OBJECTID = objectId; // ??\n                return new _feature_record_impl__WEBPACK_IMPORTED_MODULE_1__[\"FeatureDataRecordImpl\"]({\n                    attributes: attributes\n                }, _this);\n            });\n        });\n        // TODO: retry if request was unauthenticated\n        // once we are sending tokens above\n        // .catch(sessionManager.handleAuthError.bind(sessionManager));\n    };\n    FeatureLayerDataSourceImpl.prototype.fetchSchema = function () {\n        if (this.getDataSourceJson().isStatistic) {\n            return Promise.resolve(Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])({}));\n        }\n        if (this.layer) { // from map\n            return this.fetchSchemaWithLayer();\n        }\n        else { // from a feature service item or feature service url or from a feature collection item\n            return this.fetchSchemaWithoutLayer();\n        }\n    };\n    FeatureLayerDataSourceImpl.prototype.createFeatureLayer = function () {\n        var _this = this;\n        if (this.createFeatureLayerPromise) {\n            return this.createFeatureLayerPromise;\n        }\n        if (this.layer) {\n            this.createFeatureLayerPromise = Promise.resolve(this.layer);\n        }\n        else {\n            this.createFeatureLayerPromise = Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"loadArcGISJSAPIModules\"])(['esri/layers/Layer', 'esri/portal/PortalItem']).then(function (modules) {\n                var Layer = modules[0];\n                var PortalItem = modules[1];\n                return Layer.fromPortalItem({ portalItem: new PortalItem({ id: _this.itemId, portal: { url: _this.portalUrl } }) });\n            }).then(function (layer) {\n                if ((layer === null || layer === void 0 ? void 0 : layer.type) === _data_source_interface__WEBPACK_IMPORTED_MODULE_3__[\"SupportedLayerTypes\"].FeatureLayer) {\n                    _this.layer = layer;\n                    return Promise.resolve(_this.layer);\n                }\n                else if ((layer === null || layer === void 0 ? void 0 : layer.type) === _data_source_interface__WEBPACK_IMPORTED_MODULE_3__[\"SupportedLayerTypes\"].GroupLayer) {\n                    return layer.loadAll().then(function (layer) {\n                        var feaureLayer = layer.layers.toArray().find(\n                        // feature layer created from a multiple-layer feature collection item may do not have layerId,\n                        // so id of use layer definition to find the feature layer\n                        function (l) { var _a; return \"\" + l.layerId === _this.layerId || \"\" + ((_a = _this.getLayerDefinition()) === null || _a === void 0 ? void 0 : _a.id) === _this.layerId; });\n                        if ((feaureLayer === null || feaureLayer === void 0 ? void 0 : feaureLayer.type) === _data_source_interface__WEBPACK_IMPORTED_MODULE_3__[\"SupportedLayerTypes\"].FeatureLayer) {\n                            _this.layer = feaureLayer;\n                            return Promise.resolve(_this.layer);\n                        }\n                        return Promise.reject('Create feaure layer data source error: failed to create feature layer with specific layer id.');\n                    });\n                }\n            });\n        }\n        return this.createFeatureLayerPromise;\n    };\n    FeatureLayerDataSourceImpl.prototype.fetchSchemaWithoutLayer = function () {\n        var _this = this;\n        var serviceInfoPromise = this.url ? jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"ServiceManager\"].getInstance().fetchServiceInfo(this.url) : Promise.resolve(null);\n        return serviceInfoPromise.then(function (serviceInfo) {\n            if (_this.itemId) {\n                return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"requestUtils\"].requestWrapper(_this.getDataSourceJson().portalUrl, function (session) {\n                    return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"esri\"].restPortal.getItemData(_this.itemId, {\n                        portal: jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"portalUrlUtils\"].getPortalRestUrl(_this.portalUrl),\n                        authentication: session\n                    }).then(function (itemData) {\n                        var layerInfo = itemData && itemData.layers && itemData.layers[_this.layerId];\n                        var serviceDefinition = (serviceInfo === null || serviceInfo === void 0 ? void 0 : serviceInfo.definition) ? _this._getUpdatedLayerDefinition(layerInfo, serviceInfo.definition) : layerInfo === null || layerInfo === void 0 ? void 0 : layerInfo.layerDefinition;\n                        return {\n                            serviceDefinition: serviceDefinition,\n                            fieldInfos: layerInfo && layerInfo.popupInfo && layerInfo.popupInfo.fieldInfos,\n                            filter: layerInfo && layerInfo.layerDefinition && layerInfo.layerDefinition.definitionExpression,\n                            refreshInterval: (layerInfo === null || layerInfo === void 0 ? void 0 : layerInfo.refreshInterval) * 60 // change to second\n                        };\n                    });\n                });\n            }\n            else {\n                return {\n                    serviceDefinition: serviceInfo === null || serviceInfo === void 0 ? void 0 : serviceInfo.definition,\n                    fieldInfos: null,\n                    filter: null,\n                    refreshInterval: null\n                };\n            }\n        }).then(function (_a) {\n            var _b;\n            var serviceDefinition = _a.serviceDefinition, fieldInfos = _a.fieldInfos, filter = _a.filter, refreshInterval = _a.refreshInterval;\n            var schema = {\n                fields: {},\n                idField: serviceDefinition === null || serviceDefinition === void 0 ? void 0 : serviceDefinition.idField,\n                filter: filter,\n                refreshInterval: refreshInterval,\n                label: ((_b = _this.layer) === null || _b === void 0 ? void 0 : _b.title) || (serviceDefinition === null || serviceDefinition === void 0 ? void 0 : serviceDefinition.name)\n            };\n            _this.layerDefinition = serviceDefinition;\n            serviceDefinition.fields.forEach(function (f) {\n                var fieldInfo = fieldInfos && fieldInfos.find(function (fi) { return fi.fieldName === f.name; });\n                schema.fields[f.name] = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].convertFieldToJimuField(f, fieldInfo);\n            });\n            return Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])(schema);\n        });\n    };\n    FeatureLayerDataSourceImpl.prototype.fetchSchemaWithLayer = function () {\n        var _this = this;\n        return this.layer.load().then(function () {\n            _this.updateLayerDefinitionByLayer();\n            var schema = {\n                fields: {},\n                idField: _this.layer.objectIdField,\n                filter: _this.layer.definitionExpression,\n                refreshInterval: _this.layer.refreshInterval * 60,\n                label: _this.layer.title\n            };\n            _this.layer.fields.forEach(function (field) {\n                var fieldInfo = _this.layer.popupTemplate && _this.layer.popupTemplate.fieldInfos && _this.layer.popupTemplate.fieldInfos.find(function (f) { return f.fieldName === field.name; });\n                if (fieldInfo) {\n                    fieldInfo = fieldInfo.toJSON();\n                }\n                schema.fields[field.name] = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].convertFieldToJimuField(field.toJSON(), fieldInfo);\n            });\n            return Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])(schema);\n        });\n    };\n    FeatureLayerDataSourceImpl.prototype.updateLayerDefinitionByLayer = function () {\n        var layerDef = this.layer.sourceJSON;\n        var renderer = this.layer.renderer;\n        if (renderer && renderer.toJSON()) {\n            var rendererJSON = renderer.toJSON();\n            if (rendererJSON.type === 'uniqueValue') {\n                var types_1 = this.layer.sourceJSON.types;\n                if (rendererJSON.field1 !== this.layer.sourceJSON.typeIdField) {\n                    types_1 = [];\n                    rendererJSON.uniqueValueInfos.map(function (item) {\n                        types_1.push({ id: item.value, name: item.label, domain: {} });\n                    });\n                }\n                layerDef = Object.assign({ name: this.layer.title }, layerDef, {\n                    drawingInfo: { renderer: rendererJSON },\n                    typeIdField: rendererJSON.field1,\n                    types: types_1\n                });\n            }\n        }\n        this.layerDefinition = layerDef;\n    };\n    FeatureLayerDataSourceImpl.prototype.getLayerDefinition = function () {\n        if (this.isDataView || this.isLocal) {\n            return this.getMainDataSource().getLayerDefinition();\n        }\n        return this.layerDefinition;\n    };\n    FeatureLayerDataSourceImpl.prototype.getFieldCodedValueList = function (jimuFieldName, record) {\n        var fieldName = '';\n        var fields = this.getSchema().fields;\n        Object.keys(fields).some(function (name) {\n            if (name === jimuFieldName) {\n                fieldName = fields[name].name;\n                return true;\n            }\n            else {\n                return false;\n            }\n        });\n        return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getCodedValueListForCodedValueOrSubtypeField(this.getLayerDefinition(), fieldName, record);\n    };\n    FeatureLayerDataSourceImpl.prototype.getGDBVersion = function () {\n        return this.getInfo().gdbVersion;\n    };\n    FeatureLayerDataSourceImpl.prototype.changeGDBVersion = function (gdbVersion) {\n        Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"getAppStore\"])().dispatch(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"appActions\"].changeDataSourceGDBVersion(this.id, gdbVersion));\n        if (this.layer) {\n            this.layer.gdbVersion = gdbVersion;\n        }\n    };\n    /**\n     * Return data source which original data is a root layer in webmap/webscene or a root serivce.\n     * Root service is a whole service rather than a single layer under the service, such as https://sampleserver6.arcgisonline.com/arcgis/rest/services/911CallsHotspot/MapServer .\n     */\n    FeatureLayerDataSourceImpl.prototype.getRootLayerDataSource = function () {\n        var _a;\n        var parentDs = this.parentDataSource;\n        var grandParentDs = (_a = this.parentDataSource) === null || _a === void 0 ? void 0 : _a.parentDataSource;\n        while (this._isLayerDataSource(parentDs) && this._isLayerDataSource(grandParentDs)) {\n            parentDs = grandParentDs;\n            grandParentDs = grandParentDs.parentDataSource;\n        }\n        return parentDs;\n    };\n    FeatureLayerDataSourceImpl.prototype.getOriginalDataId = function () {\n        var _a, _b;\n        return ((_a = this.layer) === null || _a === void 0 ? void 0 : _a.id) || ((_b = this.layerDefinition) === null || _b === void 0 ? void 0 : _b.id);\n    };\n    FeatureLayerDataSourceImpl.prototype._isLayerDataSource = function (dataSource) {\n        var _a, _b, _c;\n        return ((_a = dataSource) === null || _a === void 0 ? void 0 : _a.layer) || ((_b = dataSource) === null || _b === void 0 ? void 0 : _b.layerDefinition) || ((_c = dataSource) === null || _c === void 0 ? void 0 : _c.serviceDefinition);\n    };\n    //update serviceInfo from layerInfo for layer item\n    FeatureLayerDataSourceImpl.prototype._getUpdatedLayerDefinition = function (layerInfo, serviceDefinition) {\n        var updatedDefinition = serviceDefinition;\n        if (layerInfo && layerInfo.layerDefinition) {\n            var updatedOptions = void 0;\n            var drawingInfo = layerInfo.layerDefinition.drawingInfo;\n            if (drawingInfo) {\n                if (drawingInfo.renderer && drawingInfo.renderer.type === 'uniqueValue') {\n                    //update types(id, name) from drawingInfo(value,label)\n                    var types_2 = serviceDefinition.types;\n                    if (drawingInfo.renderer.field1 !== serviceDefinition.typeIdField) {\n                        types_2 = [];\n                        drawingInfo.renderer.uniqueValueInfos.map(function (item) {\n                            types_2.push({ id: item.value, name: item.label, domain: {} });\n                        });\n                    }\n                    updatedOptions = {\n                        defaultVisibility: layerInfo.layerDefinition.defaultVisibility,\n                        drawingInfo: layerInfo.layerDefinition.drawingInfo,\n                        typeIdField: drawingInfo.renderer.field1,\n                        types: types_2\n                    };\n                }\n            }\n            else if (layerInfo.layerDefinition.defaultVisibility !== serviceDefinition.defaultVisibility) {\n                updatedOptions = { defaultVisibility: layerInfo.layerDefinition.defaultVisibility };\n            }\n            updatedDefinition = Object.assign({}, updatedDefinition, updatedOptions);\n        }\n        return updatedDefinition;\n    };\n    FeatureLayerDataSourceImpl.prototype._getOrderByArray = function (orderBys) {\n        var _a;\n        return (_a = orderBys === null || orderBys === void 0 ? void 0 : orderBys.map(function (orderBy) {\n            return orderBy.jimuFieldName + ' ' + orderBy.order;\n        }).asMutable()) !== null && _a !== void 0 ? _a : [];\n    };\n    FeatureLayerDataSourceImpl.prototype._changeQueryPropertiesFormat = function (queryProperties) {\n        if (!queryProperties) {\n            return null;\n        }\n        var q = this.fixQueryParam(queryProperties).asMutable({ deep: true });\n        if (q.page && q.pageSize) {\n            q.resultOffset = (q.page - 1) * q.pageSize;\n            q.resultRecordCount = q.pageSize;\n            delete q.page;\n            delete q.pageSize;\n        }\n        if (Array.isArray(q.orderByFields)) {\n            q.orderByFields = q.orderByFields.join(',');\n        }\n        if (Array.isArray(q.groupByFieldsForStatistics)) {\n            q.groupByFieldsForStatistics = q.groupByFieldsForStatistics.join(',');\n        }\n        return q;\n    };\n    FeatureLayerDataSourceImpl.prototype._doQueryByUrl = function (_queryProperties) {\n        var _this = this;\n        var queryProperties = this._changeQueryPropertiesFormat(_queryProperties);\n        if (queryProperties.returnCountOnly) {\n            console.error('To query count, please use queryCount.');\n            return Promise.reject('To query count, please use queryCount.');\n        }\n        if (queryProperties.outFields && !(queryProperties.outFields === '*' || queryProperties.outFields[0] === '*')) {\n            var typeIdField = this.getLayerDefinition().typeIdField;\n            if (typeIdField && queryProperties.outFields.indexOf(typeIdField) < 0) {\n                queryProperties.outFields.push(typeIdField);\n            }\n        }\n        return this._q(queryProperties).then(function (queryResponse) {\n            var fields = Object.keys(_this.getSchema().fields).filter(function (jimuFieldName) {\n                return queryResponse.fields && queryResponse.fields.find(function (field) { return field.name === _this.getSchema().fields[jimuFieldName].name; });\n            });\n            var queryResult = {\n                queryParams: _queryProperties,\n                fields: fields,\n                records: queryResponse.features.map(function (feature) { return new _feature_record_impl__WEBPACK_IMPORTED_MODULE_1__[\"FeatureDataRecordImpl\"](feature, _this); })\n            };\n            return queryResult;\n        });\n    };\n    FeatureLayerDataSourceImpl.prototype._doQueryByLayer = function (_query) {\n        var _this = this;\n        var fixedQuery = this.fixQueryParam(_query);\n        var query = fixedQuery.asMutable({ deep: true });\n        return Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"loadArcGISJSAPIModules\"])(['esri/geometry/support/jsonUtils']).then(function (modules) {\n            var jsonUtils = modules[0];\n            if (fixedQuery.page && fixedQuery.pageSize) {\n                query.start = (fixedQuery.page - 1) * fixedQuery.pageSize;\n                query.num = fixedQuery.pageSize;\n                delete query.page;\n                delete query.pageSize;\n            }\n            query.geometry = jsonUtils.fromJSON(query.geometry);\n            delete query.key;\n            if (_this.getGDBVersion()) {\n                query.gdbVersion = _this.getGDBVersion();\n            }\n            query.outFields = query.outFields && query.outFields.length > 0 ? query.outFields : ['*'];\n            if (query.outFields && query.outFields[0] !== '*') {\n                var typeIdField = _this.getLayerDefinition().typeIdField;\n                if (typeIdField && query.outFields.indexOf(typeIdField) < 0) {\n                    query.outFields.push(typeIdField);\n                }\n            }\n            return _this.layer.queryFeatures(query).then(function (featureSet) {\n                var records = featureSet.features.map(function (f) { return new _feature_record_impl__WEBPACK_IMPORTED_MODULE_1__[\"FeatureDataRecordImpl\"](f, _this); });\n                var fields = Object.keys(_this.getSchema().fields).filter(function (jimuFieldName) {\n                    return featureSet.fields && featureSet.fields.find(function (field) { return field.name === _this.getSchema().fields[jimuFieldName].name; });\n                });\n                return {\n                    queryParams: _query,\n                    records: records,\n                    fields: fields\n                };\n            });\n        });\n    };\n    FeatureLayerDataSourceImpl.prototype._q = function (queryProperties) {\n        var options = __assign({ url: this.url }, queryProperties);\n        return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"requestUtils\"].requestWrapper(this.url, function (session) {\n            options.authentication = session;\n            return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"esri\"].restFeatureLayer.queryFeatures(options);\n        });\n    };\n    return FeatureLayerDataSourceImpl;\n}(_ds_base_types__WEBPACK_IMPORTED_MODULE_2__[\"AbstractQueriableDataSource\"]));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvZmVhdHVyZS1sYXllci1kYXRhLXNvdXJjZS1pbXBsLnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vamltdS1jb3JlL2xpYi9kYXRhLXNvdXJjZXMvaW1wbGVtZW50YXRpb25zL2ZlYXR1cmUtbGF5ZXItZGF0YS1zb3VyY2UtaW1wbC50cz8zZmFjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGVzcmksIEltbXV0YWJsZSwgU2VydmljZURlZmluaXRpb24sIERhdGFTb3VyY2VTY2hlbWEsIFNlcnZpY2VNYW5hZ2VyLCBTZXJ2aWNlSW5mbywgcG9ydGFsVXJsVXRpbHMsIHJlcXVlc3RVdGlscywgT3JkZXJCeU9wdGlvbiwgZGF0YVNvdXJjZVV0aWxzLCBJTURhdGFTb3VyY2VTY2hlbWEsIGdldEFwcFN0b3JlLFxuICBhcHBBY3Rpb25zLCBsb2FkQXJjR0lTSlNBUElNb2R1bGVzXG59IGZyb20gJ2ppbXUtY29yZSc7XG5pbXBvcnQgeyBJRmVhdHVyZSwgR2VvbWV0cnlUeXBlIH0gZnJvbSAnQGVzcmkvYXJjZ2lzLXJlc3QtdHlwZXMnO1xuaW1wb3J0IHsgSVF1ZXJ5RmVhdHVyZXNPcHRpb25zLCBJUXVlcnlGZWF0dXJlc1Jlc3BvbnNlLCBJQWRkRmVhdHVyZXNPcHRpb25zIH0gZnJvbSAnQGVzcmkvYXJjZ2lzLXJlc3QtZmVhdHVyZS1sYXllcic7XG5pbXBvcnQgeyBGZWF0dXJlRGF0YVJlY29yZEltcGwgfSBmcm9tICcuL2ZlYXR1cmUtcmVjb3JkLWltcGwnO1xuaW1wb3J0IHsgQWJzdHJhY3RRdWVyaWFibGVEYXRhU291cmNlIH0gZnJvbSAnLi4vZHMtYmFzZS10eXBlcyc7XG5pbXBvcnQge1xuICBEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zLCBEYXRhU291cmNlVHlwZXMsIFF1ZXJ5UmVzdWx0LCBDb2RlZFZhbHVlLCBGZWF0dXJlTGF5ZXJEYXRhU291cmNlLCBGZWF0dXJlRGF0YVJlY29yZCwgSU1GZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcywgRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMsXG4gIERhdGFTb3VyY2UsXG4gIFF1ZXJ5T3B0aW9ucyxcbiAgV2lkZ2V0RGF0YVNvdXJjZVBhaXIsXG4gIFN1cHBvcnRlZExheWVyVHlwZXMsXG59IGZyb20gJy4uL2RhdGEtc291cmNlLWludGVyZmFjZSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmVhdHVyZUxheWVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyBleHRlbmRzIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMge1xuICBsYXllcj86IF9fZXNyaS5GZWF0dXJlTGF5ZXI7XG59XG5cbmV4cG9ydCBjbGFzcyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlSW1wbCBleHRlbmRzIEFic3RyYWN0UXVlcmlhYmxlRGF0YVNvdXJjZSBpbXBsZW1lbnRzIEZlYXR1cmVMYXllckRhdGFTb3VyY2Uge1xuICBwb3J0YWxVcmw/OiBzdHJpbmc7XG4gIGl0ZW1JZD86IHN0cmluZztcbiAgbGF5ZXJJZD86IHN0cmluZztcblxuICBsYXllcj86IF9fZXNyaS5GZWF0dXJlTGF5ZXI7XG4gIHByaXZhdGUgbGF5ZXJEZWZpbml0aW9uOiBTZXJ2aWNlRGVmaW5pdGlvbjtcblxuICB1cmw6IHN0cmluZztcbiAgdHlwZTogRGF0YVNvdXJjZVR5cGVzLkZlYXR1cmVMYXllciA9IERhdGFTb3VyY2VUeXBlcy5GZWF0dXJlTGF5ZXI7XG5cbiAgY3JlYXRlRmVhdHVyZUxheWVyUHJvbWlzZTogUHJvbWlzZTxfX2VzcmkuRmVhdHVyZUxheWVyPjtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBGZWF0dXJlTGF5ZXJEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zKXtcbiAgICBzdXBlcihvcHRpb25zKTtcbiAgICBjb25zdCBkc0pzb24gPSB0aGlzLmdldERhdGFTb3VyY2VKc29uKCk7XG4gICAgdGhpcy5wb3J0YWxVcmwgPSBkc0pzb24ucG9ydGFsVXJsO1xuICAgIHRoaXMuaXRlbUlkID0gZHNKc29uLml0ZW1JZDtcbiAgICB0aGlzLmxheWVySWQgPSBkc0pzb24ubGF5ZXJJZDtcblxuICAgIGlmKG9wdGlvbnMubGF5ZXIpe1xuICAgICAgdGhpcy5sYXllciA9IG9wdGlvbnMubGF5ZXI7XG4gICAgfVxuXG4gICAgaWYob3B0aW9ucy5iZWxvbmdUb0RhdGFTb3VyY2UgJiYgKG9wdGlvbnMuYmVsb25nVG9EYXRhU291cmNlIGFzIEZlYXR1cmVMYXllckRhdGFTb3VyY2UpLmxheWVyKXtcbiAgICAgIHRoaXMubGF5ZXIgPSAob3B0aW9ucy5iZWxvbmdUb0RhdGFTb3VyY2UgYXMgRmVhdHVyZUxheWVyRGF0YVNvdXJjZSkubGF5ZXI7XG4gICAgfVxuICB9XG5cbiAgZ2V0SWRGaWVsZCgpOiBzdHJpbmcge1xuICAgIGNvbnN0IGxheWVyRGVmaW5pdGlvbiA9IHRoaXMuZ2V0TGF5ZXJEZWZpbml0aW9uKCk7XG4gICAgbGV0IG9iamVjdElkRmllbGQgPSBsYXllckRlZmluaXRpb24ub2JqZWN0SWRGaWVsZDtcblxuICAgIGlmKCFvYmplY3RJZEZpZWxkKXtcbiAgICAgIGNvbnN0IGYgPSBsYXllckRlZmluaXRpb24uZmllbGRzLmZpbmQoZiA9PiBmLnR5cGUgPT09ICdlc3JpRmllbGRUeXBlT0lEJyk7XG4gICAgICBpZihmKXtcbiAgICAgICAgb2JqZWN0SWRGaWVsZCA9IGYubmFtZTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYoIW9iamVjdElkRmllbGQpe1xuICAgICAgb2JqZWN0SWRGaWVsZCA9ICdPQkpFQ1RJRCc7XG4gICAgfVxuXG4gICAgcmV0dXJuIG9iamVjdElkRmllbGQ7XG4gIH1cblxuICBnZXRHZW9tZXRyeVR5cGUoKTogR2VvbWV0cnlUeXBle1xuICAgIHJldHVybiB0aGlzLmdldExheWVyRGVmaW5pdGlvbigpLmdlb21ldHJ5VHlwZTtcbiAgfVxuXG4gIHNldEpzb25EYXRhKGRhdGE6IChJRmVhdHVyZSB8IF9fZXNyaS5HcmFwaGljKVtdKXtcbiAgICB0aGlzLnJlY29yZHMgPSBkYXRhLm1hcChkID0+IG5ldyBGZWF0dXJlRGF0YVJlY29yZEltcGwoZCwgdGhpcywgZmFsc2UpKTtcbiAgfVxuXG4gIGRvUXVlcnkocXVlcnlQcm9wZXJ0aWVzOiBJTUZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zKTogUHJvbWlzZTxRdWVyeVJlc3VsdD57XG4gICAgLy8gdGhlIHJlYXNvbiBvZiB1c2UgbGF5ZXIucXVlcnkgd2hlbiBoYXMgbGF5ZXIgaXM6IGZlYXR1cmVzIHJldHVybmVkIGZyb20gbGF5ZXIucXVlcnkoKSBoYXZlIHN5bWJvbCBvYmplY3QuXG4gICAgaWYodGhpcy5sYXllcil7XG4gICAgICByZXR1cm4gdGhpcy5fZG9RdWVyeUJ5TGF5ZXIocXVlcnlQcm9wZXJ0aWVzKTtcbiAgICB9ZWxzZSBpZih0aGlzLmdldERhdGFTb3VyY2VKc29uKCkudXJsKXtcbiAgICAgIHJldHVybiB0aGlzLl9kb1F1ZXJ5QnlVcmwocXVlcnlQcm9wZXJ0aWVzKTtcbiAgICB9ZWxzZXtcbiAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUZlYXR1cmVMYXllcigpLnRoZW4oKCkgPT4gdGhpcy5fZG9RdWVyeUJ5TGF5ZXIocXVlcnlQcm9wZXJ0aWVzKSk7XG4gICAgfVxuICB9XG5cbiAgZG9RdWVyeUNvdW50KHF1ZXJ5UHJvcGVydGllczogSU1GZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcyk6IFByb21pc2U8UXVlcnlSZXN1bHQ+e1xuICAgIC8vIFRoZSByZWFzb24gb2YgdXNlIGxheWVyLnF1ZXJ5IHdoZW4gaGFzIGxheWVyIGlzOiBzb21lIGxheWVyIGRvZXMgbm90IGhhdmUgdXJsOlxuICAgIC8vIDEuIGZlYXR1cmVzIGFyZSB1cGxvYWRlZCBhbmQgc2F2ZWQgdG8gdGhlIGxheWVyIGRpcmVjdGx5LlxuICAgIC8vIDIuIGlmIHNhdmUgdGhlIGxheWVyIHRvIGFuIGl0ZW0sIGl0IHdpbGwgYmUgYSBmZWF0dXJlIGNvbGxlY3Rpb24gaXRlbS5cbiAgICBpZih0aGlzLmxheWVyKXtcbiAgICAgIHJldHVybiB0aGlzLl9kb1F1ZXJ5Q291bnRCeUxheWVyKHF1ZXJ5UHJvcGVydGllcyk7XG4gICAgfWVsc2UgaWYodGhpcy5nZXREYXRhU291cmNlSnNvbigpLnVybCl7XG4gICAgICByZXR1cm4gdGhpcy5fZG9RdWVyeUNvdW50QnlVcmwocXVlcnlQcm9wZXJ0aWVzKTtcbiAgICB9ZWxzZXtcbiAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUZlYXR1cmVMYXllcigpLnRoZW4oKCkgPT4gdGhpcy5fZG9RdWVyeUNvdW50QnlMYXllcihxdWVyeVByb3BlcnRpZXMpKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIF9kb1F1ZXJ5Q291bnRCeUxheWVyKF9xdWVyeVByb3BlcnRpZXM6IElNRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMpOiBQcm9taXNlPFF1ZXJ5UmVzdWx0PntcbiAgICBjb25zdCBmaXhlZFF1ZXJ5ID0gdGhpcy5maXhRdWVyeVBhcmFtKF9xdWVyeVByb3BlcnRpZXMpO1xuXG4gICAgY29uc3QgcXVlcnk6IF9fZXNyaS5RdWVyeSB8IF9fZXNyaS5RdWVyeVByb3BlcnRpZXMgPSBmaXhlZFF1ZXJ5LmFzTXV0YWJsZSh7ZGVlcDogdHJ1ZX0pIGFzIChfX2VzcmkuUXVlcnkgfCBfX2VzcmkuUXVlcnlQcm9wZXJ0aWVzKTtcbiAgICByZXR1cm4gdGhpcy5sYXllci5xdWVyeUZlYXR1cmVDb3VudChxdWVyeSkudGhlbihjb3VudCA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBxdWVyeVBhcmFtczogX3F1ZXJ5UHJvcGVydGllcyxcbiAgICAgICAgY291bnRcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgX2RvUXVlcnlDb3VudEJ5VXJsKF9xdWVyeVByb3BlcnRpZXM6IElNRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMpOiBQcm9taXNlPFF1ZXJ5UmVzdWx0PntcbiAgICBjb25zdCBxdWVyeSA9IHRoaXMuX2NoYW5nZVF1ZXJ5UHJvcGVydGllc0Zvcm1hdChfcXVlcnlQcm9wZXJ0aWVzKTtcblxuICAgIGRlbGV0ZSBxdWVyeS5yZXN1bHRSZWNvcmRDb3VudDtcbiAgICBkZWxldGUgcXVlcnkucmVzdWx0T2Zmc2V0O1xuXG4gICAgaWYoIXF1ZXJ5LnJldHVybkNvdW50T25seSl7XG4gICAgICBxdWVyeS5yZXR1cm5Db3VudE9ubHkgPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5fcShxdWVyeSkudGhlbigocXVlcnlSZXNwb25zZTogSVF1ZXJ5RmVhdHVyZXNSZXNwb25zZSkgPT4ge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcXVlcnlQYXJhbXM6IF9xdWVyeVByb3BlcnRpZXMsXG4gICAgICAgIGNvdW50OiAocXVlcnlSZXNwb25zZSBhcyBhbnkpLmNvdW50XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZG9RdWVyeUJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8RmVhdHVyZURhdGFSZWNvcmQ+e1xuICAgIHJldHVybiB0aGlzLmRvUXVlcnkoSW1tdXRhYmxlKHtvYmplY3RJZHM6IFtwYXJzZUludChpZCldLCByZXR1cm5HZW9tZXRyeTogdHJ1ZX0pKS50aGVuKHJlc3VsdCA9PiByZXN1bHQucmVjb3Jkc1swXSBhcyBGZWF0dXJlRGF0YVJlY29yZCk7XG4gIH1cblxuICBxdWVyeUJ5SWQoaWQ6IHN0cmluZyk6IFByb21pc2U8RmVhdHVyZURhdGFSZWNvcmQ+e1xuICAgIHJldHVybiBzdXBlci5xdWVyeUJ5SWQoaWQpIGFzIFByb21pc2U8RmVhdHVyZURhdGFSZWNvcmQ+O1xuICB9XG5cbiAgZ2V0Q29uZmlnUXVlcnlQYXJhbXMoKTogRmVhdHVyZUxheWVyUXVlcnlQYXJhbXN7XG4gICAgY29uc3QgcXVlcnkgPSB0aGlzLmdldERhdGFWaWV3Q29uZmlnKCk7XG4gICAgaWYoIXF1ZXJ5KXtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IGNvbmZpZ1F1ZXJ5ID0ge1xuICAgICAgd2hlcmU6IGRhdGFTb3VyY2VVdGlscy5nZXRBcmNHSVNTUUwocXVlcnkud2hlcmUsIHRoaXMpLnNxbCxcbiAgICAgIG9yZGVyQnlGaWVsZHM6IHRoaXMuX2dldE9yZGVyQnlBcnJheShxdWVyeS5vcmRlckJ5KVxuICAgIH0gYXMgRmVhdHVyZUxheWVyUXVlcnlQYXJhbXM7XG5cbiAgICByZXR1cm4gY29uZmlnUXVlcnk7XG4gIH1cblxuICBtZXJnZVF1ZXJ5UGFyYW1zKGJhc2VRdWVyeTogRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMsIG5ld1F1ZXJ5OiBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcyk6IEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1ze1xuICAgIGxldCB3aGVyZSA9ICcnO1xuICAgIGNvbnN0IGJhc2VRdWVyeVdoZXJlID0gYmFzZVF1ZXJ5ICYmIGJhc2VRdWVyeS53aGVyZTtcbiAgICBjb25zdCBuZXdRdWVyeVdoZXJlID0gbmV3UXVlcnkgJiYgbmV3UXVlcnkud2hlcmU7XG4gICAgd2hlcmUgPSBbYmFzZVF1ZXJ5V2hlcmUsIG5ld1F1ZXJ5V2hlcmVdLmZpbHRlcihpdGVtID0+IGl0ZW0pLmpvaW4oJyBhbmQgJyk7XG4gICAgcmV0dXJuIHsuLi5iYXNlUXVlcnksIC4uLm5ld1F1ZXJ5LCAuLi57d2hlcmV9fSBhcyBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcztcbiAgfVxuXG4gIGdldEN1cnJlbnRRdWVyeVBhcmFtcyhleGNsdWRlT3B0aW9uPzogV2lkZ2V0RGF0YVNvdXJjZVBhaXIpOiBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtc3tcbiAgICBjb25zdCBxdWVyeTogRmVhdHVyZUxheWVyUXVlcnlQYXJhbXMgPSBzdXBlci5nZXRDdXJyZW50UXVlcnlQYXJhbXMoZXhjbHVkZU9wdGlvbik7XG4gICAgcmV0dXJuIHRoaXMuYXBwbHlHREJWZXJzaW9uQW5kRml4KHF1ZXJ5KTtcbiAgfVxuXG4gIGdldFJlYWxRdWVyeVBhcmFtcyhxdWVyeSwgZmxhZzogJ3F1ZXJ5JyB8ICdsb2FkJywgb3B0aW9ucz86IFF1ZXJ5T3B0aW9ucyk6IEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1ze1xuICAgIGNvbnN0IHJxOiBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcyA9IHN1cGVyLmdldFJlYWxRdWVyeVBhcmFtcyhxdWVyeSwgZmxhZywgb3B0aW9ucyk7XG4gICAgcmV0dXJuIHRoaXMuYXBwbHlHREJWZXJzaW9uQW5kRml4KHJxKTtcbiAgfVxuXG4gIGdldFJlbW90ZVF1ZXJ5UGFyYW1zKCk6IEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1ze1xuICAgIGlmKHRoaXMuZ2V0U2NoZW1hKCkuZmlsdGVyKXtcbiAgICAgIHJldHVybiB7d2hlcmU6IHRoaXMuZ2V0U2NoZW1hKCkuZmlsdGVyfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHByaXZhdGUgYXBwbHlHREJWZXJzaW9uQW5kRml4KHF1ZXJ5OiBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcyk6IEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1ze1xuICAgIGlmKHRoaXMuZ2V0R0RCVmVyc2lvbigpKXtcbiAgICAgIHF1ZXJ5LmdkYlZlcnNpb24gPSB0aGlzLmdldEdEQlZlcnNpb24oKTtcbiAgICB9XG5cbiAgICBxdWVyeSA9IHRoaXMuZml4UXVlcnlQYXJhbShJbW11dGFibGUocXVlcnkpKS5hc011dGFibGUoe2RlZXA6IHRydWV9KTtcbiAgICByZXR1cm4gcXVlcnk7XG4gIH1cblxuICAvKipcbiAgICogc29tZSBxdWVyeSBwYXJhbXMgYXJlIG5vdCBzdXBwb3J0ZWQgYWNjb3JkaW5nIHRvIHRoZSBmZWF0dXJlIHNlcnZpY2UgY2FwYWJpbGl0eSwgd2UnbGwgZml4IGl0IGhlcmUuXG4gICAqL1xuICBwcml2YXRlIGZpeFF1ZXJ5UGFyYW0ocTogSU1GZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcyk6IElNRmVhdHVyZUxheWVyUXVlcnlQYXJhbXN7XG4gICAgLy8gZml4IGZvciBzdGF0aXNjczogaHR0cHM6Ly9kZXZlbG9wZXJzLmFyY2dpcy5jb20vcmVzdC9zZXJ2aWNlcy1yZWZlcmVuY2UvcXVlcnktZmVhdHVyZS1zZXJ2aWNlLWxheWVyLS5odG1cbiAgICAvLyBTZWVtcyB0aGUgJ29yZGVyQnlGaWVsZHMnIGlzIHN1cHBvcnRlZCBvbmx5IHdoZW4gaXQncyBncm91cEJ5RmllbGRzLiBCZWNhdXNlIHdlIGRvbid0IHN1cHBvcnQgZ3JvdXBieSBmb3Igbm93LFxuICAgIC8vIHNvIHdlIHJlbW92ZSB0aGUgJ29yZGVyQnlGaWVsZHMnIGZvciBub3cuXG5cbiAgICAvLyBkbyBub3QgcmVtb3ZlIGdlb21ldHJ5LCB0aGlzIG1heSBub3Qgd29yayBvbiBzb21lIHNlcnZpY2VzLiBUT0RPXG4gICAgbGV0IGZpeGVkUXVlcnkgPSBxO1xuICAgIGlmKHEub3V0U3RhdGlzdGljcyl7XG4gICAgICBPYmplY3Qua2V5cyhxKS5mb3JFYWNoKGsgPT4ge1xuICAgICAgICBpZihbJ2dyb3VwQnlGaWVsZHNGb3JTdGF0aXN0aWNzJywgJ3RpbWUnLCAnd2hlcmUnLCAnb3V0U3RhdGlzdGljcycsICdnZW9tZXRyeSddLmluZGV4T2YoaykgPCAwKXtcbiAgICAgICAgICBmaXhlZFF1ZXJ5ID0gZml4ZWRRdWVyeS53aXRob3V0KGsgYXMgYW55KTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG4gICAgcmV0dXJuIGZpeGVkUXVlcnk7XG4gIH1cblxuICBhZGRSZWNvcmQocmVjb3JkOiBGZWF0dXJlRGF0YVJlY29yZCk6IFByb21pc2U8RmVhdHVyZURhdGFSZWNvcmQ+IHtcbiAgICBjb25zdCBhdHRyaWJ1dGVzID0gcmVjb3JkLmdldERhdGEoKTtcbiAgICBjb25zdCBmZWF0dXJlOiBJRmVhdHVyZSA9IHtcbiAgICAgIGF0dHJpYnV0ZXNcbiAgICB9O1xuICAgIGNvbnN0IG9wdGlvbnM6IElBZGRGZWF0dXJlc09wdGlvbnMgPSB7XG4gICAgICB1cmw6IHRoaXMudXJsLFxuICAgICAgZmVhdHVyZXM6IFtmZWF0dXJlXVxuICAgIH1cbiAgICByZXR1cm4gcmVxdWVzdFV0aWxzLnJlcXVlc3RXcmFwcGVyKHRoaXMudXJsLCAoc2Vzc2lvbikgPT4ge1xuICAgICAgb3B0aW9ucy5hdXRoZW50aWNhdGlvbiA9IHNlc3Npb247XG4gICAgICByZXR1cm4gZXNyaS5yZXN0RmVhdHVyZUxheWVyLmFkZEZlYXR1cmVzKG9wdGlvbnMpXG4gICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgLy8gcmV0dXJuIGEgbmV3IHJlY29yZCB3aXRoIHRoZSBPQkpFQ1RJRFxuICAgICAgICAgIGNvbnN0IG9iamVjdElkID0gcmVzcG9uc2UuYWRkUmVzdWx0c1swXS5vYmplY3RJZDtcbiAgICAgICAgICBhdHRyaWJ1dGVzLk9CSkVDVElEID0gb2JqZWN0SWQ7IC8vID8/XG4gICAgICAgICAgcmV0dXJuIG5ldyBGZWF0dXJlRGF0YVJlY29yZEltcGwoe1xuICAgICAgICAgICAgYXR0cmlidXRlc1xuICAgICAgICAgIH0sIHRoaXMpO1xuICAgICAgICB9KVxuICAgIH0pXG4gICAgLy8gVE9ETzogcmV0cnkgaWYgcmVxdWVzdCB3YXMgdW5hdXRoZW50aWNhdGVkXG4gICAgLy8gb25jZSB3ZSBhcmUgc2VuZGluZyB0b2tlbnMgYWJvdmVcbiAgICAvLyAuY2F0Y2goc2Vzc2lvbk1hbmFnZXIuaGFuZGxlQXV0aEVycm9yLmJpbmQoc2Vzc2lvbk1hbmFnZXIpKTtcbiAgfVxuXG4gIGZldGNoU2NoZW1hKCk6IFByb21pc2U8SU1EYXRhU291cmNlU2NoZW1hPntcbiAgICBpZih0aGlzLmdldERhdGFTb3VyY2VKc29uKCkuaXNTdGF0aXN0aWMpe1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShJbW11dGFibGUoe30pKTtcbiAgICB9XG5cbiAgICBpZih0aGlzLmxheWVyKXsgLy8gZnJvbSBtYXBcbiAgICAgIHJldHVybiB0aGlzLmZldGNoU2NoZW1hV2l0aExheWVyKCk7XG4gICAgfWVsc2V7IC8vIGZyb20gYSBmZWF0dXJlIHNlcnZpY2UgaXRlbSBvciBmZWF0dXJlIHNlcnZpY2UgdXJsIG9yIGZyb20gYSBmZWF0dXJlIGNvbGxlY3Rpb24gaXRlbVxuICAgICAgcmV0dXJuIHRoaXMuZmV0Y2hTY2hlbWFXaXRob3V0TGF5ZXIoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGNyZWF0ZUZlYXR1cmVMYXllcigpOiBQcm9taXNlPF9fZXNyaS5GZWF0dXJlTGF5ZXI+e1xuICAgIGlmKHRoaXMuY3JlYXRlRmVhdHVyZUxheWVyUHJvbWlzZSl7XG4gICAgICByZXR1cm4gdGhpcy5jcmVhdGVGZWF0dXJlTGF5ZXJQcm9taXNlO1xuICAgIH1cblxuICAgIGlmKHRoaXMubGF5ZXIpe1xuICAgICAgdGhpcy5jcmVhdGVGZWF0dXJlTGF5ZXJQcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKHRoaXMubGF5ZXIpO1xuICAgIH1lbHNle1xuICAgICAgdGhpcy5jcmVhdGVGZWF0dXJlTGF5ZXJQcm9taXNlID0gbG9hZEFyY0dJU0pTQVBJTW9kdWxlcyhbJ2VzcmkvbGF5ZXJzL0xheWVyJywgJ2VzcmkvcG9ydGFsL1BvcnRhbEl0ZW0nXSkudGhlbihtb2R1bGVzID0+IHtcbiAgICAgICAgY29uc3QgTGF5ZXI6IHR5cGVvZiBfX2VzcmkuTGF5ZXIgPSBtb2R1bGVzWzBdO1xuICAgICAgICBjb25zdCBQb3J0YWxJdGVtOiB0eXBlb2YgX19lc3JpLlBvcnRhbEl0ZW0gPSBtb2R1bGVzWzFdO1xuICAgICAgICByZXR1cm4gTGF5ZXIuZnJvbVBvcnRhbEl0ZW0oe3BvcnRhbEl0ZW06IG5ldyBQb3J0YWxJdGVtKHtpZDogdGhpcy5pdGVtSWQsIHBvcnRhbDoge3VybDogdGhpcy5wb3J0YWxVcmx9fSl9KTtcbiAgICAgIH0pLnRoZW4obGF5ZXIgPT4ge1xuICAgICAgICBpZihsYXllcj8udHlwZSA9PT0gU3VwcG9ydGVkTGF5ZXJUeXBlcy5GZWF0dXJlTGF5ZXIpe1xuICAgICAgICAgIHRoaXMubGF5ZXIgPSBsYXllciBhcyBfX2VzcmkuRmVhdHVyZUxheWVyO1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5sYXllcik7XG4gICAgICAgIH1lbHNlIGlmKGxheWVyPy50eXBlID09PSBTdXBwb3J0ZWRMYXllclR5cGVzLkdyb3VwTGF5ZXIpe1xuICAgICAgICAgIHJldHVybiAobGF5ZXIgYXMgX19lc3JpLkdyb3VwTGF5ZXIpLmxvYWRBbGwoKS50aGVuKGxheWVyID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZlYXVyZUxheWVyID0gKGxheWVyIGFzIF9fZXNyaS5Hcm91cExheWVyKS5sYXllcnMudG9BcnJheSgpLmZpbmQoXG4gICAgICAgICAgICAgIC8vIGZlYXR1cmUgbGF5ZXIgY3JlYXRlZCBmcm9tIGEgbXVsdGlwbGUtbGF5ZXIgZmVhdHVyZSBjb2xsZWN0aW9uIGl0ZW0gbWF5IGRvIG5vdCBoYXZlIGxheWVySWQsXG4gICAgICAgICAgICAgIC8vIHNvIGlkIG9mIHVzZSBsYXllciBkZWZpbml0aW9uIHRvIGZpbmQgdGhlIGZlYXR1cmUgbGF5ZXJcbiAgICAgICAgICAgICAgKGw6IF9fZXNyaS5GZWF0dXJlTGF5ZXIpID0+IGAke2wubGF5ZXJJZH1gID09PSB0aGlzLmxheWVySWQgfHwgYCR7dGhpcy5nZXRMYXllckRlZmluaXRpb24oKT8uaWR9YCA9PT0gdGhpcy5sYXllcklkXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgaWYoZmVhdXJlTGF5ZXI/LnR5cGUgPT09IFN1cHBvcnRlZExheWVyVHlwZXMuRmVhdHVyZUxheWVyKXtcbiAgICAgICAgICAgICAgdGhpcy5sYXllciA9IGZlYXVyZUxheWVyIGFzIF9fZXNyaS5GZWF0dXJlTGF5ZXI7XG4gICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy5sYXllcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoJ0NyZWF0ZSBmZWF1cmUgbGF5ZXIgZGF0YSBzb3VyY2UgZXJyb3I6IGZhaWxlZCB0byBjcmVhdGUgZmVhdHVyZSBsYXllciB3aXRoIHNwZWNpZmljIGxheWVyIGlkLicpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5jcmVhdGVGZWF0dXJlTGF5ZXJQcm9taXNlO1xuICB9XG5cbiAgcHJpdmF0ZSBmZXRjaFNjaGVtYVdpdGhvdXRMYXllcigpOiBQcm9taXNlPElNRGF0YVNvdXJjZVNjaGVtYT57XG4gICAgY29uc3Qgc2VydmljZUluZm9Qcm9taXNlID0gdGhpcy51cmwgPyBTZXJ2aWNlTWFuYWdlci5nZXRJbnN0YW5jZSgpLmZldGNoU2VydmljZUluZm8odGhpcy51cmwpIDogUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xuICAgIHJldHVybiBzZXJ2aWNlSW5mb1Byb21pc2UudGhlbigoc2VydmljZUluZm86IFNlcnZpY2VJbmZvKSA9PiB7XG4gICAgICBpZih0aGlzLml0ZW1JZCl7XG4gICAgICAgIHJldHVybiByZXF1ZXN0VXRpbHMucmVxdWVzdFdyYXBwZXIodGhpcy5nZXREYXRhU291cmNlSnNvbigpLnBvcnRhbFVybCwgKHNlc3Npb24pID0+IHtcbiAgICAgICAgICByZXR1cm4gZXNyaS5yZXN0UG9ydGFsLmdldEl0ZW1EYXRhKHRoaXMuaXRlbUlkLCB7XG4gICAgICAgICAgICBwb3J0YWw6IHBvcnRhbFVybFV0aWxzLmdldFBvcnRhbFJlc3RVcmwodGhpcy5wb3J0YWxVcmwpLFxuICAgICAgICAgICAgYXV0aGVudGljYXRpb246IHNlc3Npb25cbiAgICAgICAgICB9KS50aGVuKGl0ZW1EYXRhID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGxheWVySW5mbyA9IGl0ZW1EYXRhICYmIGl0ZW1EYXRhLmxheWVycyAmJiBpdGVtRGF0YS5sYXllcnNbdGhpcy5sYXllcklkXTtcbiAgICAgICAgICAgIGNvbnN0IHNlcnZpY2VEZWZpbml0aW9uID0gc2VydmljZUluZm8/LmRlZmluaXRpb24gPyB0aGlzLl9nZXRVcGRhdGVkTGF5ZXJEZWZpbml0aW9uKGxheWVySW5mbywgc2VydmljZUluZm8uZGVmaW5pdGlvbikgOiBsYXllckluZm8/LmxheWVyRGVmaW5pdGlvbjtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHNlcnZpY2VEZWZpbml0aW9uLFxuICAgICAgICAgICAgICBmaWVsZEluZm9zOiBsYXllckluZm8gJiYgbGF5ZXJJbmZvLnBvcHVwSW5mbyAmJiBsYXllckluZm8ucG9wdXBJbmZvLmZpZWxkSW5mb3MsXG4gICAgICAgICAgICAgIGZpbHRlcjogbGF5ZXJJbmZvICYmIGxheWVySW5mby5sYXllckRlZmluaXRpb24gJiYgbGF5ZXJJbmZvLmxheWVyRGVmaW5pdGlvbi5kZWZpbml0aW9uRXhwcmVzc2lvbixcbiAgICAgICAgICAgICAgcmVmcmVzaEludGVydmFsOiBsYXllckluZm8/LnJlZnJlc2hJbnRlcnZhbCAqIDYwIC8vIGNoYW5nZSB0byBzZWNvbmRcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgIH1lbHNle1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHNlcnZpY2VEZWZpbml0aW9uOiBzZXJ2aWNlSW5mbz8uZGVmaW5pdGlvbixcbiAgICAgICAgICBmaWVsZEluZm9zOiBudWxsLFxuICAgICAgICAgIGZpbHRlcjogbnVsbCxcbiAgICAgICAgICByZWZyZXNoSW50ZXJ2YWw6IG51bGxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9KS50aGVuKCh7c2VydmljZURlZmluaXRpb24sIGZpZWxkSW5mb3MsIGZpbHRlciwgcmVmcmVzaEludGVydmFsfSkgPT4ge1xuICAgICAgY29uc3Qgc2NoZW1hOiBEYXRhU291cmNlU2NoZW1hID0ge1xuICAgICAgICBmaWVsZHM6IHt9LFxuICAgICAgICBpZEZpZWxkOiBzZXJ2aWNlRGVmaW5pdGlvbj8uaWRGaWVsZCxcbiAgICAgICAgZmlsdGVyLFxuICAgICAgICByZWZyZXNoSW50ZXJ2YWwsXG4gICAgICAgIGxhYmVsOiB0aGlzLmxheWVyPy50aXRsZSB8fCBzZXJ2aWNlRGVmaW5pdGlvbj8ubmFtZVxuICAgICAgfTtcblxuICAgICAgdGhpcy5sYXllckRlZmluaXRpb24gPSBzZXJ2aWNlRGVmaW5pdGlvbjtcbiAgICAgIHNlcnZpY2VEZWZpbml0aW9uLmZpZWxkcy5mb3JFYWNoKGYgPT4ge1xuICAgICAgICBjb25zdCBmaWVsZEluZm8gPSBmaWVsZEluZm9zICYmIGZpZWxkSW5mb3MuZmluZChmaSA9PiBmaS5maWVsZE5hbWUgPT09IGYubmFtZSk7XG4gICAgICAgIHNjaGVtYS5maWVsZHNbZi5uYW1lXSA9IGRhdGFTb3VyY2VVdGlscy5jb252ZXJ0RmllbGRUb0ppbXVGaWVsZChmLCBmaWVsZEluZm8pXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIEltbXV0YWJsZShzY2hlbWEpO1xuICAgIH0pXG4gIH1cblxuICBwcml2YXRlIGZldGNoU2NoZW1hV2l0aExheWVyKCk6IFByb21pc2U8SU1EYXRhU291cmNlU2NoZW1hPntcbiAgICByZXR1cm4gdGhpcy5sYXllci5sb2FkKCkudGhlbigoKSA9PiB7XG4gICAgICB0aGlzLnVwZGF0ZUxheWVyRGVmaW5pdGlvbkJ5TGF5ZXIoKTtcbiAgICAgIGNvbnN0IHNjaGVtYTogRGF0YVNvdXJjZVNjaGVtYSA9IHtcbiAgICAgICAgZmllbGRzOiB7fSxcbiAgICAgICAgaWRGaWVsZDogdGhpcy5sYXllci5vYmplY3RJZEZpZWxkLFxuICAgICAgICBmaWx0ZXI6IHRoaXMubGF5ZXIuZGVmaW5pdGlvbkV4cHJlc3Npb24sXG4gICAgICAgIHJlZnJlc2hJbnRlcnZhbDogdGhpcy5sYXllci5yZWZyZXNoSW50ZXJ2YWwgKiA2MCxcbiAgICAgICAgbGFiZWw6IHRoaXMubGF5ZXIudGl0bGVcbiAgICAgIH07XG5cbiAgICAgIHRoaXMubGF5ZXIuZmllbGRzLmZvckVhY2goZmllbGQgPT4ge1xuICAgICAgICBsZXQgZmllbGRJbmZvID0gdGhpcy5sYXllci5wb3B1cFRlbXBsYXRlICYmIHRoaXMubGF5ZXIucG9wdXBUZW1wbGF0ZS5maWVsZEluZm9zICYmIHRoaXMubGF5ZXIucG9wdXBUZW1wbGF0ZS5maWVsZEluZm9zLmZpbmQoZiA9PiBmLmZpZWxkTmFtZSA9PT0gZmllbGQubmFtZSk7XG4gICAgICAgIGlmKGZpZWxkSW5mbyl7XG4gICAgICAgICAgZmllbGRJbmZvID0gZmllbGRJbmZvLnRvSlNPTigpO1xuICAgICAgICB9XG4gICAgICAgIHNjaGVtYS5maWVsZHNbZmllbGQubmFtZV0gPSBkYXRhU291cmNlVXRpbHMuY29udmVydEZpZWxkVG9KaW11RmllbGQoZmllbGQudG9KU09OKCksIGZpZWxkSW5mbyk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBJbW11dGFibGUoc2NoZW1hKTtcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlTGF5ZXJEZWZpbml0aW9uQnlMYXllcigpIHtcbiAgICBsZXQgbGF5ZXJEZWY6IFNlcnZpY2VEZWZpbml0aW9uID0gdGhpcy5sYXllci5zb3VyY2VKU09OO1xuICAgIGNvbnN0IHJlbmRlcmVyID0gdGhpcy5sYXllci5yZW5kZXJlcjtcbiAgICBpZihyZW5kZXJlciAmJiByZW5kZXJlci50b0pTT04oKSl7XG4gICAgICBjb25zdCByZW5kZXJlckpTT04gPSByZW5kZXJlci50b0pTT04oKTtcbiAgICAgIGlmKHJlbmRlcmVySlNPTi50eXBlID09PSAndW5pcXVlVmFsdWUnKXtcbiAgICAgICAgbGV0IHR5cGVzID0gdGhpcy5sYXllci5zb3VyY2VKU09OLnR5cGVzO1xuICAgICAgICBpZihyZW5kZXJlckpTT04uZmllbGQxICE9PSB0aGlzLmxheWVyLnNvdXJjZUpTT04udHlwZUlkRmllbGQpe1xuICAgICAgICAgIHR5cGVzID0gW107XG4gICAgICAgICAgcmVuZGVyZXJKU09OLnVuaXF1ZVZhbHVlSW5mb3MubWFwKGl0ZW0gPT4ge1xuICAgICAgICAgICAgdHlwZXMucHVzaCh7aWQ6IGl0ZW0udmFsdWUsIG5hbWU6IGl0ZW0ubGFiZWwsIGRvbWFpbjoge319KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBsYXllckRlZiA9IE9iamVjdC5hc3NpZ24oe25hbWU6IHRoaXMubGF5ZXIudGl0bGV9LCBsYXllckRlZiwge1xuICAgICAgICAgIGRyYXdpbmdJbmZvOiB7cmVuZGVyZXI6IHJlbmRlcmVySlNPTn0sXG4gICAgICAgICAgdHlwZUlkRmllbGQ6IHJlbmRlcmVySlNPTi5maWVsZDEsXG4gICAgICAgICAgdHlwZXM6IHR5cGVzXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLmxheWVyRGVmaW5pdGlvbiA9IGxheWVyRGVmO1xuICB9XG5cbiAgZ2V0TGF5ZXJEZWZpbml0aW9uKCk6IFNlcnZpY2VEZWZpbml0aW9ue1xuICAgIGlmKHRoaXMuaXNEYXRhVmlldyB8fCB0aGlzLmlzTG9jYWwpe1xuICAgICAgcmV0dXJuICh0aGlzLmdldE1haW5EYXRhU291cmNlKCkgYXMgRmVhdHVyZUxheWVyRGF0YVNvdXJjZSkuZ2V0TGF5ZXJEZWZpbml0aW9uKCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmxheWVyRGVmaW5pdGlvbjtcbiAgfVxuXG4gIGdldEZpZWxkQ29kZWRWYWx1ZUxpc3QoamltdUZpZWxkTmFtZTogc3RyaW5nLCByZWNvcmQ/OiBGZWF0dXJlRGF0YVJlY29yZCk6IENvZGVkVmFsdWVbXSB7XG4gICAgbGV0IGZpZWxkTmFtZSA9ICcnO1xuICAgIGNvbnN0IGZpZWxkcyA9IHRoaXMuZ2V0U2NoZW1hKCkuZmllbGRzO1xuICAgIE9iamVjdC5rZXlzKGZpZWxkcykuc29tZShuYW1lID0+IHtcbiAgICAgIGlmKG5hbWUgPT09IGppbXVGaWVsZE5hbWUpe1xuICAgICAgICBmaWVsZE5hbWUgPSBmaWVsZHNbbmFtZV0ubmFtZTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9ZWxzZXtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBkYXRhU291cmNlVXRpbHMuZ2V0Q29kZWRWYWx1ZUxpc3RGb3JDb2RlZFZhbHVlT3JTdWJ0eXBlRmllbGQodGhpcy5nZXRMYXllckRlZmluaXRpb24oKSwgZmllbGROYW1lLCByZWNvcmQpO1xuICB9XG5cbiAgZ2V0R0RCVmVyc2lvbigpOiBzdHJpbmd7XG4gICAgcmV0dXJuIHRoaXMuZ2V0SW5mbygpLmdkYlZlcnNpb247XG4gIH1cblxuICBjaGFuZ2VHREJWZXJzaW9uKGdkYlZlcnNpb246IHN0cmluZyl7XG4gICAgZ2V0QXBwU3RvcmUoKS5kaXNwYXRjaChhcHBBY3Rpb25zLmNoYW5nZURhdGFTb3VyY2VHREJWZXJzaW9uKHRoaXMuaWQsIGdkYlZlcnNpb24pKTtcbiAgICBpZih0aGlzLmxheWVyKXtcbiAgICAgIHRoaXMubGF5ZXIuZ2RiVmVyc2lvbiA9IGdkYlZlcnNpb247XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybiBkYXRhIHNvdXJjZSB3aGljaCBvcmlnaW5hbCBkYXRhIGlzIGEgcm9vdCBsYXllciBpbiB3ZWJtYXAvd2Vic2NlbmUgb3IgYSByb290IHNlcml2Y2UuXG4gICAqIFJvb3Qgc2VydmljZSBpcyBhIHdob2xlIHNlcnZpY2UgcmF0aGVyIHRoYW4gYSBzaW5nbGUgbGF5ZXIgdW5kZXIgdGhlIHNlcnZpY2UsIHN1Y2ggYXMgaHR0cHM6Ly9zYW1wbGVzZXJ2ZXI2LmFyY2dpc29ubGluZS5jb20vYXJjZ2lzL3Jlc3Qvc2VydmljZXMvOTExQ2FsbHNIb3RzcG90L01hcFNlcnZlciAuXG4gICAqL1xuICBnZXRSb290TGF5ZXJEYXRhU291cmNlKCk6IERhdGFTb3VyY2V7XG4gICAgbGV0IHBhcmVudERzID0gdGhpcy5wYXJlbnREYXRhU291cmNlO1xuICAgIGxldCBncmFuZFBhcmVudERzID0gdGhpcy5wYXJlbnREYXRhU291cmNlPy5wYXJlbnREYXRhU291cmNlO1xuICAgIHdoaWxlICh0aGlzLl9pc0xheWVyRGF0YVNvdXJjZShwYXJlbnREcykgJiYgdGhpcy5faXNMYXllckRhdGFTb3VyY2UoZ3JhbmRQYXJlbnREcykpIHtcbiAgICAgIHBhcmVudERzID0gZ3JhbmRQYXJlbnREcztcbiAgICAgIGdyYW5kUGFyZW50RHMgPSBncmFuZFBhcmVudERzLnBhcmVudERhdGFTb3VyY2U7XG4gICAgfVxuICAgIHJldHVybiBwYXJlbnREcztcbiAgfVxuXG4gIGdldE9yaWdpbmFsRGF0YUlkKCk6IHN0cmluZyB8IG51bWJlcntcbiAgICByZXR1cm4gdGhpcy5sYXllcj8uaWQgfHwgdGhpcy5sYXllckRlZmluaXRpb24/LmlkO1xuICB9XG5cbiAgcHJpdmF0ZSBfaXNMYXllckRhdGFTb3VyY2UoZGF0YVNvdXJjZTogRGF0YVNvdXJjZSk6IGJvb2xlYW57XG4gICAgcmV0dXJuIChkYXRhU291cmNlIGFzIGFueSk/LmxheWVyIHx8IChkYXRhU291cmNlIGFzIGFueSk/LmxheWVyRGVmaW5pdGlvbiB8fCAoZGF0YVNvdXJjZSBhcyBhbnkpPy5zZXJ2aWNlRGVmaW5pdGlvbjtcbiAgfVxuXG4gIC8vdXBkYXRlIHNlcnZpY2VJbmZvIGZyb20gbGF5ZXJJbmZvIGZvciBsYXllciBpdGVtXG4gIHByaXZhdGUgX2dldFVwZGF0ZWRMYXllckRlZmluaXRpb24obGF5ZXJJbmZvLCBzZXJ2aWNlRGVmaW5pdGlvbikge1xuICAgIGxldCB1cGRhdGVkRGVmaW5pdGlvbiA9IHNlcnZpY2VEZWZpbml0aW9uO1xuICAgIGlmKGxheWVySW5mbyAmJiBsYXllckluZm8ubGF5ZXJEZWZpbml0aW9uKXtcbiAgICAgIGxldCB1cGRhdGVkT3B0aW9ucztcbiAgICAgIGNvbnN0IGRyYXdpbmdJbmZvID0gbGF5ZXJJbmZvLmxheWVyRGVmaW5pdGlvbi5kcmF3aW5nSW5mbztcbiAgICAgIGlmKGRyYXdpbmdJbmZvKXtcbiAgICAgICAgaWYoZHJhd2luZ0luZm8ucmVuZGVyZXIgJiYgZHJhd2luZ0luZm8ucmVuZGVyZXIudHlwZSA9PT0gJ3VuaXF1ZVZhbHVlJyl7XG4gICAgICAgICAgLy91cGRhdGUgdHlwZXMoaWQsIG5hbWUpIGZyb20gZHJhd2luZ0luZm8odmFsdWUsbGFiZWwpXG4gICAgICAgICAgbGV0IHR5cGVzID0gc2VydmljZURlZmluaXRpb24udHlwZXM7XG4gICAgICAgICAgaWYoZHJhd2luZ0luZm8ucmVuZGVyZXIuZmllbGQxICE9PSBzZXJ2aWNlRGVmaW5pdGlvbi50eXBlSWRGaWVsZCl7XG4gICAgICAgICAgICB0eXBlcyA9IFtdO1xuICAgICAgICAgICAgZHJhd2luZ0luZm8ucmVuZGVyZXIudW5pcXVlVmFsdWVJbmZvcy5tYXAoaXRlbSA9PiB7XG4gICAgICAgICAgICAgIHR5cGVzLnB1c2goe2lkOiBpdGVtLnZhbHVlLCBuYW1lOiBpdGVtLmxhYmVsLCBkb21haW46IHt9fSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdXBkYXRlZE9wdGlvbnMgPSB7XG4gICAgICAgICAgICBkZWZhdWx0VmlzaWJpbGl0eTogbGF5ZXJJbmZvLmxheWVyRGVmaW5pdGlvbi5kZWZhdWx0VmlzaWJpbGl0eSxcbiAgICAgICAgICAgIGRyYXdpbmdJbmZvOiBsYXllckluZm8ubGF5ZXJEZWZpbml0aW9uLmRyYXdpbmdJbmZvLFxuICAgICAgICAgICAgdHlwZUlkRmllbGQ6IGRyYXdpbmdJbmZvLnJlbmRlcmVyLmZpZWxkMSxcbiAgICAgICAgICAgIHR5cGVzOiB0eXBlc1xuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1lbHNlIGlmKGxheWVySW5mby5sYXllckRlZmluaXRpb24uZGVmYXVsdFZpc2liaWxpdHkgIT09IHNlcnZpY2VEZWZpbml0aW9uLmRlZmF1bHRWaXNpYmlsaXR5KXtcbiAgICAgICAgdXBkYXRlZE9wdGlvbnMgPSB7ZGVmYXVsdFZpc2liaWxpdHk6IGxheWVySW5mby5sYXllckRlZmluaXRpb24uZGVmYXVsdFZpc2liaWxpdHl9O1xuICAgICAgfVxuICAgICAgdXBkYXRlZERlZmluaXRpb24gPSBPYmplY3QuYXNzaWduKHt9LCB1cGRhdGVkRGVmaW5pdGlvbiwgdXBkYXRlZE9wdGlvbnMpO1xuICAgIH1cbiAgICByZXR1cm4gdXBkYXRlZERlZmluaXRpb247XG4gIH1cblxuICBwcml2YXRlIF9nZXRPcmRlckJ5QXJyYXkob3JkZXJCeXM6IEltbXV0YWJsZS5JbW11dGFibGVBcnJheTxPcmRlckJ5T3B0aW9uPik6IHN0cmluZ1tde1xuICAgIHJldHVybiBvcmRlckJ5cz8ubWFwKG9yZGVyQnkgPT4ge1xuICAgICAgcmV0dXJuICBvcmRlckJ5LmppbXVGaWVsZE5hbWUgKyAnICcgKyBvcmRlckJ5Lm9yZGVyO1xuICAgIH0pLmFzTXV0YWJsZSgpID8/IFtdO1xuICB9XG5cbiAgcHJpdmF0ZSBfY2hhbmdlUXVlcnlQcm9wZXJ0aWVzRm9ybWF0KHF1ZXJ5UHJvcGVydGllczogSU1GZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcyk6IElRdWVyeUZlYXR1cmVzT3B0aW9uc3tcbiAgICBpZighcXVlcnlQcm9wZXJ0aWVzKXtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IHE6IGFueSA9IHRoaXMuZml4UXVlcnlQYXJhbShxdWVyeVByb3BlcnRpZXMpLmFzTXV0YWJsZSh7ZGVlcDogdHJ1ZX0pO1xuXG4gICAgaWYocS5wYWdlICYmIHEucGFnZVNpemUpe1xuICAgICAgcS5yZXN1bHRPZmZzZXQgPSAocS5wYWdlIC0gMSkgKiBxLnBhZ2VTaXplO1xuICAgICAgcS5yZXN1bHRSZWNvcmRDb3VudCA9IHEucGFnZVNpemU7XG4gICAgICBkZWxldGUgcS5wYWdlO1xuICAgICAgZGVsZXRlIHEucGFnZVNpemU7XG4gICAgfVxuXG4gICAgaWYoQXJyYXkuaXNBcnJheShxLm9yZGVyQnlGaWVsZHMpKXtcbiAgICAgIHEub3JkZXJCeUZpZWxkcyA9IHEub3JkZXJCeUZpZWxkcy5qb2luKCcsJyk7XG4gICAgfVxuICAgIGlmKEFycmF5LmlzQXJyYXkocS5ncm91cEJ5RmllbGRzRm9yU3RhdGlzdGljcykpe1xuICAgICAgcS5ncm91cEJ5RmllbGRzRm9yU3RhdGlzdGljcyA9IHEuZ3JvdXBCeUZpZWxkc0ZvclN0YXRpc3RpY3Muam9pbignLCcpO1xuICAgIH1cblxuICAgIHJldHVybiBxIGFzIElRdWVyeUZlYXR1cmVzT3B0aW9ucztcbiAgfVxuXG4gIHByaXZhdGUgX2RvUXVlcnlCeVVybChfcXVlcnlQcm9wZXJ0aWVzOiBJTUZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zKTogUHJvbWlzZTxRdWVyeVJlc3VsdD57XG4gICAgY29uc3QgcXVlcnlQcm9wZXJ0aWVzOiBJUXVlcnlGZWF0dXJlc09wdGlvbnMgPSB0aGlzLl9jaGFuZ2VRdWVyeVByb3BlcnRpZXNGb3JtYXQoX3F1ZXJ5UHJvcGVydGllcyk7XG4gICAgaWYocXVlcnlQcm9wZXJ0aWVzLnJldHVybkNvdW50T25seSl7XG4gICAgICBjb25zb2xlLmVycm9yKCdUbyBxdWVyeSBjb3VudCwgcGxlYXNlIHVzZSBxdWVyeUNvdW50LicpO1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KCdUbyBxdWVyeSBjb3VudCwgcGxlYXNlIHVzZSBxdWVyeUNvdW50LicpO1xuICAgIH1cbiAgICBpZihxdWVyeVByb3BlcnRpZXMub3V0RmllbGRzICYmICEocXVlcnlQcm9wZXJ0aWVzLm91dEZpZWxkcyA9PT0gJyonIHx8IHF1ZXJ5UHJvcGVydGllcy5vdXRGaWVsZHNbMF0gPT09ICcqJykpe1xuICAgICAgY29uc3QgdHlwZUlkRmllbGQgPSB0aGlzLmdldExheWVyRGVmaW5pdGlvbigpLnR5cGVJZEZpZWxkO1xuICAgICAgaWYodHlwZUlkRmllbGQgJiYgcXVlcnlQcm9wZXJ0aWVzLm91dEZpZWxkcy5pbmRleE9mKHR5cGVJZEZpZWxkKSA8IDApe1xuICAgICAgICAocXVlcnlQcm9wZXJ0aWVzLm91dEZpZWxkcyBhcyBzdHJpbmdbXSkucHVzaCh0eXBlSWRGaWVsZCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0aGlzLl9xKHF1ZXJ5UHJvcGVydGllcykudGhlbigocXVlcnlSZXNwb25zZTogSVF1ZXJ5RmVhdHVyZXNSZXNwb25zZSkgPT4ge1xuICAgICAgY29uc3QgZmllbGRzID0gT2JqZWN0LmtleXModGhpcy5nZXRTY2hlbWEoKS5maWVsZHMpLmZpbHRlcihqaW11RmllbGROYW1lID0+IHtcbiAgICAgICAgcmV0dXJuIHF1ZXJ5UmVzcG9uc2UuZmllbGRzICYmIHF1ZXJ5UmVzcG9uc2UuZmllbGRzLmZpbmQoZmllbGQgPT4gZmllbGQubmFtZSA9PT0gdGhpcy5nZXRTY2hlbWEoKS5maWVsZHNbamltdUZpZWxkTmFtZV0ubmFtZSlcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBxdWVyeVJlc3VsdDogUXVlcnlSZXN1bHQgPSB7XG4gICAgICAgIHF1ZXJ5UGFyYW1zOiBfcXVlcnlQcm9wZXJ0aWVzLFxuICAgICAgICBmaWVsZHM6IGZpZWxkcyxcbiAgICAgICAgcmVjb3JkczogcXVlcnlSZXNwb25zZS5mZWF0dXJlcy5tYXAoZmVhdHVyZSA9PiBuZXcgRmVhdHVyZURhdGFSZWNvcmRJbXBsKGZlYXR1cmUsIHRoaXMpKVxuICAgICAgfVxuICAgICAgcmV0dXJuIHF1ZXJ5UmVzdWx0O1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBfZG9RdWVyeUJ5TGF5ZXIoX3F1ZXJ5OiBJTUZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zKTogUHJvbWlzZTxRdWVyeVJlc3VsdD57XG4gICAgY29uc3QgZml4ZWRRdWVyeSA9IHRoaXMuZml4UXVlcnlQYXJhbShfcXVlcnkpO1xuXG4gICAgY29uc3QgcXVlcnk6IF9fZXNyaS5RdWVyeSB8IF9fZXNyaS5RdWVyeVByb3BlcnRpZXMgPSBmaXhlZFF1ZXJ5LmFzTXV0YWJsZSh7ZGVlcDogdHJ1ZX0pIGFzIChfX2VzcmkuUXVlcnkgfCBfX2VzcmkuUXVlcnlQcm9wZXJ0aWVzKTtcblxuICAgIHJldHVybiBsb2FkQXJjR0lTSlNBUElNb2R1bGVzKFsnZXNyaS9nZW9tZXRyeS9zdXBwb3J0L2pzb25VdGlscyddKS50aGVuKG1vZHVsZXMgPT4ge1xuICAgICAgY29uc3QganNvblV0aWxzID0gbW9kdWxlc1swXTtcbiAgICAgIGlmKGZpeGVkUXVlcnkucGFnZSAmJiBmaXhlZFF1ZXJ5LnBhZ2VTaXplKXtcbiAgICAgICAgcXVlcnkuc3RhcnQgPSAoZml4ZWRRdWVyeS5wYWdlIC0gMSkgKiBmaXhlZFF1ZXJ5LnBhZ2VTaXplO1xuICAgICAgICBxdWVyeS5udW0gPSBmaXhlZFF1ZXJ5LnBhZ2VTaXplO1xuXG4gICAgICAgIGRlbGV0ZSAocXVlcnkgYXMgYW55KS5wYWdlO1xuICAgICAgICBkZWxldGUgKHF1ZXJ5IGFzIGFueSkucGFnZVNpemU7XG4gICAgICB9XG5cbiAgICAgIHF1ZXJ5Lmdlb21ldHJ5ID0ganNvblV0aWxzLmZyb21KU09OKHF1ZXJ5Lmdlb21ldHJ5KTtcbiAgICAgIGRlbGV0ZSAocXVlcnkgYXMgYW55KS5rZXk7XG5cbiAgICAgIGlmKHRoaXMuZ2V0R0RCVmVyc2lvbigpKXtcbiAgICAgICAgcXVlcnkuZ2RiVmVyc2lvbiA9IHRoaXMuZ2V0R0RCVmVyc2lvbigpO1xuICAgICAgfVxuICAgICAgcXVlcnkub3V0RmllbGRzID0gcXVlcnkub3V0RmllbGRzICYmIHF1ZXJ5Lm91dEZpZWxkcy5sZW5ndGggPiAwID8gcXVlcnkub3V0RmllbGRzIDogWycqJ107XG4gICAgICBpZihxdWVyeS5vdXRGaWVsZHMgJiYgcXVlcnkub3V0RmllbGRzWzBdICE9PSAnKicpe1xuICAgICAgICBjb25zdCB0eXBlSWRGaWVsZCA9IHRoaXMuZ2V0TGF5ZXJEZWZpbml0aW9uKCkudHlwZUlkRmllbGQ7XG4gICAgICAgIGlmKHR5cGVJZEZpZWxkICYmIHF1ZXJ5Lm91dEZpZWxkcy5pbmRleE9mKHR5cGVJZEZpZWxkKSA8IDApe1xuICAgICAgICAgIHF1ZXJ5Lm91dEZpZWxkcy5wdXNoKHR5cGVJZEZpZWxkKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMubGF5ZXIucXVlcnlGZWF0dXJlcyhxdWVyeSkudGhlbihmZWF0dXJlU2V0ID0+IHtcbiAgICAgICAgY29uc3QgcmVjb3JkcyA9IGZlYXR1cmVTZXQuZmVhdHVyZXMubWFwKGYgPT4gbmV3IEZlYXR1cmVEYXRhUmVjb3JkSW1wbChmLCB0aGlzKSk7XG5cbiAgICAgICAgY29uc3QgZmllbGRzID0gT2JqZWN0LmtleXModGhpcy5nZXRTY2hlbWEoKS5maWVsZHMpLmZpbHRlcihqaW11RmllbGROYW1lID0+IHtcbiAgICAgICAgICByZXR1cm4gZmVhdHVyZVNldC5maWVsZHMgJiYgZmVhdHVyZVNldC5maWVsZHMuZmluZChmaWVsZCA9PiBmaWVsZC5uYW1lID09PSB0aGlzLmdldFNjaGVtYSgpLmZpZWxkc1tqaW11RmllbGROYW1lXS5uYW1lKVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHF1ZXJ5UGFyYW1zOiBfcXVlcnksXG4gICAgICAgICAgcmVjb3JkcyxcbiAgICAgICAgICBmaWVsZHNcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgIH0pXG4gIH1cblxuICBwcml2YXRlIF9xKHF1ZXJ5UHJvcGVydGllczogSVF1ZXJ5RmVhdHVyZXNPcHRpb25zKTogUHJvbWlzZTxJUXVlcnlGZWF0dXJlc1Jlc3BvbnNlPntcbiAgICBjb25zdCBvcHRpb25zOiBJUXVlcnlGZWF0dXJlc09wdGlvbnMgPSB7XG4gICAgICB1cmw6IHRoaXMudXJsLFxuICAgICAgLi4ucXVlcnlQcm9wZXJ0aWVzXG4gICAgfTtcbiAgICByZXR1cm4gcmVxdWVzdFV0aWxzLnJlcXVlc3RXcmFwcGVyKHRoaXMudXJsLCAoc2Vzc2lvbikgPT4ge1xuICAgICAgb3B0aW9ucy5hdXRoZW50aWNhdGlvbiA9IHNlc3Npb247XG4gICAgICByZXR1cm4gZXNyaS5yZXN0RmVhdHVyZUxheWVyLnF1ZXJ5RmVhdHVyZXMob3B0aW9ucyk7XG4gICAgfSk7XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBTUE7QUFDQTtBQUNBO0FBWUE7QUFBQTtBQWFBO0FBQUE7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBOztBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOzs7QUFHQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7OyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./jimu-core/lib/data-sources/implementations/feature-layer-data-source-impl.ts\n");

/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/feature-record-impl.ts":
/*!***************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/feature-record-impl.ts ***!
  \***************************************************************************/
/*! exports provided: FeatureDataRecordImpl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FeatureDataRecordImpl\", function() { return FeatureDataRecordImpl; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _ds_base_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ds-base-types */ \"./jimu-core/lib/data-sources/ds-base-types/index.ts\");\n/* harmony import */ var _data_source_interface__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../data-source-interface */ \"./jimu-core/lib/data-sources/data-source-interface.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar FeatureDataRecordImpl = /** @class */ (function (_super) {\n    __extends(FeatureDataRecordImpl, _super);\n    function FeatureDataRecordImpl(feature, dataSource, isBeforeMappingData) {\n        if (isBeforeMappingData === void 0) { isBeforeMappingData = true; }\n        var _this = _super.call(this) || this;\n        _this.dataSource = dataSource;\n        if (isBeforeMappingData) {\n            feature.attributes = _this.convertBeforeMappingDataToData(feature.attributes);\n            _this.feature = feature;\n        }\n        else {\n            _this.feature = feature;\n        }\n        _this.fillGeometry();\n        return _this;\n    }\n    FeatureDataRecordImpl.prototype.fillGeometry = function () {\n        var _a;\n        if (!this.feature.geometry || this.dataSource.type === _data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceTypes\"].FeatureSet) {\n            return;\n        }\n        var ds = this.dataSource;\n        if (!this.feature.geometry.spatialReference) {\n            this.feature.geometry.spatialReference = (_a = ds.getLayerDefinition().extent) === null || _a === void 0 ? void 0 : _a.spatialReference;\n        }\n        // (this.feature.geometry as IHasZM).hasM = ds.getLayerDefinition().hasM;\n        // (this.feature.geometry as IHasZM).hasZ = ds.getLayerDefinition().hasZ;\n    };\n    FeatureDataRecordImpl.prototype.queryAttachments = function (attachmentTypes) {\n        var _this = this;\n        var featureLayerUrl = null;\n        var featureLayerDs = this.dataSource;\n        featureLayerUrl = featureLayerDs && featureLayerDs.url;\n        if (!featureLayerUrl) {\n            return Promise.resolve([]);\n        }\n        var attachmentQuery = {\n            attachmentTypes: attachmentTypes,\n            url: featureLayerUrl,\n            featureId: this.getId()\n        };\n        if (!this._queryAllAttachmentsPromise) {\n            this._queryAllAttachmentsPromise = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].queryAllAttachments(attachmentQuery);\n        }\n        return this._queryAllAttachmentsPromise.then(function (attachmentInfos) {\n            _this.attachmentInfos = attachmentInfos;\n            return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].filterAttachments(attachmentInfos, attachmentQuery);\n        });\n    };\n    FeatureDataRecordImpl.prototype.getSymbolPreviewHTML = function () {\n        var _this = this;\n        if (!this._isGraphicFeature()) {\n            return Promise.resolve(null);\n        }\n        if (this._getSymbolPreviewHTMLPromise) {\n            return this._getSymbolPreviewHTMLPromise;\n        }\n        this._getSymbolPreviewHTMLPromise = Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"loadArcGISJSAPIModules\"])([\n            'esri/symbols/support/symbolUtils'\n        ]).then(function (modules) {\n            var symbolUtils = null;\n            symbolUtils = modules[0];\n            return symbolUtils.getDisplayedSymbol(_this.feature).then(function (symbol) {\n                var nodeHtml = document.createElement('div');\n                nodeHtml.className = 'w-100 h-100 d-flex justify-content-center align-items-center';\n                return symbolUtils.renderPreviewHTML(symbol, {\n                    node: nodeHtml\n                });\n            });\n        });\n        return this._getSymbolPreviewHTMLPromise;\n    };\n    FeatureDataRecordImpl.prototype.getData = function () {\n        return this.feature.attributes;\n    };\n    FeatureDataRecordImpl.prototype.getFormattedFieldValue = function (jimuFieldName, intl) {\n        var ds = this.dataSource;\n        if (!ds.getLayerDefinition) {\n            return null;\n        }\n        var layerDefinition = ds.getLayerDefinition();\n        var valueObj = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getDisplayValueForCodedValueOrSubtype(layerDefinition, jimuFieldName, this.getData());\n        return valueObj.isCodedValueOrSubtype ? valueObj.displayValue : _super.prototype.getFormattedFieldValue.call(this, jimuFieldName, intl);\n    };\n    FeatureDataRecordImpl.prototype.getDataBeforeMapping = function () {\n        return this.convertDataToDataBeforeMapping(this.getData());\n    };\n    FeatureDataRecordImpl.prototype.getOriginData = function () {\n        var cloneFeature = Object.assign({}, this.feature);\n        cloneFeature.attributes = this.convertDataToDataBeforeMapping(this.getData());\n        return cloneFeature;\n    };\n    FeatureDataRecordImpl.prototype.toJson = function () {\n        var featureJson = this.feature;\n        return featureJson;\n    };\n    FeatureDataRecordImpl.prototype.getId = function () {\n        return this.feature.attributes[this.dataSource.getIdField()] + '';\n    };\n    FeatureDataRecordImpl.prototype.setId = function (id) {\n        //TODO\n    };\n    FeatureDataRecordImpl.prototype.getGeometry = function () {\n        return this.feature.geometry;\n    };\n    /**\n     * @ignore\n     * Returns whether `feature` is type of `__esri.Graphic`, some methods only work with `__esri.Graphic`.\n     */\n    FeatureDataRecordImpl.prototype._isGraphicFeature = function () {\n        var _a;\n        return !!((_a = this === null || this === void 0 ? void 0 : this.feature) === null || _a === void 0 ? void 0 : _a.layer);\n    };\n    return FeatureDataRecordImpl;\n}(_ds_base_types__WEBPACK_IMPORTED_MODULE_1__[\"AbstractDataRecord\"]));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvZmVhdHVyZS1yZWNvcmQtaW1wbC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2ltcGxlbWVudGF0aW9ucy9mZWF0dXJlLXJlY29yZC1pbXBsLnRzP2E5ZjYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW50bFNoYXBlLCBsb2FkQXJjR0lTSlNBUElNb2R1bGVzLCBkYXRhU291cmNlVXRpbHMgfSBmcm9tICdqaW11LWNvcmUnO1xuaW1wb3J0IHsgSUZlYXR1cmUgfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC10eXBlcyc7XG5pbXBvcnQgeyBBYnN0cmFjdERhdGFSZWNvcmQgfSBmcm9tICcuLi9kcy1iYXNlLXR5cGVzJztcbmltcG9ydCB7IEF0dGFjaG1lbnRJbmZvLCBHZW9tZXRyeSwgRmVhdHVyZURhdGFSZWNvcmQsIEZlYXR1cmVTZXREYXRhU291cmNlLCBGZWF0dXJlTGF5ZXJEYXRhU291cmNlLCBEYXRhU291cmNlVHlwZXMgfSBmcm9tICcuLi9kYXRhLXNvdXJjZS1pbnRlcmZhY2UnO1xuXG5leHBvcnQgY2xhc3MgRmVhdHVyZURhdGFSZWNvcmRJbXBsIGV4dGVuZHMgQWJzdHJhY3REYXRhUmVjb3JkIGltcGxlbWVudHMgRmVhdHVyZURhdGFSZWNvcmQge1xuICBmZWF0dXJlOiBJRmVhdHVyZSB8IF9fZXNyaS5HcmFwaGljO1xuICBkYXRhU291cmNlOiBGZWF0dXJlU2V0RGF0YVNvdXJjZSB8IEZlYXR1cmVMYXllckRhdGFTb3VyY2U7XG4gIGF0dGFjaG1lbnRJbmZvczogQXR0YWNobWVudEluZm9bXTtcbiAgcHJvdGVjdGVkIF9xdWVyeUFsbEF0dGFjaG1lbnRzUHJvbWlzZTogUHJvbWlzZTxBdHRhY2htZW50SW5mb1tdPjtcbiAgcHJvdGVjdGVkIF9nZXRTeW1ib2xQcmV2aWV3SFRNTFByb21pc2U6IFByb21pc2U8SFRNTEVsZW1lbnQ+O1xuXG4gIGNvbnN0cnVjdG9yKGZlYXR1cmU6IElGZWF0dXJlIHwgX19lc3JpLkdyYXBoaWMsIGRhdGFTb3VyY2U6IEZlYXR1cmVTZXREYXRhU291cmNlIHwgRmVhdHVyZUxheWVyRGF0YVNvdXJjZSwgaXNCZWZvcmVNYXBwaW5nRGF0YSA9IHRydWUpe1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5kYXRhU291cmNlID0gZGF0YVNvdXJjZTtcblxuICAgIGlmKGlzQmVmb3JlTWFwcGluZ0RhdGEpe1xuICAgICAgZmVhdHVyZS5hdHRyaWJ1dGVzID0gdGhpcy5jb252ZXJ0QmVmb3JlTWFwcGluZ0RhdGFUb0RhdGEoZmVhdHVyZS5hdHRyaWJ1dGVzKTtcbiAgICAgIHRoaXMuZmVhdHVyZSA9IGZlYXR1cmU7XG4gICAgfWVsc2V7XG4gICAgICB0aGlzLmZlYXR1cmUgPSBmZWF0dXJlO1xuICAgIH1cbiAgICB0aGlzLmZpbGxHZW9tZXRyeSgpO1xuICB9XG5cbiAgcHJpdmF0ZSBmaWxsR2VvbWV0cnkoKXtcbiAgICBpZighdGhpcy5mZWF0dXJlLmdlb21ldHJ5IHx8IHRoaXMuZGF0YVNvdXJjZS50eXBlID09PSBEYXRhU291cmNlVHlwZXMuRmVhdHVyZVNldCl7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3QgZHMgPSB0aGlzLmRhdGFTb3VyY2UgYXMgRmVhdHVyZUxheWVyRGF0YVNvdXJjZTtcbiAgICBpZighdGhpcy5mZWF0dXJlLmdlb21ldHJ5LnNwYXRpYWxSZWZlcmVuY2Upe1xuICAgICAgdGhpcy5mZWF0dXJlLmdlb21ldHJ5LnNwYXRpYWxSZWZlcmVuY2UgPSBkcy5nZXRMYXllckRlZmluaXRpb24oKS5leHRlbnQ/LnNwYXRpYWxSZWZlcmVuY2U7XG4gICAgfVxuXG4gICAgLy8gKHRoaXMuZmVhdHVyZS5nZW9tZXRyeSBhcyBJSGFzWk0pLmhhc00gPSBkcy5nZXRMYXllckRlZmluaXRpb24oKS5oYXNNO1xuICAgIC8vICh0aGlzLmZlYXR1cmUuZ2VvbWV0cnkgYXMgSUhhc1pNKS5oYXNaID0gZHMuZ2V0TGF5ZXJEZWZpbml0aW9uKCkuaGFzWjtcbiAgfVxuXG4gIHF1ZXJ5QXR0YWNobWVudHMoYXR0YWNobWVudFR5cGVzPzogc3RyaW5nW10pOiBQcm9taXNlPEF0dGFjaG1lbnRJbmZvW10+IHtcbiAgICBsZXQgZmVhdHVyZUxheWVyVXJsID0gbnVsbDtcbiAgICBjb25zdCBmZWF0dXJlTGF5ZXJEcyA9IHRoaXMuZGF0YVNvdXJjZSBhcyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlO1xuICAgIGZlYXR1cmVMYXllclVybCA9IGZlYXR1cmVMYXllckRzICYmIGZlYXR1cmVMYXllckRzLnVybDtcbiAgICBpZighZmVhdHVyZUxheWVyVXJsKXtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoW10pO1xuICAgIH1cblxuICAgIGNvbnN0IGF0dGFjaG1lbnRRdWVyeSA9IHtcbiAgICAgIGF0dGFjaG1lbnRUeXBlczogYXR0YWNobWVudFR5cGVzLFxuICAgICAgdXJsOiBmZWF0dXJlTGF5ZXJVcmwsXG4gICAgICBmZWF0dXJlSWQ6IHRoaXMuZ2V0SWQoKVxuICAgIH07XG5cbiAgICBpZiAoIXRoaXMuX3F1ZXJ5QWxsQXR0YWNobWVudHNQcm9taXNlKSB7XG4gICAgICB0aGlzLl9xdWVyeUFsbEF0dGFjaG1lbnRzUHJvbWlzZSA9IGRhdGFTb3VyY2VVdGlscy5xdWVyeUFsbEF0dGFjaG1lbnRzKGF0dGFjaG1lbnRRdWVyeSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuX3F1ZXJ5QWxsQXR0YWNobWVudHNQcm9taXNlLnRoZW4oKGF0dGFjaG1lbnRJbmZvcykgPT4ge1xuICAgICAgdGhpcy5hdHRhY2htZW50SW5mb3MgPSBhdHRhY2htZW50SW5mb3M7XG4gICAgICByZXR1cm4gZGF0YVNvdXJjZVV0aWxzLmZpbHRlckF0dGFjaG1lbnRzKGF0dGFjaG1lbnRJbmZvcywgYXR0YWNobWVudFF1ZXJ5KTtcbiAgICB9KVxuICB9XG5cbiAgZ2V0U3ltYm9sUHJldmlld0hUTUwoKTogUHJvbWlzZTxIVE1MRWxlbWVudD4ge1xuICAgIGlmKCF0aGlzLl9pc0dyYXBoaWNGZWF0dXJlKCkpe1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShudWxsKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5fZ2V0U3ltYm9sUHJldmlld0hUTUxQcm9taXNlKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZ2V0U3ltYm9sUHJldmlld0hUTUxQcm9taXNlO1xuICAgIH1cblxuICAgIHRoaXMuX2dldFN5bWJvbFByZXZpZXdIVE1MUHJvbWlzZSA9IGxvYWRBcmNHSVNKU0FQSU1vZHVsZXMoW1xuICAgICAgJ2Vzcmkvc3ltYm9scy9zdXBwb3J0L3N5bWJvbFV0aWxzJ1xuICAgIF0pLnRoZW4obW9kdWxlcyA9PiB7XG4gICAgICBsZXQgc3ltYm9sVXRpbHM6IHR5cGVvZiBfX2Vzcmkuc3ltYm9sVXRpbHMgPSBudWxsO1xuICAgICAgW3N5bWJvbFV0aWxzXSA9IG1vZHVsZXM7XG4gICAgICByZXR1cm4gc3ltYm9sVXRpbHMuZ2V0RGlzcGxheWVkU3ltYm9sKHRoaXMuZmVhdHVyZSBhcyBfX2VzcmkuR3JhcGhpYykudGhlbigoc3ltYm9sKSA9PiB7XG4gICAgICAgIGNvbnN0IG5vZGVIdG1sID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgIG5vZGVIdG1sLmNsYXNzTmFtZT0ndy0xMDAgaC0xMDAgZC1mbGV4IGp1c3RpZnktY29udGVudC1jZW50ZXIgYWxpZ24taXRlbXMtY2VudGVyJztcbiAgICAgICAgcmV0dXJuIHN5bWJvbFV0aWxzLnJlbmRlclByZXZpZXdIVE1MKHN5bWJvbCwge1xuICAgICAgICAgIG5vZGU6IG5vZGVIdG1sXG4gICAgICAgIH0pO1xuICAgICAgfSlcbiAgICB9KVxuXG4gICAgcmV0dXJuIHRoaXMuX2dldFN5bWJvbFByZXZpZXdIVE1MUHJvbWlzZTtcbiAgfVxuXG4gIGdldERhdGEoKToge1trZXk6IHN0cmluZ106IGFueX0ge1xuICAgIHJldHVybiB0aGlzLmZlYXR1cmUuYXR0cmlidXRlcztcbiAgfVxuXG4gIGdldEZvcm1hdHRlZEZpZWxkVmFsdWUoamltdUZpZWxkTmFtZTogc3RyaW5nLCBpbnRsOiBJbnRsU2hhcGUpOiBzdHJpbmcge1xuICAgIGNvbnN0IGRzID0gdGhpcy5kYXRhU291cmNlIGFzIEZlYXR1cmVMYXllckRhdGFTb3VyY2U7XG4gICAgaWYoIWRzLmdldExheWVyRGVmaW5pdGlvbil7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3QgbGF5ZXJEZWZpbml0aW9uID0gZHMuZ2V0TGF5ZXJEZWZpbml0aW9uKCk7XG4gICAgY29uc3QgdmFsdWVPYmogPSBkYXRhU291cmNlVXRpbHMuZ2V0RGlzcGxheVZhbHVlRm9yQ29kZWRWYWx1ZU9yU3VidHlwZShsYXllckRlZmluaXRpb24sIGppbXVGaWVsZE5hbWUsIHRoaXMuZ2V0RGF0YSgpKTtcbiAgICByZXR1cm4gdmFsdWVPYmouaXNDb2RlZFZhbHVlT3JTdWJ0eXBlID8gdmFsdWVPYmouZGlzcGxheVZhbHVlIDogc3VwZXIuZ2V0Rm9ybWF0dGVkRmllbGRWYWx1ZShqaW11RmllbGROYW1lLCBpbnRsKTtcbiAgfVxuXG4gIGdldERhdGFCZWZvcmVNYXBwaW5nKCk6IHtba2V5OiBzdHJpbmddOiBhbnl9IHtcbiAgICByZXR1cm4gdGhpcy5jb252ZXJ0RGF0YVRvRGF0YUJlZm9yZU1hcHBpbmcodGhpcy5nZXREYXRhKCkpO1xuICB9XG5cbiAgZ2V0T3JpZ2luRGF0YSgpOiB7W2tleTogc3RyaW5nXTogYW55fSB7XG4gICAgY29uc3QgY2xvbmVGZWF0dXJlID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5mZWF0dXJlKTtcbiAgICBjbG9uZUZlYXR1cmUuYXR0cmlidXRlcyA9IHRoaXMuY29udmVydERhdGFUb0RhdGFCZWZvcmVNYXBwaW5nKHRoaXMuZ2V0RGF0YSgpKTtcbiAgICByZXR1cm4gY2xvbmVGZWF0dXJlO1xuICB9XG5cbiAgdG9Kc29uKCk6IElGZWF0dXJlIHwgX19lc3JpLkdyYXBoaWN7XG4gICAgY29uc3QgZmVhdHVyZUpzb24gPSB0aGlzLmZlYXR1cmU7XG4gICAgcmV0dXJuIGZlYXR1cmVKc29uO1xuICB9XG5cbiAgZ2V0SWQoKTogc3RyaW5ne1xuICAgIHJldHVybiB0aGlzLmZlYXR1cmUuYXR0cmlidXRlc1t0aGlzLmRhdGFTb3VyY2UuZ2V0SWRGaWVsZCgpXSArICcnO1xuICB9XG5cbiAgc2V0SWQoaWQ6IHN0cmluZyl7XG4gICAgLy9UT0RPXG4gIH1cblxuICBnZXRHZW9tZXRyeSgpOiBHZW9tZXRyeXtcbiAgICByZXR1cm4gdGhpcy5mZWF0dXJlLmdlb21ldHJ5IGFzIEdlb21ldHJ5O1xuICB9XG5cbiAgLyoqXG4gICAqIEBpZ25vcmVcbiAgICogUmV0dXJucyB3aGV0aGVyIGBmZWF0dXJlYCBpcyB0eXBlIG9mIGBfX2VzcmkuR3JhcGhpY2AsIHNvbWUgbWV0aG9kcyBvbmx5IHdvcmsgd2l0aCBgX19lc3JpLkdyYXBoaWNgLlxuICAgKi9cbiAgcHJpdmF0ZSBfaXNHcmFwaGljRmVhdHVyZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gISEodGhpcz8uZmVhdHVyZSBhcyBfX2VzcmkuR3JhcGhpYyk/LmxheWVyO1xuICB9XG59Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFFQTtBQUNBO0FBRUE7QUFBQTtBQU9BO0FBQUE7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBOzs7QUFHQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUFBOzsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./jimu-core/lib/data-sources/implementations/feature-record-impl.ts\n");

/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/feature-service-data-source-impl.ts":
/*!****************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/feature-service-data-source-impl.ts ***!
  \****************************************************************************************/
/*! exports provided: FeatureServiceDataSourceImpl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FeatureServiceDataSourceImpl\", function() { return FeatureServiceDataSourceImpl; });\n/* harmony import */ var _data_source_interface__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../data-source-interface */ \"./jimu-core/lib/data-sources/data-source-interface.ts\");\n/* harmony import */ var _ds_base_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ds-base-types */ \"./jimu-core/lib/data-sources/ds-base-types/index.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n/**\n * Data source from a feature service, which may contain multiple child data sources.\n */\nvar FeatureServiceDataSourceImpl = /** @class */ (function (_super) {\n    __extends(FeatureServiceDataSourceImpl, _super);\n    function FeatureServiceDataSourceImpl() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.type = _data_source_interface__WEBPACK_IMPORTED_MODULE_0__[\"DataSourceTypes\"].FeatureService;\n        return _this;\n    }\n    return FeatureServiceDataSourceImpl;\n}(_ds_base_types__WEBPACK_IMPORTED_MODULE_1__[\"AbstractLayerFolderDataSource\"]));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvZmVhdHVyZS1zZXJ2aWNlLWRhdGEtc291cmNlLWltcGwudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvZmVhdHVyZS1zZXJ2aWNlLWRhdGEtc291cmNlLWltcGwudHM/MjdmYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBEYXRhU291cmNlVHlwZXMsIEZlYXR1cmVTZXJ2aWNlRGF0YVNvdXJjZSB9IGZyb20gJy4uL2RhdGEtc291cmNlLWludGVyZmFjZSc7XG5pbXBvcnQgeyBBYnN0cmFjdExheWVyRm9sZGVyRGF0YVNvdXJjZSB9IGZyb20gJy4uL2RzLWJhc2UtdHlwZXMnO1xuXG4vKipcbiAqIERhdGEgc291cmNlIGZyb20gYSBmZWF0dXJlIHNlcnZpY2UsIHdoaWNoIG1heSBjb250YWluIG11bHRpcGxlIGNoaWxkIGRhdGEgc291cmNlcy5cbiAqL1xuZXhwb3J0IGNsYXNzIEZlYXR1cmVTZXJ2aWNlRGF0YVNvdXJjZUltcGwgZXh0ZW5kcyBBYnN0cmFjdExheWVyRm9sZGVyRGF0YVNvdXJjZSBpbXBsZW1lbnRzIEZlYXR1cmVTZXJ2aWNlRGF0YVNvdXJjZSB7XG4gIHR5cGU6IERhdGFTb3VyY2VUeXBlcy5GZWF0dXJlU2VydmljZSA9IERhdGFTb3VyY2VUeXBlcy5GZWF0dXJlU2VydmljZTtcbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBOztBQUNBO0FBQUE7QUFBQTs7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./jimu-core/lib/data-sources/implementations/feature-service-data-source-impl.ts\n");

/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/feature-set-data-source-impl.ts":
/*!************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/feature-set-data-source-impl.ts ***!
  \************************************************************************************/
/*! exports provided: FeatureSetDataSourceImpl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FeatureSetDataSourceImpl\", function() { return FeatureSetDataSourceImpl; });\n/* harmony import */ var _ds_base_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ds-base-types */ \"./jimu-core/lib/data-sources/ds-base-types/index.ts\");\n/* harmony import */ var _data_source_interface__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../data-source-interface */ \"./jimu-core/lib/data-sources/data-source-interface.ts\");\n/* harmony import */ var _feature_record_impl__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./feature-record-impl */ \"./jimu-core/lib/data-sources/implementations/feature-record-impl.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar FeatureSetDataSourceImpl = /** @class */ (function (_super) {\n    __extends(FeatureSetDataSourceImpl, _super);\n    function FeatureSetDataSourceImpl(options) {\n        var _this = _super.call(this, options) || this;\n        _this.type = _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceTypes\"].FeatureSet;\n        _this.records = options.records || [];\n        return _this;\n    }\n    FeatureSetDataSourceImpl.prototype.getIdField = function () {\n        if (this.getDataSourceJson().schema && this.getDataSourceJson().schema.idField) {\n            return this.getDataSourceJson().schema.idField;\n        }\n        if (this.getDataSourceJson().originDataSources && this.getDataSourceJson().originDataSources.length > 0\n            && this.dataSourceManager.getDataSource(this.getDataSourceJson().originDataSources[0].dataSourceId)) {\n            return this.dataSourceManager.getDataSource(this.getDataSourceJson().originDataSources[0].dataSourceId).getIdField();\n        }\n        return _super.prototype.getIdField.call(this);\n    };\n    FeatureSetDataSourceImpl.prototype.setJsonData = function (data) {\n        var _this = this;\n        this.records = data.map(function (d) { return new _feature_record_impl__WEBPACK_IMPORTED_MODULE_2__[\"FeatureDataRecordImpl\"](d, _this, false); });\n    };\n    FeatureSetDataSourceImpl.prototype.addRecord = function (record) {\n    };\n    return FeatureSetDataSourceImpl;\n}(_ds_base_types__WEBPACK_IMPORTED_MODULE_0__[\"AbstractDataSource\"]));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvZmVhdHVyZS1zZXQtZGF0YS1zb3VyY2UtaW1wbC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2ltcGxlbWVudGF0aW9ucy9mZWF0dXJlLXNldC1kYXRhLXNvdXJjZS1pbXBsLnRzPzFhZWIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSUZlYXR1cmUgfSBmcm9tICdAZXNyaS9hcmNnaXMtcmVzdC10eXBlcyc7XG5pbXBvcnQgeyBBYnN0cmFjdERhdGFTb3VyY2UgfSBmcm9tICcuLi9kcy1iYXNlLXR5cGVzJztcbmltcG9ydCB7IERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMsIERhdGFTb3VyY2VUeXBlcywgRmVhdHVyZVNldERhdGFTb3VyY2UsIEZlYXR1cmVEYXRhUmVjb3JkIH0gZnJvbSAnLi4vZGF0YS1zb3VyY2UtaW50ZXJmYWNlJztcbmltcG9ydCB7IEZlYXR1cmVEYXRhUmVjb3JkSW1wbCB9IGZyb20gJy4vZmVhdHVyZS1yZWNvcmQtaW1wbCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmVhdHVyZVNldERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMgZXh0ZW5kcyBEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIHtcbiAgcmVjb3JkczogRmVhdHVyZURhdGFSZWNvcmRbXTtcbn1cblxuZXhwb3J0IGNsYXNzIEZlYXR1cmVTZXREYXRhU291cmNlSW1wbCBleHRlbmRzIEFic3RyYWN0RGF0YVNvdXJjZSBpbXBsZW1lbnRzIEZlYXR1cmVTZXREYXRhU291cmNlIHtcbiAgdHlwZTogRGF0YVNvdXJjZVR5cGVzLkZlYXR1cmVTZXQgPSBEYXRhU291cmNlVHlwZXMuRmVhdHVyZVNldDtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBGZWF0dXJlU2V0RGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyl7XG4gICAgc3VwZXIob3B0aW9ucyk7XG4gICAgdGhpcy5yZWNvcmRzID0gb3B0aW9ucy5yZWNvcmRzIHx8IFtdO1xuICB9XG5cbiAgZ2V0SWRGaWVsZCgpOiBzdHJpbmd7XG4gICAgaWYodGhpcy5nZXREYXRhU291cmNlSnNvbigpLnNjaGVtYSAmJiB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkuc2NoZW1hLmlkRmllbGQpe1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5zY2hlbWEuaWRGaWVsZDtcbiAgICB9XG4gICAgaWYodGhpcy5nZXREYXRhU291cmNlSnNvbigpLm9yaWdpbkRhdGFTb3VyY2VzICYmIHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5vcmlnaW5EYXRhU291cmNlcy5sZW5ndGggPiAwXG4gICAgICAmJiB0aGlzLmRhdGFTb3VyY2VNYW5hZ2VyLmdldERhdGFTb3VyY2UodGhpcy5nZXREYXRhU291cmNlSnNvbigpLm9yaWdpbkRhdGFTb3VyY2VzWzBdLmRhdGFTb3VyY2VJZCkpe1xuICAgICAgcmV0dXJuIHRoaXMuZGF0YVNvdXJjZU1hbmFnZXIuZ2V0RGF0YVNvdXJjZSh0aGlzLmdldERhdGFTb3VyY2VKc29uKCkub3JpZ2luRGF0YVNvdXJjZXNbMF0uZGF0YVNvdXJjZUlkKS5nZXRJZEZpZWxkKCk7XG4gICAgfVxuICAgIHJldHVybiBzdXBlci5nZXRJZEZpZWxkKCk7XG4gIH1cblxuICBzZXRKc29uRGF0YShkYXRhOiAoSUZlYXR1cmUgfCBfX2VzcmkuR3JhcGhpYylbXSkge1xuICAgIHRoaXMucmVjb3JkcyA9IGRhdGEubWFwKGQgPT4gbmV3IEZlYXR1cmVEYXRhUmVjb3JkSW1wbChkLCB0aGlzLCBmYWxzZSkpO1xuICB9XG5cbiAgYWRkUmVjb3JkKHJlY29yZDogRmVhdHVyZURhdGFSZWNvcmQpIHtcbiAgfVxuXG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQU1BO0FBQUE7QUFHQTtBQUFBO0FBRkE7QUFJQTs7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFBQTs7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./jimu-core/lib/data-sources/implementations/feature-set-data-source-impl.ts\n");

/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/group-layer-data-source-impl.ts":
/*!************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/group-layer-data-source-impl.ts ***!
  \************************************************************************************/
/*! exports provided: GroupLayerDataSourceImpl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"GroupLayerDataSourceImpl\", function() { return GroupLayerDataSourceImpl; });\n/* harmony import */ var _ds_base_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ds-base-types */ \"./jimu-core/lib/data-sources/ds-base-types/index.ts\");\n/* harmony import */ var _data_source_interface__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../data-source-interface */ \"./jimu-core/lib/data-sources/data-source-interface.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n/**\n * Data source from group layer a map service, which may contain multiple child data sources.\n */\nvar GroupLayerDataSourceImpl = /** @class */ (function (_super) {\n    __extends(GroupLayerDataSourceImpl, _super);\n    function GroupLayerDataSourceImpl() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.type = _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceTypes\"].GroupLayer;\n        return _this;\n    }\n    return GroupLayerDataSourceImpl;\n}(_ds_base_types__WEBPACK_IMPORTED_MODULE_0__[\"AbstractLayerFolderDataSource\"]));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvZ3JvdXAtbGF5ZXItZGF0YS1zb3VyY2UtaW1wbC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2ltcGxlbWVudGF0aW9ucy9ncm91cC1sYXllci1kYXRhLXNvdXJjZS1pbXBsLnRzPzlmYjUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWJzdHJhY3RMYXllckZvbGRlckRhdGFTb3VyY2UgfSBmcm9tICcuLi9kcy1iYXNlLXR5cGVzJztcbmltcG9ydCB7IERhdGFTb3VyY2VUeXBlcywgR3JvdXBMYXllckRhdGFTb3VyY2UgfSBmcm9tICcuLi9kYXRhLXNvdXJjZS1pbnRlcmZhY2UnO1xuXG4vKipcbiAqIERhdGEgc291cmNlIGZyb20gZ3JvdXAgbGF5ZXIgYSBtYXAgc2VydmljZSwgd2hpY2ggbWF5IGNvbnRhaW4gbXVsdGlwbGUgY2hpbGQgZGF0YSBzb3VyY2VzLlxuICovXG5leHBvcnQgY2xhc3MgR3JvdXBMYXllckRhdGFTb3VyY2VJbXBsIGV4dGVuZHMgQWJzdHJhY3RMYXllckZvbGRlckRhdGFTb3VyY2UgaW1wbGVtZW50cyBHcm91cExheWVyRGF0YVNvdXJjZSB7XG4gIHR5cGU6IERhdGFTb3VyY2VUeXBlcy5Hcm91cExheWVyID0gRGF0YVNvdXJjZVR5cGVzLkdyb3VwTGF5ZXI7XG4gIGxheWVyPzogX19lc3JpLkdyb3VwTGF5ZXIgfCBfX2VzcmkuU3VibGF5ZXI7XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUFBO0FBQUE7OyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./jimu-core/lib/data-sources/implementations/group-layer-data-source-impl.ts\n");

/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/map-service-data-source-impl.ts":
/*!************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/map-service-data-source-impl.ts ***!
  \************************************************************************************/
/*! exports provided: MapServiceDataSourceImpl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MapServiceDataSourceImpl\", function() { return MapServiceDataSourceImpl; });\n/* harmony import */ var _ds_base_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ds-base-types */ \"./jimu-core/lib/data-sources/ds-base-types/index.ts\");\n/* harmony import */ var _data_source_interface__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../data-source-interface */ \"./jimu-core/lib/data-sources/data-source-interface.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n/**\n * Data source from a map service, which may contain multiple child data sources.\n */\nvar MapServiceDataSourceImpl = /** @class */ (function (_super) {\n    __extends(MapServiceDataSourceImpl, _super);\n    function MapServiceDataSourceImpl() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.type = _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceTypes\"].MapService;\n        return _this;\n    }\n    return MapServiceDataSourceImpl;\n}(_ds_base_types__WEBPACK_IMPORTED_MODULE_0__[\"AbstractLayerFolderDataSource\"]));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvbWFwLXNlcnZpY2UtZGF0YS1zb3VyY2UtaW1wbC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2ltcGxlbWVudGF0aW9ucy9tYXAtc2VydmljZS1kYXRhLXNvdXJjZS1pbXBsLnRzP2VkOTEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWJzdHJhY3RMYXllckZvbGRlckRhdGFTb3VyY2UgfSBmcm9tICcuLi9kcy1iYXNlLXR5cGVzJztcbmltcG9ydCB7IERhdGFTb3VyY2VUeXBlcywgTWFwU2VydmljZURhdGFTb3VyY2UgfSBmcm9tICcuLi9kYXRhLXNvdXJjZS1pbnRlcmZhY2UnO1xuXG4vKipcbiAqIERhdGEgc291cmNlIGZyb20gYSBtYXAgc2VydmljZSwgd2hpY2ggbWF5IGNvbnRhaW4gbXVsdGlwbGUgY2hpbGQgZGF0YSBzb3VyY2VzLlxuICovXG5leHBvcnQgY2xhc3MgTWFwU2VydmljZURhdGFTb3VyY2VJbXBsIGV4dGVuZHMgQWJzdHJhY3RMYXllckZvbGRlckRhdGFTb3VyY2UgaW1wbGVtZW50cyBNYXBTZXJ2aWNlRGF0YVNvdXJjZSB7XG4gIHR5cGU6IERhdGFTb3VyY2VUeXBlcy5NYXBTZXJ2aWNlID0gRGF0YVNvdXJjZVR5cGVzLk1hcFNlcnZpY2U7XG4gIGxheWVyPzogX19lc3JpLk1hcEltYWdlTGF5ZXIgfCBfX2VzcmkuVGlsZUxheWVyO1xufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFBQTtBQUFBOzsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./jimu-core/lib/data-sources/implementations/map-service-data-source-impl.ts\n");

/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/scene-layer-data-source-impl.ts":
/*!************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/scene-layer-data-source-impl.ts ***!
  \************************************************************************************/
/*! exports provided: SceneLayerDataSourceImpl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SceneLayerDataSourceImpl\", function() { return SceneLayerDataSourceImpl; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _ds_base_types_abstract_queriable_data_source__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ds-base-types/abstract-queriable-data-source */ \"./jimu-core/lib/data-sources/ds-base-types/abstract-queriable-data-source.ts\");\n/* harmony import */ var _data_source_interface__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../data-source-interface */ \"./jimu-core/lib/data-sources/data-source-interface.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar ASSOCIATED_DATA_SOURCE_ID_POSTFIX = 'ASSOCIATED_DATA_SOURCE';\nvar SceneLayerDataSourceImpl = /** @class */ (function (_super) {\n    __extends(SceneLayerDataSourceImpl, _super);\n    function SceneLayerDataSourceImpl(options) {\n        var _a, _b;\n        var _this = _super.call(this, options) || this;\n        _this.type = _data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceTypes\"].SceneLayer;\n        var dsJson = _this.getDataSourceJson();\n        _this.portalUrl = dsJson.portalUrl;\n        _this.itemId = dsJson.itemId;\n        _this.layerId = dsJson.layerId;\n        if (options.layer) {\n            _this.layer = options.layer;\n        }\n        if (options.belongToDataSource && options.belongToDataSource.layer) {\n            _this.layer = options.belongToDataSource.layer;\n        }\n        if (_this.isLocal) {\n            var associatedDataSourceBelongToDataSource = (_a = options.belongToDataSource) === null || _a === void 0 ? void 0 : _a.getAssociatedDataSource();\n            if (associatedDataSourceBelongToDataSource) {\n                jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"DataSourceManager\"].getInstance().createLocalDataSource(associatedDataSourceBelongToDataSource, _this.localId);\n            }\n        }\n        else if (_this.isDataView) {\n            var associatedDataSourceBelongToDataSource = (_b = options.belongToDataSource) === null || _b === void 0 ? void 0 : _b.getAssociatedDataSource();\n            if (associatedDataSourceBelongToDataSource) {\n                jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"DataSourceManager\"].getInstance().createDataView(associatedDataSourceBelongToDataSource, _this.dataViewId);\n            }\n        }\n        return _this;\n    }\n    SceneLayerDataSourceImpl.prototype.ready = function () {\n        var _this = this;\n        return Promise.all([\n            this.fetchLayerDefinition(),\n            this.createAssociatedDataSource()\n        ]).then(function () { return _super.prototype.ready.call(_this); });\n    };\n    SceneLayerDataSourceImpl.prototype.createAssociatedDataSource = function () {\n        var _this = this;\n        if (this.associatedDataSource) {\n            return Promise.resolve(this.associatedDataSource);\n        }\n        if (this.layer) {\n            return this._createAssociatedDataSourceWithLayer().then(function (associatedDataSource) {\n                if (!associatedDataSource) {\n                    return _this._createAssociatedDataSourceWithUrl();\n                }\n                return associatedDataSource;\n            });\n        }\n        else {\n            return this._createAssociatedDataSourceWithUrl();\n        }\n    };\n    SceneLayerDataSourceImpl.prototype._createAssociatedDataSourceWithLayer = function () {\n        var _this = this;\n        var dsId = this._getNewAssociatedDataSourceId();\n        return this.layer.load().then(function () {\n            if (!_this.layer.associatedLayer) {\n                return null;\n            }\n            var dsJson = Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])({\n                id: dsId,\n                type: _data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceTypes\"].FeatureLayer,\n                url: jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getUrlByLayer(_this.layer.associatedLayer)\n            });\n            var schema = _this.getDataSourceJson().schema;\n            if (schema) {\n                dsJson = dsJson.set('schema', schema);\n            }\n            var options = {\n                id: dsId,\n                dataSourceJson: dsJson,\n                layer: _this.layer.associatedLayer\n            };\n            return _this.dataSourceManager.createDataSource(options);\n        }).then(function (ds) {\n            _this.associatedDataSource = ds;\n            return _this.associatedDataSource;\n        });\n    };\n    SceneLayerDataSourceImpl.prototype._createAssociatedDataSourceWithUrl = function () {\n        var _this = this;\n        var dsId = this._getNewAssociatedDataSourceId();\n        return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].fetchAssociatedFeatureLayerDefinition(this.url, this.layerId, this.itemId, this.portalUrl)\n            .then(function (res) {\n            if (!res) {\n                return Promise.reject('Can not find associated feature layer');\n            }\n            var dsJson = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getSingleDsJsonFromLayerDefinition(dsId, res.url, res.def);\n            dsJson = _this._mergeAssociatedDataSourceJson(dsJson);\n            return dsJson;\n        }).then(function (dsJson) {\n            var options = {\n                id: dsJson.id,\n                dataSourceJson: dsJson\n            };\n            return _this.dataSourceManager.createDataSource(options);\n        }).then(function (ds) {\n            _this.associatedDataSource = ds;\n            return _this.associatedDataSource;\n        });\n    };\n    SceneLayerDataSourceImpl.prototype._getNewAssociatedDataSourceId = function () {\n        return this.getDataSourceJson().id + \"-\" + ASSOCIATED_DATA_SOURCE_ID_POSTFIX;\n    };\n    SceneLayerDataSourceImpl.prototype.fetchLayerDefinition = function () {\n        var _this = this;\n        var _a;\n        var url = (_a = this.getDataSourceJson()) === null || _a === void 0 ? void 0 : _a.url;\n        if (!url) {\n            return Promise.resolve(null);\n        }\n        if (this.getLayerDefinition()) {\n            return Promise.resolve(this.getLayerDefinition());\n        }\n        return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"ServiceManager\"].getInstance().fetchServiceInfo(url).then(function (res) { return res.definition; })\n            .then(function (definition) {\n            if (!definition) {\n                return null;\n            }\n            _this.layerDefinition = definition;\n            return definition;\n        });\n    };\n    SceneLayerDataSourceImpl.prototype.getLayerDefinition = function () {\n        if (this.isDataView || this.isLocal) {\n            return this.getMainDataSource().getLayerDefinition();\n        }\n        return this.layerDefinition;\n    };\n    SceneLayerDataSourceImpl.prototype.getInfo = function () {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getInfo();\n    };\n    SceneLayerDataSourceImpl.prototype.fetchSchema = function () {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.fetchSchema();\n    };\n    SceneLayerDataSourceImpl.prototype.getSchema = function () {\n        var _a, _b, _c;\n        var associatedLayerSchema = (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getSchema();\n        var sceneLayerSchema = Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])({ label: ((_b = this.layer) === null || _b === void 0 ? void 0 : _b.title) || ((_c = this.getLayerDefinition()) === null || _c === void 0 ? void 0 : _c.name) });\n        return associatedLayerSchema ? associatedLayerSchema.merge(sceneLayerSchema) : sceneLayerSchema;\n    };\n    SceneLayerDataSourceImpl.prototype.setSchema = function (schema) {\n        var _a;\n        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.setSchema(schema);\n    };\n    SceneLayerDataSourceImpl.prototype.setDataSourceJson = function (dsJson) {\n        _super.prototype.setDataSourceJson.call(this, dsJson);\n        var a = this.getAssociatedDataSource();\n        if (a) {\n            var aDsJson = this._mergeAssociatedDataSourceJson(a.getDataSourceJson());\n            a.setDataSourceJson(aDsJson);\n        }\n    };\n    SceneLayerDataSourceImpl.prototype.getFetchedSchema = function () {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getFetchedSchema();\n    };\n    SceneLayerDataSourceImpl.prototype.setFetchedSchema = function (fetchedSchema) {\n        var _a;\n        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.setFetchedSchema(fetchedSchema);\n    };\n    SceneLayerDataSourceImpl.prototype.getReversedConfigSchema = function () {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getReversedConfigSchema();\n    };\n    SceneLayerDataSourceImpl.prototype.getSelectedFields = function () {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getSelectedFields();\n    };\n    SceneLayerDataSourceImpl.prototype.getIdField = function () {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getIdField();\n    };\n    SceneLayerDataSourceImpl.prototype.setJsonData = function (data) {\n        var _a;\n        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.setJsonData(data);\n    };\n    SceneLayerDataSourceImpl.prototype.queryById = function (id) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.queryById(id);\n    };\n    SceneLayerDataSourceImpl.prototype.addRecord = function (record) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.addRecord(record);\n    };\n    SceneLayerDataSourceImpl.prototype.updateRecord = function (record) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.updateRecord(record);\n    };\n    SceneLayerDataSourceImpl.prototype.deleteRecord = function (index) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.deleteRecord(index);\n    };\n    SceneLayerDataSourceImpl.prototype.doQuery = function (queryProperties) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.doQuery(queryProperties);\n    };\n    SceneLayerDataSourceImpl.prototype.doQueryById = function (id) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.doQueryById(id);\n    };\n    SceneLayerDataSourceImpl.prototype.doQueryCount = function (queryProperties) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.doQueryCount(queryProperties);\n    };\n    SceneLayerDataSourceImpl.prototype.getConfigQueryParams = function () {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getConfigQueryParams();\n    };\n    SceneLayerDataSourceImpl.prototype.getRemoteQueryParams = function () {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getRemoteQueryParams();\n    };\n    SceneLayerDataSourceImpl.prototype.getCurrentQueryParams = function (excludeOption) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getCurrentQueryParams(excludeOption);\n    };\n    SceneLayerDataSourceImpl.prototype.getRuntimeQueryParamsgetRuntimeQueryParams = function (excludeWidgetId) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getRuntimeQueryParams(excludeWidgetId);\n    };\n    SceneLayerDataSourceImpl.prototype.getCurrentQueryId = function () {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getCurrentQueryId();\n    };\n    SceneLayerDataSourceImpl.prototype.mergeQueryParams = function (baseQuery, newQuery) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.mergeQueryParams(baseQuery, newQuery);\n    };\n    SceneLayerDataSourceImpl.prototype.getFieldCodedValueList = function (jimuFieldName, record) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getFieldCodedValueList(jimuFieldName, record);\n    };\n    SceneLayerDataSourceImpl.prototype.getRealQueryParams = function (query, flag, options) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getRealQueryParams(query, flag, options);\n    };\n    SceneLayerDataSourceImpl.prototype.updateQueryParams = function (query, widgetId) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.updateQueryParams(query, widgetId);\n    };\n    SceneLayerDataSourceImpl.prototype.getGDBVersion = function () {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getGDBVersion();\n    };\n    SceneLayerDataSourceImpl.prototype.getQueryPageSize = function () {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getQueryPageSize();\n    };\n    SceneLayerDataSourceImpl.prototype.getMaxRecordCount = function () {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getMaxRecordCount();\n    };\n    SceneLayerDataSourceImpl.prototype.getRecordsByPage = function (page, pageSize) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getRecordsByPage(page, pageSize);\n    };\n    SceneLayerDataSourceImpl.prototype.getPagesData = function () {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getPagesData();\n    };\n    SceneLayerDataSourceImpl.prototype.setPagesData = function (pages) {\n        var _a;\n        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.setPagesData(pages);\n    };\n    SceneLayerDataSourceImpl.prototype.getRealQueryPages = function (page, pageSize) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getRealQueryPages(page, pageSize);\n    };\n    SceneLayerDataSourceImpl.prototype.load = function (query, options) {\n        var _a;\n        if (options === void 0) { options = {}; }\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.load(query, options);\n    };\n    SceneLayerDataSourceImpl.prototype.loadCount = function (query, options) {\n        var _a;\n        if (options === void 0) { options = {}; }\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.loadCount(query, options);\n    };\n    SceneLayerDataSourceImpl.prototype.query = function (query, options) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.query(query, options);\n    };\n    SceneLayerDataSourceImpl.prototype.queryCount = function (query, options) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.queryCount(query, options);\n    };\n    SceneLayerDataSourceImpl.prototype.loadById = function (id, refresh) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.loadById(id, refresh);\n    };\n    SceneLayerDataSourceImpl.prototype.changeGDBVersion = function (gdbVersion) {\n        var _a;\n        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.changeGDBVersion(gdbVersion);\n    };\n    SceneLayerDataSourceImpl.prototype.getAssociatedDataSource = function () {\n        if (!this.isDataView && !this.isLocal) {\n            return this.associatedDataSource;\n        }\n        var realAssoDsId = this._getRealAssociatedDataSourceId();\n        return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"DataSourceManager\"].getInstance().getDataSource(realAssoDsId);\n    };\n    SceneLayerDataSourceImpl.prototype._getRealAssociatedDataSourceId = function () {\n        var _a;\n        var realAssoDsId;\n        var belongToAssoDs = (_a = this.belongToDataSource) === null || _a === void 0 ? void 0 : _a.associatedDataSource;\n        if (this.isLocal) {\n            realAssoDsId = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"DataSourceManager\"].getInstance().getLocalDataSourceId(belongToAssoDs === null || belongToAssoDs === void 0 ? void 0 : belongToAssoDs.id, this.localId);\n        }\n        else if (this.isDataView) {\n            realAssoDsId = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"DataSourceManager\"].getInstance().getDataViewDataSourceId(belongToAssoDs === null || belongToAssoDs === void 0 ? void 0 : belongToAssoDs.id, this.dataViewId);\n        }\n        else {\n            realAssoDsId = this.associatedDataSource.id;\n        }\n        return realAssoDsId;\n    };\n    SceneLayerDataSourceImpl.prototype.clearData = function () {\n        var _a;\n        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.clearData();\n    };\n    SceneLayerDataSourceImpl.prototype.setRecords = function (records) {\n        var _a;\n        _super.prototype.addVersion.call(this);\n        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.setRecords(records);\n    };\n    SceneLayerDataSourceImpl.prototype.getRecords = function () {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getRecords();\n    };\n    SceneLayerDataSourceImpl.prototype.getSelectedRecords = function () {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getSelectedRecords();\n    };\n    SceneLayerDataSourceImpl.prototype.getSelectedRecordIndexes = function () {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getSelectedRecordIndexes();\n    };\n    SceneLayerDataSourceImpl.prototype.getSelectedRecordIds = function () {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getSelectedRecordIds();\n    };\n    SceneLayerDataSourceImpl.prototype.nextRecord = function () {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.nextRecord();\n    };\n    SceneLayerDataSourceImpl.prototype.prevRecord = function () {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.prevRecord();\n    };\n    SceneLayerDataSourceImpl.prototype.getRecord = function (index) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getRecord(index);\n    };\n    SceneLayerDataSourceImpl.prototype.getRecordById = function (id) {\n        var _a;\n        return (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.getRecordById(id);\n    };\n    SceneLayerDataSourceImpl.prototype.clearSelection = function () {\n        var _a;\n        _super.prototype.clearSelection.call(this);\n        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.clearSelection();\n    };\n    SceneLayerDataSourceImpl.prototype.addVersion = function () {\n        var _a;\n        _super.prototype.addVersion.call(this);\n        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.addVersion();\n    };\n    SceneLayerDataSourceImpl.prototype.selectRecord = function (index) {\n        var _a;\n        _super.prototype.selectRecord.call(this, index);\n        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.selectRecord(index);\n    };\n    SceneLayerDataSourceImpl.prototype.selectRecords = function (indexes) {\n        var _a;\n        _super.prototype.selectRecords.call(this, indexes);\n        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.selectRecords(indexes);\n    };\n    SceneLayerDataSourceImpl.prototype.selectRecordById = function (id, record) {\n        var _a;\n        _super.prototype.selectRecordById.call(this, id, record);\n        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.selectRecordById(id, record);\n    };\n    SceneLayerDataSourceImpl.prototype.selectRecordsByIds = function (ids, records) {\n        var _a;\n        _super.prototype.selectRecordsByIds.call(this, ids, records);\n        (_a = this.getAssociatedDataSource()) === null || _a === void 0 ? void 0 : _a.selectRecordsByIds(ids, records);\n    };\n    SceneLayerDataSourceImpl.prototype.destroy = function () {\n        var associatedDataSource = this.getAssociatedDataSource();\n        if (associatedDataSource) {\n            this.dataSourceManager.destroyDataSource(associatedDataSource.id);\n        }\n    };\n    SceneLayerDataSourceImpl.prototype._mergeAssociatedDataSourceJson = function (associatedDataSourceJson) {\n        return associatedDataSourceJson === null || associatedDataSourceJson === void 0 ? void 0 : associatedDataSourceJson.set('query', this.getDataSourceJson().query).set('dataViews', this.getDataSourceJson().dataViews);\n    };\n    return SceneLayerDataSourceImpl;\n}(_ds_base_types_abstract_queriable_data_source__WEBPACK_IMPORTED_MODULE_1__[\"AbstractQueriableDataSource\"]));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvc2NlbmUtbGF5ZXItZGF0YS1zb3VyY2UtaW1wbC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2ltcGxlbWVudGF0aW9ucy9zY2VuZS1sYXllci1kYXRhLXNvdXJjZS1pbXBsLnRzPzViMWEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU2VydmljZURlZmluaXRpb24sIGRhdGFTb3VyY2VVdGlscywgU2VydmljZU1hbmFnZXIsIElNRGF0YVNvdXJjZUpzb24sIElNRGF0YVNvdXJjZVNjaGVtYSwgSU1GaWVsZFNjaGVtYSwgSU1SZXZlcnNlZERhdGFTb3VyY2VTY2hlbWEsIElNRGF0YVNvdXJjZUluZm8sXG4gIERhdGFTb3VyY2VNYW5hZ2VyLCBJbW11dGFibGUgfSBmcm9tICdqaW11LWNvcmUnO1xuLy8gb25seSB1c2VkIGFzIHR5cGVcbmltcG9ydCB7IElGZWF0dXJlIH0gZnJvbSAnQGVzcmkvYXJjZ2lzLXJlc3QtdHlwZXMnO1xuaW1wb3J0IHsgQWJzdHJhY3RRdWVyaWFibGVEYXRhU291cmNlIH0gZnJvbSAnLi4vZHMtYmFzZS10eXBlcy9hYnN0cmFjdC1xdWVyaWFibGUtZGF0YS1zb3VyY2UnO1xuaW1wb3J0IHtcbiAgRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyxcbiAgRGF0YVNvdXJjZVR5cGVzLFxuICBTY2VuZUxheWVyRGF0YVNvdXJjZSxcbiAgSU1GZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcyxcbiAgUXVlcnlSZXN1bHQsXG4gIEZlYXR1cmVEYXRhUmVjb3JkLFxuICBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcyxcbiAgQ29kZWRWYWx1ZSxcbiAgV2lkZ2V0RGF0YVNvdXJjZVBhaXIsXG4gIFF1ZXJ5T3B0aW9ucyxcbiAgRGF0YVJlY29yZCxcbiAgUXVlcnlQYXJhbXNcbn0gZnJvbSAnLi4vZGF0YS1zb3VyY2UtaW50ZXJmYWNlJztcbmltcG9ydCB7IEZlYXR1cmVMYXllckRhdGFTb3VyY2VJbXBsLCBGZWF0dXJlTGF5ZXJEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIH0gZnJvbSAnLi9mZWF0dXJlLWxheWVyLWRhdGEtc291cmNlLWltcGwnO1xuXG5jb25zdCBBU1NPQ0lBVEVEX0RBVEFfU09VUkNFX0lEX1BPU1RGSVggPSAnQVNTT0NJQVRFRF9EQVRBX1NPVVJDRSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2NlbmVMYXllckRhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMgZXh0ZW5kcyBEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIHtcbiAgbGF5ZXI/OiBfX2VzcmkuU2NlbmVMYXllcjtcbn1cblxuZXhwb3J0IGNsYXNzIFNjZW5lTGF5ZXJEYXRhU291cmNlSW1wbCBleHRlbmRzIEFic3RyYWN0UXVlcmlhYmxlRGF0YVNvdXJjZSBpbXBsZW1lbnRzIFNjZW5lTGF5ZXJEYXRhU291cmNlIHtcbiAgcG9ydGFsVXJsPzogc3RyaW5nO1xuICBpdGVtSWQ/OiBzdHJpbmc7XG4gIGxheWVySWQ/OiBzdHJpbmc7XG5cbiAgbGF5ZXI/OiBfX2VzcmkuU2NlbmVMYXllcjtcbiAgcHJpdmF0ZSBsYXllckRlZmluaXRpb246IFNlcnZpY2VEZWZpbml0aW9uO1xuICBwcml2YXRlIGFzc29jaWF0ZWREYXRhU291cmNlOiBGZWF0dXJlTGF5ZXJEYXRhU291cmNlSW1wbDtcblxuICB1cmw6IHN0cmluZztcbiAgdHlwZTogRGF0YVNvdXJjZVR5cGVzLlNjZW5lTGF5ZXIgPSBEYXRhU291cmNlVHlwZXMuU2NlbmVMYXllcjtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBTY2VuZUxheWVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyl7XG4gICAgc3VwZXIob3B0aW9ucyk7XG4gICAgY29uc3QgZHNKc29uID0gdGhpcy5nZXREYXRhU291cmNlSnNvbigpO1xuICAgIHRoaXMucG9ydGFsVXJsID0gZHNKc29uLnBvcnRhbFVybDtcbiAgICB0aGlzLml0ZW1JZCA9IGRzSnNvbi5pdGVtSWQ7XG4gICAgdGhpcy5sYXllcklkID0gZHNKc29uLmxheWVySWQ7XG5cbiAgICBpZihvcHRpb25zLmxheWVyKXtcbiAgICAgIHRoaXMubGF5ZXIgPSBvcHRpb25zLmxheWVyO1xuICAgIH1cblxuICAgIGlmKG9wdGlvbnMuYmVsb25nVG9EYXRhU291cmNlICYmIChvcHRpb25zLmJlbG9uZ1RvRGF0YVNvdXJjZSBhcyBTY2VuZUxheWVyRGF0YVNvdXJjZSkubGF5ZXIpe1xuICAgICAgdGhpcy5sYXllciA9IChvcHRpb25zLmJlbG9uZ1RvRGF0YVNvdXJjZSBhcyBTY2VuZUxheWVyRGF0YVNvdXJjZSkubGF5ZXI7XG4gICAgfVxuXG4gICAgaWYodGhpcy5pc0xvY2FsKXtcbiAgICAgIGNvbnN0IGFzc29jaWF0ZWREYXRhU291cmNlQmVsb25nVG9EYXRhU291cmNlID0gKG9wdGlvbnMuYmVsb25nVG9EYXRhU291cmNlIGFzIFNjZW5lTGF5ZXJEYXRhU291cmNlSW1wbCk/LmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk7XG4gICAgICBpZihhc3NvY2lhdGVkRGF0YVNvdXJjZUJlbG9uZ1RvRGF0YVNvdXJjZSl7XG4gICAgICAgIERhdGFTb3VyY2VNYW5hZ2VyLmdldEluc3RhbmNlKCkuY3JlYXRlTG9jYWxEYXRhU291cmNlKGFzc29jaWF0ZWREYXRhU291cmNlQmVsb25nVG9EYXRhU291cmNlLCB0aGlzLmxvY2FsSWQpO1xuICAgICAgfVxuICAgIH1lbHNlIGlmKHRoaXMuaXNEYXRhVmlldyl7XG4gICAgICBjb25zdCBhc3NvY2lhdGVkRGF0YVNvdXJjZUJlbG9uZ1RvRGF0YVNvdXJjZSA9IChvcHRpb25zLmJlbG9uZ1RvRGF0YVNvdXJjZSBhcyBTY2VuZUxheWVyRGF0YVNvdXJjZUltcGwpPy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpO1xuICAgICAgaWYoYXNzb2NpYXRlZERhdGFTb3VyY2VCZWxvbmdUb0RhdGFTb3VyY2Upe1xuICAgICAgICBEYXRhU291cmNlTWFuYWdlci5nZXRJbnN0YW5jZSgpLmNyZWF0ZURhdGFWaWV3KGFzc29jaWF0ZWREYXRhU291cmNlQmVsb25nVG9EYXRhU291cmNlLCB0aGlzLmRhdGFWaWV3SWQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJlYWR5KCl7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFtcbiAgICAgIHRoaXMuZmV0Y2hMYXllckRlZmluaXRpb24oKSxcbiAgICAgIHRoaXMuY3JlYXRlQXNzb2NpYXRlZERhdGFTb3VyY2UoKVxuICAgIF0pLnRoZW4oKCkgPT4gc3VwZXIucmVhZHkoKSk7XG4gIH1cblxuICBjcmVhdGVBc3NvY2lhdGVkRGF0YVNvdXJjZSgpOiBQcm9taXNlPEZlYXR1cmVMYXllckRhdGFTb3VyY2VJbXBsPiB7XG4gICAgaWYodGhpcy5hc3NvY2lhdGVkRGF0YVNvdXJjZSl7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuYXNzb2NpYXRlZERhdGFTb3VyY2UpO1xuICAgIH1cbiAgICBpZih0aGlzLmxheWVyKXtcbiAgICAgIHJldHVybiB0aGlzLl9jcmVhdGVBc3NvY2lhdGVkRGF0YVNvdXJjZVdpdGhMYXllcigpLnRoZW4oYXNzb2NpYXRlZERhdGFTb3VyY2UgPT4ge1xuICAgICAgICBpZighYXNzb2NpYXRlZERhdGFTb3VyY2Upe1xuICAgICAgICAgIHJldHVybiB0aGlzLl9jcmVhdGVBc3NvY2lhdGVkRGF0YVNvdXJjZVdpdGhVcmwoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXNzb2NpYXRlZERhdGFTb3VyY2U7XG4gICAgICB9KTtcbiAgICB9ZWxzZXtcbiAgICAgIHJldHVybiB0aGlzLl9jcmVhdGVBc3NvY2lhdGVkRGF0YVNvdXJjZVdpdGhVcmwoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIF9jcmVhdGVBc3NvY2lhdGVkRGF0YVNvdXJjZVdpdGhMYXllcigpOiBQcm9taXNlPEZlYXR1cmVMYXllckRhdGFTb3VyY2VJbXBsPntcbiAgICBjb25zdCBkc0lkID0gdGhpcy5fZ2V0TmV3QXNzb2NpYXRlZERhdGFTb3VyY2VJZCgpO1xuICAgIHJldHVybiB0aGlzLmxheWVyLmxvYWQoKS50aGVuKCgpID0+IHtcbiAgICAgIGlmKCEodGhpcy5sYXllciBhcyBhbnkpLmFzc29jaWF0ZWRMYXllcil7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICBsZXQgZHNKc29uID0gSW1tdXRhYmxlKHtcbiAgICAgICAgaWQ6IGRzSWQsXG4gICAgICAgIHR5cGU6IERhdGFTb3VyY2VUeXBlcy5GZWF0dXJlTGF5ZXIsXG4gICAgICAgIHVybDogZGF0YVNvdXJjZVV0aWxzLmdldFVybEJ5TGF5ZXIoKHRoaXMubGF5ZXIgYXMgYW55KS5hc3NvY2lhdGVkTGF5ZXIgYXMgX19lc3JpLkZlYXR1cmVMYXllcilcbiAgICAgIH0pO1xuICAgICAgY29uc3Qgc2NoZW1hID0gdGhpcy5nZXREYXRhU291cmNlSnNvbigpLnNjaGVtYTtcbiAgICAgIGlmKHNjaGVtYSl7XG4gICAgICAgIGRzSnNvbiA9IGRzSnNvbi5zZXQoJ3NjaGVtYScsIHNjaGVtYSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IG9wdGlvbnM6IEZlYXR1cmVMYXllckRhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7XG4gICAgICAgIGlkOiBkc0lkLFxuICAgICAgICBkYXRhU291cmNlSnNvbjogZHNKc29uLFxuICAgICAgICBsYXllcjogKHRoaXMubGF5ZXIgYXMgYW55KS5hc3NvY2lhdGVkTGF5ZXIgYXMgX19lc3JpLkZlYXR1cmVMYXllclxuICAgICAgfTtcblxuICAgICAgcmV0dXJuIHRoaXMuZGF0YVNvdXJjZU1hbmFnZXIuY3JlYXRlRGF0YVNvdXJjZShvcHRpb25zKTtcbiAgICB9KS50aGVuKGRzID0+IHtcbiAgICAgIHRoaXMuYXNzb2NpYXRlZERhdGFTb3VyY2UgPSBkcyBhcyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlSW1wbDtcbiAgICAgIHJldHVybiB0aGlzLmFzc29jaWF0ZWREYXRhU291cmNlO1xuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBfY3JlYXRlQXNzb2NpYXRlZERhdGFTb3VyY2VXaXRoVXJsKCk6IFByb21pc2U8RmVhdHVyZUxheWVyRGF0YVNvdXJjZUltcGw+e1xuICAgIGNvbnN0IGRzSWQgPSB0aGlzLl9nZXROZXdBc3NvY2lhdGVkRGF0YVNvdXJjZUlkKCk7XG4gICAgcmV0dXJuIGRhdGFTb3VyY2VVdGlscy5mZXRjaEFzc29jaWF0ZWRGZWF0dXJlTGF5ZXJEZWZpbml0aW9uKHRoaXMudXJsLCB0aGlzLmxheWVySWQsIHRoaXMuaXRlbUlkLCB0aGlzLnBvcnRhbFVybClcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIGlmKCFyZXMpe1xuICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgnQ2FuIG5vdCBmaW5kIGFzc29jaWF0ZWQgZmVhdHVyZSBsYXllcicpO1xuICAgICAgICB9XG4gICAgICAgIGxldCBkc0pzb24gPSBkYXRhU291cmNlVXRpbHMuZ2V0U2luZ2xlRHNKc29uRnJvbUxheWVyRGVmaW5pdGlvbihkc0lkLCByZXMudXJsLCByZXMuZGVmKTtcbiAgICAgICAgZHNKc29uID0gdGhpcy5fbWVyZ2VBc3NvY2lhdGVkRGF0YVNvdXJjZUpzb24oZHNKc29uKTtcblxuICAgICAgICByZXR1cm4gZHNKc29uO1xuICAgICAgfSkudGhlbihkc0pzb24gPT4ge1xuICAgICAgICBjb25zdCBvcHRpb25zOiBGZWF0dXJlTGF5ZXJEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zID0ge1xuICAgICAgICAgIGlkOiBkc0pzb24uaWQsXG4gICAgICAgICAgZGF0YVNvdXJjZUpzb246IGRzSnNvblxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdGhpcy5kYXRhU291cmNlTWFuYWdlci5jcmVhdGVEYXRhU291cmNlKG9wdGlvbnMpO1xuICAgICAgfSkudGhlbihkcyA9PiB7XG4gICAgICAgIHRoaXMuYXNzb2NpYXRlZERhdGFTb3VyY2UgPSBkcyBhcyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlSW1wbDtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXNzb2NpYXRlZERhdGFTb3VyY2U7XG4gICAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgX2dldE5ld0Fzc29jaWF0ZWREYXRhU291cmNlSWQoKTogc3RyaW5ne1xuICAgIHJldHVybiBgJHt0aGlzLmdldERhdGFTb3VyY2VKc29uKCkuaWR9LSR7QVNTT0NJQVRFRF9EQVRBX1NPVVJDRV9JRF9QT1NURklYfWA7XG4gIH1cblxuICBmZXRjaExheWVyRGVmaW5pdGlvbigpOiBQcm9taXNlPFNlcnZpY2VEZWZpbml0aW9uPiB7XG4gICAgY29uc3QgdXJsID0gdGhpcy5nZXREYXRhU291cmNlSnNvbigpPy51cmw7XG4gICAgaWYoIXVybCl7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xuICAgIH1cblxuICAgIGlmKHRoaXMuZ2V0TGF5ZXJEZWZpbml0aW9uKCkpe1xuICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLmdldExheWVyRGVmaW5pdGlvbigpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gU2VydmljZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5mZXRjaFNlcnZpY2VJbmZvKHVybCkudGhlbihyZXMgPT4gcmVzLmRlZmluaXRpb24pXG4gICAgICAudGhlbihkZWZpbml0aW9uID0+IHtcbiAgICAgICAgaWYoIWRlZmluaXRpb24pe1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubGF5ZXJEZWZpbml0aW9uID0gZGVmaW5pdGlvbjtcbiAgICAgICAgcmV0dXJuIGRlZmluaXRpb247XG4gICAgICB9KTtcbiAgfVxuXG4gIGdldExheWVyRGVmaW5pdGlvbigpOiBTZXJ2aWNlRGVmaW5pdGlvbntcbiAgICBpZih0aGlzLmlzRGF0YVZpZXcgfHwgdGhpcy5pc0xvY2FsKXtcbiAgICAgIHJldHVybiAodGhpcy5nZXRNYWluRGF0YVNvdXJjZSgpIGFzIFNjZW5lTGF5ZXJEYXRhU291cmNlKS5nZXRMYXllckRlZmluaXRpb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMubGF5ZXJEZWZpbml0aW9uO1xuICB9XG5cbiAgZ2V0SW5mbygpOiBJTURhdGFTb3VyY2VJbmZvIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5nZXRJbmZvKCk7XG4gIH1cblxuICBmZXRjaFNjaGVtYSgpe1xuICAgIHJldHVybiB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmZldGNoU2NoZW1hKCk7XG4gIH1cblxuICBnZXRTY2hlbWEoKTogSU1EYXRhU291cmNlU2NoZW1hIHtcbiAgICBjb25zdCBhc3NvY2lhdGVkTGF5ZXJTY2hlbWEgPSB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmdldFNjaGVtYSgpO1xuICAgIGNvbnN0IHNjZW5lTGF5ZXJTY2hlbWEgPSBJbW11dGFibGUoe2xhYmVsOiB0aGlzLmxheWVyPy50aXRsZSB8fHRoaXMuZ2V0TGF5ZXJEZWZpbml0aW9uKCk/Lm5hbWV9KTtcbiAgICByZXR1cm4gYXNzb2NpYXRlZExheWVyU2NoZW1hID8gYXNzb2NpYXRlZExheWVyU2NoZW1hLm1lcmdlKHNjZW5lTGF5ZXJTY2hlbWEpIDogc2NlbmVMYXllclNjaGVtYTtcbiAgfVxuXG4gIHNldFNjaGVtYShzY2hlbWE6IElNRGF0YVNvdXJjZVNjaGVtYSkge1xuICAgIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uc2V0U2NoZW1hKHNjaGVtYSk7XG4gIH1cblxuICBzZXREYXRhU291cmNlSnNvbihkc0pzb246IElNRGF0YVNvdXJjZUpzb24pe1xuICAgIHN1cGVyLnNldERhdGFTb3VyY2VKc29uKGRzSnNvbik7XG4gICAgY29uc3QgYSA9IHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKTtcbiAgICBpZihhKXtcbiAgICAgIGNvbnN0IGFEc0pzb24gPSB0aGlzLl9tZXJnZUFzc29jaWF0ZWREYXRhU291cmNlSnNvbihhLmdldERhdGFTb3VyY2VKc29uKCkpO1xuICAgICAgYS5zZXREYXRhU291cmNlSnNvbihhRHNKc29uKTtcbiAgICB9XG4gIH1cblxuICBnZXRGZXRjaGVkU2NoZW1hKCk6IElNRGF0YVNvdXJjZVNjaGVtYSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZ2V0RmV0Y2hlZFNjaGVtYSgpO1xuICB9XG5cbiAgc2V0RmV0Y2hlZFNjaGVtYShmZXRjaGVkU2NoZW1hOiBJTURhdGFTb3VyY2VTY2hlbWEpIHtcbiAgICB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LnNldEZldGNoZWRTY2hlbWEoZmV0Y2hlZFNjaGVtYSk7XG4gIH1cblxuICBnZXRSZXZlcnNlZENvbmZpZ1NjaGVtYSgpOiBJTVJldmVyc2VkRGF0YVNvdXJjZVNjaGVtYSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZ2V0UmV2ZXJzZWRDb25maWdTY2hlbWEoKTtcbiAgfVxuXG4gIGdldFNlbGVjdGVkRmllbGRzKCk6IHsgW2ppbXVOYW1lOiBzdHJpbmddOiBJTUZpZWxkU2NoZW1hIH17XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZ2V0U2VsZWN0ZWRGaWVsZHMoKTtcbiAgfVxuXG4gIGdldElkRmllbGQoKTogc3RyaW5ne1xuICAgIHJldHVybiB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmdldElkRmllbGQoKTtcbiAgfVxuXG4gIHNldEpzb25EYXRhKGRhdGE6IChJRmVhdHVyZSB8IF9fZXNyaS5HcmFwaGljKVtdKXtcbiAgICB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LnNldEpzb25EYXRhKGRhdGEpO1xuICB9XG5cbiAgcXVlcnlCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPEZlYXR1cmVEYXRhUmVjb3JkPntcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5xdWVyeUJ5SWQoaWQpO1xuICB9XG5cbiAgYWRkUmVjb3JkKHJlY29yZDogRmVhdHVyZURhdGFSZWNvcmQpOiBQcm9taXNlPEZlYXR1cmVEYXRhUmVjb3JkPiB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uYWRkUmVjb3JkKHJlY29yZCk7XG4gIH1cblxuICB1cGRhdGVSZWNvcmQocmVjb3JkOiBEYXRhUmVjb3JkKTogUHJvbWlzZTxEYXRhUmVjb3JkPiB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8udXBkYXRlUmVjb3JkKHJlY29yZCk7XG4gIH1cblxuICBkZWxldGVSZWNvcmQoaW5kZXg6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmRlbGV0ZVJlY29yZChpbmRleCk7XG4gIH1cblxuICBkb1F1ZXJ5KHF1ZXJ5UHJvcGVydGllczogSU1GZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcyk6IFByb21pc2U8UXVlcnlSZXN1bHQ+e1xuICAgIHJldHVybiB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmRvUXVlcnkocXVlcnlQcm9wZXJ0aWVzKTtcbiAgfVxuXG4gIGRvUXVlcnlCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPEZlYXR1cmVEYXRhUmVjb3JkPntcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5kb1F1ZXJ5QnlJZChpZCk7XG4gIH1cblxuICBkb1F1ZXJ5Q291bnQocXVlcnlQcm9wZXJ0aWVzOiBJTUZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zKTogUHJvbWlzZTxRdWVyeVJlc3VsdD57XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZG9RdWVyeUNvdW50KHF1ZXJ5UHJvcGVydGllcyk7XG4gIH1cblxuICBnZXRDb25maWdRdWVyeVBhcmFtcygpOiBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtc3tcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5nZXRDb25maWdRdWVyeVBhcmFtcygpO1xuICB9XG5cbiAgZ2V0UmVtb3RlUXVlcnlQYXJhbXMoKTogRmVhdHVyZUxheWVyUXVlcnlQYXJhbXN7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZ2V0UmVtb3RlUXVlcnlQYXJhbXMoKTtcbiAgfVxuXG4gIGdldEN1cnJlbnRRdWVyeVBhcmFtcyhleGNsdWRlT3B0aW9uPzogV2lkZ2V0RGF0YVNvdXJjZVBhaXIpOiBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtc3tcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5nZXRDdXJyZW50UXVlcnlQYXJhbXMoZXhjbHVkZU9wdGlvbik7XG4gIH1cblxuICBnZXRSdW50aW1lUXVlcnlQYXJhbXNnZXRSdW50aW1lUXVlcnlQYXJhbXMoZXhjbHVkZVdpZGdldElkPzogc3RyaW5nKXtcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5nZXRSdW50aW1lUXVlcnlQYXJhbXMoZXhjbHVkZVdpZGdldElkKTtcbiAgfVxuXG4gIGdldEN1cnJlbnRRdWVyeUlkKCl7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZ2V0Q3VycmVudFF1ZXJ5SWQoKTtcbiAgfVxuXG4gIG1lcmdlUXVlcnlQYXJhbXMoYmFzZVF1ZXJ5OiBGZWF0dXJlTGF5ZXJRdWVyeVBhcmFtcywgbmV3UXVlcnk6IEZlYXR1cmVMYXllclF1ZXJ5UGFyYW1zKTogRmVhdHVyZUxheWVyUXVlcnlQYXJhbXN7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8ubWVyZ2VRdWVyeVBhcmFtcyhiYXNlUXVlcnksIG5ld1F1ZXJ5KTtcbiAgfVxuXG4gIGdldEZpZWxkQ29kZWRWYWx1ZUxpc3QoamltdUZpZWxkTmFtZTogc3RyaW5nLCByZWNvcmQ/OiBGZWF0dXJlRGF0YVJlY29yZCk6IENvZGVkVmFsdWVbXSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZ2V0RmllbGRDb2RlZFZhbHVlTGlzdChqaW11RmllbGROYW1lLCByZWNvcmQpO1xuICB9XG5cbiAgZ2V0UmVhbFF1ZXJ5UGFyYW1zKHF1ZXJ5LCBmbGFnOiAncXVlcnknIHwgJ2xvYWQnLCBvcHRpb25zPzogUXVlcnlPcHRpb25zKTogRmVhdHVyZUxheWVyUXVlcnlQYXJhbXN7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZ2V0UmVhbFF1ZXJ5UGFyYW1zKHF1ZXJ5LCBmbGFnLCBvcHRpb25zKTtcbiAgfVxuXG4gIHVwZGF0ZVF1ZXJ5UGFyYW1zKHF1ZXJ5OiBRdWVyeVBhcmFtcywgd2lkZ2V0SWQ6IHN0cmluZyl7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8udXBkYXRlUXVlcnlQYXJhbXMocXVlcnksIHdpZGdldElkKTtcbiAgfVxuXG4gIGdldEdEQlZlcnNpb24oKTogc3RyaW5ne1xuICAgIHJldHVybiB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmdldEdEQlZlcnNpb24oKTtcbiAgfVxuXG4gIGdldFF1ZXJ5UGFnZVNpemUoKTogbnVtYmVye1xuICAgIHJldHVybiB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmdldFF1ZXJ5UGFnZVNpemUoKTtcbiAgfVxuXG4gIGdldE1heFJlY29yZENvdW50KCk6IG51bWJlcntcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5nZXRNYXhSZWNvcmRDb3VudCgpO1xuICB9XG5cbiAgZ2V0UmVjb3Jkc0J5UGFnZShwYWdlOiBudW1iZXIsIHBhZ2VTaXplOiBudW1iZXIpOiBEYXRhUmVjb3JkW117XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZ2V0UmVjb3Jkc0J5UGFnZShwYWdlLCBwYWdlU2l6ZSk7XG4gIH1cblxuICBnZXRQYWdlc0RhdGEoKToge1twYWdlOiBudW1iZXJdOiBEYXRhUmVjb3JkW119e1xuICAgIHJldHVybiB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmdldFBhZ2VzRGF0YSgpO1xuICB9XG5cbiAgc2V0UGFnZXNEYXRhKHBhZ2VzOiB7W3BhZ2U6IG51bWJlcl06IERhdGFSZWNvcmRbXX0pe1xuICAgIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uc2V0UGFnZXNEYXRhKHBhZ2VzKTtcbiAgfVxuXG4gIGdldFJlYWxRdWVyeVBhZ2VzKHBhZ2U6IG51bWJlciwgcGFnZVNpemU6IG51bWJlcik6IG51bWJlcltde1xuICAgIHJldHVybiB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmdldFJlYWxRdWVyeVBhZ2VzKHBhZ2UsIHBhZ2VTaXplKTtcbiAgfVxuXG4gIGxvYWQocXVlcnk6IFF1ZXJ5UGFyYW1zLCBvcHRpb25zOiBRdWVyeU9wdGlvbnMgPSB7fSk6IFByb21pc2U8RGF0YVJlY29yZFtdPiB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8ubG9hZChxdWVyeSwgb3B0aW9ucyk7XG4gIH1cblxuICBsb2FkQ291bnQocXVlcnk6IFF1ZXJ5UGFyYW1zLCBvcHRpb25zOiBRdWVyeU9wdGlvbnMgPSB7fSk6IFByb21pc2U8bnVtYmVyPntcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5sb2FkQ291bnQocXVlcnksIG9wdGlvbnMpO1xuICB9XG5cbiAgcXVlcnkocXVlcnk6IFF1ZXJ5UGFyYW1zLCBvcHRpb25zPzogUXVlcnlPcHRpb25zKTogUHJvbWlzZTxRdWVyeVJlc3VsdD57XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8ucXVlcnkocXVlcnksIG9wdGlvbnMpO1xuICB9XG5cbiAgcXVlcnlDb3VudChxdWVyeTogUXVlcnlQYXJhbXMsIG9wdGlvbnM/OiBRdWVyeU9wdGlvbnMpOiBQcm9taXNlPFF1ZXJ5UmVzdWx0PntcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5xdWVyeUNvdW50KHF1ZXJ5LCBvcHRpb25zKTtcbiAgfVxuXG4gIGxvYWRCeUlkKGlkOiBzdHJpbmcsIHJlZnJlc2g/OiBib29sZWFuKTogUHJvbWlzZTxEYXRhUmVjb3JkPiB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8ubG9hZEJ5SWQoaWQsIHJlZnJlc2gpO1xuICB9XG5cbiAgY2hhbmdlR0RCVmVyc2lvbihnZGJWZXJzaW9uOiBzdHJpbmcpe1xuICAgIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uY2hhbmdlR0RCVmVyc2lvbihnZGJWZXJzaW9uKTtcbiAgfVxuXG4gIGdldEFzc29jaWF0ZWREYXRhU291cmNlKCk6IEZlYXR1cmVMYXllckRhdGFTb3VyY2VJbXBse1xuICAgIGlmKCF0aGlzLmlzRGF0YVZpZXcgJiYgIXRoaXMuaXNMb2NhbCl7XG4gICAgICByZXR1cm4gdGhpcy5hc3NvY2lhdGVkRGF0YVNvdXJjZTtcbiAgICB9XG5cbiAgICBjb25zdCByZWFsQXNzb0RzSWQgPSB0aGlzLl9nZXRSZWFsQXNzb2NpYXRlZERhdGFTb3VyY2VJZCgpO1xuICAgIHJldHVybiBEYXRhU291cmNlTWFuYWdlci5nZXRJbnN0YW5jZSgpLmdldERhdGFTb3VyY2UocmVhbEFzc29Ec0lkKSBhcyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlSW1wbDtcbiAgfVxuXG4gIHByaXZhdGUgX2dldFJlYWxBc3NvY2lhdGVkRGF0YVNvdXJjZUlkKCk6IHN0cmluZ3tcbiAgICBsZXQgcmVhbEFzc29Ec0lkO1xuICAgIGNvbnN0IGJlbG9uZ1RvQXNzb0RzID0gKHRoaXMuYmVsb25nVG9EYXRhU291cmNlIGFzIFNjZW5lTGF5ZXJEYXRhU291cmNlSW1wbCk/LmFzc29jaWF0ZWREYXRhU291cmNlO1xuICAgIGlmKHRoaXMuaXNMb2NhbCl7XG4gICAgICByZWFsQXNzb0RzSWQgPSBEYXRhU291cmNlTWFuYWdlci5nZXRJbnN0YW5jZSgpLmdldExvY2FsRGF0YVNvdXJjZUlkKGJlbG9uZ1RvQXNzb0RzPy5pZCwgdGhpcy5sb2NhbElkKTtcbiAgICB9ZWxzZSBpZih0aGlzLmlzRGF0YVZpZXcpe1xuICAgICAgcmVhbEFzc29Ec0lkID0gRGF0YVNvdXJjZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS5nZXREYXRhVmlld0RhdGFTb3VyY2VJZChiZWxvbmdUb0Fzc29Ecz8uaWQsIHRoaXMuZGF0YVZpZXdJZCk7XG4gICAgfWVsc2V7XG4gICAgICByZWFsQXNzb0RzSWQgPSB0aGlzLmFzc29jaWF0ZWREYXRhU291cmNlLmlkO1xuICAgIH1cbiAgICByZXR1cm4gcmVhbEFzc29Ec0lkO1xuICB9XG5cbiAgY2xlYXJEYXRhKCl7XG4gICAgdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5jbGVhckRhdGEoKTtcbiAgfVxuXG4gIHNldFJlY29yZHMocmVjb3JkczogRGF0YVJlY29yZFtdKSB7XG4gICAgc3VwZXIuYWRkVmVyc2lvbigpO1xuICAgIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uc2V0UmVjb3JkcyhyZWNvcmRzKTtcbiAgfVxuXG4gIGdldFJlY29yZHMoKTogRGF0YVJlY29yZFtdIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5nZXRSZWNvcmRzKCk7XG4gIH1cblxuICBnZXRTZWxlY3RlZFJlY29yZHMoKTogRGF0YVJlY29yZFtdIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5nZXRTZWxlY3RlZFJlY29yZHMoKTtcbiAgfVxuXG4gIGdldFNlbGVjdGVkUmVjb3JkSW5kZXhlcygpOiBudW1iZXJbXSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZ2V0U2VsZWN0ZWRSZWNvcmRJbmRleGVzKCk7XG4gIH1cblxuICBnZXRTZWxlY3RlZFJlY29yZElkcygpOiBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uZ2V0U2VsZWN0ZWRSZWNvcmRJZHMoKTtcbiAgfVxuXG4gIG5leHRSZWNvcmQoKTogRGF0YVJlY29yZCB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8ubmV4dFJlY29yZCgpO1xuICB9XG5cbiAgcHJldlJlY29yZCgpOiBEYXRhUmVjb3JkIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5wcmV2UmVjb3JkKCk7XG4gIH1cblxuICBnZXRSZWNvcmQoaW5kZXg6IG51bWJlcik6IERhdGFSZWNvcmQge1xuICAgIHJldHVybiB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmdldFJlY29yZChpbmRleCk7XG4gIH1cblxuICBnZXRSZWNvcmRCeUlkKGlkOiBzdHJpbmcpOiBEYXRhUmVjb3JkIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5nZXRSZWNvcmRCeUlkKGlkKTtcbiAgfVxuXG4gIGNsZWFyU2VsZWN0aW9uKCl7XG4gICAgc3VwZXIuY2xlYXJTZWxlY3Rpb24oKTtcbiAgICB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmNsZWFyU2VsZWN0aW9uKCk7XG4gIH1cblxuICBhZGRWZXJzaW9uKCkge1xuICAgIHN1cGVyLmFkZFZlcnNpb24oKTtcbiAgICB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LmFkZFZlcnNpb24oKTtcbiAgfVxuXG4gIHNlbGVjdFJlY29yZChpbmRleDogbnVtYmVyKSB7XG4gICAgc3VwZXIuc2VsZWN0UmVjb3JkKGluZGV4KTtcbiAgICB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LnNlbGVjdFJlY29yZChpbmRleCk7XG4gIH1cblxuICBzZWxlY3RSZWNvcmRzKGluZGV4ZXM6IG51bWJlcltdKSB7XG4gICAgc3VwZXIuc2VsZWN0UmVjb3JkcyhpbmRleGVzKTtcbiAgICB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk/LnNlbGVjdFJlY29yZHMoaW5kZXhlcyk7XG4gIH1cblxuICBzZWxlY3RSZWNvcmRCeUlkKGlkOiBzdHJpbmcsIHJlY29yZD86IERhdGFSZWNvcmQpIHtcbiAgICBzdXBlci5zZWxlY3RSZWNvcmRCeUlkKGlkLCByZWNvcmQpO1xuICAgIHRoaXMuZ2V0QXNzb2NpYXRlZERhdGFTb3VyY2UoKT8uc2VsZWN0UmVjb3JkQnlJZChpZCwgcmVjb3JkKTtcbiAgfVxuXG4gIHNlbGVjdFJlY29yZHNCeUlkcyhpZHM6IHN0cmluZ1tdLCByZWNvcmRzPzogRGF0YVJlY29yZFtdKSB7XG4gICAgc3VwZXIuc2VsZWN0UmVjb3Jkc0J5SWRzKGlkcywgcmVjb3Jkcyk7XG4gICAgdGhpcy5nZXRBc3NvY2lhdGVkRGF0YVNvdXJjZSgpPy5zZWxlY3RSZWNvcmRzQnlJZHMoaWRzLCByZWNvcmRzKTtcbiAgfVxuXG4gIGRlc3Ryb3koKSB7XG4gICAgY29uc3QgYXNzb2NpYXRlZERhdGFTb3VyY2UgPSB0aGlzLmdldEFzc29jaWF0ZWREYXRhU291cmNlKCk7XG4gICAgaWYoYXNzb2NpYXRlZERhdGFTb3VyY2Upe1xuICAgICAgdGhpcy5kYXRhU291cmNlTWFuYWdlci5kZXN0cm95RGF0YVNvdXJjZShhc3NvY2lhdGVkRGF0YVNvdXJjZS5pZCk7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBfbWVyZ2VBc3NvY2lhdGVkRGF0YVNvdXJjZUpzb24oYXNzb2NpYXRlZERhdGFTb3VyY2VKc29uOiBJTURhdGFTb3VyY2VKc29uKTogSU1EYXRhU291cmNlSnNvbntcbiAgICByZXR1cm4gYXNzb2NpYXRlZERhdGFTb3VyY2VKc29uPy5zZXQoJ3F1ZXJ5JywgdGhpcy5nZXREYXRhU291cmNlSnNvbigpLnF1ZXJ5KS5zZXQoJ2RhdGFWaWV3cycsIHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5kYXRhVmlld3MpO1xuICB9XG5cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBSUE7QUFDQTtBQWdCQTtBQU1BO0FBQUE7QUFZQTs7QUFBQTtBQUZBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBOztBQUFBO0FBQ0E7QUFDQTtBQUVBOztBQUFBO0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUVBOztBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFBQTs7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./jimu-core/lib/data-sources/implementations/scene-layer-data-source-impl.ts\n");

/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/scene-service-data-source-impl.ts":
/*!**************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/scene-service-data-source-impl.ts ***!
  \**************************************************************************************/
/*! exports provided: SceneServiceDataSourceImpl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SceneServiceDataSourceImpl\", function() { return SceneServiceDataSourceImpl; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _ds_base_types_abstract_set_data_source__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ds-base-types/abstract-set-data-source */ \"./jimu-core/lib/data-sources/ds-base-types/abstract-set-data-source.ts\");\n/* harmony import */ var _data_source_interface__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../data-source-interface */ \"./jimu-core/lib/data-sources/data-source-interface.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (undefined && undefined.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\n\n\n\nvar SceneServiceDataSourceImpl = /** @class */ (function (_super) {\n    __extends(SceneServiceDataSourceImpl, _super);\n    function SceneServiceDataSourceImpl(options) {\n        var _this = _super.call(this, options) || this;\n        _this.type = _data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceTypes\"].SceneService;\n        return _this;\n    }\n    SceneServiceDataSourceImpl.prototype.ready = function () {\n        var _this = this;\n        return this.fetchServiceDefinition().then(function () { return _super.prototype.ready.call(_this); });\n    };\n    SceneServiceDataSourceImpl.prototype.getServiceDefinition = function () {\n        if (this.isDataView || this.isLocal) {\n            return this.getMainDataSource().getServiceDefinition();\n        }\n        return this.serviceDefinition;\n    };\n    SceneServiceDataSourceImpl.prototype._createChildDataSources = function () {\n        var _this = this;\n        var _a;\n        var supportedLayerDefinitionsPromises;\n        if ((_a = this.getDataSourceJson()) === null || _a === void 0 ? void 0 : _a.url) {\n            supportedLayerDefinitionsPromises = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].fetchSupportedLayerDefinitions(this.getDataSourceJson().url, this.getServiceDefinition())\n                .then(function (res) { return Object.keys(res).map(function (url) { return ({ def: res[url], url: url }); }); });\n        }\n        if (supportedLayerDefinitionsPromises) {\n            this._childDataSourcesPromise = supportedLayerDefinitionsPromises.then(function (res) {\n                return _this._getDsJsonsFromSupportedLayerDefinitions(res && res.map(function (r) { var _a; return (__assign(__assign({}, r), { url: (_a = _this.getDataSourceJson()) === null || _a === void 0 ? void 0 : _a.url })); }), _this.getDataSourceJson());\n            }).then(function (dsJsons) {\n                var promises = [];\n                dsJsons.forEach(function (dsJson) {\n                    var options = {\n                        id: dsJson.id,\n                        dataSourceJson: dsJson.without('jimuChildId'),\n                        parentDataSource: _this,\n                        jimuChildId: dsJson.jimuChildId\n                    };\n                    promises.push(_this.dataSourceManager.createDataSource(options));\n                });\n                return Promise.all(promises);\n            });\n        }\n        return this._childDataSourcesPromise;\n    };\n    SceneServiceDataSourceImpl.prototype.fetchSchema = function () {\n        var _a;\n        var dss = this.getChildDataSources();\n        var schema = Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"Immutable\"])({ childSchemas: {}, label: (_a = this.getServiceDefinition()) === null || _a === void 0 ? void 0 : _a.name });\n        dss.map(function (ds, i) {\n            var _a;\n            var layerSchema = ds.getFetchedSchema();\n            var definition = (_a = ds) === null || _a === void 0 ? void 0 : _a.getLayerDefinition();\n            schema = schema.setIn(['childSchemas', jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].fixLayerId((definition === null || definition === void 0 ? void 0 : definition.name) || \"\" + (definition === null || definition === void 0 ? void 0 : definition.id))], layerSchema);\n        });\n        return Promise.resolve(schema);\n    };\n    SceneServiceDataSourceImpl.prototype.fetchServiceDefinition = function () {\n        var _this = this;\n        var _a;\n        var url = (_a = this.getDataSourceJson()) === null || _a === void 0 ? void 0 : _a.url;\n        if (!url) {\n            return Promise.resolve(null);\n        }\n        if (this.getServiceDefinition()) {\n            return Promise.resolve(this.getServiceDefinition());\n        }\n        return jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"ServiceManager\"].getInstance().fetchServiceInfo(url).then(function (res) { return res.definition; })\n            .then(function (definition) {\n            if (!definition) {\n                return null;\n            }\n            _this.serviceDefinition = definition;\n            return definition;\n        });\n    };\n    SceneServiceDataSourceImpl.prototype._getDsJsonsFromSupportedLayerDefinitions = function (res, dsJsonInConfig) {\n        var _this = this;\n        if (!res) {\n            return [];\n        }\n        var dsJsons = [];\n        res.forEach(function (r) {\n            var url = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getFullServiceUrl(r.url, true, r.def);\n            _this._getDsJsonsFromSingleLayerDefinition(url, r.def, dsJsonInConfig).forEach(function (dsJson) {\n                dsJsons = dsJsons.concat(dsJson);\n            });\n        });\n        return dsJsons;\n    };\n    SceneServiceDataSourceImpl.prototype._getDsJsonsFromSingleLayerDefinition = function (url, layerDefinition, dsJsonInConfig) {\n        var _this = this;\n        if (!layerDefinition) {\n            return [];\n        }\n        var dsJsons = [];\n        var singleDsJson;\n        var jimuChildIds = this.getJimuChildId(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].fixLayerId(layerDefinition.name || \"\" + layerDefinition.id));\n        jimuChildIds.forEach(function (jimuChildId) {\n            var _a, _b;\n            var schema = _this.getDataSourceJson().schema ? _this.getDataSourceJson().schema.childSchemas[jimuChildId] : null;\n            var dsId = _this.getChildDataSourceId(jimuChildId);\n            if (jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].isSupportedSingleLayerService(url)) {\n                singleDsJson = jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"dataSourceUtils\"].getSingleDsJsonFromLayerDefinition(dsId, url, layerDefinition, (dsJsonInConfig === null || dsJsonInConfig === void 0 ? void 0 : dsJsonInConfig.childDataSourceJsons) && dsJsonInConfig.childDataSourceJsons[jimuChildId] ? dsJsonInConfig.childDataSourceJsons[jimuChildId] : null);\n            }\n            if (singleDsJson) {\n                if ((_a = _this.getDataSourceJson()) === null || _a === void 0 ? void 0 : _a.portalUrl) {\n                    singleDsJson = singleDsJson.set('portalUrl', _this.getDataSourceJson().portalUrl);\n                }\n                if ((_b = _this.getDataSourceJson()) === null || _b === void 0 ? void 0 : _b.itemId) {\n                    singleDsJson = singleDsJson.set('itemId', _this.getDataSourceJson().itemId);\n                }\n                if (schema) {\n                    singleDsJson = singleDsJson.set('schema', schema);\n                }\n                dsJsons = dsJsons.concat(singleDsJson.set('jimuChildId', jimuChildId));\n            }\n        });\n        return dsJsons;\n    };\n    return SceneServiceDataSourceImpl;\n}(_ds_base_types_abstract_set_data_source__WEBPACK_IMPORTED_MODULE_1__[\"AbstractSetDataSource\"]));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvc2NlbmUtc2VydmljZS1kYXRhLXNvdXJjZS1pbXBsLnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vamltdS1jb3JlL2xpYi9kYXRhLXNvdXJjZXMvaW1wbGVtZW50YXRpb25zL3NjZW5lLXNlcnZpY2UtZGF0YS1zb3VyY2UtaW1wbC50cz9kZjY4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IElNRGF0YVNvdXJjZUpzb24sIElNRGF0YVNvdXJjZVNjaGVtYSwgSW1tdXRhYmxlLCBTZXJ2aWNlRGVmaW5pdGlvbiwgZGF0YVNvdXJjZVV0aWxzLCBTZXJ2aWNlTWFuYWdlciB9IGZyb20gJ2ppbXUtY29yZSc7XG5pbXBvcnQgeyBBYnN0cmFjdFNldERhdGFTb3VyY2UgfSBmcm9tICcuLi9kcy1iYXNlLXR5cGVzL2Fic3RyYWN0LXNldC1kYXRhLXNvdXJjZSc7XG5pbXBvcnQge1xuICBEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zLFxuICBEYXRhU291cmNlVHlwZXMsXG4gIERhdGFTb3VyY2UsXG4gIFNjZW5lU2VydmljZURhdGFTb3VyY2UsXG4gIFNjZW5lTGF5ZXJEYXRhU291cmNlXG59IGZyb20gJy4uL2RhdGEtc291cmNlLWludGVyZmFjZSc7XG5pbXBvcnQgeyBTY2VuZUxheWVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyB9IGZyb20gJy4vc2NlbmUtbGF5ZXItZGF0YS1zb3VyY2UtaW1wbCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2NlbmVTZXJ2aWNlRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyBleHRlbmRzIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMge1xuXG59XG5cbmV4cG9ydCBjbGFzcyBTY2VuZVNlcnZpY2VEYXRhU291cmNlSW1wbCBleHRlbmRzIEFic3RyYWN0U2V0RGF0YVNvdXJjZSBpbXBsZW1lbnRzIFNjZW5lU2VydmljZURhdGFTb3VyY2Uge1xuICB0eXBlOiBEYXRhU291cmNlVHlwZXMuU2NlbmVTZXJ2aWNlID0gRGF0YVNvdXJjZVR5cGVzLlNjZW5lU2VydmljZTtcbiAgcHJpdmF0ZSBzZXJ2aWNlRGVmaW5pdGlvbjogU2VydmljZURlZmluaXRpb247XG5cbiAgY29uc3RydWN0b3Iob3B0aW9uczogU2NlbmVTZXJ2aWNlRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyl7XG4gICAgc3VwZXIob3B0aW9ucyk7XG4gIH1cblxuICByZWFkeSgpe1xuICAgIHJldHVybiB0aGlzLmZldGNoU2VydmljZURlZmluaXRpb24oKS50aGVuKCgpID0+IHN1cGVyLnJlYWR5KCkpO1xuICB9XG5cbiAgZ2V0U2VydmljZURlZmluaXRpb24oKTogU2VydmljZURlZmluaXRpb257XG4gICAgaWYodGhpcy5pc0RhdGFWaWV3IHx8IHRoaXMuaXNMb2NhbCl7XG4gICAgICByZXR1cm4gKHRoaXMuZ2V0TWFpbkRhdGFTb3VyY2UoKSBhcyBTY2VuZVNlcnZpY2VEYXRhU291cmNlKS5nZXRTZXJ2aWNlRGVmaW5pdGlvbigpO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcy5zZXJ2aWNlRGVmaW5pdGlvbjtcbiAgfVxuXG4gIHByb3RlY3RlZCBfY3JlYXRlQ2hpbGREYXRhU291cmNlcygpOiBQcm9taXNlPERhdGFTb3VyY2VbXT57XG4gICAgbGV0IHN1cHBvcnRlZExheWVyRGVmaW5pdGlvbnNQcm9taXNlczogUHJvbWlzZTx7ZGVmOiBTZXJ2aWNlRGVmaW5pdGlvbiwgdXJsPzogc3RyaW5nfVtdPjtcbiAgICBpZih0aGlzLmdldERhdGFTb3VyY2VKc29uKCk/LnVybCl7XG4gICAgICBzdXBwb3J0ZWRMYXllckRlZmluaXRpb25zUHJvbWlzZXMgPSBkYXRhU291cmNlVXRpbHMuZmV0Y2hTdXBwb3J0ZWRMYXllckRlZmluaXRpb25zKHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS51cmwsIHRoaXMuZ2V0U2VydmljZURlZmluaXRpb24oKSlcbiAgICAgICAgLnRoZW4ocmVzID0+IE9iamVjdC5rZXlzKHJlcykubWFwKHVybCA9PiAoe2RlZjogcmVzW3VybF0sIHVybH0pKSk7XG4gICAgfVxuXG4gICAgaWYoc3VwcG9ydGVkTGF5ZXJEZWZpbml0aW9uc1Byb21pc2VzKXtcbiAgICAgIHRoaXMuX2NoaWxkRGF0YVNvdXJjZXNQcm9taXNlID0gc3VwcG9ydGVkTGF5ZXJEZWZpbml0aW9uc1Byb21pc2VzLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dldERzSnNvbnNGcm9tU3VwcG9ydGVkTGF5ZXJEZWZpbml0aW9ucyhcbiAgICAgICAgICByZXMgJiYgcmVzLm1hcChyID0+ICh7Li4uciwgdXJsOiB0aGlzLmdldERhdGFTb3VyY2VKc29uKCk/LnVybH0pKSxcbiAgICAgICAgICB0aGlzLmdldERhdGFTb3VyY2VKc29uKClcbiAgICAgICAgKTtcbiAgICAgIH0pLnRoZW4oZHNKc29ucyA9PiB7XG4gICAgICAgIGNvbnN0IHByb21pc2VzOiBQcm9taXNlPERhdGFTb3VyY2U+W10gPSBbXTtcbiAgICAgICAgZHNKc29ucy5mb3JFYWNoKGRzSnNvbiA9PiB7XG4gICAgICAgICAgY29uc3Qgb3B0aW9uczogU2NlbmVMYXllckRhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMgPSB7XG4gICAgICAgICAgICBpZDogZHNKc29uLmlkLFxuICAgICAgICAgICAgZGF0YVNvdXJjZUpzb246IChkc0pzb24gYXMgYW55KS53aXRob3V0KCdqaW11Q2hpbGRJZCcpLCAvLyB3ZSBkbyBub3Qgc2F2ZSBqaW11Q2hpbGRJZCBpbiBjb25maWdcbiAgICAgICAgICAgIHBhcmVudERhdGFTb3VyY2U6IHRoaXMsXG4gICAgICAgICAgICBqaW11Q2hpbGRJZDogKGRzSnNvbiBhcyBhbnkpLmppbXVDaGlsZElkXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHByb21pc2VzLnB1c2godGhpcy5kYXRhU291cmNlTWFuYWdlci5jcmVhdGVEYXRhU291cmNlKG9wdGlvbnMpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBQcm9taXNlLmFsbChwcm9taXNlcyk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5fY2hpbGREYXRhU291cmNlc1Byb21pc2U7XG4gIH1cblxuICBmZXRjaFNjaGVtYSgpe1xuICAgIGNvbnN0IGRzcyA9IHRoaXMuZ2V0Q2hpbGREYXRhU291cmNlcygpIGFzIERhdGFTb3VyY2VbXTtcblxuICAgIGxldCBzY2hlbWE6IElNRGF0YVNvdXJjZVNjaGVtYSA9IEltbXV0YWJsZSh7Y2hpbGRTY2hlbWFzOiB7fSwgbGFiZWw6IHRoaXMuZ2V0U2VydmljZURlZmluaXRpb24oKT8ubmFtZX0pIGFzIElNRGF0YVNvdXJjZVNjaGVtYTtcbiAgICBkc3MubWFwKChkczogU2NlbmVMYXllckRhdGFTb3VyY2UsIGkpID0+IHtcbiAgICAgIGNvbnN0IGxheWVyU2NoZW1hID0gZHMuZ2V0RmV0Y2hlZFNjaGVtYSgpO1xuICAgICAgY29uc3QgZGVmaW5pdGlvbiA9IChkcyBhcyBTY2VuZUxheWVyRGF0YVNvdXJjZSk/LmdldExheWVyRGVmaW5pdGlvbigpO1xuXG4gICAgICBzY2hlbWEgPSBzY2hlbWEuc2V0SW4oWydjaGlsZFNjaGVtYXMnLCBkYXRhU291cmNlVXRpbHMuZml4TGF5ZXJJZChkZWZpbml0aW9uPy5uYW1lIHx8IGAke2RlZmluaXRpb24/LmlkfWApXSwgbGF5ZXJTY2hlbWEpO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShzY2hlbWEpO1xuICB9XG5cbiAgZmV0Y2hTZXJ2aWNlRGVmaW5pdGlvbigpOiBQcm9taXNlPFNlcnZpY2VEZWZpbml0aW9uPiB7XG4gICAgY29uc3QgdXJsID0gdGhpcy5nZXREYXRhU291cmNlSnNvbigpPy51cmw7XG4gICAgaWYoIXVybCl7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xuICAgIH1cblxuICAgIGlmKHRoaXMuZ2V0U2VydmljZURlZmluaXRpb24oKSl7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuZ2V0U2VydmljZURlZmluaXRpb24oKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIFNlcnZpY2VNYW5hZ2VyLmdldEluc3RhbmNlKCkuZmV0Y2hTZXJ2aWNlSW5mbyh1cmwpLnRoZW4ocmVzID0+IHJlcy5kZWZpbml0aW9uKVxuICAgICAgLnRoZW4oZGVmaW5pdGlvbiA9PiB7XG4gICAgICAgIGlmKCFkZWZpbml0aW9uKXtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNlcnZpY2VEZWZpbml0aW9uID0gZGVmaW5pdGlvbjtcbiAgICAgICAgcmV0dXJuIGRlZmluaXRpb247XG4gICAgICB9KTtcbiAgfVxuXG4gIHByb3RlY3RlZCBfZ2V0RHNKc29uc0Zyb21TdXBwb3J0ZWRMYXllckRlZmluaXRpb25zKHJlczoge2RlZjogU2VydmljZURlZmluaXRpb24sIHVybD86IHN0cmluZ31bXSwgZHNKc29uSW5Db25maWc6IElNRGF0YVNvdXJjZUpzb24pOiBJTURhdGFTb3VyY2VKc29uW117XG4gICAgaWYoIXJlcyl7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIGxldCBkc0pzb25zOiBJTURhdGFTb3VyY2VKc29uW10gPSBbXSBhcyBJTURhdGFTb3VyY2VKc29uW107XG4gICAgcmVzLmZvckVhY2gociA9PiB7XG4gICAgICBjb25zdCB1cmwgPSBkYXRhU291cmNlVXRpbHMuZ2V0RnVsbFNlcnZpY2VVcmwoci51cmwsIHRydWUsIHIuZGVmKTtcbiAgICAgIHRoaXMuX2dldERzSnNvbnNGcm9tU2luZ2xlTGF5ZXJEZWZpbml0aW9uKHVybCwgci5kZWYsIGRzSnNvbkluQ29uZmlnKS5mb3JFYWNoKGRzSnNvbiA9PiB7XG4gICAgICAgIGRzSnNvbnMgPSBkc0pzb25zLmNvbmNhdChkc0pzb24pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGRzSnNvbnM7XG4gIH1cblxuICBwcm90ZWN0ZWQgX2dldERzSnNvbnNGcm9tU2luZ2xlTGF5ZXJEZWZpbml0aW9uKHVybDogc3RyaW5nLCBsYXllckRlZmluaXRpb246IFNlcnZpY2VEZWZpbml0aW9uLCBkc0pzb25JbkNvbmZpZzogSU1EYXRhU291cmNlSnNvbik6IElNRGF0YVNvdXJjZUpzb25bXXtcbiAgICBpZighbGF5ZXJEZWZpbml0aW9uKXtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgbGV0IGRzSnNvbnMgPSBbXTtcbiAgICBsZXQgc2luZ2xlRHNKc29uOiBJTURhdGFTb3VyY2VKc29uO1xuICAgIGNvbnN0IGppbXVDaGlsZElkcyA9IHRoaXMuZ2V0SmltdUNoaWxkSWQoZGF0YVNvdXJjZVV0aWxzLmZpeExheWVySWQobGF5ZXJEZWZpbml0aW9uLm5hbWUgfHwgYCR7bGF5ZXJEZWZpbml0aW9uLmlkfWApKTtcbiAgICBqaW11Q2hpbGRJZHMuZm9yRWFjaChqaW11Q2hpbGRJZCA9PiB7XG4gICAgICBjb25zdCBzY2hlbWEgPSB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkuc2NoZW1hID8gdGhpcy5nZXREYXRhU291cmNlSnNvbigpLnNjaGVtYS5jaGlsZFNjaGVtYXNbamltdUNoaWxkSWRdIDogbnVsbDtcbiAgICAgIGNvbnN0IGRzSWQgPSB0aGlzLmdldENoaWxkRGF0YVNvdXJjZUlkKGppbXVDaGlsZElkKTtcblxuICAgICAgaWYoZGF0YVNvdXJjZVV0aWxzLmlzU3VwcG9ydGVkU2luZ2xlTGF5ZXJTZXJ2aWNlKHVybCkpe1xuICAgICAgICBzaW5nbGVEc0pzb24gPSBkYXRhU291cmNlVXRpbHMuZ2V0U2luZ2xlRHNKc29uRnJvbUxheWVyRGVmaW5pdGlvbihcbiAgICAgICAgICBkc0lkLFxuICAgICAgICAgIHVybCxcbiAgICAgICAgICBsYXllckRlZmluaXRpb24sXG4gICAgICAgICAgZHNKc29uSW5Db25maWc/LmNoaWxkRGF0YVNvdXJjZUpzb25zICYmIGRzSnNvbkluQ29uZmlnLmNoaWxkRGF0YVNvdXJjZUpzb25zW2ppbXVDaGlsZElkXSA/IGRzSnNvbkluQ29uZmlnLmNoaWxkRGF0YVNvdXJjZUpzb25zW2ppbXVDaGlsZElkXSA6IG51bGxcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgaWYoc2luZ2xlRHNKc29uKXtcbiAgICAgICAgaWYodGhpcy5nZXREYXRhU291cmNlSnNvbigpPy5wb3J0YWxVcmwpe1xuICAgICAgICAgIHNpbmdsZURzSnNvbiA9IHNpbmdsZURzSnNvbi5zZXQoJ3BvcnRhbFVybCcsIHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKS5wb3J0YWxVcmwpO1xuICAgICAgICB9XG4gICAgICAgIGlmKHRoaXMuZ2V0RGF0YVNvdXJjZUpzb24oKT8uaXRlbUlkKXtcbiAgICAgICAgICBzaW5nbGVEc0pzb24gPSBzaW5nbGVEc0pzb24uc2V0KCdpdGVtSWQnLCB0aGlzLmdldERhdGFTb3VyY2VKc29uKCkuaXRlbUlkKTtcbiAgICAgICAgfVxuICAgICAgICBpZihzY2hlbWEpe1xuICAgICAgICAgIHNpbmdsZURzSnNvbiA9IHNpbmdsZURzSnNvbi5zZXQoJ3NjaGVtYScsIHNjaGVtYSk7XG4gICAgICAgIH1cblxuICAgICAgICBkc0pzb25zID0gZHNKc29ucy5jb25jYXQoc2luZ2xlRHNKc29uLnNldCgnamltdUNoaWxkSWQnLCBqaW11Q2hpbGRJZCkpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBkc0pzb25zO1xuICB9XG5cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBYUE7QUFBQTtBQUlBO0FBQUE7QUFIQTs7QUFLQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTs7QUFDQTtBQUVBO0FBQ0E7O0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFBQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFNQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7OyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./jimu-core/lib/data-sources/implementations/scene-service-data-source-impl.ts\n");

/***/ }),

/***/ "./jimu-core/lib/data-sources/implementations/simple-local-data-source-impl.ts":
/*!*************************************************************************************!*\
  !*** ./jimu-core/lib/data-sources/implementations/simple-local-data-source-impl.ts ***!
  \*************************************************************************************/
/*! exports provided: SimpleLocalDataSourceImpl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SimpleLocalDataSourceImpl\", function() { return SimpleLocalDataSourceImpl; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _ds_base_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ds-base-types */ \"./jimu-core/lib/data-sources/ds-base-types/index.ts\");\n/* harmony import */ var _data_source_interface__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../data-source-interface */ \"./jimu-core/lib/data-sources/data-source-interface.ts\");\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n/**\n * @ignore\n */\nvar SimpleLocalDataSourceImpl = /** @class */ (function (_super) {\n    __extends(SimpleLocalDataSourceImpl, _super);\n    function SimpleLocalDataSourceImpl() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.type = _data_source_interface__WEBPACK_IMPORTED_MODULE_2__[\"DataSourceTypes\"].SimpleLocal;\n        return _this;\n    }\n    SimpleLocalDataSourceImpl.prototype.updateAllRecoreds = function (records) {\n        this.records = records;\n        this.addVersion();\n    };\n    SimpleLocalDataSourceImpl.prototype.addRecord = function (record) {\n        if (!record.getId()) {\n            record.setId(Object(jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"uuidv1\"])());\n        }\n        this.records.push(record);\n        this.addVersion();\n        return record;\n    };\n    SimpleLocalDataSourceImpl.prototype.updateRecord = function (record) {\n        var i = this.records.findIndex(function (r) { return r.getId() === record.getId(); });\n        this.records.splice(i, 1, record);\n        this.addVersion();\n    };\n    SimpleLocalDataSourceImpl.prototype.deleteRecord = function (index) {\n        this.records.splice(index, 1);\n        this.addVersion();\n    };\n    return SimpleLocalDataSourceImpl;\n}(_ds_base_types__WEBPACK_IMPORTED_MODULE_1__[\"AbstractDataSource\"]));\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvc2ltcGxlLWxvY2FsLWRhdGEtc291cmNlLWltcGwudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbXBsZW1lbnRhdGlvbnMvc2ltcGxlLWxvY2FsLWRhdGEtc291cmNlLWltcGwudHM/OTQ0YSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB1dWlkdjEgfSBmcm9tICdqaW11LWNvcmUnO1xuaW1wb3J0IHsgQWJzdHJhY3REYXRhU291cmNlIH0gZnJvbSAnLi4vZHMtYmFzZS10eXBlcyc7XG5pbXBvcnQgeyBEYXRhUmVjb3JkLCBTaW1wbGVMb2NhbERhdGFTb3VyY2UsIERhdGFTb3VyY2VUeXBlcyB9IGZyb20gJy4uL2RhdGEtc291cmNlLWludGVyZmFjZSc7XG5cbi8qKlxuICogQGlnbm9yZVxuICovXG5leHBvcnQgY2xhc3MgU2ltcGxlTG9jYWxEYXRhU291cmNlSW1wbCBleHRlbmRzIEFic3RyYWN0RGF0YVNvdXJjZSBpbXBsZW1lbnRzIFNpbXBsZUxvY2FsRGF0YVNvdXJjZSB7XG4gIHR5cGU6IERhdGFTb3VyY2VUeXBlcy5TaW1wbGVMb2NhbCA9IERhdGFTb3VyY2VUeXBlcy5TaW1wbGVMb2NhbDtcblxuICB1cGRhdGVBbGxSZWNvcmVkcyhyZWNvcmRzOiBEYXRhUmVjb3JkW10pIHtcbiAgICB0aGlzLnJlY29yZHMgPSByZWNvcmRzO1xuICAgIHRoaXMuYWRkVmVyc2lvbigpO1xuICB9XG5cbiAgYWRkUmVjb3JkKHJlY29yZDogRGF0YVJlY29yZCk6IERhdGFSZWNvcmQge1xuICAgIGlmICghcmVjb3JkLmdldElkKCkpIHtcbiAgICAgIHJlY29yZC5zZXRJZCh1dWlkdjEoKSk7XG4gICAgfVxuICAgIHRoaXMucmVjb3Jkcy5wdXNoKHJlY29yZCk7XG4gICAgdGhpcy5hZGRWZXJzaW9uKCk7XG4gICAgcmV0dXJuIHJlY29yZDtcbiAgfVxuXG4gIHVwZGF0ZVJlY29yZChyZWNvcmQ6IERhdGFSZWNvcmQpIHtcbiAgICBjb25zdCBpID0gdGhpcy5yZWNvcmRzLmZpbmRJbmRleChyID0+IHIuZ2V0SWQoKSA9PT0gcmVjb3JkLmdldElkKCkpO1xuICAgIHRoaXMucmVjb3Jkcy5zcGxpY2UoaSwgMSwgcmVjb3JkKTtcbiAgICB0aGlzLmFkZFZlcnNpb24oKTtcbiAgfVxuXG4gIGRlbGV0ZVJlY29yZChpbmRleDogbnVtYmVyKSB7XG4gICAgdGhpcy5yZWNvcmRzLnNwbGljZShpbmRleCwgMSk7XG4gICAgdGhpcy5hZGRWZXJzaW9uKCk7XG4gIH1cbn0iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7O0FBMEJBO0FBeEJBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7OyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./jimu-core/lib/data-sources/implementations/simple-local-data-source-impl.ts\n");

/***/ }),

/***/ "./jimu-core/lib/data-sources/index.ts":
/*!*********************************************!*\
  !*** ./jimu-core/lib/data-sources/index.ts ***!
  \*********************************************/
/*! exports provided: JimuCoreDataSourceFactory, AbstractDataSource, AbstractLayerFolderDataSource, AbstractLoadableDataSource, AbstractQueriableDataSource, AbstractSetDataSource, AbstractDataRecord, SimpleDataRecordImpl, SimpleDataRecordSetImpl, DataSourceStatus, DataSourceTypes, SupportedLayerServiceTypes, SupportedServiceTypes, SupportedItemTypes, SupportedLayerTypes, QueryScope, DataSourceError, FeatureDataRecordImpl, CsvDataSourceImpl, FeatureLayerDataSourceImpl, FeatureServiceDataSourceImpl, FeatureSetDataSourceImpl, GroupLayerDataSourceImpl, MapServiceDataSourceImpl, SimpleLocalDataSourceImpl, SceneServiceDataSourceImpl, SceneLayerDataSourceImpl */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"JimuCoreDataSourceFactory\", function() { return JimuCoreDataSourceFactory; });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jimu_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _data_source_interface__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./data-source-interface */ \"./jimu-core/lib/data-sources/data-source-interface.ts\");\n/* harmony import */ var _implementations_feature_record_impl__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./implementations/feature-record-impl */ \"./jimu-core/lib/data-sources/implementations/feature-record-impl.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"FeatureDataRecordImpl\", function() { return _implementations_feature_record_impl__WEBPACK_IMPORTED_MODULE_2__[\"FeatureDataRecordImpl\"]; });\n\n/* harmony import */ var _implementations_csv_data_source_impl__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./implementations/csv-data-source-impl */ \"./jimu-core/lib/data-sources/implementations/csv-data-source-impl.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"CsvDataSourceImpl\", function() { return _implementations_csv_data_source_impl__WEBPACK_IMPORTED_MODULE_3__[\"CsvDataSourceImpl\"]; });\n\n/* harmony import */ var _implementations_feature_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./implementations/feature-layer-data-source-impl */ \"./jimu-core/lib/data-sources/implementations/feature-layer-data-source-impl.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"FeatureLayerDataSourceImpl\", function() { return _implementations_feature_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_4__[\"FeatureLayerDataSourceImpl\"]; });\n\n/* harmony import */ var _implementations_feature_service_data_source_impl__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./implementations/feature-service-data-source-impl */ \"./jimu-core/lib/data-sources/implementations/feature-service-data-source-impl.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"FeatureServiceDataSourceImpl\", function() { return _implementations_feature_service_data_source_impl__WEBPACK_IMPORTED_MODULE_5__[\"FeatureServiceDataSourceImpl\"]; });\n\n/* harmony import */ var _implementations_feature_set_data_source_impl__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./implementations/feature-set-data-source-impl */ \"./jimu-core/lib/data-sources/implementations/feature-set-data-source-impl.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"FeatureSetDataSourceImpl\", function() { return _implementations_feature_set_data_source_impl__WEBPACK_IMPORTED_MODULE_6__[\"FeatureSetDataSourceImpl\"]; });\n\n/* harmony import */ var _implementations_group_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./implementations/group-layer-data-source-impl */ \"./jimu-core/lib/data-sources/implementations/group-layer-data-source-impl.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"GroupLayerDataSourceImpl\", function() { return _implementations_group_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_7__[\"GroupLayerDataSourceImpl\"]; });\n\n/* harmony import */ var _implementations_map_service_data_source_impl__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./implementations/map-service-data-source-impl */ \"./jimu-core/lib/data-sources/implementations/map-service-data-source-impl.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"MapServiceDataSourceImpl\", function() { return _implementations_map_service_data_source_impl__WEBPACK_IMPORTED_MODULE_8__[\"MapServiceDataSourceImpl\"]; });\n\n/* harmony import */ var _implementations_simple_local_data_source_impl__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./implementations/simple-local-data-source-impl */ \"./jimu-core/lib/data-sources/implementations/simple-local-data-source-impl.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SimpleLocalDataSourceImpl\", function() { return _implementations_simple_local_data_source_impl__WEBPACK_IMPORTED_MODULE_9__[\"SimpleLocalDataSourceImpl\"]; });\n\n/* harmony import */ var _implementations_scene_service_data_source_impl__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./implementations/scene-service-data-source-impl */ \"./jimu-core/lib/data-sources/implementations/scene-service-data-source-impl.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SceneServiceDataSourceImpl\", function() { return _implementations_scene_service_data_source_impl__WEBPACK_IMPORTED_MODULE_10__[\"SceneServiceDataSourceImpl\"]; });\n\n/* harmony import */ var _implementations_scene_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./implementations/scene-layer-data-source-impl */ \"./jimu-core/lib/data-sources/implementations/scene-layer-data-source-impl.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SceneLayerDataSourceImpl\", function() { return _implementations_scene_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_11__[\"SceneLayerDataSourceImpl\"]; });\n\n/* harmony import */ var _ds_base_types__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./ds-base-types */ \"./jimu-core/lib/data-sources/ds-base-types/index.ts\");\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AbstractDataSource\", function() { return _ds_base_types__WEBPACK_IMPORTED_MODULE_12__[\"AbstractDataSource\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AbstractLayerFolderDataSource\", function() { return _ds_base_types__WEBPACK_IMPORTED_MODULE_12__[\"AbstractLayerFolderDataSource\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AbstractLoadableDataSource\", function() { return _ds_base_types__WEBPACK_IMPORTED_MODULE_12__[\"AbstractLoadableDataSource\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AbstractQueriableDataSource\", function() { return _ds_base_types__WEBPACK_IMPORTED_MODULE_12__[\"AbstractQueriableDataSource\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AbstractSetDataSource\", function() { return _ds_base_types__WEBPACK_IMPORTED_MODULE_12__[\"AbstractSetDataSource\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"AbstractDataRecord\", function() { return _ds_base_types__WEBPACK_IMPORTED_MODULE_12__[\"AbstractDataRecord\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SimpleDataRecordImpl\", function() { return _ds_base_types__WEBPACK_IMPORTED_MODULE_12__[\"SimpleDataRecordImpl\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SimpleDataRecordSetImpl\", function() { return _ds_base_types__WEBPACK_IMPORTED_MODULE_12__[\"SimpleDataRecordSetImpl\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DataSourceStatus\", function() { return _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceStatus\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DataSourceTypes\", function() { return _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceTypes\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SupportedLayerServiceTypes\", function() { return _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"SupportedLayerServiceTypes\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SupportedServiceTypes\", function() { return _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"SupportedServiceTypes\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SupportedItemTypes\", function() { return _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"SupportedItemTypes\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"SupportedLayerTypes\", function() { return _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"SupportedLayerTypes\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"QueryScope\", function() { return _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"QueryScope\"]; });\n\n/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, \"DataSourceError\", function() { return _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceError\"]; });\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar JimuCoreDataSourceFactory = /** @class */ (function () {\n    function JimuCoreDataSourceFactory() {\n    }\n    JimuCoreDataSourceFactory.prototype.createDataSource = function (options) {\n        var _a;\n        var dsJson = (_a = options.dataSourceJson) !== null && _a !== void 0 ? _a : options.belongToDataSource.getMainDataSource().getDataSourceJson();\n        var dsType;\n        if (options.dataViewId && options.dataViewId === jimu_core__WEBPACK_IMPORTED_MODULE_0__[\"CONSTANTS\"].SELECTION_DATA_VIEW_ID) {\n            dsType = _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceTypes\"].FeatureSet;\n        }\n        else {\n            dsType = options.dataViewId && dsJson.dataViews && dsJson.dataViews[options.dataViewId] ? dsJson.dataViews[options.dataViewId].type || dsJson.type : dsJson.type;\n        }\n        if (dsType === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceTypes\"].CSV) {\n            return new _implementations_csv_data_source_impl__WEBPACK_IMPORTED_MODULE_3__[\"CsvDataSourceImpl\"](options);\n        }\n        else if (dsType === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceTypes\"].FeatureLayer) {\n            return new _implementations_feature_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_4__[\"FeatureLayerDataSourceImpl\"](options);\n        }\n        else if (dsType === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceTypes\"].FeatureService) {\n            return new _implementations_feature_service_data_source_impl__WEBPACK_IMPORTED_MODULE_5__[\"FeatureServiceDataSourceImpl\"](options);\n        }\n        else if (dsType === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceTypes\"].FeatureSet) {\n            return new _implementations_feature_set_data_source_impl__WEBPACK_IMPORTED_MODULE_6__[\"FeatureSetDataSourceImpl\"](options);\n        }\n        else if (dsType === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceTypes\"].GroupLayer) {\n            return new _implementations_group_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_7__[\"GroupLayerDataSourceImpl\"](options);\n        }\n        else if (dsType === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceTypes\"].MapService) {\n            return new _implementations_map_service_data_source_impl__WEBPACK_IMPORTED_MODULE_8__[\"MapServiceDataSourceImpl\"](options);\n        }\n        else if (dsType === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceTypes\"].SceneService) {\n            return new _implementations_scene_service_data_source_impl__WEBPACK_IMPORTED_MODULE_10__[\"SceneServiceDataSourceImpl\"](options);\n        }\n        else if (dsType === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceTypes\"].SceneLayer) {\n            return new _implementations_scene_layer_data_source_impl__WEBPACK_IMPORTED_MODULE_11__[\"SceneLayerDataSourceImpl\"](options);\n        }\n        else if (dsType === _data_source_interface__WEBPACK_IMPORTED_MODULE_1__[\"DataSourceTypes\"].SimpleLocal) {\n            return new _implementations_simple_local_data_source_impl__WEBPACK_IMPORTED_MODULE_9__[\"SimpleLocalDataSourceImpl\"](options);\n        }\n        else {\n            console.error('Unimplemented data source type.', dsJson.type);\n        }\n    };\n    return JimuCoreDataSourceFactory;\n}());\n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL2RhdGEtc291cmNlcy9pbmRleC50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtY29yZS9saWIvZGF0YS1zb3VyY2VzL2luZGV4LnRzP2YwYjciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtDT05TVEFOVFN9IGZyb20gJ2ppbXUtY29yZSc7XG5cbmltcG9ydCB7IERhdGFTb3VyY2UsIERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMsIERhdGFTb3VyY2VGYWN0b3J5LCBEYXRhU291cmNlVHlwZXMgfSBmcm9tICcuL2RhdGEtc291cmNlLWludGVyZmFjZSc7XG5pbXBvcnQgeyBGZWF0dXJlRGF0YVJlY29yZEltcGwgfSBmcm9tICcuL2ltcGxlbWVudGF0aW9ucy9mZWF0dXJlLXJlY29yZC1pbXBsJztcbmltcG9ydCB7IENzdkRhdGFTb3VyY2VJbXBsIH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbnMvY3N2LWRhdGEtc291cmNlLWltcGwnO1xuaW1wb3J0IHR5cGUgeyBGZWF0dXJlTGF5ZXJEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbnMvZmVhdHVyZS1sYXllci1kYXRhLXNvdXJjZS1pbXBsJztcbmltcG9ydCB0eXBlIHsgU2NlbmVMYXllckRhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMgfSBmcm9tICcuL2ltcGxlbWVudGF0aW9ucy9zY2VuZS1sYXllci1kYXRhLXNvdXJjZS1pbXBsJztcbmltcG9ydCB7IEZlYXR1cmVMYXllckRhdGFTb3VyY2VJbXBsIH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbnMvZmVhdHVyZS1sYXllci1kYXRhLXNvdXJjZS1pbXBsJztcbmltcG9ydCB7IEZlYXR1cmVTZXJ2aWNlRGF0YVNvdXJjZUltcGwgfSBmcm9tICcuL2ltcGxlbWVudGF0aW9ucy9mZWF0dXJlLXNlcnZpY2UtZGF0YS1zb3VyY2UtaW1wbCc7XG5pbXBvcnQgdHlwZSB7IEZlYXR1cmVTZXREYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zIH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbnMvZmVhdHVyZS1zZXQtZGF0YS1zb3VyY2UtaW1wbCc7XG5pbXBvcnQgeyBGZWF0dXJlU2V0RGF0YVNvdXJjZUltcGwgfSBmcm9tICcuL2ltcGxlbWVudGF0aW9ucy9mZWF0dXJlLXNldC1kYXRhLXNvdXJjZS1pbXBsJztcbmltcG9ydCB7IEdyb3VwTGF5ZXJEYXRhU291cmNlSW1wbCB9IGZyb20gJy4vaW1wbGVtZW50YXRpb25zL2dyb3VwLWxheWVyLWRhdGEtc291cmNlLWltcGwnO1xuaW1wb3J0IHsgTWFwU2VydmljZURhdGFTb3VyY2VJbXBsIH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbnMvbWFwLXNlcnZpY2UtZGF0YS1zb3VyY2UtaW1wbCc7XG5pbXBvcnQgeyBTaW1wbGVMb2NhbERhdGFTb3VyY2VJbXBsIH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbnMvc2ltcGxlLWxvY2FsLWRhdGEtc291cmNlLWltcGwnO1xuaW1wb3J0IHsgU2NlbmVTZXJ2aWNlRGF0YVNvdXJjZUltcGwgfSBmcm9tICcuL2ltcGxlbWVudGF0aW9ucy9zY2VuZS1zZXJ2aWNlLWRhdGEtc291cmNlLWltcGwnO1xuaW1wb3J0IHsgU2NlbmVMYXllckRhdGFTb3VyY2VJbXBsIH0gZnJvbSAnLi9pbXBsZW1lbnRhdGlvbnMvc2NlbmUtbGF5ZXItZGF0YS1zb3VyY2UtaW1wbCc7XG5cbmV4cG9ydCBjbGFzcyBKaW11Q29yZURhdGFTb3VyY2VGYWN0b3J5IGltcGxlbWVudHMgRGF0YVNvdXJjZUZhY3Rvcnl7XG4gIGNyZWF0ZURhdGFTb3VyY2Uob3B0aW9uczogRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyk6IERhdGFTb3VyY2V7XG4gICAgY29uc3QgZHNKc29uID0gb3B0aW9ucy5kYXRhU291cmNlSnNvbiA/PyBvcHRpb25zLmJlbG9uZ1RvRGF0YVNvdXJjZS5nZXRNYWluRGF0YVNvdXJjZSgpLmdldERhdGFTb3VyY2VKc29uKCk7XG4gICAgbGV0IGRzVHlwZTtcbiAgICBpZihvcHRpb25zLmRhdGFWaWV3SWQgJiYgb3B0aW9ucy5kYXRhVmlld0lkID09PSBDT05TVEFOVFMuU0VMRUNUSU9OX0RBVEFfVklFV19JRCl7XG4gICAgICBkc1R5cGUgPSBEYXRhU291cmNlVHlwZXMuRmVhdHVyZVNldDtcbiAgICB9ZWxzZXtcbiAgICAgIGRzVHlwZSA9IG9wdGlvbnMuZGF0YVZpZXdJZCAmJiBkc0pzb24uZGF0YVZpZXdzICYmIGRzSnNvbi5kYXRhVmlld3Nbb3B0aW9ucy5kYXRhVmlld0lkXSA/IGRzSnNvbi5kYXRhVmlld3Nbb3B0aW9ucy5kYXRhVmlld0lkXS50eXBlIHx8IGRzSnNvbi50eXBlIDogZHNKc29uLnR5cGU7XG4gICAgfVxuICAgIGlmKGRzVHlwZSA9PT0gRGF0YVNvdXJjZVR5cGVzLkNTVil7XG4gICAgICByZXR1cm4gbmV3IENzdkRhdGFTb3VyY2VJbXBsKG9wdGlvbnMpO1xuICAgIH1lbHNlIGlmKGRzVHlwZSA9PT0gRGF0YVNvdXJjZVR5cGVzLkZlYXR1cmVMYXllcil7XG4gICAgICByZXR1cm4gbmV3IEZlYXR1cmVMYXllckRhdGFTb3VyY2VJbXBsKG9wdGlvbnMpO1xuICAgIH1lbHNlIGlmKGRzVHlwZSA9PT0gRGF0YVNvdXJjZVR5cGVzLkZlYXR1cmVTZXJ2aWNlKXtcbiAgICAgIHJldHVybiBuZXcgRmVhdHVyZVNlcnZpY2VEYXRhU291cmNlSW1wbChvcHRpb25zKTtcbiAgICB9ZWxzZSBpZihkc1R5cGUgPT09IERhdGFTb3VyY2VUeXBlcy5GZWF0dXJlU2V0KXtcbiAgICAgIHJldHVybiBuZXcgRmVhdHVyZVNldERhdGFTb3VyY2VJbXBsKG9wdGlvbnMgYXMgRmVhdHVyZVNldERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMpO1xuICAgIH1lbHNlIGlmKGRzVHlwZSA9PT0gRGF0YVNvdXJjZVR5cGVzLkdyb3VwTGF5ZXIpe1xuICAgICAgcmV0dXJuIG5ldyBHcm91cExheWVyRGF0YVNvdXJjZUltcGwob3B0aW9ucyk7XG4gICAgfWVsc2UgaWYoZHNUeXBlID09PSBEYXRhU291cmNlVHlwZXMuTWFwU2VydmljZSl7XG4gICAgICByZXR1cm4gbmV3IE1hcFNlcnZpY2VEYXRhU291cmNlSW1wbChvcHRpb25zKTtcbiAgICB9ZWxzZSBpZihkc1R5cGUgPT09IERhdGFTb3VyY2VUeXBlcy5TY2VuZVNlcnZpY2Upe1xuICAgICAgcmV0dXJuIG5ldyBTY2VuZVNlcnZpY2VEYXRhU291cmNlSW1wbChvcHRpb25zKTtcbiAgICB9ZWxzZSBpZihkc1R5cGUgPT09IERhdGFTb3VyY2VUeXBlcy5TY2VuZUxheWVyKXtcbiAgICAgIHJldHVybiBuZXcgU2NlbmVMYXllckRhdGFTb3VyY2VJbXBsKG9wdGlvbnMpO1xuICAgIH1lbHNlIGlmKGRzVHlwZSA9PT0gRGF0YVNvdXJjZVR5cGVzLlNpbXBsZUxvY2FsKXtcbiAgICAgIHJldHVybiBuZXcgU2ltcGxlTG9jYWxEYXRhU291cmNlSW1wbChvcHRpb25zKTtcbiAgICB9ZWxzZXtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1VuaW1wbGVtZW50ZWQgZGF0YSBzb3VyY2UgdHlwZS4nLCBkc0pzb24udHlwZSk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCAqIGZyb20gJy4vZHMtYmFzZS10eXBlcyc7XG5leHBvcnQgKiBmcm9tICcuL2RhdGEtc291cmNlLWludGVyZmFjZSc7XG5leHBvcnQge1xuICBGZWF0dXJlRGF0YVJlY29yZEltcGwsXG4gIENzdkRhdGFTb3VyY2VJbXBsLFxuICBGZWF0dXJlTGF5ZXJEYXRhU291cmNlSW1wbCxcbiAgRmVhdHVyZVNlcnZpY2VEYXRhU291cmNlSW1wbCxcbiAgRmVhdHVyZVNldERhdGFTb3VyY2VJbXBsLFxuICBHcm91cExheWVyRGF0YVNvdXJjZUltcGwsXG4gIE1hcFNlcnZpY2VEYXRhU291cmNlSW1wbCxcbiAgU2ltcGxlTG9jYWxEYXRhU291cmNlSW1wbCxcbiAgU2NlbmVTZXJ2aWNlRGF0YVNvdXJjZUltcGwsXG4gIFNjZW5lTGF5ZXJEYXRhU291cmNlSW1wbCxcbiAgRmVhdHVyZUxheWVyRGF0YVNvdXJjZUNvbnN0cnVjdG9yT3B0aW9ucyxcbiAgRmVhdHVyZVNldERhdGFTb3VyY2VDb25zdHJ1Y3Rvck9wdGlvbnMsXG4gIFNjZW5lTGF5ZXJEYXRhU291cmNlQ29uc3RydWN0b3JPcHRpb25zXG59O1xuIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQStCQTtBQTlCQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBOztBQUVBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./jimu-core/lib/data-sources/index.ts\n");

/***/ }),

/***/ "./jimu-core/lib/types/common.ts":
/*!***************************************!*\
  !*** ./jimu-core/lib/types/common.ts ***!
  \***************************************/
/*! exports provided: BrowserSizeMode, JimuFieldType, EsriFieldType, AjaxState, AppMode, WidgetState, LinkType, WidgetType, ESRI_DATE_FORMAT_ARRAY, PagePart, UrlProtocol, APP_FRAME_NAME_IN_BUILDER, ResourceType, LoadingType */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BrowserSizeMode\", function() { return BrowserSizeMode; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"JimuFieldType\", function() { return JimuFieldType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"EsriFieldType\", function() { return EsriFieldType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AjaxState\", function() { return AjaxState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AppMode\", function() { return AppMode; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"WidgetState\", function() { return WidgetState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LinkType\", function() { return LinkType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"WidgetType\", function() { return WidgetType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ESRI_DATE_FORMAT_ARRAY\", function() { return ESRI_DATE_FORMAT_ARRAY; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PagePart\", function() { return PagePart; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"UrlProtocol\", function() { return UrlProtocol; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"APP_FRAME_NAME_IN_BUILDER\", function() { return APP_FRAME_NAME_IN_BUILDER; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ResourceType\", function() { return ResourceType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LoadingType\", function() { return LoadingType; });\nvar BrowserSizeMode;\n(function (BrowserSizeMode) {\n    BrowserSizeMode[\"Small\"] = \"SMALL\";\n    BrowserSizeMode[\"Medium\"] = \"MEDIUM\";\n    BrowserSizeMode[\"Large\"] = \"LARGE\";\n})(BrowserSizeMode || (BrowserSizeMode = {}));\nvar JimuFieldType;\n(function (JimuFieldType) {\n    JimuFieldType[\"String\"] = \"STRING\";\n    JimuFieldType[\"Number\"] = \"NUMBER\";\n    JimuFieldType[\"Date\"] = \"DATE\";\n})(JimuFieldType || (JimuFieldType = {}));\nvar EsriFieldType;\n(function (EsriFieldType) {\n    EsriFieldType[\"Blob\"] = \"esriFieldTypeBlob\";\n    EsriFieldType[\"Date\"] = \"esriFieldTypeDate\";\n    EsriFieldType[\"Double\"] = \"esriFieldTypeDouble\";\n    EsriFieldType[\"Geometry\"] = \"esriFieldTypeGeometry\";\n    EsriFieldType[\"GlobalID\"] = \"esriFieldTypeGlobalID\";\n    EsriFieldType[\"GUID\"] = \"esriFieldTypeGUID\";\n    EsriFieldType[\"Integer\"] = \"esriFieldTypeInteger\";\n    EsriFieldType[\"OID\"] = \"esriFieldTypeOID\";\n    EsriFieldType[\"Raster\"] = \"esriFieldTypeRaster\";\n    EsriFieldType[\"Single\"] = \"esriFieldTypeSingle\";\n    EsriFieldType[\"SmallInteger\"] = \"esriFieldTypeSmallInteger\";\n    EsriFieldType[\"String\"] = \"esriFieldTypeString\";\n    EsriFieldType[\"XML\"] = \"esriFieldTypeXML\";\n})(EsriFieldType || (EsriFieldType = {}));\nvar AjaxState;\n(function (AjaxState) {\n    AjaxState[\"Fetching\"] = \"FETCHING\";\n    AjaxState[\"Success\"] = \"SUCCESS\";\n    AjaxState[\"Error\"] = \"ERROR\";\n})(AjaxState || (AjaxState = {}));\nvar AppMode;\n(function (AppMode) {\n    /**\n     * In this mode, user can design the app but can't interact with the app.\n     */\n    AppMode[\"Design\"] = \"DESIGN\";\n    /**\n     * In this mode, useR can use the app but can't edit the app's layout\n     */\n    AppMode[\"Run\"] = \"RUN\";\n})(AppMode || (AppMode = {}));\nvar WidgetState;\n(function (WidgetState) {\n    WidgetState[\"Opened\"] = \"OPENED\";\n    WidgetState[\"Active\"] = \"ACTIVE\";\n    WidgetState[\"Closed\"] = \"CLOSED\";\n})(WidgetState || (WidgetState = {}));\nvar LinkType;\n(function (LinkType) {\n    LinkType[\"None\"] = \"NONE\";\n    LinkType[\"Page\"] = \"PAGE\";\n    LinkType[\"Dialog\"] = \"DIALOG\";\n    LinkType[\"View\"] = \"VIEW\";\n    LinkType[\"WebAddress\"] = \"WEB_ADDRESS\";\n})(LinkType || (LinkType = {}));\nvar WidgetType;\n(function (WidgetType) {\n    WidgetType[\"Normal\"] = \"NORMAL\";\n    WidgetType[\"Layout\"] = \"LAYOUT\";\n})(WidgetType || (WidgetType = {}));\nvar ESRI_DATE_FORMAT_ARRAY = ['shortDate', 'shortDateLE', 'longMonthDayYear', 'dayShortMonthYear', 'longDate',\n    'shortDateShortTime', 'shortDateLEShortTime', 'shortDateShortTime24', 'shortDateLEShortTime24', 'shortDateLongTime',\n    'shortDateLELongTime', 'shortDateLongTime24', 'shortDateLELongTime24', 'longMonthYear', 'shortMonthYear', 'year'\n];\nvar PagePart;\n(function (PagePart) {\n    PagePart[\"Header\"] = \"HEADER\";\n    PagePart[\"Footer\"] = \"FOOTER\";\n    PagePart[\"Body\"] = \"BODY\";\n})(PagePart || (PagePart = {}));\nvar UrlProtocol;\n(function (UrlProtocol) {\n    UrlProtocol[\"Http\"] = \"http:\";\n    UrlProtocol[\"Https\"] = \"https:\";\n})(UrlProtocol || (UrlProtocol = {}));\nvar APP_FRAME_NAME_IN_BUILDER = '_appWindow';\nvar ResourceType;\n(function (ResourceType) {\n    ResourceType[\"Image\"] = \"IMAGE\";\n    ResourceType[\"Config\"] = \"CONFIG\";\n})(ResourceType || (ResourceType = {}));\nvar LoadingType;\n(function (LoadingType) {\n    LoadingType[\"Primary\"] = \"PRIMARY\";\n    LoadingType[\"Secondary\"] = \"SECONDARY\";\n    LoadingType[\"Image\"] = \"IMAGE\";\n    LoadingType[\"Donut\"] = \"DONUT\";\n})(LoadingType || (LoadingType = {}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9qaW11LWNvcmUvbGliL3R5cGVzL2NvbW1vbi50cy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ppbXUtY29yZS9saWIvdHlwZXMvY29tbW9uLnRzP2RjNjgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTGF5b3V0SXRlbVR5cGUsIExheW91dEluZm8gfSBmcm9tICcuL2xheW91dCc7XG5pbXBvcnQgeyBXaWRnZXRNYW5pZmVzdCB9IGZyb20gJy4vbWFuaWZlc3QnO1xuaW1wb3J0IHsgSW1tdXRhYmxlT2JqZWN0IH0gZnJvbSAnc2VhbWxlc3MtaW1tdXRhYmxlJztcbmltcG9ydCB7IEljb25SZXN1bHQgfSBmcm9tICcuL2FwcC1jb25maWcnO1xuaW1wb3J0IHsgU2VydmljZURlZmluaXRpb24gfSBmcm9tICcuL3NlcnZpY2UtZGVmaW5pdGlvbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2l6ZXtcbiAgd2lkdGg6IG51bWJlcjtcbiAgaGVpZ2h0OiBudW1iZXI7XG59XG5cbmV4cG9ydCBlbnVtIEJyb3dzZXJTaXplTW9kZXtcbiAgU21hbGwgPSAnU01BTEwnLFxuICBNZWRpdW0gPSAnTUVESVVNJyxcbiAgTGFyZ2UgPSAnTEFSR0UnXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQm91bmRpbmdCb3gge1xuICBsZWZ0Pzogc3RyaW5nOyAvLyBwaXhlbCBudW1iZXIsIHBlcmNlbnRhZ2UsIG9yICdhdXRvJ1xuICB0b3A/OiBzdHJpbmc7XG4gIHJpZ2h0Pzogc3RyaW5nO1xuICBib3R0b20/OiBzdHJpbmc7XG4gIHdpZHRoPzogc3RyaW5nO1xuICBoZWlnaHQ/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCB0eXBlIElNQm91bmRpbmdCb3ggPSBJbW11dGFibGVPYmplY3Q8Qm91bmRpbmdCb3g+O1xuXG5leHBvcnQgZW51bSBKaW11RmllbGRUeXBle1xuICBTdHJpbmcgPSAnU1RSSU5HJyxcbiAgTnVtYmVyID0gJ05VTUJFUicsXG4gIERhdGUgPSAnREFURScsXG59XG5cbmV4cG9ydCBlbnVtIEVzcmlGaWVsZFR5cGUge1xuICBCbG9iID0gJ2VzcmlGaWVsZFR5cGVCbG9iJyxcbiAgRGF0ZSA9ICdlc3JpRmllbGRUeXBlRGF0ZScsXG4gIERvdWJsZSA9ICdlc3JpRmllbGRUeXBlRG91YmxlJyxcbiAgR2VvbWV0cnkgPSAnZXNyaUZpZWxkVHlwZUdlb21ldHJ5JyxcbiAgR2xvYmFsSUQgPSAnZXNyaUZpZWxkVHlwZUdsb2JhbElEJyxcbiAgR1VJRCA9ICdlc3JpRmllbGRUeXBlR1VJRCcsXG4gIEludGVnZXIgPSAnZXNyaUZpZWxkVHlwZUludGVnZXInLFxuICBPSUQgPSAnZXNyaUZpZWxkVHlwZU9JRCcsXG4gIFJhc3RlciA9ICdlc3JpRmllbGRUeXBlUmFzdGVyJyxcbiAgU2luZ2xlID0gJ2VzcmlGaWVsZFR5cGVTaW5nbGUnLFxuICBTbWFsbEludGVnZXIgPSAnZXNyaUZpZWxkVHlwZVNtYWxsSW50ZWdlcicsXG4gIFN0cmluZyA9ICdlc3JpRmllbGRUeXBlU3RyaW5nJyxcbiAgWE1MID0gJ2VzcmlGaWVsZFR5cGVYTUwnXG59XG5cbmV4cG9ydCBlbnVtIEFqYXhTdGF0ZXtcbiAgRmV0Y2hpbmcgPSAnRkVUQ0hJTkcnLFxuICBTdWNjZXNzID0gJ1NVQ0NFU1MnLFxuICBFcnJvciA9ICdFUlJPUicsXG59XG5cbmV4cG9ydCBlbnVtIEFwcE1vZGV7XG4gIC8qKlxuICAgKiBJbiB0aGlzIG1vZGUsIHVzZXIgY2FuIGRlc2lnbiB0aGUgYXBwIGJ1dCBjYW4ndCBpbnRlcmFjdCB3aXRoIHRoZSBhcHAuXG4gICAqL1xuICBEZXNpZ24gPSAnREVTSUdOJyxcblxuICAvKipcbiAgICogSW4gdGhpcyBtb2RlLCB1c2VSIGNhbiB1c2UgdGhlIGFwcCBidXQgY2FuJ3QgZWRpdCB0aGUgYXBwJ3MgbGF5b3V0XG4gICAqL1xuICBSdW4gPSAnUlVOJ1xufVxuXG5leHBvcnQgZW51bSBXaWRnZXRTdGF0ZXtcbiAgT3BlbmVkID0gJ09QRU5FRCcsXG4gIEFjdGl2ZSA9ICdBQ1RJVkUnLFxuICBDbG9zZWQgPSAnQ0xPU0VEJ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIExvY2F0aW9uIHtcbiAgcGF0aG5hbWU6IHN0cmluZztcbiAgc2VhcmNoOiBzdHJpbmc7XG4gIGhhc2g6IHN0cmluZztcbn1cblxuZXhwb3J0IGVudW0gTGlua1R5cGV7XG4gIE5vbmUgPSAnTk9ORScsXG4gIFBhZ2UgPSAnUEFHRScsXG4gIERpYWxvZyA9ICdESUFMT0cnLFxuICBWaWV3ID0gJ1ZJRVcnLFxuICBXZWJBZGRyZXNzID0gJ1dFQl9BRERSRVNTJ1xufVxuXG4vKipcbiAqIFRoZSByZXN1bHQgb2YgbGluayBzZXR0aW5nXG4gKi9cbmV4cG9ydCB0eXBlIExpbmtSZXN1bHQgPSB7XG4gIGxpbmtUeXBlPzogTGlua1R5cGUsXG5cbiAgLyoqXG4gICAqIElmIHRoZSBsaW5rVHlwZSBpcyBgUGFnZWAsIHRoZSB2YWx1ZSBpcyA8cGFnZUlkPiwgb3IgdGhlIHNwZWNpZmljIHZhbHVlOiBjdXJyZW50X3BhZ2UuXG4gICAqIElmIHRoZSBsaW5rVHlwZSBpcyBgVmlld2AsIHRoZSB2YWx1ZSBpcyA8cGFnZUlkLHZpZXdJZD4uXG4gICAqL1xuICB2YWx1ZT86IHN0cmluZyxcbn07XG5cbmV4cG9ydCB0eXBlIExpbmtUbyA9IHN0cmluZyB8IExvY2F0aW9uIHwgTGlua1Jlc3VsdDtcblxuZXhwb3J0IGludGVyZmFjZSBSZXNvdXJjZXtcbiAgdXJsOiBzdHJpbmc7XG4gIGRlcGVuZGVuY2llcz86IFJlc291cmNlW11cbn1cblxuZXhwb3J0IGVudW0gV2lkZ2V0VHlwZSB7XG4gIE5vcm1hbCA9ICdOT1JNQUwnLFxuICBMYXlvdXQgPSAnTEFZT1VUJyxcbn1cblxuLyoqIEBpZ25vcmUgKi9cbmV4cG9ydCBpbnRlcmZhY2UgTGF5b3V0SXRlbUNvbnN0cnVjdG9yUHJvcHN7XG4gIGl0ZW1UeXBlOiBMYXlvdXRJdGVtVHlwZTtcblxuICAvLyBUaGUgZm9sbG93aW5nIHRocmVlIHByb3BlcnRpZXMgYXJlIHVzZWQgZm9yIHBlbmRpbmcgaXRlbXMuXG4gIGlkPzogc3RyaW5nOyAvLyBzZWN0aW9uSWQgb3Igd2lkZ2V0SWRcbiAgbGF5b3V0SW5mbz86IExheW91dEluZm87IC8vIFRoZSBleGlzdGVkIGxheW91dCBpbmZvIHRoYXQgaG9sZHMgdGhlIHdpZGdldC9zZWN0aW9uLlxuICBpc0Zyb21DdXJyZW50U2l6ZU1vZGU/OiBib29sZWFuOyAvLyBXaGV0aGVyIHRoZSBleGlzdGVkIGxheW91dCBpbmZvIGlzIGZyb20gdGhlIGN1cnJlbnQgc2l6ZSBtb2RlLlxuICByb3RhdGlvbj86IG51bWJlcjtcblxuICAvLyBUaGUgZm9sbG93aW5nIHByb3BlcnRpZXMgYXJlIHVzZWQgZm9yIGNyZWF0aW5nIG5ldyBsYXlvdXQgaXRlbSBmcm9tIHdpZGdldCBsaXN0LlxuICBuYW1lPzogc3RyaW5nO1xuICBtYW5pZmVzdDogUGFydGlhbDxXaWRnZXRNYW5pZmVzdD47XG4gIGxhYmVsOiBzdHJpbmc7XG4gIGRlc3JpcHRpb24/OiBzdHJpbmc7XG4gIHVyaTogc3RyaW5nO1xuICBpY29uOiBzdHJpbmcgfCBJY29uUmVzdWx0O1xufVxuXG5leHBvcnQgdHlwZSBFc3JpRGF0ZUZvcm1hdHMgPSAnc2hvcnREYXRlJyB8ICdzaG9ydERhdGVMRScgfCAnbG9uZ01vbnRoRGF5WWVhcicgfCAnZGF5U2hvcnRNb250aFllYXInIHwgJ2xvbmdEYXRlJyB8XG4gICdzaG9ydERhdGVTaG9ydFRpbWUnIHwgJ3Nob3J0RGF0ZUxFU2hvcnRUaW1lJyB8ICdzaG9ydERhdGVTaG9ydFRpbWUyNCcgfCAnc2hvcnREYXRlTEVTaG9ydFRpbWUyNCcgfCAnc2hvcnREYXRlTG9uZ1RpbWUnIHxcbiAgJ3Nob3J0RGF0ZUxFTG9uZ1RpbWUnIHwgJ3Nob3J0RGF0ZUxvbmdUaW1lMjQnIHwgJ3Nob3J0RGF0ZUxFTG9uZ1RpbWUyNCcgfCAnbG9uZ01vbnRoWWVhcicgfCAnc2hvcnRNb250aFllYXInIHwgJ3llYXInO1xuXG5leHBvcnQgY29uc3QgRVNSSV9EQVRFX0ZPUk1BVF9BUlJBWSA9IFsnc2hvcnREYXRlJywgJ3Nob3J0RGF0ZUxFJywgJ2xvbmdNb250aERheVllYXInLCAnZGF5U2hvcnRNb250aFllYXInLCAnbG9uZ0RhdGUnLFxuICAnc2hvcnREYXRlU2hvcnRUaW1lJywgJ3Nob3J0RGF0ZUxFU2hvcnRUaW1lJywgJ3Nob3J0RGF0ZVNob3J0VGltZTI0JywgJ3Nob3J0RGF0ZUxFU2hvcnRUaW1lMjQnLCAnc2hvcnREYXRlTG9uZ1RpbWUnLFxuICAnc2hvcnREYXRlTEVMb25nVGltZScsICdzaG9ydERhdGVMb25nVGltZTI0JywgJ3Nob3J0RGF0ZUxFTG9uZ1RpbWUyNCcsICdsb25nTW9udGhZZWFyJywgJ3Nob3J0TW9udGhZZWFyJywgJ3llYXInXG5dO1xuXG5leHBvcnQgaW50ZXJmYWNlIEVzcmlEYXRlRm9ybWF0IHtcbiAgZGF0ZVBhdHRlcm46IHN0cmluZztcbiAgdGltZVBhdHRlcm4/OiBzdHJpbmc7XG4gIHNlbGVjdG9yOiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFc3JpRGF0ZUZvcm1hdE1hcCB7XG4gIFt4OiBzdHJpbmddOiBFc3JpRGF0ZUZvcm1hdFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNlcnZpY2VJbmZve1xuICBkZWZpbml0aW9uOiBTZXJ2aWNlRGVmaW5pdGlvbjtcbiAgaXNIb3N0ZWRJblNhbWVQb3J0YWw6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBlbnVtIFBhZ2VQYXJ0e1xuICBIZWFkZXIgPSAnSEVBREVSJyxcbiAgRm9vdGVyID0gJ0ZPT1RFUicsXG4gIEJvZHkgPSAnQk9EWSdcbn1cblxuZXhwb3J0IGVudW0gVXJsUHJvdG9jb2x7XG4gIEh0dHAgPSAnaHR0cDonLFxuICBIdHRwcyA9ICdodHRwczonXG59XG5cbmV4cG9ydCBjb25zdCBBUFBfRlJBTUVfTkFNRV9JTl9CVUlMREVSID0gJ19hcHBXaW5kb3cnO1xuXG5leHBvcnQgaW50ZXJmYWNlIEFyY0dJU1NlcnZlckluZm97XG4gIGN1cnJlbnRWZXJzaW9uOiBudW1iZXIsXG4gIGZ1bGxWZXJzaW9uOiBzdHJpbmcsIC8vIEFkZGVkIGluIDEwLjEgLSByZXR1cm5zIHZlcnNpb24gaW5mb3JtYXRpb24gYXMgYSBTdHJpbmcuXG5cbiAgc29hcFVybD86IHN0cmluZyxcbiAgc2VjdXJlU29hcFVybD86IHN0cmluZyxcblxuICBvd25pbmdTeXN0ZW1Vcmw/OiBzdHJpbmcsIC8vIEFkZGVkIGluIDEwLjEgU1AxLCBmb3IgaG9zdGVkIHNlcnZlci5cbiAgb3duaW5nVGVuYW50Pzogc3RyaW5nLFxuXG4gIGF1dGhJbmZvOiB7XG4gICAgaXNUb2tlbkJhc2VkU2VjdXJpdHk6IGJvb2xlYW4sXG4gICAgdG9rZW5TZXJ2aWNlc1VybDogc3RyaW5nXG4gIH1cbn1cblxuZXhwb3J0IGVudW0gUmVzb3VyY2VUeXBlIHtcbiAgSW1hZ2UgPSAnSU1BR0UnLFxuICBDb25maWcgPSAnQ09ORklHJ1xufVxuXG5leHBvcnQgZW51bSBMb2FkaW5nVHlwZXtcbiAgUHJpbWFyeSA9ICdQUklNQVJZJyxcbiAgU2Vjb25kYXJ5ID0gJ1NFQ09OREFSWScsXG4gIEltYWdlID0gJ0lNQUdFJyxcbiAgRG9udXQgPSAnRE9OVVQnLFxufSJdLCJtYXBwaW5ncyI6IkFBV0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBYUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFzQkE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQXlCQTtBQUNBO0FBQ0E7QUFDQTtBQWlCQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFrQkE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOyIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./jimu-core/lib/types/common.ts\n");

/***/ }),

/***/ "jimu-core":
/*!****************************!*\
  !*** external "jimu-core" ***!
  \****************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = __WEBPACK_EXTERNAL_MODULE_jimu_core__;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiamltdS1jb3JlLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL2V4dGVybmFsIFwiamltdS1jb3JlXCI/YzY5NSJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfamltdV9jb3JlX187Il0sIm1hcHBpbmdzIjoiQUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///jimu-core\n");

/***/ })

/******/ })
			);
		}
	};
});